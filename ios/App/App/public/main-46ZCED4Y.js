import{d as jv}from"./chunk-EEDYPVYP.js";import"./chunk-FK6H3RFT.js";import"./chunk-EZ4MB5JR.js";import{a as Uv,b as mS}from"./chunk-3J7GGTVR.js";import{a as Bv,b as bh}from"./chunk-USGWMXIJ.js";import{a as L,b as le,c as Vv,f as Zi,g as w}from"./chunk-RA2WU32H.js";function Wv(n,e){return Object.is(n,e)}var xt=null,Ih=!1,qv=1,Hn=Symbol("SIGNAL");function Se(n){let e=xt;return xt=n,e}function Gv(){return xt}var Dl={version:0,lastCleanEpoch:0,dirty:!1,producerNode:void 0,producerLastReadVersion:void 0,producerIndexOfThis:void 0,nextProducerIndex:0,liveConsumerNode:void 0,liveConsumerIndexOfThis:void 0,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,kind:"unknown",producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{},consumerOnSignalRead:()=>{}};function Ml(n){if(Ih)throw new Error("");if(xt===null)return;xt.consumerOnSignalRead(n);let e=xt.nextProducerIndex++;if(Th(xt),e<xt.producerNode.length&&xt.producerNode[e]!==n&&Tl(xt)){let t=xt.producerNode[e];Sh(t,xt.producerIndexOfThis[e])}xt.producerNode[e]!==n&&(xt.producerNode[e]=n,xt.producerIndexOfThis[e]=Tl(xt)?vS(n,xt,e):0),xt.producerLastReadVersion[e]=n.version}function gS(){qv++}function Kv(n){if(!(Tl(n)&&!n.dirty)&&!(!n.dirty&&n.lastCleanEpoch===qv)){if(!n.producerMustRecompute(n)&&!Jv(n)){Hv(n);return}n.producerRecomputeValue(n),Hv(n)}}function Yv(n){if(n.liveConsumerNode===void 0)return;let e=Ih;Ih=!0;try{for(let t of n.liveConsumerNode)t.dirty||xL(t)}finally{Ih=e}}function Qv(){return xt?.consumerAllowSignalWrites!==!1}function xL(n){n.dirty=!0,Yv(n),n.consumerMarkedDirty?.(n)}function Hv(n){n.dirty=!1,n.lastCleanEpoch=qv}function xh(n){return n&&(n.nextProducerIndex=0),Se(n)}function Zv(n,e){if(Se(e),!(!n||n.producerNode===void 0||n.producerIndexOfThis===void 0||n.producerLastReadVersion===void 0)){if(Tl(n))for(let t=n.nextProducerIndex;t<n.producerNode.length;t++)Sh(n.producerNode[t],n.producerIndexOfThis[t]);for(;n.producerNode.length>n.nextProducerIndex;)n.producerNode.pop(),n.producerLastReadVersion.pop(),n.producerIndexOfThis.pop()}}function Jv(n){Th(n);for(let e=0;e<n.producerNode.length;e++){let t=n.producerNode[e],r=n.producerLastReadVersion[e];if(r!==t.version||(Kv(t),r!==t.version))return!0}return!1}function Xv(n){if(Th(n),Tl(n))for(let e=0;e<n.producerNode.length;e++)Sh(n.producerNode[e],n.producerIndexOfThis[e]);n.producerNode.length=n.producerLastReadVersion.length=n.producerIndexOfThis.length=0,n.liveConsumerNode&&(n.liveConsumerNode.length=n.liveConsumerIndexOfThis.length=0)}function vS(n,e,t){if(_S(n),n.liveConsumerNode.length===0&&yS(n))for(let r=0;r<n.producerNode.length;r++)n.producerIndexOfThis[r]=vS(n.producerNode[r],n,r);return n.liveConsumerIndexOfThis.push(t),n.liveConsumerNode.push(e)-1}function Sh(n,e){if(_S(n),n.liveConsumerNode.length===1&&yS(n))for(let r=0;r<n.producerNode.length;r++)Sh(n.producerNode[r],n.producerIndexOfThis[r]);let t=n.liveConsumerNode.length-1;if(n.liveConsumerNode[e]=n.liveConsumerNode[t],n.liveConsumerIndexOfThis[e]=n.liveConsumerIndexOfThis[t],n.liveConsumerNode.length--,n.liveConsumerIndexOfThis.length--,e<n.liveConsumerNode.length){let r=n.liveConsumerIndexOfThis[e],i=n.liveConsumerNode[e];Th(i),i.producerIndexOfThis[r]=e}}function Tl(n){return n.consumerIsAlwaysLive||(n?.liveConsumerNode?.length??0)>0}function Th(n){n.producerNode??=[],n.producerIndexOfThis??=[],n.producerLastReadVersion??=[]}function _S(n){n.liveConsumerNode??=[],n.liveConsumerIndexOfThis??=[]}function yS(n){return n.producerNode!==void 0}function e_(n,e){let t=Object.create(SL);t.computation=n,e!==void 0&&(t.equal=e);let r=()=>{if(Kv(t),Ml(t),t.value===Eh)throw t.error;return t.value};return r[Hn]=t,r}var $v=Symbol("UNSET"),zv=Symbol("COMPUTING"),Eh=Symbol("ERRORED"),SL=le(L({},Dl),{value:$v,dirty:!0,error:null,equal:Wv,kind:"computed",producerMustRecompute(n){return n.value===$v||n.value===zv},producerRecomputeValue(n){if(n.value===zv)throw new Error("Detected cycle in computations.");let e=n.value;n.value=zv;let t=xh(n),r,i=!1;try{r=n.computation(),Se(null),i=e!==$v&&e!==Eh&&r!==Eh&&n.equal(e,r)}catch(o){r=Eh,n.error=o}finally{Zv(n,t)}if(i){n.value=e;return}n.value=r,n.version++}});function TL(){throw new Error}var wS=TL;function CS(n){wS(n)}function t_(n){wS=n}var DL=null;function n_(n,e){let t=Object.create(Dh);t.value=n,e!==void 0&&(t.equal=e);let r=()=>(Ml(t),t.value);return r[Hn]=t,r}function Pl(n,e){Qv()||CS(n),n.equal(n.value,e)||(n.value=e,ML(n))}function r_(n,e){Qv()||CS(n),Pl(n,e(n.value))}var Dh=le(L({},Dl),{equal:Wv,value:void 0,kind:"signal"});function ML(n){n.version++,gS(),Yv(n),DL?.()}function i_(n){let e=Se(null);try{return n()}finally{Se(e)}}var o_;function Al(){return o_}function wi(n){let e=o_;return o_=n,e}var Mh=Symbol("NotFound");function ve(n){return typeof n=="function"}function ha(n){let t=n(r=>{Error.call(r),r.stack=new Error().stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}var Ph=ha(n=>function(t){n(this),this.message=t?`${t.length} errors occurred during unsubscription:
${t.map((r,i)=>`${i+1}) ${r.toString()}`).join(`
  `)}`:"",this.name="UnsubscriptionError",this.errors=t});function Yo(n,e){if(n){let t=n.indexOf(e);0<=t&&n.splice(t,1)}}var ht=class n{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;let{_parentage:t}=this;if(t)if(this._parentage=null,Array.isArray(t))for(let o of t)o.remove(this);else t.remove(this);let{initialTeardown:r}=this;if(ve(r))try{r()}catch(o){e=o instanceof Ph?o.errors:[o]}let{_finalizers:i}=this;if(i){this._finalizers=null;for(let o of i)try{bS(o)}catch(s){e=e??[],s instanceof Ph?e=[...e,...s.errors]:e.push(s)}}if(e)throw new Ph(e)}}add(e){var t;if(e&&e!==this)if(this.closed)bS(e);else{if(e instanceof n){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(t=this._finalizers)!==null&&t!==void 0?t:[]).push(e)}}_hasParent(e){let{_parentage:t}=this;return t===e||Array.isArray(t)&&t.includes(e)}_addParent(e){let{_parentage:t}=this;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e}_removeParent(e){let{_parentage:t}=this;t===e?this._parentage=null:Array.isArray(t)&&Yo(t,e)}remove(e){let{_finalizers:t}=this;t&&Yo(t,e),e instanceof n&&e._removeParent(this)}};ht.EMPTY=(()=>{let n=new ht;return n.closed=!0,n})();var s_=ht.EMPTY;function Ah(n){return n instanceof ht||n&&"closed"in n&&ve(n.remove)&&ve(n.add)&&ve(n.unsubscribe)}function bS(n){ve(n)?n():n.unsubscribe()}var ar={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1};var fa={setTimeout(n,e,...t){let{delegate:r}=fa;return r?.setTimeout?r.setTimeout(n,e,...t):setTimeout(n,e,...t)},clearTimeout(n){let{delegate:e}=fa;return(e?.clearTimeout||clearTimeout)(n)},delegate:void 0};function Oh(n){fa.setTimeout(()=>{let{onUnhandledError:e}=ar;if(e)e(n);else throw n})}function Qo(){}var IS=a_("C",void 0,void 0);function ES(n){return a_("E",void 0,n)}function xS(n){return a_("N",n,void 0)}function a_(n,e,t){return{kind:n,value:e,error:t}}var Zo=null;function pa(n){if(ar.useDeprecatedSynchronousErrorHandling){let e=!Zo;if(e&&(Zo={errorThrown:!1,error:null}),n(),e){let{errorThrown:t,error:r}=Zo;if(Zo=null,t)throw r}}else n()}function SS(n){ar.useDeprecatedSynchronousErrorHandling&&Zo&&(Zo.errorThrown=!0,Zo.error=n)}var Jo=class extends ht{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,Ah(e)&&e.add(this)):this.destination=kL}static create(e,t,r){return new ma(e,t,r)}next(e){this.isStopped?l_(xS(e),this):this._next(e)}error(e){this.isStopped?l_(ES(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?l_(IS,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}},NL=Function.prototype.bind;function c_(n,e){return NL.call(n,e)}var u_=class{constructor(e){this.partialObserver=e}next(e){let{partialObserver:t}=this;if(t.next)try{t.next(e)}catch(r){Nh(r)}}error(e){let{partialObserver:t}=this;if(t.error)try{t.error(e)}catch(r){Nh(r)}else Nh(e)}complete(){let{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(t){Nh(t)}}},ma=class extends Jo{constructor(e,t,r){super();let i;if(ve(e)||!e)i={next:e??void 0,error:t??void 0,complete:r??void 0};else{let o;this&&ar.useDeprecatedNextContext?(o=Object.create(e),o.unsubscribe=()=>this.unsubscribe(),i={next:e.next&&c_(e.next,o),error:e.error&&c_(e.error,o),complete:e.complete&&c_(e.complete,o)}):i=e}this.destination=new u_(i)}};function Nh(n){ar.useDeprecatedSynchronousErrorHandling?SS(n):Oh(n)}function RL(n){throw n}function l_(n,e){let{onStoppedNotification:t}=ar;t&&fa.setTimeout(()=>t(n,e))}var kL={closed:!0,next:Qo,error:RL,complete:Qo};var ga=typeof Symbol=="function"&&Symbol.observable||"@@observable";function On(n){return n}function Rh(...n){return d_(n)}function d_(n){return n.length===0?On:n.length===1?n[0]:function(t){return n.reduce((r,i)=>i(r),t)}}var me=(()=>{class n{constructor(t){t&&(this._subscribe=t)}lift(t){let r=new n;return r.source=this,r.operator=t,r}subscribe(t,r,i){let o=LL(t)?t:new ma(t,r,i);return pa(()=>{let{operator:s,source:a}=this;o.add(s?s.call(o,a):a?this._subscribe(o):this._trySubscribe(o))}),o}_trySubscribe(t){try{return this._subscribe(t)}catch(r){t.error(r)}}forEach(t,r){return r=TS(r),new r((i,o)=>{let s=new ma({next:a=>{try{t(a)}catch(c){o(c),s.unsubscribe()}},error:o,complete:i});this.subscribe(s)})}_subscribe(t){var r;return(r=this.source)===null||r===void 0?void 0:r.subscribe(t)}[ga](){return this}pipe(...t){return d_(t)(this)}toPromise(t){return t=TS(t),new t((r,i)=>{let o;this.subscribe(s=>o=s,s=>i(s),()=>r(o))})}}return n.create=e=>new n(e),n})();function TS(n){var e;return(e=n??ar.Promise)!==null&&e!==void 0?e:Promise}function FL(n){return n&&ve(n.next)&&ve(n.error)&&ve(n.complete)}function LL(n){return n&&n instanceof Jo||FL(n)&&Ah(n)}function h_(n){return ve(n?.lift)}function Oe(n){return e=>{if(h_(e))return e.lift(function(t){try{return n(t,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function Te(n,e,t,r,i){return new f_(n,e,t,r,i)}var f_=class extends Jo{constructor(e,t,r,i,o,s){super(e),this.onFinalize=o,this.shouldUnsubscribe=s,this._next=t?function(a){try{t(a)}catch(c){e.error(c)}}:super._next,this._error=i?function(a){try{i(a)}catch(c){e.error(c)}finally{this.unsubscribe()}}:super._error,this._complete=r?function(){try{r()}catch(a){e.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){let{closed:t}=this;super.unsubscribe(),!t&&((e=this.onFinalize)===null||e===void 0||e.call(this))}}};function va(){return Oe((n,e)=>{let t=null;n._refCount++;let r=Te(e,void 0,void 0,void 0,()=>{if(!n||n._refCount<=0||0<--n._refCount){t=null;return}let i=n._connection,o=t;t=null,i&&(!o||i===o)&&i.unsubscribe(),e.unsubscribe()});n.subscribe(r),r.closed||(t=n.connect())})}var _a=class extends me{constructor(e,t){super(),this.source=e,this.subjectFactory=t,this._subject=null,this._refCount=0,this._connection=null,h_(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){let e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;let{_connection:e}=this;this._subject=this._connection=null,e?.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new ht;let t=this.getSubject();e.add(this.source.subscribe(Te(t,void 0,()=>{this._teardown(),t.complete()},r=>{this._teardown(),t.error(r)},()=>this._teardown()))),e.closed&&(this._connection=null,e=ht.EMPTY)}return e}refCount(){return va()(this)}};var DS=ha(n=>function(){n(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var ct=(()=>{class n extends me{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(t){let r=new kh(this,this);return r.operator=t,r}_throwIfClosed(){if(this.closed)throw new DS}next(t){pa(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(let r of this.currentObservers)r.next(t)}})}error(t){pa(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=t;let{observers:r}=this;for(;r.length;)r.shift().error(t)}})}complete(){pa(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;let{observers:t}=this;for(;t.length;)t.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var t;return((t=this.observers)===null||t===void 0?void 0:t.length)>0}_trySubscribe(t){return this._throwIfClosed(),super._trySubscribe(t)}_subscribe(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)}_innerSubscribe(t){let{hasError:r,isStopped:i,observers:o}=this;return r||i?s_:(this.currentObservers=null,o.push(t),new ht(()=>{this.currentObservers=null,Yo(o,t)}))}_checkFinalizedStatuses(t){let{hasError:r,thrownError:i,isStopped:o}=this;r?t.error(i):o&&t.complete()}asObservable(){let t=new me;return t.source=this,t}}return n.create=(e,t)=>new kh(e,t),n})(),kh=class extends ct{constructor(e,t){super(),this.destination=e,this.source=t}next(e){var t,r;(r=(t=this.destination)===null||t===void 0?void 0:t.next)===null||r===void 0||r.call(t,e)}error(e){var t,r;(r=(t=this.destination)===null||t===void 0?void 0:t.error)===null||r===void 0||r.call(t,e)}complete(){var e,t;(t=(e=this.destination)===null||e===void 0?void 0:e.complete)===null||t===void 0||t.call(e)}_subscribe(e){var t,r;return(r=(t=this.source)===null||t===void 0?void 0:t.subscribe(e))!==null&&r!==void 0?r:s_}};var Bt=class extends ct{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){let t=super._subscribe(e);return!t.closed&&e.next(this._value),t}getValue(){let{hasError:e,thrownError:t,_value:r}=this;if(e)throw t;return this._throwIfClosed(),r}next(e){super.next(this._value=e)}};var p_={now(){return(p_.delegate||Date).now()},delegate:void 0};var Fh=class extends ht{constructor(e,t){super()}schedule(e,t=0){return this}};var Ol={setInterval(n,e,...t){let{delegate:r}=Ol;return r?.setInterval?r.setInterval(n,e,...t):setInterval(n,e,...t)},clearInterval(n){let{delegate:e}=Ol;return(e?.clearInterval||clearInterval)(n)},delegate:void 0};var ya=class extends Fh{constructor(e,t){super(e,t),this.scheduler=e,this.work=t,this.pending=!1}schedule(e,t=0){var r;if(this.closed)return this;this.state=e;let i=this.id,o=this.scheduler;return i!=null&&(this.id=this.recycleAsyncId(o,i,t)),this.pending=!0,this.delay=t,this.id=(r=this.id)!==null&&r!==void 0?r:this.requestAsyncId(o,this.id,t),this}requestAsyncId(e,t,r=0){return Ol.setInterval(e.flush.bind(e,this),r)}recycleAsyncId(e,t,r=0){if(r!=null&&this.delay===r&&this.pending===!1)return t;t!=null&&Ol.clearInterval(t)}execute(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;let r=this._execute(e,t);if(r)return r;this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,t){let r=!1,i;try{this.work(e)}catch(o){r=!0,i=o||new Error("Scheduled action threw falsy error")}if(r)return this.unsubscribe(),i}unsubscribe(){if(!this.closed){let{id:e,scheduler:t}=this,{actions:r}=t;this.work=this.state=this.scheduler=null,this.pending=!1,Yo(r,this),e!=null&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null,super.unsubscribe()}}};var wa=class n{constructor(e,t=n.now){this.schedulerActionCtor=e,this.now=t}schedule(e,t=0,r){return new this.schedulerActionCtor(this,e).schedule(r,t)}};wa.now=p_.now;var Ca=class extends wa{constructor(e,t=wa.now){super(e,t),this.actions=[],this._active=!1}flush(e){let{actions:t}=this;if(this._active){t.push(e);return}let r;this._active=!0;do if(r=e.execute(e.state,e.delay))break;while(e=t.shift());if(this._active=!1,r){for(;e=t.shift();)e.unsubscribe();throw r}}};var m_=new Ca(ya);var Lh=class extends ya{constructor(e,t){super(e,t),this.scheduler=e,this.work=t}schedule(e,t=0){return t>0?super.schedule(e,t):(this.delay=t,this.state=e,this.scheduler.flush(this),this)}execute(e,t){return t>0||this.closed?super.execute(e,t):this._execute(e,t)}requestAsyncId(e,t,r=0){return r!=null&&r>0||r==null&&this.delay>0?super.requestAsyncId(e,t,r):(e.flush(this),0)}};var Vh=class extends Ca{};var g_=new Vh(Lh);var _n=new me(n=>n.complete());function MS(n){return n&&ve(n.schedule)}function PS(n){return n[n.length-1]}function jh(n){return ve(PS(n))?n.pop():void 0}function Ji(n){return MS(PS(n))?n.pop():void 0}function v_(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(t[r[i]]=n[r[i]]);return t}function OS(n,e,t,r){function i(o){return o instanceof t?o:new t(function(s){s(o)})}return new(t||(t=Promise))(function(o,s){function a(d){try{u(r.next(d))}catch(f){s(f)}}function c(d){try{u(r.throw(d))}catch(f){s(f)}}function u(d){d.done?o(d.value):i(d.value).then(a,c)}u((r=r.apply(n,e||[])).next())})}function AS(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],r=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Xo(n){return this instanceof Xo?(this.v=n,this):new Xo(n)}function NS(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=t.apply(n,e||[]),i,o=[];return i=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),a("next"),a("throw"),a("return",s),i[Symbol.asyncIterator]=function(){return this},i;function s(_){return function(b){return Promise.resolve(b).then(_,f)}}function a(_,b){r[_]&&(i[_]=function(N){return new Promise(function(R,G){o.push([_,N,R,G])>1||c(_,N)})},b&&(i[_]=b(i[_])))}function c(_,b){try{u(r[_](b))}catch(N){v(o[0][3],N)}}function u(_){_.value instanceof Xo?Promise.resolve(_.value.v).then(d,f):v(o[0][2],_)}function d(_){c("next",_)}function f(_){c("throw",_)}function v(_,b){_(b),o.shift(),o.length&&c(o[0][0],o[0][1])}}function RS(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof AS=="function"?AS(n):n[Symbol.iterator](),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(o){t[o]=n[o]&&function(s){return new Promise(function(a,c){s=n[o](s),i(a,c,s.done,s.value)})}}function i(o,s,a,c){Promise.resolve(c).then(function(u){o({value:u,done:a})},s)}}var Bh=n=>n&&typeof n.length=="number"&&typeof n!="function";function Uh(n){return ve(n?.then)}function $h(n){return ve(n[ga])}function zh(n){return Symbol.asyncIterator&&ve(n?.[Symbol.asyncIterator])}function Hh(n){return new TypeError(`You provided ${n!==null&&typeof n=="object"?"an invalid object":`'${n}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}function VL(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var Wh=VL();function qh(n){return ve(n?.[Wh])}function Gh(n){return NS(this,arguments,function*(){let t=n.getReader();try{for(;;){let{value:r,done:i}=yield Xo(t.read());if(i)return yield Xo(void 0);yield yield Xo(r)}}finally{t.releaseLock()}})}function Kh(n){return ve(n?.getReader)}function vt(n){if(n instanceof me)return n;if(n!=null){if($h(n))return jL(n);if(Bh(n))return BL(n);if(Uh(n))return UL(n);if(zh(n))return kS(n);if(qh(n))return $L(n);if(Kh(n))return zL(n)}throw Hh(n)}function jL(n){return new me(e=>{let t=n[ga]();if(ve(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function BL(n){return new me(e=>{for(let t=0;t<n.length&&!e.closed;t++)e.next(n[t]);e.complete()})}function UL(n){return new me(e=>{n.then(t=>{e.closed||(e.next(t),e.complete())},t=>e.error(t)).then(null,Oh)})}function $L(n){return new me(e=>{for(let t of n)if(e.next(t),e.closed)return;e.complete()})}function kS(n){return new me(e=>{HL(n,e).catch(t=>e.error(t))})}function zL(n){return kS(Gh(n))}function HL(n,e){var t,r,i,o;return OS(this,void 0,void 0,function*(){try{for(t=RS(n);r=yield t.next(),!r.done;){let s=r.value;if(e.next(s),e.closed)return}}catch(s){i={error:s}}finally{try{r&&!r.done&&(o=t.return)&&(yield o.call(t))}finally{if(i)throw i.error}}e.complete()})}function yn(n,e,t,r=0,i=!1){let o=e.schedule(function(){t(),i?n.add(this.schedule(null,r)):this.unsubscribe()},r);if(n.add(o),!i)return o}function Xi(n,e=0){return Oe((t,r)=>{t.subscribe(Te(r,i=>yn(r,n,()=>r.next(i),e),()=>yn(r,n,()=>r.complete(),e),i=>yn(r,n,()=>r.error(i),e)))})}function eo(n,e=0){return Oe((t,r)=>{r.add(n.schedule(()=>t.subscribe(r),e))})}function FS(n,e){return vt(n).pipe(eo(e),Xi(e))}function LS(n,e){return vt(n).pipe(eo(e),Xi(e))}function VS(n,e){return new me(t=>{let r=0;return e.schedule(function(){r===n.length?t.complete():(t.next(n[r++]),t.closed||this.schedule())})})}function jS(n,e){return new me(t=>{let r;return yn(t,e,()=>{r=n[Wh](),yn(t,e,()=>{let i,o;try{({value:i,done:o}=r.next())}catch(s){t.error(s);return}o?t.complete():t.next(i)},0,!0)}),()=>ve(r?.return)&&r.return()})}function Yh(n,e){if(!n)throw new Error("Iterable cannot be null");return new me(t=>{yn(t,e,()=>{let r=n[Symbol.asyncIterator]();yn(t,e,()=>{r.next().then(i=>{i.done?t.complete():t.next(i.value)})},0,!0)})})}function BS(n,e){return Yh(Gh(n),e)}function US(n,e){if(n!=null){if($h(n))return FS(n,e);if(Bh(n))return VS(n,e);if(Uh(n))return LS(n,e);if(zh(n))return Yh(n,e);if(qh(n))return jS(n,e);if(Kh(n))return BS(n,e)}throw Hh(n)}function nt(n,e){return e?US(n,e):vt(n)}function fe(...n){let e=Ji(n);return nt(n,e)}function ba(n,e){let t=ve(n)?n:()=>n,r=i=>i.error(t());return new me(e?i=>e.schedule(r,0,i):r)}function __(n){return!!n&&(n instanceof me||ve(n.lift)&&ve(n.subscribe))}var Ci=ha(n=>function(){n(this),this.name="EmptyError",this.message="no elements in sequence"});function _e(n,e){return Oe((t,r)=>{let i=0;t.subscribe(Te(r,o=>{r.next(n.call(e,o,i++))}))})}var{isArray:WL}=Array;function qL(n,e){return WL(e)?n(...e):n(e)}function Qh(n){return _e(e=>qL(n,e))}var{isArray:GL}=Array,{getPrototypeOf:KL,prototype:YL,keys:QL}=Object;function Zh(n){if(n.length===1){let e=n[0];if(GL(e))return{args:e,keys:null};if(ZL(e)){let t=QL(e);return{args:t.map(r=>e[r]),keys:t}}}return{args:n,keys:null}}function ZL(n){return n&&typeof n=="object"&&KL(n)===YL}function Jh(n,e){return n.reduce((t,r,i)=>(t[r]=e[i],t),{})}function Nl(...n){let e=Ji(n),t=jh(n),{args:r,keys:i}=Zh(n);if(r.length===0)return nt([],e);let o=new me(JL(r,e,i?s=>Jh(i,s):On));return t?o.pipe(Qh(t)):o}function JL(n,e,t=On){return r=>{$S(e,()=>{let{length:i}=n,o=new Array(i),s=i,a=i;for(let c=0;c<i;c++)$S(e,()=>{let u=nt(n[c],e),d=!1;u.subscribe(Te(r,f=>{o[c]=f,d||(d=!0,a--),a||r.next(t(o.slice()))},()=>{--s||r.complete()}))},r)},r)}}function $S(n,e,t){n?yn(t,n,e):e()}function zS(n,e,t,r,i,o,s,a){let c=[],u=0,d=0,f=!1,v=()=>{f&&!c.length&&!u&&e.complete()},_=N=>u<r?b(N):c.push(N),b=N=>{o&&e.next(N),u++;let R=!1;vt(t(N,d++)).subscribe(Te(e,G=>{i?.(G),o?_(G):e.next(G)},()=>{R=!0},void 0,()=>{if(R)try{for(u--;c.length&&u<r;){let G=c.shift();s?yn(e,s,()=>b(G)):b(G)}v()}catch(G){e.error(G)}}))};return n.subscribe(Te(e,_,()=>{f=!0,v()})),()=>{a?.()}}function mt(n,e,t=1/0){return ve(e)?mt((r,i)=>_e((o,s)=>e(r,o,i,s))(vt(n(r,i))),t):(typeof e=="number"&&(t=e),Oe((r,i)=>zS(r,i,n,t)))}function Ia(n=1/0){return mt(On,n)}function HS(){return Ia(1)}function Ea(...n){return HS()(nt(n,Ji(n)))}function Xh(n){return new me(e=>{vt(n()).subscribe(e)})}function y_(...n){let e=jh(n),{args:t,keys:r}=Zh(n),i=new me(o=>{let{length:s}=t;if(!s){o.complete();return}let a=new Array(s),c=s,u=s;for(let d=0;d<s;d++){let f=!1;vt(t[d]).subscribe(Te(o,v=>{f||(f=!0,u--),a[d]=v},()=>c--,void 0,()=>{(!c||!f)&&(u||o.next(r?Jh(r,a):a),o.complete())}))}});return e?i.pipe(Qh(e)):i}var es=new me(Qo);function Ut(n,e){return Oe((t,r)=>{let i=0;t.subscribe(Te(r,o=>n.call(e,o,i++)&&r.next(o)))})}function bi(n){return Oe((e,t)=>{let r=null,i=!1,o;r=e.subscribe(Te(t,void 0,void 0,s=>{o=vt(n(s,bi(n)(e))),r?(r.unsubscribe(),r=null,o.subscribe(t)):i=!0})),i&&(r.unsubscribe(),r=null,o.subscribe(t))})}function WS(n,e,t,r,i){return(o,s)=>{let a=t,c=e,u=0;o.subscribe(Te(s,d=>{let f=u++;c=a?n(c,d,f):(a=!0,d),r&&s.next(c)},i&&(()=>{a&&s.next(c),s.complete()})))}}function to(n,e){return ve(e)?mt(n,e,1):mt(n,1)}function no(n){return Oe((e,t)=>{let r=!1;e.subscribe(Te(t,i=>{r=!0,t.next(i)},()=>{r||t.next(n),t.complete()}))})}function hn(n){return n<=0?()=>_n:Oe((e,t)=>{let r=0;e.subscribe(Te(t,i=>{++r<=n&&(t.next(i),n<=r&&t.complete())}))})}function ef(n=XL){return Oe((e,t)=>{let r=!1;e.subscribe(Te(t,i=>{r=!0,t.next(i)},()=>r?t.complete():t.error(n())))})}function XL(){return new Ci}function Rl(n){return Oe((e,t)=>{try{e.subscribe(t)}finally{t.add(n)}})}function Ii(n,e){let t=arguments.length>=2;return r=>r.pipe(n?Ut((i,o)=>n(i,o,r)):On,hn(1),t?no(e):ef(()=>new Ci))}function xa(n){return n<=0?()=>_n:Oe((e,t)=>{let r=[];e.subscribe(Te(t,i=>{r.push(i),n<r.length&&r.shift()},()=>{for(let i of r)t.next(i);t.complete()},void 0,()=>{r=null}))})}function w_(n,e){let t=arguments.length>=2;return r=>r.pipe(n?Ut((i,o)=>n(i,o,r)):On,xa(1),t?no(e):ef(()=>new Ci))}function tf(n,e){return Oe(WS(n,e,arguments.length>=2,!0))}function nf(...n){let e=Ji(n);return Oe((t,r)=>{(e?Ea(n,t,e):Ea(n,t)).subscribe(r)})}function $t(n,e){return Oe((t,r)=>{let i=null,o=0,s=!1,a=()=>s&&!i&&r.complete();t.subscribe(Te(r,c=>{i?.unsubscribe();let u=0,d=o++;vt(n(c,d)).subscribe(i=Te(r,f=>r.next(e?e(c,f,d,u++):f),()=>{i=null,a()}))},()=>{s=!0,a()}))})}function C_(n){return Oe((e,t)=>{vt(n).subscribe(Te(t,()=>t.complete(),Qo)),!t.closed&&e.subscribe(t)})}function zt(n,e,t){let r=ve(n)||e||t?{next:n,error:e,complete:t}:n;return r?Oe((i,o)=>{var s;(s=r.subscribe)===null||s===void 0||s.call(r);let a=!0;i.subscribe(Te(o,c=>{var u;(u=r.next)===null||u===void 0||u.call(r,c),o.next(c)},()=>{var c;a=!1,(c=r.complete)===null||c===void 0||c.call(r),o.complete()},c=>{var u;a=!1,(u=r.error)===null||u===void 0||u.call(r,c),o.error(c)},()=>{var c,u;a&&((c=r.unsubscribe)===null||c===void 0||c.call(r)),(u=r.finalize)===null||u===void 0||u.call(r)}))}):On}var eV="https://angular.dev/best-practices/security#preventing-cross-site-scripting-xss",Z=class extends Error{code;constructor(e,t){super(Lf(e,t)),this.code=e}};function tV(n){return`NG0${Math.abs(n)}`}function Lf(n,e){return`${tV(n)}${e?": "+e:""}`}var OT=Symbol("InputSignalNode#UNSET"),nV=le(L({},Dh),{transformFn:void 0,applyValueToInputSignal(n,e){Pl(n,e)}});function NT(n,e){let t=Object.create(nV);t.value=n,t.transformFn=e?.transform;function r(){if(Ml(t),t.value===OT){let i=null;throw new Z(-950,i)}return t.value}return r[Hn]=t,r}function Gl(n){return{toString:n}.toString()}var rf="__parameters__";function rV(n){return function(...t){if(n){let r=n(...t);for(let i in r)this[i]=r[i]}}}function RT(n,e,t){return Gl(()=>{let r=rV(e);function i(...o){if(this instanceof i)return r.apply(this,o),this;let s=new i(...o);return a.annotation=s,a;function a(c,u,d){let f=c.hasOwnProperty(rf)?c[rf]:Object.defineProperty(c,rf,{value:[]})[rf];for(;f.length<=d;)f.push(null);return(f[d]=f[d]||[]).push(s),c}}return i.prototype.ngMetadataName=n,i.annotationCls=i,i})}var Fl=globalThis;function Ye(n){for(let e in n)if(n[e]===Ye)return e;throw Error("Could not find renamed property on target object.")}function iV(n,e){for(let t in e)e.hasOwnProperty(t)&&!n.hasOwnProperty(t)&&(n[t]=e[t])}function bn(n){if(typeof n=="string")return n;if(Array.isArray(n))return`[${n.map(bn).join(", ")}]`;if(n==null)return""+n;let e=n.overriddenName||n.name;if(e)return`${e}`;let t=n.toString();if(t==null)return""+t;let r=t.indexOf(`
`);return r>=0?t.slice(0,r):t}function F_(n,e){return n?e?`${n} ${e}`:n:e||""}var oV=Ye({__forward_ref__:Ye});function mn(n){return n.__forward_ref__=mn,n.toString=function(){return bn(this())},n}function fn(n){return kT(n)?n():n}function kT(n){return typeof n=="function"&&n.hasOwnProperty(oV)&&n.__forward_ref__===mn}function H(n){return{token:n.token,providedIn:n.providedIn||null,factory:n.factory,value:void 0}}function jr(n){return{providers:n.providers||[],imports:n.imports||[]}}function Vf(n){return qS(n,LT)||qS(n,VT)}function FT(n){return Vf(n)!==null}function qS(n,e){return n.hasOwnProperty(e)?n[e]:null}function sV(n){let e=n&&(n[LT]||n[VT]);return e||null}function GS(n){return n&&(n.hasOwnProperty(KS)||n.hasOwnProperty(aV))?n[KS]:null}var LT=Ye({\u0275prov:Ye}),KS=Ye({\u0275inj:Ye}),VT=Ye({ngInjectableDef:Ye}),aV=Ye({ngInjectorDef:Ye}),J=class{_desc;ngMetadataName="InjectionToken";\u0275prov;constructor(e,t){this._desc=e,this.\u0275prov=void 0,typeof t=="number"?this.__NG_ELEMENT_ID__=t:t!==void 0&&(this.\u0275prov=H({token:this,providedIn:t.providedIn||"root",factory:t.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}};function jT(n){return n&&!!n.\u0275providers}var cV=Ye({\u0275cmp:Ye}),lV=Ye({\u0275dir:Ye}),uV=Ye({\u0275pipe:Ye}),dV=Ye({\u0275mod:Ye}),df=Ye({\u0275fac:Ye}),jl=Ye({__NG_ELEMENT_ID__:Ye}),YS=Ye({__NG_ENV_ID__:Ye});function Bl(n){return typeof n=="string"?n:n==null?"":String(n)}function hV(n){return typeof n=="function"?n.name||n.toString():typeof n=="object"&&n!=null&&typeof n.type=="function"?n.type.name||n.type.toString():Bl(n)}function BT(n,e){throw new Z(-200,n)}function Sy(n,e){throw new Z(-201,!1)}var be=function(n){return n[n.Default=0]="Default",n[n.Host=1]="Host",n[n.Self=2]="Self",n[n.SkipSelf=4]="SkipSelf",n[n.Optional=8]="Optional",n}(be||{}),L_;function UT(){return L_}function wn(n){let e=L_;return L_=n,e}function $T(n,e,t){let r=Vf(n);if(r&&r.providedIn=="root")return r.value===void 0?r.value=r.factory():r.value;if(t&be.Optional)return null;if(e!==void 0)return e;Sy(n,"Injector")}var fV={},ns=fV,V_="__NG_DI_FLAG__",hf=class{injector;constructor(e){this.injector=e}retrieve(e,t){let r=t;return this.injector.get(e,r.optional?Mh:ns,r)}},ff="ngTempTokenPath",pV="ngTokenPath",mV=/\n/gm,gV="\u0275",QS="__source";function vV(n,e=be.Default){if(Al()===void 0)throw new Z(-203,!1);if(Al()===null)return $T(n,void 0,e);{let t=Al(),r;return t instanceof hf?r=t.injector:r=t,r.get(n,e&be.Optional?null:void 0,e)}}function ee(n,e=be.Default){return(UT()||vV)(fn(n),e)}function j(n,e=be.Default){return ee(n,jf(e))}function jf(n){return typeof n>"u"||typeof n=="number"?n:0|(n.optional&&8)|(n.host&&1)|(n.self&&2)|(n.skipSelf&&4)}function j_(n){let e=[];for(let t=0;t<n.length;t++){let r=fn(n[t]);if(Array.isArray(r)){if(r.length===0)throw new Z(900,!1);let i,o=be.Default;for(let s=0;s<r.length;s++){let a=r[s],c=_V(a);typeof c=="number"?c===-1?i=a.token:o|=c:i=a}e.push(ee(i,o))}else e.push(ee(r))}return e}function zT(n,e){return n[V_]=e,n.prototype[V_]=e,n}function _V(n){return n[V_]}function yV(n,e,t,r){let i=n[ff];throw e[QS]&&i.unshift(e[QS]),n.message=wV(`
`+n.message,i,t,r),n[pV]=i,n[ff]=null,n}function wV(n,e,t,r=null){n=n&&n.charAt(0)===`
`&&n.charAt(1)==gV?n.slice(2):n;let i=bn(e);if(Array.isArray(e))i=e.map(bn).join(" -> ");else if(typeof e=="object"){let o=[];for(let s in e)if(e.hasOwnProperty(s)){let a=e[s];o.push(s+":"+(typeof a=="string"?JSON.stringify(a):bn(a)))}i=`{${o.join(", ")}}`}return`${t}${r?"("+r+")":""}[${i}]: ${n.replace(mV,`
  `)}`}var Mt=zT(RT("Optional"),8);var CV=zT(RT("SkipSelf"),4);function is(n,e){let t=n.hasOwnProperty(df);return t?n[df]:null}function Ty(n,e){n.forEach(t=>Array.isArray(t)?Ty(t,e):e(t))}function HT(n,e,t){e>=n.length?n.push(t):n.splice(e,0,t)}function pf(n,e){return e>=n.length-1?n.pop():n.splice(e,1)[0]}function bV(n,e,t,r){let i=n.length;if(i==e)n.push(t,r);else if(i===1)n.push(r,n[0]),n[0]=t;else{for(i--,n.push(n[i-1],n[i]);i>e;){let o=i-2;n[i]=n[o],i--}n[e]=t,n[e+1]=r}}function Dy(n,e,t){let r=Kl(n,e);return r>=0?n[r|1]=t:(r=~r,bV(n,r,e,t)),r}function b_(n,e){let t=Kl(n,e);if(t>=0)return n[t|1]}function Kl(n,e){return IV(n,e,1)}function IV(n,e,t){let r=0,i=n.length>>t;for(;i!==r;){let o=r+(i-r>>1),s=n[o<<t];if(e===s)return o<<t;s>e?i=o:r=o+1}return~(i<<t)}var os={},Cn=[],Ul=new J(""),WT=new J("",-1),qT=new J(""),mf=class{get(e,t=ns){if(t===ns){let r=new Error(`NullInjectorError: No provider for ${bn(e)}!`);throw r.name="NullInjectorError",r}return t}};function GT(n,e){let t=n[dV]||null;if(!t&&e===!0)throw new Error(`Type ${bn(n)} does not have '\u0275mod' property.`);return t}function ss(n){return n[cV]||null}function EV(n){return n[lV]||null}function xV(n){return n[uV]||null}function En(n){return{\u0275providers:n}}function My(...n){return{\u0275providers:KT(!0,n),\u0275fromNgModule:!0}}function KT(n,...e){let t=[],r=new Set,i,o=s=>{t.push(s)};return Ty(e,s=>{let a=s;B_(a,o,[],r)&&(i||=[],i.push(a))}),i!==void 0&&YT(i,o),t}function YT(n,e){for(let t=0;t<n.length;t++){let{ngModule:r,providers:i}=n[t];Py(i,o=>{e(o,r)})}}function B_(n,e,t,r){if(n=fn(n),!n)return!1;let i=null,o=GS(n),s=!o&&ss(n);if(!o&&!s){let c=n.ngModule;if(o=GS(c),o)i=c;else return!1}else{if(s&&!s.standalone)return!1;i=n}let a=r.has(i);if(s){if(a)return!1;if(r.add(i),s.dependencies){let c=typeof s.dependencies=="function"?s.dependencies():s.dependencies;for(let u of c)B_(u,e,t,r)}}else if(o){if(o.imports!=null&&!a){r.add(i);let u;try{Ty(o.imports,d=>{B_(d,e,t,r)&&(u||=[],u.push(d))})}finally{}u!==void 0&&YT(u,e)}if(!a){let u=is(i)||(()=>new i);e({provide:i,useFactory:u,deps:Cn},i),e({provide:qT,useValue:i,multi:!0},i),e({provide:Ul,useValue:()=>ee(i),multi:!0},i)}let c=o.providers;if(c!=null&&!a){let u=n;Py(c,d=>{e(d,u)})}}else return!1;return i!==n&&n.providers!==void 0}function Py(n,e){for(let t of n)jT(t)&&(t=t.\u0275providers),Array.isArray(t)?Py(t,e):e(t)}var SV=Ye({provide:String,useValue:Ye});function QT(n){return n!==null&&typeof n=="object"&&SV in n}function TV(n){return!!(n&&n.useExisting)}function DV(n){return!!(n&&n.useFactory)}function Oa(n){return typeof n=="function"}function MV(n){return!!n.useClass}var Bf=new J(""),sf={},ZS={},I_;function Ay(){return I_===void 0&&(I_=new mf),I_}var en=class{},$l=class extends en{parent;source;scopes;records=new Map;_ngOnDestroyHooks=new Set;_onDestroyHooks=[];get destroyed(){return this._destroyed}_destroyed=!1;injectorDefTypes;constructor(e,t,r,i){super(),this.parent=t,this.source=r,this.scopes=i,$_(e,s=>this.processProvider(s)),this.records.set(WT,Sa(void 0,this)),i.has("environment")&&this.records.set(en,Sa(void 0,this));let o=this.records.get(Bf);o!=null&&typeof o.value=="string"&&this.scopes.add(o.value),this.injectorDefTypes=new Set(this.get(qT,Cn,be.Self))}retrieve(e,t){let r=t;return this.get(e,r.optional?Mh:ns,r)}destroy(){Ll(this),this._destroyed=!0;let e=Se(null);try{for(let r of this._ngOnDestroyHooks)r.ngOnDestroy();let t=this._onDestroyHooks;this._onDestroyHooks=[];for(let r of t)r()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),Se(e)}}onDestroy(e){return Ll(this),this._onDestroyHooks.push(e),()=>this.removeOnDestroy(e)}runInContext(e){Ll(this);let t=wi(this),r=wn(void 0),i;try{return e()}finally{wi(t),wn(r)}}get(e,t=ns,r=be.Default){if(Ll(this),e.hasOwnProperty(YS))return e[YS](this);r=jf(r);let i,o=wi(this),s=wn(void 0);try{if(!(r&be.SkipSelf)){let c=this.records.get(e);if(c===void 0){let u=RV(e)&&Vf(e);u&&this.injectableDefInScope(u)?c=Sa(U_(e),sf):c=null,this.records.set(e,c)}if(c!=null)return this.hydrate(e,c,r)}let a=r&be.Self?Ay():this.parent;return t=r&be.Optional&&t===ns?null:t,a.get(e,t)}catch(a){if(a.name==="NullInjectorError"){if((a[ff]=a[ff]||[]).unshift(bn(e)),o)throw a;return yV(a,e,"R3InjectorError",this.source)}else throw a}finally{wn(s),wi(o)}}resolveInjectorInitializers(){let e=Se(null),t=wi(this),r=wn(void 0),i;try{let o=this.get(Ul,Cn,be.Self);for(let s of o)s()}finally{wi(t),wn(r),Se(e)}}toString(){let e=[],t=this.records;for(let r of t.keys())e.push(bn(r));return`R3Injector[${e.join(", ")}]`}processProvider(e){e=fn(e);let t=Oa(e)?e:fn(e&&e.provide),r=AV(e);if(!Oa(e)&&e.multi===!0){let i=this.records.get(t);i||(i=Sa(void 0,sf,!0),i.factory=()=>j_(i.multi),this.records.set(t,i)),t=e,i.multi.push(e)}this.records.set(t,r)}hydrate(e,t,r){let i=Se(null);try{return t.value===ZS?BT(bn(e)):t.value===sf&&(t.value=ZS,t.value=t.factory(void 0,r)),typeof t.value=="object"&&t.value&&NV(t.value)&&this._ngOnDestroyHooks.add(t.value),t.value}finally{Se(i)}}injectableDefInScope(e){if(!e.providedIn)return!1;let t=fn(e.providedIn);return typeof t=="string"?t==="any"||this.scopes.has(t):this.injectorDefTypes.has(t)}removeOnDestroy(e){let t=this._onDestroyHooks.indexOf(e);t!==-1&&this._onDestroyHooks.splice(t,1)}};function U_(n){let e=Vf(n),t=e!==null?e.factory:is(n);if(t!==null)return t;if(n instanceof J)throw new Z(204,!1);if(n instanceof Function)return PV(n);throw new Z(204,!1)}function PV(n){if(n.length>0)throw new Z(204,!1);let t=sV(n);return t!==null?()=>t.factory(n):()=>new n}function AV(n){if(QT(n))return Sa(void 0,n.useValue);{let e=ZT(n);return Sa(e,sf)}}function ZT(n,e,t){let r;if(Oa(n)){let i=fn(n);return is(i)||U_(i)}else if(QT(n))r=()=>fn(n.useValue);else if(DV(n))r=()=>n.useFactory(...j_(n.deps||[]));else if(TV(n))r=(i,o)=>ee(fn(n.useExisting),o!==void 0&&o&be.Optional?be.Optional:void 0);else{let i=fn(n&&(n.useClass||n.provide));if(OV(n))r=()=>new i(...j_(n.deps));else return is(i)||U_(i)}return r}function Ll(n){if(n.destroyed)throw new Z(205,!1)}function Sa(n,e,t=!1){return{factory:n,value:e,multi:t?[]:void 0}}function OV(n){return!!n.deps}function NV(n){return n!==null&&typeof n=="object"&&typeof n.ngOnDestroy=="function"}function RV(n){return typeof n=="function"||typeof n=="object"&&n instanceof J}function $_(n,e){for(let t of n)Array.isArray(t)?$_(t,e):t&&jT(t)?$_(t.\u0275providers,e):e(t)}function tn(n,e){let t;n instanceof $l?(Ll(n),t=n):t=new hf(n);let r,i=wi(t),o=wn(void 0);try{return e()}finally{wi(i),wn(o)}}function JT(){return UT()!==void 0||Al()!=null}function Oy(n){if(!JT())throw new Z(-203,!1)}function kV(n){return typeof n=="function"}var xi=0,Me=1,ye=2,pn=3,ur=4,hr=5,gf=6,vf=7,In=8,Na=9,oo=10,_t=11,zl=12,JS=13,Ba=14,Or=15,Ra=16,Ta=17,ka=18,Uf=19,XT=20,ro=21,E_=22,_f=23,Wn=24,Pa=25,dr=26,eD=1;var as=7,yf=8,wf=9,qn=10;function io(n){return Array.isArray(n)&&typeof n[eD]=="object"}function Si(n){return Array.isArray(n)&&n[eD]===!0}function tD(n){return(n.flags&4)!==0}function Ua(n){return n.componentOffset>-1}function Ny(n){return(n.flags&1)===1}function Nr(n){return!!n.template}function Cf(n){return(n[ye]&512)!==0}function $a(n){return(n[ye]&256)===256}var z_=class{previousValue;currentValue;firstChange;constructor(e,t,r){this.previousValue=e,this.currentValue=t,this.firstChange=r}isFirstChange(){return this.firstChange}};function nD(n,e,t,r){e!==null?e.applyValueToInputSignal(e,r):n[t]=r}var ps=(()=>{let n=()=>rD;return n.ngInherit=!0,n})();function rD(n){return n.type.prototype.ngOnChanges&&(n.setInput=LV),FV}function FV(){let n=oD(this),e=n?.current;if(e){let t=n.previous;if(t===os)n.previous=e;else for(let r in e)t[r]=e[r];n.current=null,this.ngOnChanges(e)}}function LV(n,e,t,r,i){let o=this.declaredInputs[r],s=oD(n)||VV(n,{previous:os,current:null}),a=s.current||(s.current={}),c=s.previous,u=c[o];a[o]=new z_(u&&u.currentValue,t,c===os),nD(n,e,i,t)}var iD="__ngSimpleChanges__";function oD(n){return n[iD]||null}function VV(n,e){return n[iD]=e}var XS=null;var We=function(n,e=null,t){XS?.(n,e,t)},sD="svg",jV="math";function Rr(n){for(;Array.isArray(n);)n=n[xi];return n}function aD(n,e){return Rr(e[n])}function Br(n,e){return Rr(e[n.index])}function cD(n,e){return n.data[e]}function BV(n,e){return n[e]}function UV(n,e,t,r){t>=n.data.length&&(n.data[t]=null,n.blueprint[t]=null),e[t]=r}function kr(n,e){let t=e[n];return io(t)?t:t[xi]}function Ry(n){return(n[ye]&128)===128}function $V(n){return Si(n[pn])}function bf(n,e){return e==null?null:n[e]}function lD(n){n[Ta]=0}function uD(n){n[ye]&1024||(n[ye]|=1024,Ry(n)&&Yl(n))}function zV(n,e){for(;n>0;)e=e[Ba],n--;return e}function $f(n){return!!(n[ye]&9216||n[Wn]?.dirty)}function H_(n){n[oo].changeDetectionScheduler?.notify(8),n[ye]&64&&(n[ye]|=1024),$f(n)&&Yl(n)}function Yl(n){n[oo].changeDetectionScheduler?.notify(0);let e=cs(n);for(;e!==null&&!(e[ye]&8192||(e[ye]|=8192,!Ry(e)));)e=cs(e)}function dD(n,e){if($a(n))throw new Z(911,!1);n[ro]===null&&(n[ro]=[]),n[ro].push(e)}function HV(n,e){if(n[ro]===null)return;let t=n[ro].indexOf(e);t!==-1&&n[ro].splice(t,1)}function cs(n){let e=n[pn];return Si(e)?e[pn]:e}function hD(n){return n[vf]??=[]}function fD(n){return n.cleanup??=[]}var Ie={lFrame:bD(null),bindingsEnabled:!0,skipHydrationRootTNode:null};var W_=!1;function WV(){return Ie.lFrame.elementDepthCount}function qV(){Ie.lFrame.elementDepthCount++}function GV(){Ie.lFrame.elementDepthCount--}function pD(){return Ie.bindingsEnabled}function KV(){return Ie.skipHydrationRootTNode!==null}function YV(n){return Ie.skipHydrationRootTNode===n}function QV(){Ie.skipHydrationRootTNode=null}function He(){return Ie.lFrame.lView}function gn(){return Ie.lFrame.tView}function B(n){return Ie.lFrame.contextLView=n,n[In]}function U(n){return Ie.lFrame.contextLView=null,n}function Nn(){let n=mD();for(;n!==null&&n.type===64;)n=n.parent;return n}function mD(){return Ie.lFrame.currentTNode}function ZV(){let n=Ie.lFrame,e=n.currentTNode;return n.isParent?e:e.parent}function Ql(n,e){let t=Ie.lFrame;t.currentTNode=n,t.isParent=e}function gD(){return Ie.lFrame.isParent}function JV(){Ie.lFrame.isParent=!1}function vD(){return W_}function eT(n){let e=W_;return W_=n,e}function _D(){let n=Ie.lFrame,e=n.bindingRootIndex;return e===-1&&(e=n.bindingRootIndex=n.tView.bindingStartIndex),e}function XV(){return Ie.lFrame.bindingIndex}function e3(n){return Ie.lFrame.bindingIndex=n}function zf(){return Ie.lFrame.bindingIndex++}function ky(n){let e=Ie.lFrame,t=e.bindingIndex;return e.bindingIndex=e.bindingIndex+n,t}function t3(){return Ie.lFrame.inI18n}function n3(n,e){let t=Ie.lFrame;t.bindingIndex=t.bindingRootIndex=n,q_(e)}function r3(){return Ie.lFrame.currentDirectiveIndex}function q_(n){Ie.lFrame.currentDirectiveIndex=n}function i3(n){let e=Ie.lFrame.currentDirectiveIndex;return e===-1?null:n[e]}function yD(n){Ie.lFrame.currentQueryIndex=n}function o3(n){let e=n[Me];return e.type===2?e.declTNode:e.type===1?n[hr]:null}function wD(n,e,t){if(t&be.SkipSelf){let i=e,o=n;for(;i=i.parent,i===null&&!(t&be.Host);)if(i=o3(o),i===null||(o=o[Ba],i.type&10))break;if(i===null)return!1;e=i,n=o}let r=Ie.lFrame=CD();return r.currentTNode=e,r.lView=n,!0}function Fy(n){let e=CD(),t=n[Me];Ie.lFrame=e,e.currentTNode=t.firstChild,e.lView=n,e.tView=t,e.contextLView=n,e.bindingIndex=t.bindingStartIndex,e.inI18n=!1}function CD(){let n=Ie.lFrame,e=n===null?null:n.child;return e===null?bD(n):e}function bD(n){let e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:n,child:null,inI18n:!1};return n!==null&&(n.child=e),e}function ID(){let n=Ie.lFrame;return Ie.lFrame=n.parent,n.currentTNode=null,n.lView=null,n}var ED=ID;function Ly(){let n=ID();n.isParent=!0,n.tView=null,n.selectedIndex=-1,n.contextLView=null,n.elementDepthCount=0,n.currentDirectiveIndex=-1,n.currentNamespace=null,n.bindingRootIndex=-1,n.bindingIndex=-1,n.currentQueryIndex=0}function s3(n){return(Ie.lFrame.contextLView=zV(n,Ie.lFrame.contextLView))[In]}function ao(){return Ie.lFrame.selectedIndex}function ls(n){Ie.lFrame.selectedIndex=n}function Vy(){let n=Ie.lFrame;return cD(n.tView,n.selectedIndex)}function xD(){Ie.lFrame.currentNamespace=sD}function SD(){a3()}function a3(){Ie.lFrame.currentNamespace=null}function c3(){return Ie.lFrame.currentNamespace}var TD=!0;function jy(){return TD}function By(n){TD=n}function l3(n,e,t){let{ngOnChanges:r,ngOnInit:i,ngDoCheck:o}=e.type.prototype;if(r){let s=rD(e);(t.preOrderHooks??=[]).push(n,s),(t.preOrderCheckHooks??=[]).push(n,s)}i&&(t.preOrderHooks??=[]).push(0-n,i),o&&((t.preOrderHooks??=[]).push(n,o),(t.preOrderCheckHooks??=[]).push(n,o))}function DD(n,e){for(let t=e.directiveStart,r=e.directiveEnd;t<r;t++){let o=n.data[t].type.prototype,{ngAfterContentInit:s,ngAfterContentChecked:a,ngAfterViewInit:c,ngAfterViewChecked:u,ngOnDestroy:d}=o;s&&(n.contentHooks??=[]).push(-t,s),a&&((n.contentHooks??=[]).push(t,a),(n.contentCheckHooks??=[]).push(t,a)),c&&(n.viewHooks??=[]).push(-t,c),u&&((n.viewHooks??=[]).push(t,u),(n.viewCheckHooks??=[]).push(t,u)),d!=null&&(n.destroyHooks??=[]).push(t,d)}}function af(n,e,t){MD(n,e,3,t)}function cf(n,e,t,r){(n[ye]&3)===t&&MD(n,e,t,r)}function x_(n,e){let t=n[ye];(t&3)===e&&(t&=16383,t+=1,n[ye]=t)}function MD(n,e,t,r){let i=r!==void 0?n[Ta]&65535:0,o=r??-1,s=e.length-1,a=0;for(let c=i;c<s;c++)if(typeof e[c+1]=="number"){if(a=e[c],r!=null&&a>=r)break}else e[c]<0&&(n[Ta]+=65536),(a<o||o==-1)&&(u3(n,t,e,c),n[Ta]=(n[Ta]&4294901760)+c+2),c++}function tT(n,e){We(4,n,e);let t=Se(null);try{e.call(n)}finally{Se(t),We(5,n,e)}}function u3(n,e,t,r){let i=t[r]<0,o=t[r+1],s=i?-t[r]:t[r],a=n[s];i?n[ye]>>14<n[Ta]>>16&&(n[ye]&3)===e&&(n[ye]+=16384,tT(a,o)):tT(a,o)}var Aa=-1,us=class{factory;injectImpl;resolving=!1;canSeeViewProviders;multi;componentProviders;index;providerFactory;constructor(e,t,r){this.factory=e,this.canSeeViewProviders=t,this.injectImpl=r}};function d3(n){return(n.flags&8)!==0}function h3(n){return(n.flags&16)!==0}function f3(n,e,t){let r=0;for(;r<t.length;){let i=t[r];if(typeof i=="number"){if(i!==0)break;r++;let o=t[r++],s=t[r++],a=t[r++];n.setAttribute(e,s,a,o)}else{let o=i,s=t[++r];m3(o)?n.setProperty(e,o,s):n.setAttribute(e,o,s),r++}}return r}function p3(n){return n===3||n===4||n===6}function m3(n){return n.charCodeAt(0)===64}function Hl(n,e){if(!(e===null||e.length===0))if(n===null||n.length===0)n=e.slice();else{let t=-1;for(let r=0;r<e.length;r++){let i=e[r];typeof i=="number"?t=i:t===0||(t===-1||t===2?nT(n,t,i,null,e[++r]):nT(n,t,i,null,null))}}return n}function nT(n,e,t,r,i){let o=0,s=n.length;if(e===-1)s=-1;else for(;o<n.length;){let a=n[o++];if(typeof a=="number"){if(a===e){s=-1;break}else if(a>e){s=o-1;break}}}for(;o<n.length;){let a=n[o];if(typeof a=="number")break;if(a===t){i!==null&&(n[o+1]=i);return}o++,i!==null&&o++}s!==-1&&(n.splice(s,0,e),o=s+1),n.splice(o++,0,t),i!==null&&n.splice(o++,0,i)}function PD(n){return n!==Aa}function If(n){return n&32767}function g3(n){return n>>16}function Ef(n,e){let t=g3(n),r=e;for(;t>0;)r=r[Ba],t--;return r}var G_=!0;function xf(n){let e=G_;return G_=n,e}var v3=256,AD=v3-1,OD=5,_3=0,Ar={};function y3(n,e,t){let r;typeof t=="string"?r=t.charCodeAt(0)||0:t.hasOwnProperty(jl)&&(r=t[jl]),r==null&&(r=t[jl]=_3++);let i=r&AD,o=1<<i;e.data[n+(i>>OD)]|=o}function Sf(n,e){let t=ND(n,e);if(t!==-1)return t;let r=e[Me];r.firstCreatePass&&(n.injectorIndex=e.length,S_(r.data,n),S_(e,null),S_(r.blueprint,null));let i=Uy(n,e),o=n.injectorIndex;if(PD(i)){let s=If(i),a=Ef(i,e),c=a[Me].data;for(let u=0;u<8;u++)e[o+u]=a[s+u]|c[s+u]}return e[o+8]=i,o}function S_(n,e){n.push(0,0,0,0,0,0,0,0,e)}function ND(n,e){return n.injectorIndex===-1||n.parent&&n.parent.injectorIndex===n.injectorIndex||e[n.injectorIndex+8]===null?-1:n.injectorIndex}function Uy(n,e){if(n.parent&&n.parent.injectorIndex!==-1)return n.parent.injectorIndex;let t=0,r=null,i=e;for(;i!==null;){if(r=VD(i),r===null)return Aa;if(t++,i=i[Ba],r.injectorIndex!==-1)return r.injectorIndex|t<<16}return Aa}function K_(n,e,t){y3(n,e,t)}function RD(n,e,t){if(t&be.Optional||n!==void 0)return n;Sy(e,"NodeInjector")}function kD(n,e,t,r){if(t&be.Optional&&r===void 0&&(r=null),(t&(be.Self|be.Host))===0){let i=n[Na],o=wn(void 0);try{return i?i.get(e,r,t&be.Optional):$T(e,r,t&be.Optional)}finally{wn(o)}}return RD(r,e,t)}function FD(n,e,t,r=be.Default,i){if(n!==null){if(e[ye]&2048&&!(r&be.Self)){let s=E3(n,e,t,r,Ar);if(s!==Ar)return s}let o=LD(n,e,t,r,Ar);if(o!==Ar)return o}return kD(e,t,r,i)}function LD(n,e,t,r,i){let o=b3(t);if(typeof o=="function"){if(!wD(e,n,r))return r&be.Host?RD(i,t,r):kD(e,t,r,i);try{let s;if(s=o(r),s==null&&!(r&be.Optional))Sy(t);else return s}finally{ED()}}else if(typeof o=="number"){let s=null,a=ND(n,e),c=Aa,u=r&be.Host?e[Or][hr]:null;for((a===-1||r&be.SkipSelf)&&(c=a===-1?Uy(n,e):e[a+8],c===Aa||!iT(r,!1)?a=-1:(s=e[Me],a=If(c),e=Ef(c,e)));a!==-1;){let d=e[Me];if(rT(o,a,d.data)){let f=w3(a,e,t,s,r,u);if(f!==Ar)return f}c=e[a+8],c!==Aa&&iT(r,e[Me].data[a+8]===u)&&rT(o,a,e)?(s=d,a=If(c),e=Ef(c,e)):a=-1}}return i}function w3(n,e,t,r,i,o){let s=e[Me],a=s.data[n+8],c=r==null?Ua(a)&&G_:r!=s&&(a.type&3)!==0,u=i&be.Host&&o===a,d=C3(a,s,t,c,u);return d!==null?Tf(e,s,d,a,i):Ar}function C3(n,e,t,r,i){let o=n.providerIndexes,s=e.data,a=o&1048575,c=n.directiveStart,u=n.directiveEnd,d=o>>20,f=r?a:a+d,v=i?a+d:u;for(let _=f;_<v;_++){let b=s[_];if(_<c&&t===b||_>=c&&b.type===t)return _}if(i){let _=s[c];if(_&&Nr(_)&&_.type===t)return c}return null}function Tf(n,e,t,r,i){let o=n[t],s=e.data;if(o instanceof us){let a=o;a.resolving&&BT(hV(s[t]));let c=xf(a.canSeeViewProviders);a.resolving=!0;let u,d=a.injectImpl?wn(a.injectImpl):null,f=wD(n,r,be.Default);try{o=n[t]=a.factory(void 0,i,s,n,r),e.firstCreatePass&&t>=r.directiveStart&&l3(t,s[t],e)}finally{d!==null&&wn(d),xf(c),a.resolving=!1,ED()}}return o}function b3(n){if(typeof n=="string")return n.charCodeAt(0)||0;let e=n.hasOwnProperty(jl)?n[jl]:void 0;return typeof e=="number"?e>=0?e&AD:I3:e}function rT(n,e,t){let r=1<<n;return!!(t[e+(n>>OD)]&r)}function iT(n,e){return!(n&be.Self)&&!(n&be.Host&&e)}var rs=class{_tNode;_lView;constructor(e,t){this._tNode=e,this._lView=t}get(e,t,r){return FD(this._tNode,this._lView,e,jf(r),t)}};function I3(){return new rs(Nn(),He())}function Rn(n){return Gl(()=>{let e=n.prototype.constructor,t=e[df]||Y_(e),r=Object.prototype,i=Object.getPrototypeOf(n.prototype).constructor;for(;i&&i!==r;){let o=i[df]||Y_(i);if(o&&o!==t)return o;i=Object.getPrototypeOf(i)}return o=>new o})}function Y_(n){return kT(n)?()=>{let e=Y_(fn(n));return e&&e()}:is(n)}function E3(n,e,t,r,i){let o=n,s=e;for(;o!==null&&s!==null&&s[ye]&2048&&!Cf(s);){let a=LD(o,s,t,r|be.Self,Ar);if(a!==Ar)return a;let c=o.parent;if(!c){let u=s[XT];if(u){let d=u.get(t,Ar,r);if(d!==Ar)return d}c=VD(s),s=s[Ba]}o=c}return i}function VD(n){let e=n[Me],t=e.type;return t===2?e.declTNode:t===1?n[hr]:null}function oT(n,e=null,t=null,r){let i=jD(n,e,t,r);return i.resolveInjectorInitializers(),i}function jD(n,e=null,t=null,r,i=new Set){let o=[t||Cn,My(n)];return r=r||(typeof n=="object"?void 0:bn(n)),new $l(o,e||Ay(),r||null,i)}var rt=class n{static THROW_IF_NOT_FOUND=ns;static NULL=new mf;static create(e,t){if(Array.isArray(e))return oT({name:""},t,e,"");{let r=e.name??"";return oT({name:r},e.parent,e.providers,r)}}static \u0275prov=H({token:n,providedIn:"any",factory:()=>ee(WT)});static __NG_ELEMENT_ID__=-1};var x3=new J("");x3.__NG_ELEMENT_ID__=n=>{let e=Nn();if(e===null)throw new Z(204,!1);if(e.type&2)return e.value;if(n&be.Optional)return null;throw new Z(204,!1)};var BD=!1,za=(()=>{class n{static __NG_ELEMENT_ID__=S3;static __NG_ENV_ID__=t=>t}return n})(),Q_=class extends za{_lView;constructor(e){super(),this._lView=e}onDestroy(e){let t=this._lView;return $a(t)?(e(),()=>{}):(dD(t,e),()=>HV(t,e))}};function S3(){return new Q_(He())}var ds=class{},$y=new J("",{providedIn:"root",factory:()=>!1});var UD=new J(""),$D=new J(""),ms=(()=>{class n{taskId=0;pendingTasks=new Set;get _hasPendingTasks(){return this.hasPendingTasks.value}hasPendingTasks=new Bt(!1);add(){this._hasPendingTasks||this.hasPendingTasks.next(!0);let t=this.taskId++;return this.pendingTasks.add(t),t}has(t){return this.pendingTasks.has(t)}remove(t){this.pendingTasks.delete(t),this.pendingTasks.size===0&&this._hasPendingTasks&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this._hasPendingTasks&&this.hasPendingTasks.next(!1)}static \u0275prov=H({token:n,providedIn:"root",factory:()=>new n})}return n})(),Hf=(()=>{class n{internalPendingTasks=j(ms);scheduler=j(ds);add(){let t=this.internalPendingTasks.add();return()=>{this.internalPendingTasks.has(t)&&(this.scheduler.notify(11),this.internalPendingTasks.remove(t))}}run(t){return w(this,null,function*(){let r=this.add();try{return yield t()}finally{r()}})}static \u0275prov=H({token:n,providedIn:"root",factory:()=>new n})}return n})(),Z_=class extends ct{__isAsync;destroyRef=void 0;pendingTasks=void 0;constructor(e=!1){super(),this.__isAsync=e,JT()&&(this.destroyRef=j(za,{optional:!0})??void 0,this.pendingTasks=j(ms,{optional:!0})??void 0)}emit(e){let t=Se(null);try{super.next(e)}finally{Se(t)}}subscribe(e,t,r){let i=e,o=t||(()=>null),s=r;if(e&&typeof e=="object"){let c=e;i=c.next?.bind(c),o=c.error?.bind(c),s=c.complete?.bind(c)}this.__isAsync&&(o=this.wrapInTimeout(o),i&&(i=this.wrapInTimeout(i)),s&&(s=this.wrapInTimeout(s)));let a=super.subscribe({next:i,error:o,complete:s});return e instanceof ht&&e.add(a),a}wrapInTimeout(e){return t=>{let r=this.pendingTasks?.add();setTimeout(()=>{try{e(t)}finally{r!==void 0&&this.pendingTasks?.remove(r)}})}}},St=Z_;function Df(...n){}function zD(n){let e,t;function r(){n=Df;try{t!==void 0&&typeof cancelAnimationFrame=="function"&&cancelAnimationFrame(t),e!==void 0&&clearTimeout(e)}catch{}}return e=setTimeout(()=>{n(),r()}),typeof requestAnimationFrame=="function"&&(t=requestAnimationFrame(()=>{n(),r()})),()=>r()}function sT(n){return queueMicrotask(()=>n()),()=>{n=Df}}var zy="isAngularZone",Mf=zy+"_ID",T3=0,Pe=class n{hasPendingMacrotasks=!1;hasPendingMicrotasks=!1;isStable=!0;onUnstable=new St(!1);onMicrotaskEmpty=new St(!1);onStable=new St(!1);onError=new St(!1);constructor(e){let{enableLongStackTrace:t=!1,shouldCoalesceEventChangeDetection:r=!1,shouldCoalesceRunChangeDetection:i=!1,scheduleInRootZone:o=BD}=e;if(typeof Zone>"u")throw new Z(908,!1);Zone.assertZonePatched();let s=this;s._nesting=0,s._outer=s._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(s._inner=s._inner.fork(new Zone.TaskTrackingZoneSpec)),t&&Zone.longStackTraceZoneSpec&&(s._inner=s._inner.fork(Zone.longStackTraceZoneSpec)),s.shouldCoalesceEventChangeDetection=!i&&r,s.shouldCoalesceRunChangeDetection=i,s.callbackScheduled=!1,s.scheduleInRootZone=o,P3(s)}static isInAngularZone(){return typeof Zone<"u"&&Zone.current.get(zy)===!0}static assertInAngularZone(){if(!n.isInAngularZone())throw new Z(909,!1)}static assertNotInAngularZone(){if(n.isInAngularZone())throw new Z(909,!1)}run(e,t,r){return this._inner.run(e,t,r)}runTask(e,t,r,i){let o=this._inner,s=o.scheduleEventTask("NgZoneEvent: "+i,e,D3,Df,Df);try{return o.runTask(s,t,r)}finally{o.cancelTask(s)}}runGuarded(e,t,r){return this._inner.runGuarded(e,t,r)}runOutsideAngular(e){return this._outer.run(e)}},D3={};function Hy(n){if(n._nesting==0&&!n.hasPendingMicrotasks&&!n.isStable)try{n._nesting++,n.onMicrotaskEmpty.emit(null)}finally{if(n._nesting--,!n.hasPendingMicrotasks)try{n.runOutsideAngular(()=>n.onStable.emit(null))}finally{n.isStable=!0}}}function M3(n){if(n.isCheckStableRunning||n.callbackScheduled)return;n.callbackScheduled=!0;function e(){zD(()=>{n.callbackScheduled=!1,J_(n),n.isCheckStableRunning=!0,Hy(n),n.isCheckStableRunning=!1})}n.scheduleInRootZone?Zone.root.run(()=>{e()}):n._outer.run(()=>{e()}),J_(n)}function P3(n){let e=()=>{M3(n)},t=T3++;n._inner=n._inner.fork({name:"angular",properties:{[zy]:!0,[Mf]:t,[Mf+t]:!0},onInvokeTask:(r,i,o,s,a,c)=>{if(A3(c))return r.invokeTask(o,s,a,c);try{return aT(n),r.invokeTask(o,s,a,c)}finally{(n.shouldCoalesceEventChangeDetection&&s.type==="eventTask"||n.shouldCoalesceRunChangeDetection)&&e(),cT(n)}},onInvoke:(r,i,o,s,a,c,u)=>{try{return aT(n),r.invoke(o,s,a,c,u)}finally{n.shouldCoalesceRunChangeDetection&&!n.callbackScheduled&&!O3(c)&&e(),cT(n)}},onHasTask:(r,i,o,s)=>{r.hasTask(o,s),i===o&&(s.change=="microTask"?(n._hasPendingMicrotasks=s.microTask,J_(n),Hy(n)):s.change=="macroTask"&&(n.hasPendingMacrotasks=s.macroTask))},onHandleError:(r,i,o,s)=>(r.handleError(o,s),n.runOutsideAngular(()=>n.onError.emit(s)),!1)})}function J_(n){n._hasPendingMicrotasks||(n.shouldCoalesceEventChangeDetection||n.shouldCoalesceRunChangeDetection)&&n.callbackScheduled===!0?n.hasPendingMicrotasks=!0:n.hasPendingMicrotasks=!1}function aT(n){n._nesting++,n.isStable&&(n.isStable=!1,n.onUnstable.emit(null))}function cT(n){n._nesting--,Hy(n)}var X_=class{hasPendingMicrotasks=!1;hasPendingMacrotasks=!1;isStable=!0;onUnstable=new St;onMicrotaskEmpty=new St;onStable=new St;onError=new St;run(e,t,r){return e.apply(t,r)}runGuarded(e,t,r){return e.apply(t,r)}runOutsideAngular(e){return e()}runTask(e,t,r,i){return e.apply(t,r)}};function A3(n){return HD(n,"__ignore_ng_zone__")}function O3(n){return HD(n,"__scheduler_tick__")}function HD(n,e){return!Array.isArray(n)||n.length!==1?!1:n[0]?.data?.[e]===!0}var Fr=class{_console=console;handleError(e){this._console.error("ERROR",e)}},N3=new J("",{providedIn:"root",factory:()=>{let n=j(Pe),e=j(Fr);return t=>n.runOutsideAngular(()=>e.handleError(t))}});function lT(n,e){return NT(n,e)}function R3(n){return NT(OT,n)}var WD=(lT.required=R3,lT);function k3(){return Wf(Nn(),He())}function Wf(n,e){return new Ur(Br(n,e))}var Ur=(()=>{class n{nativeElement;constructor(t){this.nativeElement=t}static __NG_ELEMENT_ID__=k3}return n})();function F3(n){return typeof n=="function"&&n[Hn]!==void 0}function Ha(n,e){let t=n_(n,e?.equal),r=t[Hn];return t.set=i=>Pl(r,i),t.update=i=>r_(r,i),t.asReadonly=L3.bind(t),t}function L3(){let n=this[Hn];if(n.readonlyFn===void 0){let e=()=>this();e[Hn]=n,n.readonlyFn=e}return n.readonlyFn}function qD(n){return F3(n)&&typeof n.set=="function"}function GD(n){return(n.flags&128)===128}var KD=function(n){return n[n.OnPush=0]="OnPush",n[n.Default=1]="Default",n}(KD||{}),YD=new Map,V3=0;function j3(){return V3++}function B3(n){YD.set(n[Uf],n)}function ey(n){YD.delete(n[Uf])}var uT="__ngContext__";function Zl(n,e){io(e)?(n[uT]=e[Uf],B3(e)):n[uT]=e}function QD(n){return JD(n[zl])}function ZD(n){return JD(n[ur])}function JD(n){for(;n!==null&&!Si(n);)n=n[ur];return n}var ty;function XD(n){ty=n}function U3(){if(ty!==void 0)return ty;if(typeof document<"u")return document;throw new Z(210,!1)}var Wy=new J("",{providedIn:"root",factory:()=>$3}),$3="ng",qy=new J(""),co=new J("",{providedIn:"platform",factory:()=>"unknown"});var Gy=new J("",{providedIn:"root",factory:()=>U3().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});var z3="h",H3="b";var e1=!1,W3=new J("",{providedIn:"root",factory:()=>e1});var Ky=function(n){return n[n.CHANGE_DETECTION=0]="CHANGE_DETECTION",n[n.AFTER_NEXT_RENDER=1]="AFTER_NEXT_RENDER",n}(Ky||{}),Wa=new J(""),dT=new Set;function qa(n){dT.has(n)||(dT.add(n),performance?.mark?.("mark_feature_usage",{detail:{feature:n}}))}var t1=(()=>{class n{view;node;constructor(t,r){this.view=t,this.node=r}static __NG_ELEMENT_ID__=q3}return n})();function q3(){return new t1(He(),Nn())}var Da=function(n){return n[n.EarlyRead=0]="EarlyRead",n[n.Write=1]="Write",n[n.MixedReadWrite=2]="MixedReadWrite",n[n.Read=3]="Read",n}(Da||{}),n1=(()=>{class n{impl=null;execute(){this.impl?.execute()}static \u0275prov=H({token:n,providedIn:"root",factory:()=>new n})}return n})(),G3=[Da.EarlyRead,Da.Write,Da.MixedReadWrite,Da.Read],K3=(()=>{class n{ngZone=j(Pe);scheduler=j(ds);errorHandler=j(Fr,{optional:!0});sequences=new Set;deferredRegistrations=new Set;executing=!1;constructor(){j(Wa,{optional:!0})}execute(){let t=this.sequences.size>0;t&&We(16),this.executing=!0;for(let r of G3)for(let i of this.sequences)if(!(i.erroredOrDestroyed||!i.hooks[r]))try{i.pipelinedValue=this.ngZone.runOutsideAngular(()=>this.maybeTrace(()=>{let o=i.hooks[r];return o(i.pipelinedValue)},i.snapshot))}catch(o){i.erroredOrDestroyed=!0,this.errorHandler?.handleError(o)}this.executing=!1;for(let r of this.sequences)r.afterRun(),r.once&&(this.sequences.delete(r),r.destroy());for(let r of this.deferredRegistrations)this.sequences.add(r);this.deferredRegistrations.size>0&&this.scheduler.notify(7),this.deferredRegistrations.clear(),t&&We(17)}register(t){let{view:r}=t;r!==void 0?((r[Pa]??=[]).push(t),Yl(r),r[ye]|=8192):this.executing?this.deferredRegistrations.add(t):this.addSequence(t)}addSequence(t){this.sequences.add(t),this.scheduler.notify(7)}unregister(t){this.executing&&this.sequences.has(t)?(t.erroredOrDestroyed=!0,t.pipelinedValue=void 0,t.once=!0):(this.sequences.delete(t),this.deferredRegistrations.delete(t))}maybeTrace(t,r){return r?r.run(Ky.AFTER_NEXT_RENDER,t):t()}static \u0275prov=H({token:n,providedIn:"root",factory:()=>new n})}return n})(),ny=class{impl;hooks;view;once;snapshot;erroredOrDestroyed=!1;pipelinedValue=void 0;unregisterOnDestroy;constructor(e,t,r,i,o,s=null){this.impl=e,this.hooks=t,this.view=r,this.once=i,this.snapshot=s,this.unregisterOnDestroy=o?.onDestroy(()=>this.destroy())}afterRun(){this.erroredOrDestroyed=!1,this.pipelinedValue=void 0,this.snapshot?.dispose(),this.snapshot=null}destroy(){this.impl.unregister(this),this.unregisterOnDestroy?.();let e=this.view?.[Pa];e&&(this.view[Pa]=e.filter(t=>t!==this))}};function Yy(n,e){!e?.injector&&Oy(Yy);let t=e?.injector??j(rt);return qa("NgAfterNextRender"),Q3(n,t,e,!0)}function Y3(n,e){if(n instanceof Function){let t=[void 0,void 0,void 0,void 0];return t[e]=n,t}else return[n.earlyRead,n.write,n.mixedReadWrite,n.read]}function Q3(n,e,t,r){let i=e.get(n1);i.impl??=e.get(K3);let o=e.get(Wa,null,{optional:!0}),s=t?.phase??Da.MixedReadWrite,a=t?.manualCleanup!==!0?e.get(za):null,c=e.get(t1,null,{optional:!0}),u=new ny(i.impl,Y3(n,s),c?.view,r,a,o?.snapshot(null));return i.impl.register(u),u}var Z3=(n,e,t,r)=>{};function J3(n,e,t,r){Z3(n,e,t,r)}var X3=()=>null;function r1(n,e,t=!1){return X3(n,e,t)}function i1(n,e){let t=n.contentQueries;if(t!==null){let r=Se(null);try{for(let i=0;i<t.length;i+=2){let o=t[i],s=t[i+1];if(s!==-1){let a=n.data[s];yD(o),a.contentQueries(2,e[s],s)}}}finally{Se(r)}}}function ry(n,e,t){yD(0);let r=Se(null);try{e(n,t)}finally{Se(r)}}function o1(n,e,t){if(tD(e)){let r=Se(null);try{let i=e.directiveStart,o=e.directiveEnd;for(let s=i;s<o;s++){let a=n.data[s];if(a.contentQueries){let c=t[s];a.contentQueries(1,c,s)}}}finally{Se(r)}}}var Lr=function(n){return n[n.Emulated=0]="Emulated",n[n.None=2]="None",n[n.ShadowDom=3]="ShadowDom",n}(Lr||{});var iy=class{changingThisBreaksApplicationSecurity;constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${eV})`}};function Qy(n){return n instanceof iy?n.changingThisBreaksApplicationSecurity:n}function s1(n){return n instanceof Function?n():n}function e4(n,e,t){let r=n.length;for(;;){let i=n.indexOf(e,t);if(i===-1)return i;if(i===0||n.charCodeAt(i-1)<=32){let o=e.length;if(i+o===r||n.charCodeAt(i+o)<=32)return i}t=i+1}}var a1="ng-template";function t4(n,e,t,r){let i=0;if(r){for(;i<e.length&&typeof e[i]=="string";i+=2)if(e[i]==="class"&&e4(e[i+1].toLowerCase(),t,0)!==-1)return!0}else if(Zy(n))return!1;if(i=e.indexOf(1,i),i>-1){let o;for(;++i<e.length&&typeof(o=e[i])=="string";)if(o.toLowerCase()===t)return!0}return!1}function Zy(n){return n.type===4&&n.value!==a1}function n4(n,e,t){let r=n.type===4&&!t?a1:n.value;return e===r}function r4(n,e,t){let r=4,i=n.attrs,o=i!==null?s4(i):0,s=!1;for(let a=0;a<e.length;a++){let c=e[a];if(typeof c=="number"){if(!s&&!cr(r)&&!cr(c))return!1;if(s&&cr(c))continue;s=!1,r=c|r&1;continue}if(!s)if(r&4){if(r=2|r&1,c!==""&&!n4(n,c,t)||c===""&&e.length===1){if(cr(r))return!1;s=!0}}else if(r&8){if(i===null||!t4(n,i,c,t)){if(cr(r))return!1;s=!0}}else{let u=e[++a],d=i4(c,i,Zy(n),t);if(d===-1){if(cr(r))return!1;s=!0;continue}if(u!==""){let f;if(d>o?f="":f=i[d+1].toLowerCase(),r&2&&u!==f){if(cr(r))return!1;s=!0}}}}return cr(r)||s}function cr(n){return(n&1)===0}function i4(n,e,t,r){if(e===null)return-1;let i=0;if(r||!t){let o=!1;for(;i<e.length;){let s=e[i];if(s===n)return i;if(s===3||s===6)o=!0;else if(s===1||s===2){let a=e[++i];for(;typeof a=="string";)a=e[++i];continue}else{if(s===4)break;if(s===0){i+=4;continue}}i+=o?1:2}return-1}else return a4(e,n)}function o4(n,e,t=!1){for(let r=0;r<e.length;r++)if(r4(n,e[r],t))return!0;return!1}function s4(n){for(let e=0;e<n.length;e++){let t=n[e];if(p3(t))return e}return n.length}function a4(n,e){let t=n.indexOf(4);if(t>-1)for(t++;t<n.length;){let r=n[t];if(typeof r=="number")return-1;if(r===e)return t;t++}return-1}function hT(n,e){return n?":not("+e.trim()+")":e}function c4(n){let e=n[0],t=1,r=2,i="",o=!1;for(;t<n.length;){let s=n[t];if(typeof s=="string")if(r&2){let a=n[++t];i+="["+s+(a.length>0?'="'+a+'"':"")+"]"}else r&8?i+="."+s:r&4&&(i+=" "+s);else i!==""&&!cr(s)&&(e+=hT(o,i),i=""),r=s,o=o||!cr(r);t++}return i!==""&&(e+=hT(o,i)),e}function l4(n){return n.map(c4).join(",")}function u4(n){let e=[],t=[],r=1,i=2;for(;r<n.length;){let o=n[r];if(typeof o=="string")i===2?o!==""&&e.push(o,n[++r]):i===8&&t.push(o);else{if(!cr(i))break;i=o}r++}return t.length&&e.push(1,...t),e}var Gn={};function d4(n,e){return n.createText(e)}function h4(n,e,t){n.setValue(e,t)}function c1(n,e,t){return n.createElement(e,t)}function Pf(n,e,t,r,i){n.insertBefore(e,t,r,i)}function l1(n,e,t){n.appendChild(e,t)}function fT(n,e,t,r,i){r!==null?Pf(n,e,t,r,i):l1(n,e,t)}function f4(n,e,t){n.removeChild(null,e,t)}function p4(n,e,t){n.setAttribute(e,"style",t)}function m4(n,e,t){t===""?n.removeAttribute(e,"class"):n.setAttribute(e,"class",t)}function u1(n,e,t){let{mergedAttrs:r,classes:i,styles:o}=t;r!==null&&f3(n,e,r),i!==null&&m4(n,e,i),o!==null&&p4(n,e,o)}function Jy(n,e,t,r,i,o,s,a,c,u,d){let f=dr+r,v=f+i,_=g4(f,v),b=typeof u=="function"?u():u;return _[Me]={type:n,blueprint:_,template:t,queries:null,viewQuery:a,declTNode:e,data:_.slice().fill(null,f),bindingStartIndex:f,expandoStartIndex:v,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:typeof o=="function"?o():o,pipeRegistry:typeof s=="function"?s():s,firstChild:null,schemas:c,consts:b,incompleteFirstPass:!1,ssrId:d}}function g4(n,e){let t=[];for(let r=0;r<e;r++)t.push(r<n?null:Gn);return t}function v4(n){let e=n.tView;return e===null||e.incompleteFirstPass?n.tView=Jy(1,null,n.template,n.decls,n.vars,n.directiveDefs,n.pipeDefs,n.viewQuery,n.schemas,n.consts,n.id):e}function Xy(n,e,t,r,i,o,s,a,c,u,d){let f=e.blueprint.slice();return f[xi]=i,f[ye]=r|4|128|8|64|1024,(u!==null||n&&n[ye]&2048)&&(f[ye]|=2048),lD(f),f[pn]=f[Ba]=n,f[In]=t,f[oo]=s||n&&n[oo],f[_t]=a||n&&n[_t],f[Na]=c||n&&n[Na]||null,f[hr]=o,f[Uf]=j3(),f[gf]=d,f[XT]=u,f[Or]=e.type==2?n[Or]:f,f}function _4(n,e,t){let r=Br(e,n),i=v4(t),o=n[oo].rendererFactory,s=e0(n,Xy(n,i,null,d1(t),r,e,null,o.createRenderer(r,t),null,null,null));return n[e.index]=s}function d1(n){let e=16;return n.signals?e=4096:n.onPush&&(e=64),e}function h1(n,e,t,r){if(t===0)return-1;let i=e.length;for(let o=0;o<t;o++)e.push(r),n.blueprint.push(r),n.data.push(null);return i}function e0(n,e){return n[zl]?n[JS][ur]=e:n[zl]=e,n[JS]=e,e}function I(n=1){f1(gn(),He(),ao()+n,!1)}function f1(n,e,t,r){if(!r)if((e[ye]&3)===3){let o=n.preOrderCheckHooks;o!==null&&af(e,o,t)}else{let o=n.preOrderHooks;o!==null&&cf(e,o,0,t)}ls(t)}var qf=function(n){return n[n.None=0]="None",n[n.SignalBased=1]="SignalBased",n[n.HasDecoratorInputTransform=2]="HasDecoratorInputTransform",n}(qf||{});function oy(n,e,t,r){let i=Se(null);try{let[o,s,a]=n.inputs[t],c=null;(s&qf.SignalBased)!==0&&(c=e[o][Hn]),c!==null&&c.transformFn!==void 0?r=c.transformFn(r):a!==null&&(r=a.call(e,r)),n.setInput!==null?n.setInput(e,c,r,t,o):nD(e,c,o,r)}finally{Se(i)}}function p1(n,e,t,r,i){let o=ao(),s=r&2;try{ls(-1),s&&e.length>dr&&f1(n,e,dr,!1),We(s?2:0,i),t(r,i)}finally{ls(o),We(s?3:1,i)}}function t0(n,e,t){E4(n,e,t),(t.flags&64)===64&&x4(n,e,t)}function m1(n,e,t=Br){let r=e.localNames;if(r!==null){let i=e.index+1;for(let o=0;o<r.length;o+=2){let s=r[o+1],a=s===-1?t(e,n):n[s];n[i++]=a}}}function y4(n,e,t,r){let o=r.get(W3,e1)||t===Lr.ShadowDom,s=n.selectRootElement(e,o);return w4(s),s}function w4(n){C4(n)}var C4=()=>null;function b4(n){return n==="class"?"className":n==="for"?"htmlFor":n==="formaction"?"formAction":n==="innerHtml"?"innerHTML":n==="readonly"?"readOnly":n==="tabindex"?"tabIndex":n}function g1(n,e,t,r,i,o,s,a){if(!a&&n0(e,n,t,r,i)){Ua(e)&&I4(t,e.index);return}if(e.type&3){let c=Br(e,t);r=b4(r),i=s!=null?s(i,e.value||"",r):i,o.setProperty(c,r,i)}else e.type&12}function I4(n,e){let t=kr(e,n);t[ye]&16||(t[ye]|=64)}function E4(n,e,t){let r=t.directiveStart,i=t.directiveEnd;Ua(t)&&_4(e,t,n.data[r+t.componentOffset]),n.firstCreatePass||Sf(t,e);let o=t.initialInputs;for(let s=r;s<i;s++){let a=n.data[s],c=Tf(e,n,s,t);if(Zl(c,e),o!==null&&M4(e,s-r,c,a,t,o),Nr(a)){let u=kr(t.index,e);u[In]=Tf(e,n,s,t)}}}function x4(n,e,t){let r=t.directiveStart,i=t.directiveEnd,o=t.index,s=r3();try{ls(o);for(let a=r;a<i;a++){let c=n.data[a],u=e[a];q_(a),(c.hostBindings!==null||c.hostVars!==0||c.hostAttrs!==null)&&S4(c,u)}}finally{ls(-1),q_(s)}}function S4(n,e){n.hostBindings!==null&&n.hostBindings(1,e)}function v1(n,e){let t=n.directiveRegistry,r=null;if(t)for(let i=0;i<t.length;i++){let o=t[i];o4(e,o.selectors,!1)&&(r??=[],Nr(o)?r.unshift(o):r.push(o))}return r}function T4(n,e,t,r,i,o){let s=Br(n,e);D4(e[_t],s,o,n.value,t,r,i)}function D4(n,e,t,r,i,o,s){if(o==null)n.removeAttribute(e,i,t);else{let a=s==null?Bl(o):s(o,r||"",i);n.setAttribute(e,i,a,t)}}function M4(n,e,t,r,i,o){let s=o[e];if(s!==null)for(let a=0;a<s.length;a+=2){let c=s[a],u=s[a+1];oy(r,t,c,u)}}function P4(n,e){let t=n[Na],r=t?t.get(Fr,null):null;r&&r.handleError(e)}function n0(n,e,t,r,i){let o=n.inputs?.[r],s=n.hostDirectiveInputs?.[r],a=!1;if(s)for(let c=0;c<s.length;c+=2){let u=s[c],d=s[c+1],f=e.data[u];oy(f,t[u],d,i),a=!0}if(o)for(let c of o){let u=t[c],d=e.data[c];oy(d,u,r,i),a=!0}return a}function A4(n,e){let t=kr(e,n),r=t[Me];O4(r,t);let i=t[xi];i!==null&&t[gf]===null&&(t[gf]=r1(i,t[Na])),We(18),r0(r,t,t[In]),We(19,t[In])}function O4(n,e){for(let t=e.length;t<n.blueprint.length;t++)e.push(n.blueprint[t])}function r0(n,e,t){Fy(e);try{let r=n.viewQuery;r!==null&&ry(1,r,t);let i=n.template;i!==null&&p1(n,e,i,1,t),n.firstCreatePass&&(n.firstCreatePass=!1),e[ka]?.finishViewCreation(n),n.staticContentQueries&&i1(n,e),n.staticViewQueries&&ry(2,n.viewQuery,t);let o=n.components;o!==null&&N4(e,o)}catch(r){throw n.firstCreatePass&&(n.incompleteFirstPass=!0,n.firstCreatePass=!1),r}finally{e[ye]&=-5,Ly()}}function N4(n,e){for(let t=0;t<e.length;t++)A4(n,e[t])}function R4(n,e,t,r){let i=Se(null);try{let o=e.tView,a=n[ye]&4096?4096:16,c=Xy(n,o,t,a,null,e,null,null,r?.injector??null,r?.embeddedViewInjector??null,r?.dehydratedView??null),u=n[e.index];c[Ra]=u;let d=n[ka];return d!==null&&(c[ka]=d.createEmbeddedView(o)),r0(o,c,t),c}finally{Se(i)}}function pT(n,e){return!e||e.firstChild===null||GD(n)}var k4;function i0(n,e){return k4(n,e)}var Ei=function(n){return n[n.Important=1]="Important",n[n.DashCase=2]="DashCase",n}(Ei||{});function _1(n){return(n.flags&32)===32}function Ma(n,e,t,r,i){if(r!=null){let o,s=!1;Si(r)?o=r:io(r)&&(s=!0,r=r[xi]);let a=Rr(r);n===0&&t!==null?i==null?l1(e,t,a):Pf(e,t,a,i||null,!0):n===1&&t!==null?Pf(e,t,a,i||null,!0):n===2?f4(e,a,s):n===3&&e.destroyNode(a),o!=null&&G4(e,n,o,t,i)}}function F4(n,e){y1(n,e),e[xi]=null,e[hr]=null}function L4(n,e,t,r,i,o){r[xi]=i,r[hr]=e,Gf(n,r,t,1,i,o)}function y1(n,e){e[oo].changeDetectionScheduler?.notify(9),Gf(n,e,e[_t],2,null,null)}function V4(n){let e=n[zl];if(!e)return T_(n[Me],n);for(;e;){let t=null;if(io(e))t=e[zl];else{let r=e[qn];r&&(t=r)}if(!t){for(;e&&!e[ur]&&e!==n;)io(e)&&T_(e[Me],e),e=e[pn];e===null&&(e=n),io(e)&&T_(e[Me],e),t=e&&e[ur]}e=t}}function o0(n,e){let t=n[wf],r=t.indexOf(e);t.splice(r,1)}function w1(n,e){if($a(e))return;let t=e[_t];t.destroyNode&&Gf(n,e,t,3,null,null),V4(e)}function T_(n,e){if($a(e))return;let t=Se(null);try{e[ye]&=-129,e[ye]|=256,e[Wn]&&Xv(e[Wn]),B4(n,e),j4(n,e),e[Me].type===1&&e[_t].destroy();let r=e[Ra];if(r!==null&&Si(e[pn])){r!==e[pn]&&o0(r,e);let i=e[ka];i!==null&&i.detachView(n)}ey(e)}finally{Se(t)}}function j4(n,e){let t=n.cleanup,r=e[vf];if(t!==null)for(let s=0;s<t.length-1;s+=2)if(typeof t[s]=="string"){let a=t[s+3];a>=0?r[a]():r[-a].unsubscribe(),s+=2}else{let a=r[t[s+1]];t[s].call(a)}r!==null&&(e[vf]=null);let i=e[ro];if(i!==null){e[ro]=null;for(let s=0;s<i.length;s++){let a=i[s];a()}}let o=e[_f];if(o!==null){e[_f]=null;for(let s of o)s.destroy()}}function B4(n,e){let t;if(n!=null&&(t=n.destroyHooks)!=null)for(let r=0;r<t.length;r+=2){let i=e[t[r]];if(!(i instanceof us)){let o=t[r+1];if(Array.isArray(o))for(let s=0;s<o.length;s+=2){let a=i[o[s]],c=o[s+1];We(4,a,c);try{c.call(a)}finally{We(5,a,c)}}else{We(4,i,o);try{o.call(i)}finally{We(5,i,o)}}}}}function U4(n,e,t){return $4(n,e.parent,t)}function $4(n,e,t){let r=e;for(;r!==null&&r.type&168;)e=r,r=e.parent;if(r===null)return t[xi];if(Ua(r)){let{encapsulation:i}=n.data[r.directiveStart+r.componentOffset];if(i===Lr.None||i===Lr.Emulated)return null}return Br(r,t)}function z4(n,e,t){return W4(n,e,t)}function H4(n,e,t){return n.type&40?Br(n,t):null}var W4=H4,mT;function s0(n,e,t,r){let i=U4(n,r,e),o=e[_t],s=r.parent||e[hr],a=z4(s,r,e);if(i!=null)if(Array.isArray(t))for(let c=0;c<t.length;c++)fT(o,i,t[c],a,!1);else fT(o,i,t,a,!1);mT!==void 0&&mT(o,r,e,t,i)}function Vl(n,e){if(e!==null){let t=e.type;if(t&3)return Br(e,n);if(t&4)return sy(-1,n[e.index]);if(t&8){let r=e.child;if(r!==null)return Vl(n,r);{let i=n[e.index];return Si(i)?sy(-1,i):Rr(i)}}else{if(t&128)return Vl(n,e.next);if(t&32)return i0(e,n)()||Rr(n[e.index]);{let r=C1(n,e);if(r!==null){if(Array.isArray(r))return r[0];let i=cs(n[Or]);return Vl(i,r)}else return Vl(n,e.next)}}}return null}function C1(n,e){if(e!==null){let r=n[Or][hr],i=e.projection;return r.projection[i]}return null}function sy(n,e){let t=qn+n+1;if(t<e.length){let r=e[t],i=r[Me].firstChild;if(i!==null)return Vl(r,i)}return e[as]}function a0(n,e,t,r,i,o,s){for(;t!=null;){if(t.type===128){t=t.next;continue}let a=r[t.index],c=t.type;if(s&&e===0&&(a&&Zl(Rr(a),r),t.flags|=2),!_1(t))if(c&8)a0(n,e,t.child,r,i,o,!1),Ma(e,n,i,a,o);else if(c&32){let u=i0(t,r),d;for(;d=u();)Ma(e,n,i,d,o);Ma(e,n,i,a,o)}else c&16?q4(n,e,r,t,i,o):Ma(e,n,i,a,o);t=s?t.projectionNext:t.next}}function Gf(n,e,t,r,i,o){a0(t,r,n.firstChild,e,i,o,!1)}function q4(n,e,t,r,i,o){let s=t[Or],c=s[hr].projection[r.projection];if(Array.isArray(c))for(let u=0;u<c.length;u++){let d=c[u];Ma(e,n,i,d,o)}else{let u=c,d=s[pn];GD(r)&&(u.flags|=128),a0(n,e,u,d,i,o,!0)}}function G4(n,e,t,r,i){let o=t[as],s=Rr(t);o!==s&&Ma(e,n,r,o,i);for(let a=qn;a<t.length;a++){let c=t[a];Gf(c[Me],c,n,e,r,o)}}function K4(n,e,t,r,i){if(e)i?n.addClass(t,r):n.removeClass(t,r);else{let o=r.indexOf("-")===-1?void 0:Ei.DashCase;i==null?n.removeStyle(t,r,o):(typeof i=="string"&&i.endsWith("!important")&&(i=i.slice(0,-10),o|=Ei.Important),n.setStyle(t,r,i,o))}}function Af(n,e,t,r,i=!1){for(;t!==null;){if(t.type===128){t=i?t.projectionNext:t.next;continue}let o=e[t.index];o!==null&&r.push(Rr(o)),Si(o)&&Y4(o,r);let s=t.type;if(s&8)Af(n,e,t.child,r);else if(s&32){let a=i0(t,e),c;for(;c=a();)r.push(c)}else if(s&16){let a=C1(e,t);if(Array.isArray(a))r.push(...a);else{let c=cs(e[Or]);Af(c[Me],c,a,r,!0)}}t=i?t.projectionNext:t.next}return r}function Y4(n,e){for(let t=qn;t<n.length;t++){let r=n[t],i=r[Me].firstChild;i!==null&&Af(r[Me],r,i,e)}n[as]!==n[xi]&&e.push(n[as])}function b1(n){if(n[Pa]!==null){for(let e of n[Pa])e.impl.addSequence(e);n[Pa].length=0}}var I1=[];function Q4(n){return n[Wn]??Z4(n)}function Z4(n){let e=I1.pop()??Object.create(X4);return e.lView=n,e}function J4(n){n.lView[Wn]!==n&&(n.lView=null,I1.push(n))}var X4=le(L({},Dl),{consumerIsAlwaysLive:!0,kind:"template",consumerMarkedDirty:n=>{Yl(n.lView)},consumerOnSignalRead(){this.lView[Wn]=this}});function e5(n){let e=n[Wn]??Object.create(t5);return e.lView=n,e}var t5=le(L({},Dl),{consumerIsAlwaysLive:!0,kind:"template",consumerMarkedDirty:n=>{let e=cs(n.lView);for(;e&&!E1(e[Me]);)e=cs(e);e&&uD(e)},consumerOnSignalRead(){this.lView[Wn]=this}});function E1(n){return n.type!==2}function x1(n){if(n[_f]===null)return;let e=!0;for(;e;){let t=!1;for(let r of n[_f])r.dirty&&(t=!0,r.zone===null||Zone.current===r.zone?r.run():r.zone.run(()=>r.run()));e=t&&!!(n[ye]&8192)}}var n5=100;function S1(n,e=!0,t=0){let i=n[oo].rendererFactory,o=!1;o||i.begin?.();try{r5(n,t)}catch(s){throw e&&P4(n,s),s}finally{o||i.end?.()}}function r5(n,e){let t=vD();try{eT(!0),ay(n,e);let r=0;for(;$f(n);){if(r===n5)throw new Z(103,!1);r++,ay(n,1)}}finally{eT(t)}}function i5(n,e,t,r){if($a(e))return;let i=e[ye],o=!1,s=!1;Fy(e);let a=!0,c=null,u=null;o||(E1(n)?(u=Q4(e),c=xh(u)):Gv()===null?(a=!1,u=e5(e),c=xh(u)):e[Wn]&&(Xv(e[Wn]),e[Wn]=null));try{lD(e),e3(n.bindingStartIndex),t!==null&&p1(n,e,t,2,r);let d=(i&3)===3;if(!o)if(d){let _=n.preOrderCheckHooks;_!==null&&af(e,_,null)}else{let _=n.preOrderHooks;_!==null&&cf(e,_,0,null),x_(e,0)}if(s||o5(e),x1(e),T1(e,0),n.contentQueries!==null&&i1(n,e),!o)if(d){let _=n.contentCheckHooks;_!==null&&af(e,_)}else{let _=n.contentHooks;_!==null&&cf(e,_,1),x_(e,1)}a5(n,e);let f=n.components;f!==null&&M1(e,f,0);let v=n.viewQuery;if(v!==null&&ry(2,v,r),!o)if(d){let _=n.viewCheckHooks;_!==null&&af(e,_)}else{let _=n.viewHooks;_!==null&&cf(e,_,2),x_(e,2)}if(n.firstUpdatePass===!0&&(n.firstUpdatePass=!1),e[E_]){for(let _ of e[E_])_();e[E_]=null}o||(b1(e),e[ye]&=-73)}catch(d){throw o||Yl(e),d}finally{u!==null&&(Zv(u,c),a&&J4(u)),Ly()}}function T1(n,e){for(let t=QD(n);t!==null;t=ZD(t))for(let r=qn;r<t.length;r++){let i=t[r];D1(i,e)}}function o5(n){for(let e=QD(n);e!==null;e=ZD(e)){if(!(e[ye]&2))continue;let t=e[wf];for(let r=0;r<t.length;r++){let i=t[r];uD(i)}}}function s5(n,e,t){We(18);let r=kr(e,n);D1(r,t),We(19,r[In])}function D1(n,e){Ry(n)&&ay(n,e)}function ay(n,e){let r=n[Me],i=n[ye],o=n[Wn],s=!!(e===0&&i&16);if(s||=!!(i&64&&e===0),s||=!!(i&1024),s||=!!(o?.dirty&&Jv(o)),s||=!1,o&&(o.dirty=!1),n[ye]&=-9217,s)i5(r,n,r.template,n[In]);else if(i&8192){x1(n),T1(n,1);let a=r.components;a!==null&&M1(n,a,1),b1(n)}}function M1(n,e,t){for(let r=0;r<e.length;r++)s5(n,e[r],t)}function a5(n,e){let t=n.hostBindingOpCodes;if(t!==null)try{for(let r=0;r<t.length;r++){let i=t[r];if(i<0)ls(~i);else{let o=i,s=t[++r],a=t[++r];n3(s,o);let c=e[o];We(24,c),a(2,c),We(25,c)}}}finally{ls(-1)}}function c0(n,e){let t=vD()?64:1088;for(n[oo].changeDetectionScheduler?.notify(e);n;){n[ye]|=t;let r=cs(n);if(Cf(n)&&!r)return n;n=r}return null}function P1(n,e,t,r){return[n,!0,0,e,null,r,null,t,null,null]}function c5(n,e,t,r=!0){let i=e[Me];if(l5(i,e,n,t),r){let s=sy(t,n),a=e[_t],c=a.parentNode(n[as]);c!==null&&L4(i,n[hr],a,e,c,s)}let o=e[gf];o!==null&&o.firstChild!==null&&(o.firstChild=null)}function cy(n,e){if(n.length<=qn)return;let t=qn+e,r=n[t];if(r){let i=r[Ra];i!==null&&i!==n&&o0(i,r),e>0&&(n[t-1][ur]=r[ur]);let o=pf(n,qn+e);F4(r[Me],r);let s=o[ka];s!==null&&s.detachView(o[Me]),r[pn]=null,r[ur]=null,r[ye]&=-129}return r}function l5(n,e,t,r){let i=qn+r,o=t.length;r>0&&(t[i-1][ur]=e),r<o-qn?(e[ur]=t[i],HT(t,qn+r,e)):(t.push(e),e[ur]=null),e[pn]=t;let s=e[Ra];s!==null&&t!==s&&A1(s,e);let a=e[ka];a!==null&&a.insertView(n),H_(e),e[ye]|=128}function A1(n,e){let t=n[wf],r=e[pn];if(io(r))n[ye]|=2;else{let i=r[pn][Or];e[Or]!==i&&(n[ye]|=2)}t===null?n[wf]=[e]:t.push(e)}var Wl=class{_lView;_cdRefInjectingView;notifyErrorHandler;_appRef=null;_attachedToViewContainer=!1;get rootNodes(){let e=this._lView,t=e[Me];return Af(t,e,t.firstChild,[])}constructor(e,t,r=!0){this._lView=e,this._cdRefInjectingView=t,this.notifyErrorHandler=r}get context(){return this._lView[In]}set context(e){this._lView[In]=e}get destroyed(){return $a(this._lView)}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){let e=this._lView[pn];if(Si(e)){let t=e[yf],r=t?t.indexOf(this):-1;r>-1&&(cy(e,r),pf(t,r))}this._attachedToViewContainer=!1}w1(this._lView[Me],this._lView)}onDestroy(e){dD(this._lView,e)}markForCheck(){c0(this._cdRefInjectingView||this._lView,4)}detach(){this._lView[ye]&=-129}reattach(){H_(this._lView),this._lView[ye]|=128}detectChanges(){this._lView[ye]|=1024,S1(this._lView,this.notifyErrorHandler)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new Z(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null;let e=Cf(this._lView),t=this._lView[Ra];t!==null&&!e&&o0(t,this._lView),y1(this._lView[Me],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new Z(902,!1);this._appRef=e;let t=Cf(this._lView),r=this._lView[Ra];r!==null&&!t&&A1(r,this._lView),H_(this._lView)}};var Kf=(()=>{class n{static __NG_ELEMENT_ID__=h5}return n})(),u5=Kf,d5=class extends u5{_declarationLView;_declarationTContainer;elementRef;constructor(e,t,r){super(),this._declarationLView=e,this._declarationTContainer=t,this.elementRef=r}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(e,t){return this.createEmbeddedViewImpl(e,t)}createEmbeddedViewImpl(e,t,r){let i=R4(this._declarationLView,this._declarationTContainer,e,{embeddedViewInjector:t,dehydratedView:r});return new Wl(i)}};function h5(){return f5(Nn(),He())}function f5(n,e){return n.type&4?new d5(e,n,Wf(n,e)):null}function l0(n,e,t,r,i){let o=n.data[e];if(o===null)o=p5(n,e,t,r,i),t3()&&(o.flags|=32);else if(o.type&64){o.type=t,o.value=r,o.attrs=i;let s=ZV();o.injectorIndex=s===null?-1:s.injectorIndex}return Ql(o,!0),o}function p5(n,e,t,r,i){let o=mD(),s=gD(),a=s?o:o&&o.parent,c=n.data[e]=g5(n,a,t,e,r,i);return m5(n,c,o,s),c}function m5(n,e,t,r){n.firstChild===null&&(n.firstChild=e),t!==null&&(r?t.child==null&&e.parent!==null&&(t.child=e):t.next===null&&(t.next=e,e.prev=t))}function g5(n,e,t,r,i,o){let s=e?e.injectorIndex:-1,a=0;return KV()&&(a|=128),{type:t,index:r,insertBeforeIndex:null,injectorIndex:s,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:a,providerIndexes:0,value:i,attrs:o,mergedAttrs:null,localNames:null,initialInputs:null,inputs:null,hostDirectiveInputs:null,outputs:null,hostDirectiveOutputs:null,directiveToIndex:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}var lre=new RegExp(`^(\\d+)*(${H3}|${z3})*(.*)`);var v5=()=>null;function gT(n,e){return v5(n,e)}var _5=class{},O1=class{},ly=class{resolveComponentFactory(e){throw Error(`No component factory found for ${bn(e)}.`)}},Yf=class{static NULL=new ly},Fa=class{},Ti=(()=>{class n{destroyNode=null;static __NG_ELEMENT_ID__=()=>y5()}return n})();function y5(){let n=He(),e=Nn(),t=kr(e.index,n);return(io(t)?t:n)[_t]}var w5=(()=>{class n{static \u0275prov=H({token:n,providedIn:"root",factory:()=>null})}return n})();var D_={},uy=class{injector;parentInjector;constructor(e,t){this.injector=e,this.parentInjector=t}get(e,t,r){r=jf(r);let i=this.injector.get(e,D_,r);return i!==D_||t===D_?i:this.parentInjector.get(e,t,r)}};function vT(n,e,t){let r=t?n.styles:null,i=t?n.classes:null,o=0;if(e!==null)for(let s=0;s<e.length;s++){let a=e[s];if(typeof a=="number")o=a;else if(o==1)i=F_(i,a);else if(o==2){let c=a,u=e[++s];r=F_(r,c+": "+u+";")}}t?n.styles=r:n.stylesWithoutHost=r,t?n.classes=i:n.classesWithoutHost=i}function q(n,e=be.Default){let t=He();if(t===null)return ee(n,e);let r=Nn();return FD(r,t,fn(n),e)}function N1(){let n="invalid";throw new Error(n)}function R1(n,e,t,r,i){let o=r===null?null:{"":-1},s=i(n,t);if(s!==null){let a,c=null,u=null,d=b5(s);d===null?a=s:[a,c,u]=d,x5(n,e,t,a,o,c,u)}o!==null&&r!==null&&C5(t,r,o)}function C5(n,e,t){let r=n.localNames=[];for(let i=0;i<e.length;i+=2){let o=t[e[i+1]];if(o==null)throw new Z(-301,!1);r.push(e[i],o)}}function b5(n){let e=null,t=!1;for(let s=0;s<n.length;s++){let a=n[s];if(s===0&&Nr(a)&&(e=a),a.findHostDirectiveDefs!==null){t=!0;break}}if(!t)return null;let r=null,i=null,o=null;for(let s of n)s.findHostDirectiveDefs!==null&&(r??=[],i??=new Map,o??=new Map,I5(s,r,o,i)),s===e&&(r??=[],r.push(s));return r!==null?(r.push(...e===null?n:n.slice(1)),[r,i,o]):null}function I5(n,e,t,r){let i=e.length;n.findHostDirectiveDefs(n,e,r),t.set(n,[i,e.length-1])}function E5(n,e,t){e.componentOffset=t,(n.components??=[]).push(e.index)}function x5(n,e,t,r,i,o,s){let a=r.length,c=!1;for(let v=0;v<a;v++){let _=r[v];!c&&Nr(_)&&(c=!0,E5(n,t,v)),K_(Sf(t,e),n,_.type)}A5(t,n.data.length,a);for(let v=0;v<a;v++){let _=r[v];_.providersResolver&&_.providersResolver(_)}let u=!1,d=!1,f=h1(n,e,a,null);a>0&&(t.directiveToIndex=new Map);for(let v=0;v<a;v++){let _=r[v];if(t.mergedAttrs=Hl(t.mergedAttrs,_.hostAttrs),T5(n,t,e,f,_),P5(f,_,i),s!==null&&s.has(_)){let[N,R]=s.get(_);t.directiveToIndex.set(_.type,[f,N+t.directiveStart,R+t.directiveStart])}else(o===null||!o.has(_))&&t.directiveToIndex.set(_.type,f);_.contentQueries!==null&&(t.flags|=4),(_.hostBindings!==null||_.hostAttrs!==null||_.hostVars!==0)&&(t.flags|=64);let b=_.type.prototype;!u&&(b.ngOnChanges||b.ngOnInit||b.ngDoCheck)&&((n.preOrderHooks??=[]).push(t.index),u=!0),!d&&(b.ngOnChanges||b.ngDoCheck)&&((n.preOrderCheckHooks??=[]).push(t.index),d=!0),f++}S5(n,t,o)}function S5(n,e,t){for(let r=e.directiveStart;r<e.directiveEnd;r++){let i=n.data[r];if(t===null||!t.has(i))_T(0,e,i,r),_T(1,e,i,r),wT(e,r,!1);else{let o=t.get(i);yT(0,e,o,r),yT(1,e,o,r),wT(e,r,!0)}}}function _T(n,e,t,r){let i=n===0?t.inputs:t.outputs;for(let o in i)if(i.hasOwnProperty(o)){let s;n===0?s=e.inputs??={}:s=e.outputs??={},s[o]??=[],s[o].push(r),k1(e,o)}}function yT(n,e,t,r){let i=n===0?t.inputs:t.outputs;for(let o in i)if(i.hasOwnProperty(o)){let s=i[o],a;n===0?a=e.hostDirectiveInputs??={}:a=e.hostDirectiveOutputs??={},a[s]??=[],a[s].push(r,o),k1(e,s)}}function k1(n,e){e==="class"?n.flags|=8:e==="style"&&(n.flags|=16)}function wT(n,e,t){let{attrs:r,inputs:i,hostDirectiveInputs:o}=n;if(r===null||!t&&i===null||t&&o===null||Zy(n)){n.initialInputs??=[],n.initialInputs.push(null);return}let s=null,a=0;for(;a<r.length;){let c=r[a];if(c===0){a+=4;continue}else if(c===5){a+=2;continue}else if(typeof c=="number")break;if(!t&&i.hasOwnProperty(c)){let u=i[c];for(let d of u)if(d===e){s??=[],s.push(c,r[a+1]);break}}else if(t&&o.hasOwnProperty(c)){let u=o[c];for(let d=0;d<u.length;d+=2)if(u[d]===e){s??=[],s.push(u[d+1],r[a+1]);break}}a+=2}n.initialInputs??=[],n.initialInputs.push(s)}function T5(n,e,t,r,i){n.data[r]=i;let o=i.factory||(i.factory=is(i.type,!0)),s=new us(o,Nr(i),q);n.blueprint[r]=s,t[r]=s,D5(n,e,r,h1(n,t,i.hostVars,Gn),i)}function D5(n,e,t,r,i){let o=i.hostBindings;if(o){let s=n.hostBindingOpCodes;s===null&&(s=n.hostBindingOpCodes=[]);let a=~e.index;M5(s)!=a&&s.push(a),s.push(t,r,o)}}function M5(n){let e=n.length;for(;e>0;){let t=n[--e];if(typeof t=="number"&&t<0)return t}return 0}function P5(n,e,t){if(t){if(e.exportAs)for(let r=0;r<e.exportAs.length;r++)t[e.exportAs[r]]=n;Nr(e)&&(t[""]=n)}}function A5(n,e,t){n.flags|=1,n.directiveStart=e,n.directiveEnd=e+t,n.providerIndexes=e}function F1(n,e,t,r,i,o,s,a){let c=e.consts,u=bf(c,s),d=l0(e,n,2,r,u);return o&&R1(e,t,d,bf(c,a),i),d.mergedAttrs=Hl(d.mergedAttrs,d.attrs),d.attrs!==null&&vT(d,d.attrs,!1),d.mergedAttrs!==null&&vT(d,d.mergedAttrs,!0),e.queries!==null&&e.queries.elementStart(e,d),d}function L1(n,e){DD(n,e),tD(e)&&n.queries.elementEnd(e)}var Of=class extends Yf{ngModule;constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){let t=ss(e);return new La(t,this.ngModule)}};function O5(n){return Object.keys(n).map(e=>{let[t,r,i]=n[e],o={propName:t,templateName:e,isSignal:(r&qf.SignalBased)!==0};return i&&(o.transform=i),o})}function N5(n){return Object.keys(n).map(e=>({propName:n[e],templateName:e}))}function R5(n,e,t){let r=e instanceof en?e:e?.injector;return r&&n.getStandaloneInjector!==null&&(r=n.getStandaloneInjector(r)||r),r?new uy(t,r):t}function k5(n){let e=n.get(Fa,null);if(e===null)throw new Z(407,!1);let t=n.get(w5,null),r=n.get(ds,null);return{rendererFactory:e,sanitizer:t,changeDetectionScheduler:r}}function F5(n,e){let t=(n.selectors[0][0]||"div").toLowerCase();return c1(e,t,t==="svg"?sD:t==="math"?jV:null)}var La=class extends O1{componentDef;ngModule;selector;componentType;ngContentSelectors;isBoundToModule;cachedInputs=null;cachedOutputs=null;get inputs(){return this.cachedInputs??=O5(this.componentDef.inputs),this.cachedInputs}get outputs(){return this.cachedOutputs??=N5(this.componentDef.outputs),this.cachedOutputs}constructor(e,t){super(),this.componentDef=e,this.ngModule=t,this.componentType=e.type,this.selector=l4(e.selectors),this.ngContentSelectors=e.ngContentSelectors??[],this.isBoundToModule=!!t}create(e,t,r,i){We(22);let o=Se(null);try{let s=this.componentDef,a=r?["ng-version","19.2.14"]:u4(this.componentDef.selectors[0]),c=Jy(0,null,null,1,0,null,null,null,null,[a],null),u=R5(s,i||this.ngModule,e),d=k5(u),f=d.rendererFactory.createRenderer(null,s),v=r?y4(f,r,s.encapsulation,u):F5(s,f),_=Xy(null,c,null,512|d1(s),null,null,d,f,u,null,r1(v,u,!0));_[dr]=v,Fy(_);let b=null;try{let N=F1(dr,c,_,"#host",()=>[this.componentDef],!0,0);v&&(u1(f,v,N),Zl(v,_)),t0(c,_,N),o1(c,N,_),L1(c,N),t!==void 0&&L5(N,this.ngContentSelectors,t),b=kr(N.index,_),_[In]=b[In],r0(c,_,null)}catch(N){throw b!==null&&ey(b),ey(_),N}finally{We(23),Ly()}return new dy(this.componentType,_)}finally{Se(o)}}},dy=class extends _5{_rootLView;instance;hostView;changeDetectorRef;componentType;location;previousInputValues=null;_tNode;constructor(e,t){super(),this._rootLView=t,this._tNode=cD(t[Me],dr),this.location=Wf(this._tNode,t),this.instance=kr(this._tNode.index,t)[In],this.hostView=this.changeDetectorRef=new Wl(t,void 0,!1),this.componentType=e}setInput(e,t){let r=this._tNode;if(this.previousInputValues??=new Map,this.previousInputValues.has(e)&&Object.is(this.previousInputValues.get(e),t))return;let i=this._rootLView,o=n0(r,i[Me],i,e,t);this.previousInputValues.set(e,t);let s=kr(r.index,i);c0(s,1)}get injector(){return new rs(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}};function L5(n,e,t){let r=n.projection=[];for(let i=0;i<e.length;i++){let o=t[i];r.push(o!=null&&o.length?Array.from(o):null)}}var Ga=(()=>{class n{static __NG_ELEMENT_ID__=V5}return n})();function V5(){let n=Nn();return B5(n,He())}var j5=Ga,V1=class extends j5{_lContainer;_hostTNode;_hostLView;constructor(e,t,r){super(),this._lContainer=e,this._hostTNode=t,this._hostLView=r}get element(){return Wf(this._hostTNode,this._hostLView)}get injector(){return new rs(this._hostTNode,this._hostLView)}get parentInjector(){let e=Uy(this._hostTNode,this._hostLView);if(PD(e)){let t=Ef(e,this._hostLView),r=If(e),i=t[Me].data[r+8];return new rs(i,t)}else return new rs(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){let t=CT(this._lContainer);return t!==null&&t[e]||null}get length(){return this._lContainer.length-qn}createEmbeddedView(e,t,r){let i,o;typeof r=="number"?i=r:r!=null&&(i=r.index,o=r.injector);let s=gT(this._lContainer,e.ssrId),a=e.createEmbeddedViewImpl(t||{},o,s);return this.insertImpl(a,i,pT(this._hostTNode,s)),a}createComponent(e,t,r,i,o){let s=e&&!kV(e),a;if(s)a=t;else{let b=t||{};a=b.index,r=b.injector,i=b.projectableNodes,o=b.environmentInjector||b.ngModuleRef}let c=s?e:new La(ss(e)),u=r||this.parentInjector;if(!o&&c.ngModule==null){let N=(s?u:this.parentInjector).get(en,null);N&&(o=N)}let d=ss(c.componentType??{}),f=gT(this._lContainer,d?.id??null),v=f?.firstChild??null,_=c.create(u,i,v,o);return this.insertImpl(_.hostView,a,pT(this._hostTNode,f)),_}insert(e,t){return this.insertImpl(e,t,!0)}insertImpl(e,t,r){let i=e._lView;if($V(i)){let a=this.indexOf(e);if(a!==-1)this.detach(a);else{let c=i[pn],u=new V1(c,c[hr],c[pn]);u.detach(u.indexOf(e))}}let o=this._adjustIndex(t),s=this._lContainer;return c5(s,i,o,r),e.attachToViewContainerRef(),HT(M_(s),o,e),e}move(e,t){return this.insert(e,t)}indexOf(e){let t=CT(this._lContainer);return t!==null?t.indexOf(e):-1}remove(e){let t=this._adjustIndex(e,-1),r=cy(this._lContainer,t);r&&(pf(M_(this._lContainer),t),w1(r[Me],r))}detach(e){let t=this._adjustIndex(e,-1),r=cy(this._lContainer,t);return r&&pf(M_(this._lContainer),t)!=null?new Wl(r):null}_adjustIndex(e,t=0){return e??this.length+t}};function CT(n){return n[yf]}function M_(n){return n[yf]||(n[yf]=[])}function B5(n,e){let t,r=e[n.index];return Si(r)?t=r:(t=P1(r,e,null,n),e[n.index]=t,e0(e,t)),$5(t,e,n,r),new V1(t,n,e)}function U5(n,e){let t=n[_t],r=t.createComment(""),i=Br(e,n),o=t.parentNode(i);return Pf(t,o,r,t.nextSibling(i),!1),r}var $5=W5,z5=()=>!1;function H5(n,e,t){return z5(n,e,t)}function W5(n,e,t,r){if(n[as])return;let i;t.type&8?i=Rr(r):i=U5(e,t),n[as]=i}var Va=class{},u0=class{};var hy=class extends Va{ngModuleType;_parent;_bootstrapComponents=[];_r3Injector;instance;destroyCbs=[];componentFactoryResolver=new Of(this);constructor(e,t,r,i=!0){super(),this.ngModuleType=e,this._parent=t;let o=GT(e);this._bootstrapComponents=s1(o.bootstrap),this._r3Injector=jD(e,t,[{provide:Va,useValue:this},{provide:Yf,useValue:this.componentFactoryResolver},...r],bn(e),new Set(["environment"])),i&&this.resolveInjectorInitializers()}resolveInjectorInitializers(){this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(this.ngModuleType)}get injector(){return this._r3Injector}destroy(){let e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(t=>t()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}},fy=class extends u0{moduleType;constructor(e){super(),this.moduleType=e}create(e){return new hy(this.moduleType,e,[])}};var Nf=class extends Va{injector;componentFactoryResolver=new Of(this);instance=null;constructor(e){super();let t=new $l([...e.providers,{provide:Va,useValue:this},{provide:Yf,useValue:this.componentFactoryResolver}],e.parent||Ay(),e.debugName,new Set(["environment"]));this.injector=t,e.runEnvironmentInitializers&&t.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(e){this.injector.onDestroy(e)}};function Jl(n,e,t=null){return new Nf({providers:n,parent:e,debugName:t,runEnvironmentInitializers:!0}).injector}var q5=(()=>{class n{_injector;cachedInjectors=new Map;constructor(t){this._injector=t}getOrCreateStandaloneInjector(t){if(!t.standalone)return null;if(!this.cachedInjectors.has(t)){let r=KT(!1,t.type),i=r.length>0?Jl([r],this._injector,`Standalone[${t.type.name}]`):null;this.cachedInjectors.set(t,i)}return this.cachedInjectors.get(t)}ngOnDestroy(){try{for(let t of this.cachedInjectors.values())t!==null&&t.destroy()}finally{this.cachedInjectors.clear()}}static \u0275prov=H({token:n,providedIn:"environment",factory:()=>new n(ee(en))})}return n})();function Pt(n){return Gl(()=>{let e=j1(n),t=le(L({},e),{decls:n.decls,vars:n.vars,template:n.template,consts:n.consts||null,ngContentSelectors:n.ngContentSelectors,onPush:n.changeDetection===KD.OnPush,directiveDefs:null,pipeDefs:null,dependencies:e.standalone&&n.dependencies||null,getStandaloneInjector:e.standalone?i=>i.get(q5).getOrCreateStandaloneInjector(t):null,getExternalStyles:null,signals:n.signals??!1,data:n.data||{},encapsulation:n.encapsulation||Lr.Emulated,styles:n.styles||Cn,_:null,schemas:n.schemas||null,tView:null,id:""});e.standalone&&qa("NgStandalone"),B1(t);let r=n.dependencies;return t.directiveDefs=bT(r,!1),t.pipeDefs=bT(r,!0),t.id=Z5(t),t})}function G5(n){return ss(n)||EV(n)}function K5(n){return n!==null}function $r(n){return Gl(()=>({type:n.type,bootstrap:n.bootstrap||Cn,declarations:n.declarations||Cn,imports:n.imports||Cn,exports:n.exports||Cn,transitiveCompileScopes:null,schemas:n.schemas||null,id:n.id||null}))}function Y5(n,e){if(n==null)return os;let t={};for(let r in n)if(n.hasOwnProperty(r)){let i=n[r],o,s,a,c;Array.isArray(i)?(a=i[0],o=i[1],s=i[2]??o,c=i[3]||null):(o=i,s=i,a=qf.None,c=null),t[o]=[r,a,c],e[o]=s}return t}function Q5(n){if(n==null)return os;let e={};for(let t in n)n.hasOwnProperty(t)&&(e[n[t]]=t);return e}function Qe(n){return Gl(()=>{let e=j1(n);return B1(e),e})}function d0(n){return{type:n.type,name:n.name,factory:null,pure:n.pure!==!1,standalone:n.standalone??!0,onDestroy:n.type.prototype.ngOnDestroy||null}}function j1(n){let e={};return{type:n.type,providersResolver:null,factory:null,hostBindings:n.hostBindings||null,hostVars:n.hostVars||0,hostAttrs:n.hostAttrs||null,contentQueries:n.contentQueries||null,declaredInputs:e,inputConfig:n.inputs||os,exportAs:n.exportAs||null,standalone:n.standalone??!0,signals:n.signals===!0,selectors:n.selectors||Cn,viewQuery:n.viewQuery||null,features:n.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:Y5(n.inputs,e),outputs:Q5(n.outputs),debugInfo:null}}function B1(n){n.features?.forEach(e=>e(n))}function bT(n,e){if(!n)return null;let t=e?xV:G5;return()=>(typeof n=="function"?n():n).map(r=>t(r)).filter(K5)}function Z5(n){let e=0,t=typeof n.consts=="function"?"":n.consts,r=[n.selectors,n.ngContentSelectors,n.hostVars,n.hostAttrs,t,n.vars,n.decls,n.encapsulation,n.standalone,n.signals,n.exportAs,JSON.stringify(n.inputs),JSON.stringify(n.outputs),Object.getOwnPropertyNames(n.type.prototype),!!n.contentQueries,!!n.viewQuery];for(let o of r.join("|"))e=Math.imul(31,e)+o.charCodeAt(0)<<0;return e+=2147483648,"c"+e}function J5(n){return Object.getPrototypeOf(n.prototype).constructor}function Ht(n){let e=J5(n.type),t=!0,r=[n];for(;e;){let i;if(Nr(n))i=e.\u0275cmp||e.\u0275dir;else{if(e.\u0275cmp)throw new Z(903,!1);i=e.\u0275dir}if(i){if(t){r.push(i);let s=n;s.inputs=P_(n.inputs),s.declaredInputs=P_(n.declaredInputs),s.outputs=P_(n.outputs);let a=i.hostBindings;a&&rj(n,a);let c=i.viewQuery,u=i.contentQueries;if(c&&tj(n,c),u&&nj(n,u),X5(n,i),iV(n.outputs,i.outputs),Nr(i)&&i.data.animation){let d=n.data;d.animation=(d.animation||[]).concat(i.data.animation)}}let o=i.features;if(o)for(let s=0;s<o.length;s++){let a=o[s];a&&a.ngInherit&&a(n),a===Ht&&(t=!1)}}e=Object.getPrototypeOf(e)}ej(r)}function X5(n,e){for(let t in e.inputs){if(!e.inputs.hasOwnProperty(t)||n.inputs.hasOwnProperty(t))continue;let r=e.inputs[t];r!==void 0&&(n.inputs[t]=r,n.declaredInputs[t]=e.declaredInputs[t])}}function ej(n){let e=0,t=null;for(let r=n.length-1;r>=0;r--){let i=n[r];i.hostVars=e+=i.hostVars,i.hostAttrs=Hl(i.hostAttrs,t=Hl(t,i.hostAttrs))}}function P_(n){return n===os?{}:n===Cn?[]:n}function tj(n,e){let t=n.viewQuery;t?n.viewQuery=(r,i)=>{e(r,i),t(r,i)}:n.viewQuery=e}function nj(n,e){let t=n.contentQueries;t?n.contentQueries=(r,i,o)=>{e(r,i,o),t(r,i,o)}:n.contentQueries=e}function rj(n,e){let t=n.hostBindings;t?n.hostBindings=(r,i)=>{e(r,i),t(r,i)}:n.hostBindings=e}function U1(n){return oj(n)?Array.isArray(n)||!(n instanceof Map)&&Symbol.iterator in n:!1}function ij(n,e){if(Array.isArray(n))for(let t=0;t<n.length;t++)e(n[t]);else{let t=n[Symbol.iterator](),r;for(;!(r=t.next()).done;)e(r.value)}}function oj(n){return n!==null&&(typeof n=="function"||typeof n=="object")}function $1(n,e,t){return n[e]=t}function sj(n,e){return n[e]}function so(n,e,t){let r=n[e];return Object.is(r,t)?!1:(n[e]=t,!0)}function z1(n,e,t,r){let i=so(n,e,t);return so(n,e+1,r)||i}function aj(n,e,t,r,i,o,s,a,c){let u=e.consts,d=l0(e,n,4,s||null,a||null);pD()&&R1(e,t,d,bf(u,c),v1),d.mergedAttrs=Hl(d.mergedAttrs,d.attrs),DD(e,d);let f=d.tView=Jy(2,d,r,i,o,e.directiveRegistry,e.pipeRegistry,null,e.schemas,u,null);return e.queries!==null&&(e.queries.template(e,d),f.queries=e.queries.embeddedTView(d)),d}function cj(n,e,t,r,i,o,s,a,c,u){let d=t+dr,f=e.firstCreatePass?aj(d,e,n,r,i,o,s,a,c):e.data[d];Ql(f,!1);let v=lj(e,n,f,t);jy()&&s0(e,n,v,f),Zl(v,n);let _=P1(v,n,v,f);return n[d]=_,e0(n,_),H5(_,f,n),Ny(f)&&t0(e,n,f),c!=null&&m1(n,f,u),f}function ie(n,e,t,r,i,o,s,a){let c=He(),u=gn(),d=bf(u.consts,o);return cj(c,u,n,e,t,r,i,d,s,a),ie}var lj=uj;function uj(n,e,t,r){return By(!0),e[_t].createComment("")}var H1=(()=>{class n{log(t){console.log(t)}warn(t){console.warn(t)}static \u0275fac=function(r){return new(r||n)};static \u0275prov=H({token:n,factory:n.\u0275fac,providedIn:"platform"})}return n})();var W1=new J("");var dj=(()=>{class n{static \u0275prov=H({token:n,providedIn:"root",factory:()=>new py})}return n})(),py=class{queuedEffectCount=0;queues=new Map;schedule(e){this.enqueue(e)}remove(e){let t=e.zone,r=this.queues.get(t);r.has(e)&&(r.delete(e),this.queuedEffectCount--)}enqueue(e){let t=e.zone;this.queues.has(t)||this.queues.set(t,new Set);let r=this.queues.get(t);r.has(e)||(this.queuedEffectCount++,r.add(e))}flush(){for(;this.queuedEffectCount>0;)for(let[e,t]of this.queues)e===null?this.flushQueue(t):e.run(()=>this.flushQueue(t))}flushQueue(e){for(let t of e)e.delete(t),this.queuedEffectCount--,t.run()}};function gs(n){return!!n&&typeof n.then=="function"}function q1(n){return!!n&&typeof n.subscribe=="function"}var G1=new J("");function Xl(n){return En([{provide:G1,multi:!0,useValue:n}])}var K1=(()=>{class n{resolve;reject;initialized=!1;done=!1;donePromise=new Promise((t,r)=>{this.resolve=t,this.reject=r});appInits=j(G1,{optional:!0})??[];injector=j(rt);constructor(){}runInitializers(){if(this.initialized)return;let t=[];for(let i of this.appInits){let o=tn(this.injector,i);if(gs(o))t.push(o);else if(q1(o)){let s=new Promise((a,c)=>{o.subscribe({complete:a,error:c})});t.push(s)}}let r=()=>{this.done=!0,this.resolve()};Promise.all(t).then(()=>{r()}).catch(i=>{this.reject(i)}),t.length===0&&r(),this.initialized=!0}static \u0275fac=function(r){return new(r||n)};static \u0275prov=H({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),Qf=new J("");function hj(){t_(()=>{throw new Z(600,!1)})}function fj(n){return n.isBoundToModule}var pj=10;var Vr=(()=>{class n{_runningTick=!1;_destroyed=!1;_destroyListeners=[];_views=[];internalErrorHandler=j(N3);afterRenderManager=j(n1);zonelessEnabled=j($y);rootEffectScheduler=j(dj);dirtyFlags=0;tracingSnapshot=null;externalTestViews=new Set;afterTick=new ct;get allViews(){return[...this.externalTestViews.keys(),...this._views]}get destroyed(){return this._destroyed}componentTypes=[];components=[];isStable=j(ms).hasPendingTasks.pipe(_e(t=>!t));constructor(){j(Wa,{optional:!0})}whenStable(){let t;return new Promise(r=>{t=this.isStable.subscribe({next:i=>{i&&r()}})}).finally(()=>{t.unsubscribe()})}_injector=j(en);_rendererFactory=null;get injector(){return this._injector}bootstrap(t,r){return this.bootstrapImpl(t,r)}bootstrapImpl(t,r,i=rt.NULL){We(10);let o=t instanceof O1;if(!this._injector.get(K1).done){let _="";throw new Z(405,_)}let a;o?a=t:a=this._injector.get(Yf).resolveComponentFactory(t),this.componentTypes.push(a.componentType);let c=fj(a)?void 0:this._injector.get(Va),u=r||a.selector,d=a.create(i,[],u,c),f=d.location.nativeElement,v=d.injector.get(W1,null);return v?.registerApplication(f),d.onDestroy(()=>{this.detachView(d.hostView),lf(this.components,d),v?.unregisterApplication(f)}),this._loadComponent(d),We(11,d),d}tick(){this.zonelessEnabled||(this.dirtyFlags|=1),this._tick()}_tick(){We(12),this.tracingSnapshot!==null?this.tracingSnapshot.run(Ky.CHANGE_DETECTION,this.tickImpl):this.tickImpl()}tickImpl=()=>{if(this._runningTick)throw new Z(101,!1);let t=Se(null);try{this._runningTick=!0,this.synchronize()}catch(r){this.internalErrorHandler(r)}finally{this._runningTick=!1,this.tracingSnapshot?.dispose(),this.tracingSnapshot=null,Se(t),this.afterTick.next(),We(13)}};synchronize(){this._rendererFactory===null&&!this._injector.destroyed&&(this._rendererFactory=this._injector.get(Fa,null,{optional:!0}));let t=0;for(;this.dirtyFlags!==0&&t++<pj;)We(14),this.synchronizeOnce(),We(15)}synchronizeOnce(){if(this.dirtyFlags&16&&(this.dirtyFlags&=-17,this.rootEffectScheduler.flush()),this.dirtyFlags&7){let t=!!(this.dirtyFlags&1);this.dirtyFlags&=-8,this.dirtyFlags|=8;for(let{_lView:r,notifyErrorHandler:i}of this.allViews)mj(r,i,t,this.zonelessEnabled);if(this.dirtyFlags&=-5,this.syncDirtyFlagsWithViews(),this.dirtyFlags&23)return}else this._rendererFactory?.begin?.(),this._rendererFactory?.end?.();this.dirtyFlags&8&&(this.dirtyFlags&=-9,this.afterRenderManager.execute()),this.syncDirtyFlagsWithViews()}syncDirtyFlagsWithViews(){if(this.allViews.some(({_lView:t})=>$f(t))){this.dirtyFlags|=2;return}else this.dirtyFlags&=-8}attachView(t){let r=t;this._views.push(r),r.attachToAppRef(this)}detachView(t){let r=t;lf(this._views,r),r.detachFromAppRef()}_loadComponent(t){this.attachView(t.hostView),this.tick(),this.components.push(t),this._injector.get(Qf,[]).forEach(i=>i(t))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(t=>t()),this._views.slice().forEach(t=>t.destroy())}finally{this._destroyed=!0,this._views=[],this._destroyListeners=[]}}onDestroy(t){return this._destroyListeners.push(t),()=>lf(this._destroyListeners,t)}destroy(){if(this._destroyed)throw new Z(406,!1);let t=this._injector;t.destroy&&!t.destroyed&&t.destroy()}get viewCount(){return this._views.length}static \u0275fac=function(r){return new(r||n)};static \u0275prov=H({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function lf(n,e){let t=n.indexOf(e);t>-1&&n.splice(t,1)}function mj(n,e,t,r){if(!t&&!$f(n))return;S1(n,e,t&&!r?0:1)}function lo(n,e,t,r){let i=He(),o=zf();if(so(i,o,e)){let s=gn(),a=Vy();T4(a,i,n,e,t,r)}return lo}function gj(n,e,t,r){return so(n,zf(),t)?e+Bl(t)+r:Gn}function vj(n,e,t,r,i,o){let s=XV(),a=z1(n,s,t,i);return ky(2),a?e+Bl(t)+r+Bl(i)+o:Gn}function of(n,e){return n<<17|e<<2}function hs(n){return n>>17&32767}function _j(n){return(n&2)==2}function yj(n,e){return n&131071|e<<17}function my(n){return n|2}function ja(n){return(n&131068)>>2}function A_(n,e){return n&-131069|e<<2}function wj(n){return(n&1)===1}function gy(n){return n|1}function Cj(n,e,t,r,i,o){let s=o?e.classBindings:e.styleBindings,a=hs(s),c=ja(s);n[r]=t;let u=!1,d;if(Array.isArray(t)){let f=t;d=f[1],(d===null||Kl(f,d)>0)&&(u=!0)}else d=t;if(i)if(c!==0){let v=hs(n[a+1]);n[r+1]=of(v,a),v!==0&&(n[v+1]=A_(n[v+1],r)),n[a+1]=yj(n[a+1],r)}else n[r+1]=of(a,0),a!==0&&(n[a+1]=A_(n[a+1],r)),a=r;else n[r+1]=of(c,0),a===0?a=r:n[c+1]=A_(n[c+1],r),c=r;u&&(n[r+1]=my(n[r+1])),IT(n,d,r,!0),IT(n,d,r,!1),bj(e,d,n,r,o),s=of(a,c),o?e.classBindings=s:e.styleBindings=s}function bj(n,e,t,r,i){let o=i?n.residualClasses:n.residualStyles;o!=null&&typeof e=="string"&&Kl(o,e)>=0&&(t[r+1]=gy(t[r+1]))}function IT(n,e,t,r){let i=n[t+1],o=e===null,s=r?hs(i):ja(i),a=!1;for(;s!==0&&(a===!1||o);){let c=n[s],u=n[s+1];Ij(c,e)&&(a=!0,n[s+1]=r?gy(u):my(u)),s=r?hs(u):ja(u)}a&&(n[t+1]=r?my(i):gy(i))}function Ij(n,e){return n===null||e==null||(Array.isArray(n)?n[1]:n)===e?!0:Array.isArray(n)&&typeof e=="string"?Kl(n,e)>=0:!1}var lr={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function Ej(n){return n.substring(lr.key,lr.keyEnd)}function xj(n){return Sj(n),Y1(n,Q1(n,0,lr.textEnd))}function Y1(n,e){let t=lr.textEnd;return t===e?-1:(e=lr.keyEnd=Tj(n,lr.key=e,t),Q1(n,e,t))}function Sj(n){lr.key=0,lr.keyEnd=0,lr.value=0,lr.valueEnd=0,lr.textEnd=n.length}function Q1(n,e,t){for(;e<t&&n.charCodeAt(e)<=32;)e++;return e}function Tj(n,e,t){for(;e<t&&n.charCodeAt(e)>32;)e++;return e}function V(n,e,t){let r=He(),i=zf();if(so(r,i,e)){let o=gn(),s=Vy();g1(o,s,r,n,e,r[_t],t,!1)}return V}function vy(n,e,t,r,i){n0(e,n,t,i?"class":"style",r)}function Ze(n,e){return Mj(n,e,null,!0),Ze}function eu(n){Pj(Fj,Dj,n,!0)}function Dj(n,e){for(let t=xj(e);t>=0;t=Y1(e,t))Dy(n,Ej(e),!0)}function Mj(n,e,t,r){let i=He(),o=gn(),s=ky(2);if(o.firstUpdatePass&&J1(o,n,s,r),e!==Gn&&so(i,s,e)){let a=o.data[ao()];X1(o,a,i,i[_t],n,i[s+1]=Vj(e,t),r,s)}}function Pj(n,e,t,r){let i=gn(),o=ky(2);i.firstUpdatePass&&J1(i,null,o,r);let s=He();if(t!==Gn&&so(s,o,t)){let a=i.data[ao()];if(eM(a,r)&&!Z1(i,o)){let c=r?a.classesWithoutHost:a.stylesWithoutHost;c!==null&&(t=F_(c,t||"")),vy(i,a,s,t,r)}else Lj(i,a,s,s[_t],s[o+1],s[o+1]=kj(n,e,t),r,o)}}function Z1(n,e){return e>=n.expandoStartIndex}function J1(n,e,t,r){let i=n.data;if(i[t+1]===null){let o=i[ao()],s=Z1(n,t);eM(o,r)&&e===null&&!s&&(e=!1),e=Aj(i,o,e,r),Cj(i,o,e,t,s,r)}}function Aj(n,e,t,r){let i=i3(n),o=r?e.residualClasses:e.residualStyles;if(i===null)(r?e.classBindings:e.styleBindings)===0&&(t=O_(null,n,e,t,r),t=ql(t,e.attrs,r),o=null);else{let s=e.directiveStylingLast;if(s===-1||n[s]!==i)if(t=O_(i,n,e,t,r),o===null){let c=Oj(n,e,r);c!==void 0&&Array.isArray(c)&&(c=O_(null,n,e,c[1],r),c=ql(c,e.attrs,r),Nj(n,e,r,c))}else o=Rj(n,e,r)}return o!==void 0&&(r?e.residualClasses=o:e.residualStyles=o),t}function Oj(n,e,t){let r=t?e.classBindings:e.styleBindings;if(ja(r)!==0)return n[hs(r)]}function Nj(n,e,t,r){let i=t?e.classBindings:e.styleBindings;n[hs(i)]=r}function Rj(n,e,t){let r,i=e.directiveEnd;for(let o=1+e.directiveStylingLast;o<i;o++){let s=n[o].hostAttrs;r=ql(r,s,t)}return ql(r,e.attrs,t)}function O_(n,e,t,r,i){let o=null,s=t.directiveEnd,a=t.directiveStylingLast;for(a===-1?a=t.directiveStart:a++;a<s&&(o=e[a],r=ql(r,o.hostAttrs,i),o!==n);)a++;return n!==null&&(t.directiveStylingLast=a),r}function ql(n,e,t){let r=t?1:2,i=-1;if(e!==null)for(let o=0;o<e.length;o++){let s=e[o];typeof s=="number"?i=s:i===r&&(Array.isArray(n)||(n=n===void 0?[]:["",n]),Dy(n,s,t?!0:e[++o]))}return n===void 0?null:n}function kj(n,e,t){if(t==null||t==="")return Cn;let r=[],i=Qy(t);if(Array.isArray(i))for(let o=0;o<i.length;o++)n(r,i[o],!0);else if(typeof i=="object")for(let o in i)i.hasOwnProperty(o)&&n(r,o,i[o]);else typeof i=="string"&&e(r,i);return r}function Fj(n,e,t){let r=String(e);r!==""&&!r.includes(" ")&&Dy(n,r,t)}function Lj(n,e,t,r,i,o,s,a){i===Gn&&(i=Cn);let c=0,u=0,d=0<i.length?i[0]:null,f=0<o.length?o[0]:null;for(;d!==null||f!==null;){let v=c<i.length?i[c+1]:void 0,_=u<o.length?o[u+1]:void 0,b=null,N;d===f?(c+=2,u+=2,v!==_&&(b=f,N=_)):f===null||d!==null&&d<f?(c+=2,b=d):(u+=2,b=f,N=_),b!==null&&X1(n,e,t,r,b,N,s,a),d=c<i.length?i[c]:null,f=u<o.length?o[u]:null}}function X1(n,e,t,r,i,o,s,a){if(!(e.type&3))return;let c=n.data,u=c[a+1],d=wj(u)?ET(c,e,t,i,ja(u),s):void 0;if(!Rf(d)){Rf(o)||_j(u)&&(o=ET(c,null,t,i,a,s));let f=aD(ao(),t);K4(r,s,f,i,o)}}function ET(n,e,t,r,i,o){let s=e===null,a;for(;i>0;){let c=n[i],u=Array.isArray(c),d=u?c[1]:c,f=d===null,v=t[i+1];v===Gn&&(v=f?Cn:void 0);let _=f?b_(v,r):d===r?v:void 0;if(u&&!Rf(_)&&(_=b_(c,r)),Rf(_)&&(a=_,s))return a;let b=n[i+1];i=s?hs(b):ja(b)}if(e!==null){let c=o?e.residualClasses:e.residualStyles;c!=null&&(a=b_(c,r))}return a}function Rf(n){return n!==void 0}function Vj(n,e){return n==null||n===""||(typeof e=="string"?n=n+e:typeof n=="object"&&(n=bn(Qy(n)))),n}function eM(n,e){return(n.flags&(e?8:16))!==0}function m(n,e,t,r){let i=He(),o=gn(),s=dr+n,a=i[_t],c=o.firstCreatePass?F1(s,o,i,e,v1,pD(),t,r):o.data[s],u=jj(o,i,c,a,e,n);i[s]=u;let d=Ny(c);return Ql(c,!0),u1(a,u,c),!_1(c)&&jy()&&s0(o,i,u,c),(WV()===0||d)&&Zl(u,i),qV(),d&&(t0(o,i,c),o1(o,c,i)),r!==null&&m1(i,c),m}function g(){let n=Nn();gD()?JV():(n=n.parent,Ql(n,!1));let e=n;YV(e)&&QV(),GV();let t=gn();return t.firstCreatePass&&L1(t,e),e.classesWithoutHost!=null&&d3(e)&&vy(t,e,He(),e.classesWithoutHost,!0),e.stylesWithoutHost!=null&&h3(e)&&vy(t,e,He(),e.stylesWithoutHost,!1),g}function K(n,e,t,r){return m(n,e,t,r),g(),K}var jj=(n,e,t,r,i,o)=>(By(!0),c1(r,i,c3()));function de(){return He()}var ts=void 0;function Bj(n){let e=Math.floor(Math.abs(n)),t=n.toString().replace(/^[^.]*\.?/,"").length;return e===1&&t===0?1:5}var Uj=["en",[["a","p"],["AM","PM"],ts],[["AM","PM"],ts,ts],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],ts,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],ts,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",ts,"{1} 'at' {0}",ts],[".",",",";","%","+","-","E","\xD7","\u2030","\u221E","NaN",":"],["#,##0.###","#,##0%","\xA4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",Bj],N_={};function kn(n){let e=$j(n),t=xT(e);if(t)return t;let r=e.split("-")[0];if(t=xT(r),t)return t;if(r==="en")return Uj;throw new Z(701,!1)}function xT(n){return n in N_||(N_[n]=Fl.ng&&Fl.ng.common&&Fl.ng.common.locales&&Fl.ng.common.locales[n]),N_[n]}var ft=function(n){return n[n.LocaleId=0]="LocaleId",n[n.DayPeriodsFormat=1]="DayPeriodsFormat",n[n.DayPeriodsStandalone=2]="DayPeriodsStandalone",n[n.DaysFormat=3]="DaysFormat",n[n.DaysStandalone=4]="DaysStandalone",n[n.MonthsFormat=5]="MonthsFormat",n[n.MonthsStandalone=6]="MonthsStandalone",n[n.Eras=7]="Eras",n[n.FirstDayOfWeek=8]="FirstDayOfWeek",n[n.WeekendRange=9]="WeekendRange",n[n.DateFormat=10]="DateFormat",n[n.TimeFormat=11]="TimeFormat",n[n.DateTimeFormat=12]="DateTimeFormat",n[n.NumberSymbols=13]="NumberSymbols",n[n.NumberFormats=14]="NumberFormats",n[n.CurrencyCode=15]="CurrencyCode",n[n.CurrencySymbol=16]="CurrencySymbol",n[n.CurrencyName=17]="CurrencyName",n[n.Currencies=18]="Currencies",n[n.Directionality=19]="Directionality",n[n.PluralCase=20]="PluralCase",n[n.ExtraData=21]="ExtraData",n}(ft||{});function $j(n){return n.toLowerCase().replace(/_/g,"-")}var kf="en-US";var zj=kf;function Hj(n){typeof n=="string"&&(zj=n.toLowerCase().replace(/_/g,"-"))}function ST(n,e,t){return function r(i){if(i===Function)return t;let o=Ua(n)?kr(n.index,e):e;c0(o,5);let s=e[In],a=TT(e,s,t,i),c=r.__ngNextListenerFn__;for(;c;)a=TT(e,s,c,i)&&a,c=c.__ngNextListenerFn__;return a}}function TT(n,e,t,r){let i=Se(null);try{return We(6,e,t),t(r)!==!1}catch(o){return Wj(n,o),!1}finally{We(7,e,t),Se(i)}}function Wj(n,e){let t=n[Na],r=t?t.get(Fr,null):null;r&&r.handleError(e)}function DT(n,e,t,r,i,o){let s=e[t],a=e[Me],u=a.data[t].outputs[r],d=s[u],f=a.firstCreatePass?fD(a):null,v=hD(e),_=d.subscribe(o),b=v.length;v.push(o,_),f&&f.push(i,n.index,b,-(b+1))}function z(n,e,t,r){let i=He(),o=gn(),s=Nn();return tM(o,i,i[_t],s,n,e,r),z}function qj(n,e,t,r){let i=n.cleanup;if(i!=null)for(let o=0;o<i.length-1;o+=2){let s=i[o];if(s===t&&i[o+1]===r){let a=e[vf],c=i[o+2];return a.length>c?a[c]:null}typeof s=="string"&&(o+=2)}return null}function tM(n,e,t,r,i,o,s){let a=Ny(r),u=n.firstCreatePass?fD(n):null,d=hD(e),f=!0;if(r.type&3||s){let v=Br(r,e),_=s?s(v):v,b=d.length,N=s?G=>s(Rr(G[r.index])):r.index,R=null;if(!s&&a&&(R=qj(n,e,i,r.index)),R!==null){let G=R.__ngLastListenerFn__||R;G.__ngNextListenerFn__=o,R.__ngLastListenerFn__=o,f=!1}else{o=ST(r,e,o),J3(e,_,i,o);let G=t.listen(_,i,o);d.push(o,G),u&&u.push(i,N,b,b+1)}}else o=ST(r,e,o);if(f){let v=r.outputs?.[i],_=r.hostDirectiveOutputs?.[i];if(_&&_.length)for(let b=0;b<_.length;b+=2){let N=_[b],R=_[b+1];DT(r,e,N,R,i,o)}if(v&&v.length)for(let b of v)DT(r,e,b,i,i,o)}}function A(n=1){return s3(n)}function y(n,e=""){let t=He(),r=gn(),i=n+dr,o=r.firstCreatePass?l0(r,i,1,e,null):r.data[i],s=Gj(r,t,o,e,n);t[i]=s,jy()&&s0(r,t,s,o),Ql(o,!1)}var Gj=(n,e,t,r,i)=>(By(!0),d4(e[_t],r));function se(n){return pe("",n,""),se}function pe(n,e,t){let r=He(),i=gj(r,n,e,t);return i!==Gn&&nM(r,ao(),i),pe}function vs(n,e,t,r,i){let o=He(),s=vj(o,n,e,t,r,i);return s!==Gn&&nM(o,ao(),s),vs}function nM(n,e,t){let r=aD(e,n);h4(n[_t],r,t)}function te(n,e,t){qD(e)&&(e=e());let r=He(),i=zf();if(so(r,i,e)){let o=gn(),s=Vy();g1(o,s,r,n,e,r[_t],t,!1)}return te}function re(n,e){let t=qD(n);return t&&n.set(e),t}function ne(n,e){let t=He(),r=gn(),i=Nn();return tM(r,t,t[_t],i,n,e),ne}function Kj(n,e,t){let r=gn();if(r.firstCreatePass){let i=Nr(n);_y(t,r.data,r.blueprint,i,!0),_y(e,r.data,r.blueprint,i,!1)}}function _y(n,e,t,r,i){if(n=fn(n),Array.isArray(n))for(let o=0;o<n.length;o++)_y(n[o],e,t,r,i);else{let o=gn(),s=He(),a=Nn(),c=Oa(n)?n:fn(n.provide),u=ZT(n),d=a.providerIndexes&1048575,f=a.directiveStart,v=a.providerIndexes>>20;if(Oa(n)||!n.multi){let _=new us(u,i,q),b=k_(c,e,i?d:d+v,f);b===-1?(K_(Sf(a,s),o,c),R_(o,n,e.length),e.push(c),a.directiveStart++,a.directiveEnd++,i&&(a.providerIndexes+=1048576),t.push(_),s.push(_)):(t[b]=_,s[b]=_)}else{let _=k_(c,e,d+v,f),b=k_(c,e,d,d+v),N=_>=0&&t[_],R=b>=0&&t[b];if(i&&!R||!i&&!N){K_(Sf(a,s),o,c);let G=Zj(i?Qj:Yj,t.length,i,r,u);!i&&R&&(t[b].providerFactory=G),R_(o,n,e.length,0),e.push(c),a.directiveStart++,a.directiveEnd++,i&&(a.providerIndexes+=1048576),t.push(G),s.push(G)}else{let G=rM(t[i?b:_],u,!i&&r);R_(o,n,_>-1?_:b,G)}!i&&r&&R&&t[b].componentProviders++}}}function R_(n,e,t,r){let i=Oa(e),o=MV(e);if(i||o){let c=(o?fn(e.useClass):e).prototype.ngOnDestroy;if(c){let u=n.destroyHooks||(n.destroyHooks=[]);if(!i&&e.multi){let d=u.indexOf(t);d===-1?u.push(t,[r,c]):u[d+1].push(r,c)}else u.push(t,c)}}}function rM(n,e,t){return t&&n.componentProviders++,n.multi.push(e)-1}function k_(n,e,t,r){for(let i=t;i<r;i++)if(e[i]===n)return i;return-1}function Yj(n,e,t,r,i){return yy(this.multi,[])}function Qj(n,e,t,r,i){let o=this.multi,s;if(this.providerFactory){let a=this.providerFactory.componentProviders,c=Tf(r,r[Me],this.providerFactory.index,i);s=c.slice(0,a),yy(o,s);for(let u=a;u<c.length;u++)s.push(c[u])}else s=[],yy(o,s);return s}function yy(n,e){for(let t=0;t<n.length;t++){let r=n[t];e.push(r())}return e}function Zj(n,e,t,r,i){let o=new us(n,t,q);return o.multi=[],o.index=e,o.componentProviders=0,rM(o,i,r&&!t),o}function Fn(n,e=[]){return t=>{t.providersResolver=(r,i)=>Kj(r,i?i(n):n,e)}}function iM(n,e,t){let r=_D()+n,i=He();return i[r]===Gn?$1(i,r,t?e.call(t):e()):sj(i,r)}function Jj(n,e){let t=n[e];return t===Gn?void 0:t}function Xj(n,e,t,r,i,o,s){let a=e+t;return z1(n,a,i,o)?$1(n,a+2,s?r.call(s,i,o):r(i,o)):Jj(n,a+2)}function Ve(n,e){let t=gn(),r,i=n+dr;t.firstCreatePass?(r=eB(e,t.pipeRegistry),t.data[i]=r,r.onDestroy&&(t.destroyHooks??=[]).push(i,r.onDestroy)):r=t.data[i];let o=r.factory||(r.factory=is(r.type,!0)),s,a=wn(q);try{let c=xf(!1),u=o();return xf(c),UV(t,He(),i,u),u}finally{wn(a)}}function eB(n,e){if(e)for(let t=e.length-1;t>=0;t--){let r=e[t];if(n===r.name)return r}}function je(n,e,t,r){let i=n+dr,o=He(),s=BV(o,i);return tB(o,i)?Xj(o,_D(),e,s.transform,t,r,s):s.transform(t,r)}function tB(n,e){return n[Me].data[e].pure}var fs=class{full;major;minor;patch;constructor(e){this.full=e;let t=e.split(".");this.major=t[0],this.minor=t[1],this.patch=t.slice(2).join(".")}},oM=new fs("19.2.14"),wy=class{ngModuleFactory;componentFactories;constructor(e,t){this.ngModuleFactory=e,this.componentFactories=t}},sM=(()=>{class n{compileModuleSync(t){return new fy(t)}compileModuleAsync(t){return Promise.resolve(this.compileModuleSync(t))}compileModuleAndAllComponentsSync(t){let r=this.compileModuleSync(t),i=GT(t),o=s1(i.declarations).reduce((s,a)=>{let c=ss(a);return c&&s.push(new La(c)),s},[]);return new wy(r,o)}compileModuleAndAllComponentsAsync(t){return Promise.resolve(this.compileModuleAndAllComponentsSync(t))}clearCache(){}clearCacheFor(t){}getModuleId(t){}static \u0275fac=function(r){return new(r||n)};static \u0275prov=H({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var nB=(()=>{class n{zone=j(Pe);changeDetectionScheduler=j(ds);applicationRef=j(Vr);_onMicrotaskEmptySubscription;initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.changeDetectionScheduler.runningTick||this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}static \u0275fac=function(r){return new(r||n)};static \u0275prov=H({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),rB=new J("",{factory:()=>!1});function aM({ngZoneFactory:n,ignoreChangesOutsideZone:e,scheduleInRootZone:t}){return n??=()=>new Pe(le(L({},lM()),{scheduleInRootZone:t})),[{provide:Pe,useFactory:n},{provide:Ul,multi:!0,useFactory:()=>{let r=j(nB,{optional:!0});return()=>r.initialize()}},{provide:Ul,multi:!0,useFactory:()=>{let r=j(iB);return()=>{r.initialize()}}},e===!0?{provide:UD,useValue:!0}:[],{provide:$D,useValue:t??BD}]}function cM(n){let e=n?.ignoreChangesOutsideZone,t=n?.scheduleInRootZone,r=aM({ngZoneFactory:()=>{let i=lM(n);return i.scheduleInRootZone=t,i.shouldCoalesceEventChangeDetection&&qa("NgZone_CoalesceEvent"),new Pe(i)},ignoreChangesOutsideZone:e,scheduleInRootZone:t});return En([{provide:rB,useValue:!0},{provide:$y,useValue:!1},r])}function lM(n){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:n?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:n?.runCoalescing??!1}}var iB=(()=>{class n{subscription=new ht;initialized=!1;zone=j(Pe);pendingTasks=j(ms);initialize(){if(this.initialized)return;this.initialized=!0;let t=null;!this.zone.isStable&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(t=this.pendingTasks.add()),this.zone.runOutsideAngular(()=>{this.subscription.add(this.zone.onStable.subscribe(()=>{Pe.assertNotInAngularZone(),queueMicrotask(()=>{t!==null&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(this.pendingTasks.remove(t),t=null)})}))}),this.subscription.add(this.zone.onUnstable.subscribe(()=>{Pe.assertInAngularZone(),t??=this.pendingTasks.add()}))}ngOnDestroy(){this.subscription.unsubscribe()}static \u0275fac=function(r){return new(r||n)};static \u0275prov=H({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var oB=(()=>{class n{appRef=j(Vr);taskService=j(ms);ngZone=j(Pe);zonelessEnabled=j($y);tracing=j(Wa,{optional:!0});disableScheduling=j(UD,{optional:!0})??!1;zoneIsDefined=typeof Zone<"u"&&!!Zone.root.run;schedulerTickApplyArgs=[{data:{__scheduler_tick__:!0}}];subscriptions=new ht;angularZoneId=this.zoneIsDefined?this.ngZone._inner?.get(Mf):null;scheduleInRootZone=!this.zonelessEnabled&&this.zoneIsDefined&&(j($D,{optional:!0})??!1);cancelScheduledCallback=null;useMicrotaskScheduler=!1;runningTick=!1;pendingRenderTaskId=null;constructor(){this.subscriptions.add(this.appRef.afterTick.subscribe(()=>{this.runningTick||this.cleanup()})),this.subscriptions.add(this.ngZone.onUnstable.subscribe(()=>{this.runningTick||this.cleanup()})),this.disableScheduling||=!this.zonelessEnabled&&(this.ngZone instanceof X_||!this.zoneIsDefined)}notify(t){if(!this.zonelessEnabled&&t===5)return;let r=!1;switch(t){case 0:{this.appRef.dirtyFlags|=2;break}case 3:case 2:case 4:case 5:case 1:{this.appRef.dirtyFlags|=4;break}case 6:{this.appRef.dirtyFlags|=2,r=!0;break}case 12:{this.appRef.dirtyFlags|=16,r=!0;break}case 13:{this.appRef.dirtyFlags|=2,r=!0;break}case 11:{r=!0;break}case 9:case 8:case 7:case 10:default:this.appRef.dirtyFlags|=8}if(this.appRef.tracingSnapshot=this.tracing?.snapshot(this.appRef.tracingSnapshot)??null,!this.shouldScheduleTick(r))return;let i=this.useMicrotaskScheduler?sT:zD;this.pendingRenderTaskId=this.taskService.add(),this.scheduleInRootZone?this.cancelScheduledCallback=Zone.root.run(()=>i(()=>this.tick())):this.cancelScheduledCallback=this.ngZone.runOutsideAngular(()=>i(()=>this.tick()))}shouldScheduleTick(t){return!(this.disableScheduling&&!t||this.appRef.destroyed||this.pendingRenderTaskId!==null||this.runningTick||this.appRef._runningTick||!this.zonelessEnabled&&this.zoneIsDefined&&Zone.current.get(Mf+this.angularZoneId))}tick(){if(this.runningTick||this.appRef.destroyed)return;if(this.appRef.dirtyFlags===0){this.cleanup();return}!this.zonelessEnabled&&this.appRef.dirtyFlags&7&&(this.appRef.dirtyFlags|=1);let t=this.taskService.add();try{this.ngZone.run(()=>{this.runningTick=!0,this.appRef._tick()},void 0,this.schedulerTickApplyArgs)}catch(r){throw this.taskService.remove(t),r}finally{this.cleanup()}this.useMicrotaskScheduler=!0,sT(()=>{this.useMicrotaskScheduler=!1,this.taskService.remove(t)})}ngOnDestroy(){this.subscriptions.unsubscribe(),this.cleanup()}cleanup(){if(this.runningTick=!1,this.cancelScheduledCallback?.(),this.cancelScheduledCallback=null,this.pendingRenderTaskId!==null){let t=this.pendingRenderTaskId;this.pendingRenderTaskId=null,this.taskService.remove(t)}}static \u0275fac=function(r){return new(r||n)};static \u0275prov=H({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function sB(){return typeof $localize<"u"&&$localize.locale||kf}var tu=new J("",{providedIn:"root",factory:()=>j(tu,be.Optional|be.SkipSelf)||sB()});var Cy=new J(""),aB=new J("");function kl(n){return!n.moduleRef}function cB(n){let e=kl(n)?n.r3Injector:n.moduleRef.injector,t=e.get(Pe);return t.run(()=>{kl(n)?n.r3Injector.resolveInjectorInitializers():n.moduleRef.resolveInjectorInitializers();let r=e.get(Fr,null),i;if(t.runOutsideAngular(()=>{i=t.onError.subscribe({next:o=>{r.handleError(o)}})}),kl(n)){let o=()=>e.destroy(),s=n.platformInjector.get(Cy);s.add(o),e.onDestroy(()=>{i.unsubscribe(),s.delete(o)})}else{let o=()=>n.moduleRef.destroy(),s=n.platformInjector.get(Cy);s.add(o),n.moduleRef.onDestroy(()=>{lf(n.allPlatformModules,n.moduleRef),i.unsubscribe(),s.delete(o)})}return uB(r,t,()=>{let o=e.get(K1);return o.runInitializers(),o.donePromise.then(()=>{let s=e.get(tu,kf);if(Hj(s||kf),!e.get(aB,!0))return kl(n)?e.get(Vr):(n.allPlatformModules.push(n.moduleRef),n.moduleRef);if(kl(n)){let c=e.get(Vr);return n.rootComponent!==void 0&&c.bootstrap(n.rootComponent),c}else return lB(n.moduleRef,n.allPlatformModules),n.moduleRef})})})}function lB(n,e){let t=n.injector.get(Vr);if(n._bootstrapComponents.length>0)n._bootstrapComponents.forEach(r=>t.bootstrap(r));else if(n.instance.ngDoBootstrap)n.instance.ngDoBootstrap(t);else throw new Z(-403,!1);e.push(n)}function uB(n,e,t){try{let r=t();return gs(r)?r.catch(i=>{throw e.runOutsideAngular(()=>n.handleError(i)),i}):r}catch(r){throw e.runOutsideAngular(()=>n.handleError(r)),r}}var uf=null;function dB(n=[],e){return rt.create({name:e,providers:[{provide:Bf,useValue:"platform"},{provide:Cy,useValue:new Set([()=>uf=null])},...n]})}function hB(n=[]){if(uf)return uf;let e=dB(n);return uf=e,hj(),fB(e),e}function fB(n){let e=n.get(qy,null);tn(n,()=>{e?.forEach(t=>t())})}function nu(){return!1}var _s=(()=>{class n{static __NG_ELEMENT_ID__=pB}return n})();function pB(n){return mB(Nn(),He(),(n&16)===16)}function mB(n,e,t){if(Ua(n)&&!t){let r=kr(n.index,e);return new Wl(r,r)}else if(n.type&175){let r=e[Or];return new Wl(r,e)}return null}var by=class{constructor(){}supports(e){return U1(e)}create(e){return new Iy(e)}},gB=(n,e)=>e,Iy=class{length=0;collection;_linkedRecords=null;_unlinkedRecords=null;_previousItHead=null;_itHead=null;_itTail=null;_additionsHead=null;_additionsTail=null;_movesHead=null;_movesTail=null;_removalsHead=null;_removalsTail=null;_identityChangesHead=null;_identityChangesTail=null;_trackByFn;constructor(e){this._trackByFn=e||gB}forEachItem(e){let t;for(t=this._itHead;t!==null;t=t._next)e(t)}forEachOperation(e){let t=this._itHead,r=this._removalsHead,i=0,o=null;for(;t||r;){let s=!r||t&&t.currentIndex<MT(r,i,o)?t:r,a=MT(s,i,o),c=s.currentIndex;if(s===r)i--,r=r._nextRemoved;else if(t=t._next,s.previousIndex==null)i++;else{o||(o=[]);let u=a-i,d=c-i;if(u!=d){for(let v=0;v<u;v++){let _=v<o.length?o[v]:o[v]=0,b=_+v;d<=b&&b<u&&(o[v]=_+1)}let f=s.previousIndex;o[f]=d-u}}a!==c&&e(s,a,c)}}forEachPreviousItem(e){let t;for(t=this._previousItHead;t!==null;t=t._nextPrevious)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;t!==null;t=t._nextAdded)e(t)}forEachMovedItem(e){let t;for(t=this._movesHead;t!==null;t=t._nextMoved)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;t!==null;t=t._nextRemoved)e(t)}forEachIdentityChange(e){let t;for(t=this._identityChangesHead;t!==null;t=t._nextIdentityChange)e(t)}diff(e){if(e==null&&(e=[]),!U1(e))throw new Z(900,!1);return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let t=this._itHead,r=!1,i,o,s;if(Array.isArray(e)){this.length=e.length;for(let a=0;a<this.length;a++)o=e[a],s=this._trackByFn(a,o),t===null||!Object.is(t.trackById,s)?(t=this._mismatch(t,o,s,a),r=!0):(r&&(t=this._verifyReinsertion(t,o,s,a)),Object.is(t.item,o)||this._addIdentityChange(t,o)),t=t._next}else i=0,ij(e,a=>{s=this._trackByFn(i,a),t===null||!Object.is(t.trackById,s)?(t=this._mismatch(t,a,s,i),r=!0):(r&&(t=this._verifyReinsertion(t,a,s,i)),Object.is(t.item,a)||this._addIdentityChange(t,a)),t=t._next,i++}),this.length=i;return this._truncate(t),this.collection=e,this.isDirty}get isDirty(){return this._additionsHead!==null||this._movesHead!==null||this._removalsHead!==null||this._identityChangesHead!==null}_reset(){if(this.isDirty){let e;for(e=this._previousItHead=this._itHead;e!==null;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;e!==null;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;e!==null;e=e._nextMoved)e.previousIndex=e.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(e,t,r,i){let o;return e===null?o=this._itTail:(o=e._prev,this._remove(e)),e=this._unlinkedRecords===null?null:this._unlinkedRecords.get(r,null),e!==null?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._reinsertAfter(e,o,i)):(e=this._linkedRecords===null?null:this._linkedRecords.get(r,i),e!==null?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._moveAfter(e,o,i)):e=this._addAfter(new Ey(t,r),o,i)),e}_verifyReinsertion(e,t,r,i){let o=this._unlinkedRecords===null?null:this._unlinkedRecords.get(r,null);return o!==null?e=this._reinsertAfter(o,e._prev,i):e.currentIndex!=i&&(e.currentIndex=i,this._addToMoves(e,i)),e}_truncate(e){for(;e!==null;){let t=e._next;this._addToRemovals(this._unlink(e)),e=t}this._unlinkedRecords!==null&&this._unlinkedRecords.clear(),this._additionsTail!==null&&(this._additionsTail._nextAdded=null),this._movesTail!==null&&(this._movesTail._nextMoved=null),this._itTail!==null&&(this._itTail._next=null),this._removalsTail!==null&&(this._removalsTail._nextRemoved=null),this._identityChangesTail!==null&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(e,t,r){this._unlinkedRecords!==null&&this._unlinkedRecords.remove(e);let i=e._prevRemoved,o=e._nextRemoved;return i===null?this._removalsHead=o:i._nextRemoved=o,o===null?this._removalsTail=i:o._prevRemoved=i,this._insertAfter(e,t,r),this._addToMoves(e,r),e}_moveAfter(e,t,r){return this._unlink(e),this._insertAfter(e,t,r),this._addToMoves(e,r),e}_addAfter(e,t,r){return this._insertAfter(e,t,r),this._additionsTail===null?this._additionsTail=this._additionsHead=e:this._additionsTail=this._additionsTail._nextAdded=e,e}_insertAfter(e,t,r){let i=t===null?this._itHead:t._next;return e._next=i,e._prev=t,i===null?this._itTail=e:i._prev=e,t===null?this._itHead=e:t._next=e,this._linkedRecords===null&&(this._linkedRecords=new Ff),this._linkedRecords.put(e),e.currentIndex=r,e}_remove(e){return this._addToRemovals(this._unlink(e))}_unlink(e){this._linkedRecords!==null&&this._linkedRecords.remove(e);let t=e._prev,r=e._next;return t===null?this._itHead=r:t._next=r,r===null?this._itTail=t:r._prev=t,e}_addToMoves(e,t){return e.previousIndex===t||(this._movesTail===null?this._movesTail=this._movesHead=e:this._movesTail=this._movesTail._nextMoved=e),e}_addToRemovals(e){return this._unlinkedRecords===null&&(this._unlinkedRecords=new Ff),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,this._removalsTail===null?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}_addIdentityChange(e,t){return e.item=t,this._identityChangesTail===null?this._identityChangesTail=this._identityChangesHead=e:this._identityChangesTail=this._identityChangesTail._nextIdentityChange=e,e}},Ey=class{item;trackById;currentIndex=null;previousIndex=null;_nextPrevious=null;_prev=null;_next=null;_prevDup=null;_nextDup=null;_prevRemoved=null;_nextRemoved=null;_nextAdded=null;_nextMoved=null;_nextIdentityChange=null;constructor(e,t){this.item=e,this.trackById=t}},xy=class{_head=null;_tail=null;add(e){this._head===null?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}get(e,t){let r;for(r=this._head;r!==null;r=r._nextDup)if((t===null||t<=r.currentIndex)&&Object.is(r.trackById,e))return r;return null}remove(e){let t=e._prevDup,r=e._nextDup;return t===null?this._head=r:t._nextDup=r,r===null?this._tail=t:r._prevDup=t,this._head===null}},Ff=class{map=new Map;put(e){let t=e.trackById,r=this.map.get(t);r||(r=new xy,this.map.set(t,r)),r.add(e)}get(e,t){let r=e,i=this.map.get(r);return i?i.get(e,t):null}remove(e){let t=e.trackById;return this.map.get(t).remove(e)&&this.map.delete(t),e}get isEmpty(){return this.map.size===0}clear(){this.map.clear()}};function MT(n,e,t){let r=n.previousIndex;if(r===null)return r;let i=0;return t&&r<t.length&&(i=t[r]),r+e+i}function PT(){return new h0([new by])}var h0=(()=>{class n{factories;static \u0275prov=H({token:n,providedIn:"root",factory:PT});constructor(t){this.factories=t}static create(t,r){if(r!=null){let i=r.factories.slice();t=t.concat(i)}return new n(t)}static extend(t){return{provide:n,useFactory:r=>n.create(t,r||PT()),deps:[[n,new CV,new Mt]]}}find(t){let r=this.factories.find(i=>i.supports(t));if(r!=null)return r;throw new Z(901,!1)}}return n})();function uM(n){We(8);try{let{rootComponent:e,appProviders:t,platformProviders:r}=n,i=hB(r),o=[aM({}),{provide:ds,useExisting:oB},...t||[]],s=new Nf({providers:o,parent:i,debugName:"",runEnvironmentInitializers:!1});return cB({r3Injector:s.injector,platformInjector:i,rootComponent:e})}catch(e){return Promise.reject(e)}finally{We(9)}}function ru(n){return typeof n=="boolean"?n:n!=null&&n!=="false"}function zr(n){return i_(n)}function Ka(n,e){return e_(n,e?.equal)}var AT=class{[Hn];constructor(e){this[Hn]=e}destroy(){this[Hn].destroy()}};function dM(n){let e=ss(n);if(!e)return null;let t=new La(e);return{get selector(){return t.selector},get type(){return t.componentType},get inputs(){return t.inputs},get outputs(){return t.outputs},get ngContentSelectors(){return t.ngContentSelectors},get isStandalone(){return e.standalone},get isSignal(){return e.signals}}}var At=new J("");var pM=null;function Kn(){return pM}function f0(n){pM??=n}var iu=class{},ou=(()=>{class n{historyGo(t){throw new Error("")}static \u0275fac=function(r){return new(r||n)};static \u0275prov=H({token:n,factory:()=>j(mM),providedIn:"platform"})}return n})(),p0=new J(""),mM=(()=>{class n extends ou{_location;_history;_doc=j(At);constructor(){super(),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return Kn().getBaseHref(this._doc)}onPopState(t){let r=Kn().getGlobalEventTarget(this._doc,"window");return r.addEventListener("popstate",t,!1),()=>r.removeEventListener("popstate",t)}onHashChange(t){let r=Kn().getGlobalEventTarget(this._doc,"window");return r.addEventListener("hashchange",t,!1),()=>r.removeEventListener("hashchange",t)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(t){this._location.pathname=t}pushState(t,r,i){this._history.pushState(t,r,i)}replaceState(t,r,i){this._history.replaceState(t,r,i)}forward(){this._history.forward()}back(){this._history.back()}historyGo(t=0){this._history.go(t)}getState(){return this._history.state}static \u0275fac=function(r){return new(r||n)};static \u0275prov=H({token:n,factory:()=>new n,providedIn:"platform"})}return n})();function Zf(n,e){return n?e?n.endsWith("/")?e.startsWith("/")?n+e.slice(1):n+e:e.startsWith("/")?n+e:`${n}/${e}`:n:e}function hM(n){let e=n.search(/#|\?|$/);return n[e-1]==="/"?n.slice(0,e-1)+n.slice(e):n}function fr(n){return n&&n[0]!=="?"?`?${n}`:n}var Di=(()=>{class n{historyGo(t){throw new Error("")}static \u0275fac=function(r){return new(r||n)};static \u0275prov=H({token:n,factory:()=>j(Xf),providedIn:"root"})}return n})(),Jf=new J(""),Xf=(()=>{class n extends Di{_platformLocation;_baseHref;_removeListenerFns=[];constructor(t,r){super(),this._platformLocation=t,this._baseHref=r??this._platformLocation.getBaseHrefFromDOM()??j(At).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}prepareExternalUrl(t){return Zf(this._baseHref,t)}path(t=!1){let r=this._platformLocation.pathname+fr(this._platformLocation.search),i=this._platformLocation.hash;return i&&t?`${r}${i}`:r}pushState(t,r,i,o){let s=this.prepareExternalUrl(i+fr(o));this._platformLocation.pushState(t,r,s)}replaceState(t,r,i,o){let s=this.prepareExternalUrl(i+fr(o));this._platformLocation.replaceState(t,r,s)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}static \u0275fac=function(r){return new(r||n)(ee(ou),ee(Jf,8))};static \u0275prov=H({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),uo=(()=>{class n{_subject=new ct;_basePath;_locationStrategy;_urlChangeListeners=[];_urlChangeSubscription=null;constructor(t){this._locationStrategy=t;let r=this._locationStrategy.getBaseHref();this._basePath=yB(hM(fM(r))),this._locationStrategy.onPopState(i=>{this._subject.next({url:this.path(!0),pop:!0,state:i.state,type:i.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(t=!1){return this.normalize(this._locationStrategy.path(t))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(t,r=""){return this.path()==this.normalize(t+fr(r))}normalize(t){return n.stripTrailingSlash(_B(this._basePath,fM(t)))}prepareExternalUrl(t){return t&&t[0]!=="/"&&(t="/"+t),this._locationStrategy.prepareExternalUrl(t)}go(t,r="",i=null){this._locationStrategy.pushState(i,"",t,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+fr(r)),i)}replaceState(t,r="",i=null){this._locationStrategy.replaceState(i,"",t,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+fr(r)),i)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(t=0){this._locationStrategy.historyGo?.(t)}onUrlChange(t){return this._urlChangeListeners.push(t),this._urlChangeSubscription??=this.subscribe(r=>{this._notifyUrlChangeListeners(r.url,r.state)}),()=>{let r=this._urlChangeListeners.indexOf(t);this._urlChangeListeners.splice(r,1),this._urlChangeListeners.length===0&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(t="",r){this._urlChangeListeners.forEach(i=>i(t,r))}subscribe(t,r,i){return this._subject.subscribe({next:t,error:r??void 0,complete:i??void 0})}static normalizeQueryParams=fr;static joinWithSlash=Zf;static stripTrailingSlash=hM;static \u0275fac=function(r){return new(r||n)(ee(Di))};static \u0275prov=H({token:n,factory:()=>vB(),providedIn:"root"})}return n})();function vB(){return new uo(ee(Di))}function _B(n,e){if(!n||!e.startsWith(n))return e;let t=e.substring(n.length);return t===""||["/",";","?","#"].includes(t[0])?t:e}function fM(n){return n.replace(/\/index.html$/,"")}function yB(n){if(new RegExp("^(https?:)?//").test(n)){let[,t]=n.split(/\/\/[^\/]+/);return t}return n}var w0=(()=>{class n extends Di{_platformLocation;_baseHref="";_removeListenerFns=[];constructor(t,r){super(),this._platformLocation=t,r!=null&&(this._baseHref=r)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}path(t=!1){let r=this._platformLocation.hash??"#";return r.length>0?r.substring(1):r}prepareExternalUrl(t){let r=Zf(this._baseHref,t);return r.length>0?"#"+r:r}pushState(t,r,i,o){let s=this.prepareExternalUrl(i+fr(o))||this._platformLocation.pathname;this._platformLocation.pushState(t,r,s)}replaceState(t,r,i,o){let s=this.prepareExternalUrl(i+fr(o))||this._platformLocation.pathname;this._platformLocation.replaceState(t,r,s)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}static \u0275fac=function(r){return new(r||n)(ee(ou),ee(Jf,8))};static \u0275prov=H({token:n,factory:n.\u0275fac})}return n})();var C0=function(n){return n[n.Decimal=0]="Decimal",n[n.Percent=1]="Percent",n[n.Currency=2]="Currency",n[n.Scientific=3]="Scientific",n}(C0||{});var nn=function(n){return n[n.Format=0]="Format",n[n.Standalone=1]="Standalone",n}(nn||{}),qe=function(n){return n[n.Narrow=0]="Narrow",n[n.Abbreviated=1]="Abbreviated",n[n.Wide=2]="Wide",n[n.Short=3]="Short",n}(qe||{}),xn=function(n){return n[n.Short=0]="Short",n[n.Medium=1]="Medium",n[n.Long=2]="Long",n[n.Full=3]="Full",n}(xn||{}),Sn={Decimal:0,Group:1,List:2,PercentSign:3,PlusSign:4,MinusSign:5,Exponential:6,SuperscriptingExponent:7,PerMille:8,Infinity:9,NaN:10,TimeSeparator:11,CurrencyDecimal:12,CurrencyGroup:13};function wM(n){return kn(n)[ft.LocaleId]}function CM(n,e,t){let r=kn(n),i=[r[ft.DayPeriodsFormat],r[ft.DayPeriodsStandalone]],o=Yn(i,e);return Yn(o,t)}function bM(n,e,t){let r=kn(n),i=[r[ft.DaysFormat],r[ft.DaysStandalone]],o=Yn(i,e);return Yn(o,t)}function IM(n,e,t){let r=kn(n),i=[r[ft.MonthsFormat],r[ft.MonthsStandalone]],o=Yn(i,e);return Yn(o,t)}function EM(n,e){let r=kn(n)[ft.Eras];return Yn(r,e)}function su(n,e){let t=kn(n);return Yn(t[ft.DateFormat],e)}function au(n,e){let t=kn(n);return Yn(t[ft.TimeFormat],e)}function cu(n,e){let r=kn(n)[ft.DateTimeFormat];return Yn(r,e)}function Hr(n,e){let t=kn(n),r=t[ft.NumberSymbols][e];if(typeof r>"u"){if(e===Sn.CurrencyDecimal)return t[ft.NumberSymbols][Sn.Decimal];if(e===Sn.CurrencyGroup)return t[ft.NumberSymbols][Sn.Group]}return r}function xM(n,e){return kn(n)[ft.NumberFormats][e]}function SM(n){if(!n[ft.ExtraData])throw new Error(`Missing extra locale data for the locale "${n[ft.LocaleId]}". Use "registerLocaleData" to load new data. See the "I18n guide" on angular.io to know more.`)}function TM(n){let e=kn(n);return SM(e),(e[ft.ExtraData][2]||[]).map(r=>typeof r=="string"?m0(r):[m0(r[0]),m0(r[1])])}function DM(n,e,t){let r=kn(n);SM(r);let i=[r[ft.ExtraData][0],r[ft.ExtraData][1]],o=Yn(i,e)||[];return Yn(o,t)||[]}function Yn(n,e){for(let t=e;t>-1;t--)if(typeof n[t]<"u")return n[t];throw new Error("Locale data API: locale data undefined")}function m0(n){let[e,t]=n.split(":");return{hours:+e,minutes:+t}}var CB=/^(\d{4,})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/,ep={},bB=/((?:[^BEGHLMOSWYZabcdhmswyz']+)|(?:'(?:[^']|'')*')|(?:G{1,5}|y{1,4}|Y{1,4}|M{1,5}|L{1,5}|w{1,2}|W{1}|d{1,2}|E{1,6}|c{1,6}|a{1,5}|b{1,5}|B{1,5}|h{1,2}|H{1,2}|m{1,2}|s{1,2}|S{1,3}|z{1,4}|Z{1,5}|O{1,4}))([\s\S]*)/;function MM(n,e,t,r){let i=AB(n);e=Mi(t,e)||e;let s=[],a;for(;e;)if(a=bB.exec(e),a){s=s.concat(a.slice(1));let d=s.pop();if(!d)break;e=d}else{s.push(e);break}let c=i.getTimezoneOffset();r&&(c=AM(r,c),i=PB(i,r));let u="";return s.forEach(d=>{let f=DB(d);u+=f?f(i,t,c):d==="''"?"'":d.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),u}function op(n,e,t){let r=new Date(0);return r.setFullYear(n,e,t),r.setHours(0,0,0),r}function Mi(n,e){let t=wM(n);if(ep[t]??={},ep[t][e])return ep[t][e];let r="";switch(e){case"shortDate":r=su(n,xn.Short);break;case"mediumDate":r=su(n,xn.Medium);break;case"longDate":r=su(n,xn.Long);break;case"fullDate":r=su(n,xn.Full);break;case"shortTime":r=au(n,xn.Short);break;case"mediumTime":r=au(n,xn.Medium);break;case"longTime":r=au(n,xn.Long);break;case"fullTime":r=au(n,xn.Full);break;case"short":let i=Mi(n,"shortTime"),o=Mi(n,"shortDate");r=tp(cu(n,xn.Short),[i,o]);break;case"medium":let s=Mi(n,"mediumTime"),a=Mi(n,"mediumDate");r=tp(cu(n,xn.Medium),[s,a]);break;case"long":let c=Mi(n,"longTime"),u=Mi(n,"longDate");r=tp(cu(n,xn.Long),[c,u]);break;case"full":let d=Mi(n,"fullTime"),f=Mi(n,"fullDate");r=tp(cu(n,xn.Full),[d,f]);break}return r&&(ep[t][e]=r),r}function tp(n,e){return e&&(n=n.replace(/\{([^}]+)}/g,function(t,r){return e!=null&&r in e?e[r]:t})),n}function pr(n,e,t="-",r,i){let o="";(n<0||i&&n<=0)&&(i?n=-n+1:(n=-n,o=t));let s=String(n);for(;s.length<e;)s="0"+s;return r&&(s=s.slice(s.length-e)),o+s}function IB(n,e){return pr(n,3).substring(0,e)}function yt(n,e,t=0,r=!1,i=!1){return function(o,s){let a=EB(n,o);if((t>0||a>-t)&&(a+=t),n===3)a===0&&t===-12&&(a=12);else if(n===6)return IB(a,e);let c=Hr(s,Sn.MinusSign);return pr(a,e,c,r,i)}}function EB(n,e){switch(n){case 0:return e.getFullYear();case 1:return e.getMonth();case 2:return e.getDate();case 3:return e.getHours();case 4:return e.getMinutes();case 5:return e.getSeconds();case 6:return e.getMilliseconds();case 7:return e.getDay();default:throw new Error(`Unknown DateType value "${n}".`)}}function et(n,e,t=nn.Format,r=!1){return function(i,o){return xB(i,o,n,e,t,r)}}function xB(n,e,t,r,i,o){switch(t){case 2:return IM(e,i,r)[n.getMonth()];case 1:return bM(e,i,r)[n.getDay()];case 0:let s=n.getHours(),a=n.getMinutes();if(o){let u=TM(e),d=DM(e,i,r),f=u.findIndex(v=>{if(Array.isArray(v)){let[_,b]=v,N=s>=_.hours&&a>=_.minutes,R=s<b.hours||s===b.hours&&a<b.minutes;if(_.hours<b.hours){if(N&&R)return!0}else if(N||R)return!0}else if(v.hours===s&&v.minutes===a)return!0;return!1});if(f!==-1)return d[f]}return CM(e,i,r)[s<12?0:1];case 3:return EM(e,r)[n.getFullYear()<=0?0:1];default:let c=t;throw new Error(`unexpected translation type ${c}`)}}function np(n){return function(e,t,r){let i=-1*r,o=Hr(t,Sn.MinusSign),s=i>0?Math.floor(i/60):Math.ceil(i/60);switch(n){case 0:return(i>=0?"+":"")+pr(s,2,o)+pr(Math.abs(i%60),2,o);case 1:return"GMT"+(i>=0?"+":"")+pr(s,1,o);case 2:return"GMT"+(i>=0?"+":"")+pr(s,2,o)+":"+pr(Math.abs(i%60),2,o);case 3:return r===0?"Z":(i>=0?"+":"")+pr(s,2,o)+":"+pr(Math.abs(i%60),2,o);default:throw new Error(`Unknown zone width "${n}"`)}}}var SB=0,ip=4;function TB(n){let e=op(n,SB,1).getDay();return op(n,0,1+(e<=ip?ip:ip+7)-e)}function PM(n){let e=n.getDay(),t=e===0?-3:ip-e;return op(n.getFullYear(),n.getMonth(),n.getDate()+t)}function g0(n,e=!1){return function(t,r){let i;if(e){let o=new Date(t.getFullYear(),t.getMonth(),1).getDay()-1,s=t.getDate();i=1+Math.floor((s+o)/7)}else{let o=PM(t),s=TB(o.getFullYear()),a=o.getTime()-s.getTime();i=1+Math.round(a/6048e5)}return pr(i,n,Hr(r,Sn.MinusSign))}}function rp(n,e=!1){return function(t,r){let o=PM(t).getFullYear();return pr(o,n,Hr(r,Sn.MinusSign),e)}}var v0={};function DB(n){if(v0[n])return v0[n];let e;switch(n){case"G":case"GG":case"GGG":e=et(3,qe.Abbreviated);break;case"GGGG":e=et(3,qe.Wide);break;case"GGGGG":e=et(3,qe.Narrow);break;case"y":e=yt(0,1,0,!1,!0);break;case"yy":e=yt(0,2,0,!0,!0);break;case"yyy":e=yt(0,3,0,!1,!0);break;case"yyyy":e=yt(0,4,0,!1,!0);break;case"Y":e=rp(1);break;case"YY":e=rp(2,!0);break;case"YYY":e=rp(3);break;case"YYYY":e=rp(4);break;case"M":case"L":e=yt(1,1,1);break;case"MM":case"LL":e=yt(1,2,1);break;case"MMM":e=et(2,qe.Abbreviated);break;case"MMMM":e=et(2,qe.Wide);break;case"MMMMM":e=et(2,qe.Narrow);break;case"LLL":e=et(2,qe.Abbreviated,nn.Standalone);break;case"LLLL":e=et(2,qe.Wide,nn.Standalone);break;case"LLLLL":e=et(2,qe.Narrow,nn.Standalone);break;case"w":e=g0(1);break;case"ww":e=g0(2);break;case"W":e=g0(1,!0);break;case"d":e=yt(2,1);break;case"dd":e=yt(2,2);break;case"c":case"cc":e=yt(7,1);break;case"ccc":e=et(1,qe.Abbreviated,nn.Standalone);break;case"cccc":e=et(1,qe.Wide,nn.Standalone);break;case"ccccc":e=et(1,qe.Narrow,nn.Standalone);break;case"cccccc":e=et(1,qe.Short,nn.Standalone);break;case"E":case"EE":case"EEE":e=et(1,qe.Abbreviated);break;case"EEEE":e=et(1,qe.Wide);break;case"EEEEE":e=et(1,qe.Narrow);break;case"EEEEEE":e=et(1,qe.Short);break;case"a":case"aa":case"aaa":e=et(0,qe.Abbreviated);break;case"aaaa":e=et(0,qe.Wide);break;case"aaaaa":e=et(0,qe.Narrow);break;case"b":case"bb":case"bbb":e=et(0,qe.Abbreviated,nn.Standalone,!0);break;case"bbbb":e=et(0,qe.Wide,nn.Standalone,!0);break;case"bbbbb":e=et(0,qe.Narrow,nn.Standalone,!0);break;case"B":case"BB":case"BBB":e=et(0,qe.Abbreviated,nn.Format,!0);break;case"BBBB":e=et(0,qe.Wide,nn.Format,!0);break;case"BBBBB":e=et(0,qe.Narrow,nn.Format,!0);break;case"h":e=yt(3,1,-12);break;case"hh":e=yt(3,2,-12);break;case"H":e=yt(3,1);break;case"HH":e=yt(3,2);break;case"m":e=yt(4,1);break;case"mm":e=yt(4,2);break;case"s":e=yt(5,1);break;case"ss":e=yt(5,2);break;case"S":e=yt(6,1);break;case"SS":e=yt(6,2);break;case"SSS":e=yt(6,3);break;case"Z":case"ZZ":case"ZZZ":e=np(0);break;case"ZZZZZ":e=np(3);break;case"O":case"OO":case"OOO":case"z":case"zz":case"zzz":e=np(1);break;case"OOOO":case"ZZZZ":case"zzzz":e=np(2);break;default:return null}return v0[n]=e,e}function AM(n,e){n=n.replace(/:/g,"");let t=Date.parse("Jan 01, 1970 00:00:00 "+n)/6e4;return isNaN(t)?e:t}function MB(n,e){return n=new Date(n.getTime()),n.setMinutes(n.getMinutes()+e),n}function PB(n,e,t){let i=n.getTimezoneOffset(),o=AM(e,i);return MB(n,-1*(o-i))}function AB(n){if(gM(n))return n;if(typeof n=="number"&&!isNaN(n))return new Date(n);if(typeof n=="string"){if(n=n.trim(),/^(\d{4}(-\d{1,2}(-\d{1,2})?)?)$/.test(n)){let[i,o=1,s=1]=n.split("-").map(a=>+a);return op(i,o-1,s)}let t=parseFloat(n);if(!isNaN(n-t))return new Date(t);let r;if(r=n.match(CB))return OB(r)}let e=new Date(n);if(!gM(e))throw new Error(`Unable to convert "${n}" into a date`);return e}function OB(n){let e=new Date(0),t=0,r=0,i=n[8]?e.setUTCFullYear:e.setFullYear,o=n[8]?e.setUTCHours:e.setHours;n[9]&&(t=Number(n[9]+n[10]),r=Number(n[9]+n[11])),i.call(e,Number(n[1]),Number(n[2])-1,Number(n[3]));let s=Number(n[4]||0)-t,a=Number(n[5]||0)-r,c=Number(n[6]||0),u=Math.floor(parseFloat("0."+(n[7]||0))*1e3);return o.call(e,s,a,c,u),e}function gM(n){return n instanceof Date&&!isNaN(n.valueOf())}var NB=/^(\d+)?\.((\d+)(-(\d+))?)?$/,vM=22,sp=".",lu="0",RB=";",kB=",",_0="#";function FB(n,e,t,r,i,o,s=!1){let a="",c=!1;if(!isFinite(n))a=Hr(t,Sn.Infinity);else{let u=jB(n);s&&(u=VB(u));let d=e.minInt,f=e.minFrac,v=e.maxFrac;if(o){let oe=o.match(NB);if(oe===null)throw new Error(`${o} is not a valid digit info`);let ce=oe[1],Fe=oe[3],Dt=oe[5];ce!=null&&(d=y0(ce)),Fe!=null&&(f=y0(Fe)),Dt!=null?v=y0(Dt):Fe!=null&&f>v&&(v=f)}BB(u,f,v);let _=u.digits,b=u.integerLen,N=u.exponent,R=[];for(c=_.every(oe=>!oe);b<d;b++)_.unshift(0);for(;b<0;b++)_.unshift(0);b>0?R=_.splice(b,_.length):(R=_,_=[0]);let G=[];for(_.length>=e.lgSize&&G.unshift(_.splice(-e.lgSize,_.length).join(""));_.length>e.gSize;)G.unshift(_.splice(-e.gSize,_.length).join(""));_.length&&G.unshift(_.join("")),a=G.join(Hr(t,r)),R.length&&(a+=Hr(t,i)+R.join("")),N&&(a+=Hr(t,Sn.Exponential)+"+"+N)}return n<0&&!c?a=e.negPre+a+e.negSuf:a=e.posPre+a+e.posSuf,a}function OM(n,e,t){let r=xM(e,C0.Decimal),i=LB(r,Hr(e,Sn.MinusSign));return FB(n,i,e,Sn.Group,Sn.Decimal,t)}function LB(n,e="-"){let t={minInt:1,minFrac:0,maxFrac:0,posPre:"",posSuf:"",negPre:"",negSuf:"",gSize:0,lgSize:0},r=n.split(RB),i=r[0],o=r[1],s=i.indexOf(sp)!==-1?i.split(sp):[i.substring(0,i.lastIndexOf(lu)+1),i.substring(i.lastIndexOf(lu)+1)],a=s[0],c=s[1]||"";t.posPre=a.substring(0,a.indexOf(_0));for(let d=0;d<c.length;d++){let f=c.charAt(d);f===lu?t.minFrac=t.maxFrac=d+1:f===_0?t.maxFrac=d+1:t.posSuf+=f}let u=a.split(kB);if(t.gSize=u[1]?u[1].length:0,t.lgSize=u[2]||u[1]?(u[2]||u[1]).length:0,o){let d=i.length-t.posPre.length-t.posSuf.length,f=o.indexOf(_0);t.negPre=o.substring(0,f).replace(/'/g,""),t.negSuf=o.slice(f+d).replace(/'/g,"")}else t.negPre=e+t.posPre,t.negSuf=t.posSuf;return t}function VB(n){if(n.digits[0]===0)return n;let e=n.digits.length-n.integerLen;return n.exponent?n.exponent+=2:(e===0?n.digits.push(0,0):e===1&&n.digits.push(0),n.integerLen+=2),n}function jB(n){let e=Math.abs(n)+"",t=0,r,i,o,s,a;for((i=e.indexOf(sp))>-1&&(e=e.replace(sp,"")),(o=e.search(/e/i))>0?(i<0&&(i=o),i+=+e.slice(o+1),e=e.substring(0,o)):i<0&&(i=e.length),o=0;e.charAt(o)===lu;o++);if(o===(a=e.length))r=[0],i=1;else{for(a--;e.charAt(a)===lu;)a--;for(i-=o,r=[],s=0;o<=a;o++,s++)r[s]=Number(e.charAt(o))}return i>vM&&(r=r.splice(0,vM-1),t=i-1,i=1),{digits:r,exponent:t,integerLen:i}}function BB(n,e,t){if(e>t)throw new Error(`The minimum number of digits after fraction (${e}) is higher than the maximum (${t}).`);let r=n.digits,i=r.length-n.integerLen,o=Math.min(Math.max(e,i),t),s=o+n.integerLen,a=r[s];if(s>0){r.splice(Math.max(n.integerLen,s));for(let f=s;f<r.length;f++)r[f]=0}else{i=Math.max(0,i),n.integerLen=1,r.length=Math.max(1,s=o+1),r[0]=0;for(let f=1;f<s;f++)r[f]=0}if(a>=5)if(s-1<0){for(let f=0;f>s;f--)r.unshift(0),n.integerLen++;r.unshift(1),n.integerLen++}else r[s-1]++;for(;i<Math.max(0,o);i++)r.push(0);let c=o!==0,u=e+n.integerLen,d=r.reduceRight(function(f,v,_,b){return v=v+f,b[_]=v<10?v:v-10,c&&(b[_]===0&&_>=u?b.pop():c=!1),v>=10?1:0},0);d&&(r.unshift(d),n.integerLen++)}function y0(n){let e=parseInt(n);if(isNaN(e))throw new Error("Invalid integer literal when parsing "+n);return e}var ap=class{$implicit;ngForOf;index;count;constructor(e,t,r,i){this.$implicit=e,this.ngForOf=t,this.index=r,this.count=i}get first(){return this.index===0}get last(){return this.index===this.count-1}get even(){return this.index%2===0}get odd(){return!this.even}},Tn=(()=>{class n{_viewContainer;_template;_differs;set ngForOf(t){this._ngForOf=t,this._ngForOfDirty=!0}set ngForTrackBy(t){this._trackByFn=t}get ngForTrackBy(){return this._trackByFn}_ngForOf=null;_ngForOfDirty=!0;_differ=null;_trackByFn;constructor(t,r,i){this._viewContainer=t,this._template=r,this._differs=i}set ngForTemplate(t){t&&(this._template=t)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;let t=this._ngForOf;!this._differ&&t&&(this._differ=this._differs.find(t).create(this.ngForTrackBy))}if(this._differ){let t=this._differ.diff(this._ngForOf);t&&this._applyChanges(t)}}_applyChanges(t){let r=this._viewContainer;t.forEachOperation((i,o,s)=>{if(i.previousIndex==null)r.createEmbeddedView(this._template,new ap(i.item,this._ngForOf,-1,-1),s===null?void 0:s);else if(s==null)r.remove(o===null?void 0:o);else if(o!==null){let a=r.get(o);r.move(a,s),_M(a,i)}});for(let i=0,o=r.length;i<o;i++){let a=r.get(i).context;a.index=i,a.count=o,a.ngForOf=this._ngForOf}t.forEachIdentityChange(i=>{let o=r.get(i.currentIndex);_M(o,i)})}static ngTemplateContextGuard(t,r){return!0}static \u0275fac=function(r){return new(r||n)(q(Ga),q(Kf),q(h0))};static \u0275dir=Qe({type:n,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"}})}return n})();function _M(n,e){n.context.$implicit=e.item}var Wt=(()=>{class n{_viewContainer;_context=new cp;_thenTemplateRef=null;_elseTemplateRef=null;_thenViewRef=null;_elseViewRef=null;constructor(t,r){this._viewContainer=t,this._thenTemplateRef=r}set ngIf(t){this._context.$implicit=this._context.ngIf=t,this._updateView()}set ngIfThen(t){yM(t,!1),this._thenTemplateRef=t,this._thenViewRef=null,this._updateView()}set ngIfElse(t){yM(t,!1),this._elseTemplateRef=t,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngIfUseIfTypeGuard;static ngTemplateGuard_ngIf;static ngTemplateContextGuard(t,r){return!0}static \u0275fac=function(r){return new(r||n)(q(Ga),q(Kf))};static \u0275dir=Qe({type:n,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"}})}return n})(),cp=class{$implicit=null;ngIf=null};function yM(n,e){if(n&&!n.createEmbeddedView)throw new Z(2020,!1)}function NM(n,e){return new Z(2100,!1)}var UB="mediumDate",RM=new J(""),kM=new J(""),uu=(()=>{class n{locale;defaultTimezone;defaultOptions;constructor(t,r,i){this.locale=t,this.defaultTimezone=r,this.defaultOptions=i}transform(t,r,i,o){if(t==null||t===""||t!==t)return null;try{let s=r??this.defaultOptions?.dateFormat??UB,a=i??this.defaultOptions?.timezone??this.defaultTimezone??void 0;return MM(t,s,o||this.locale,a)}catch(s){throw NM(n,s.message)}}static \u0275fac=function(r){return new(r||n)(q(tu,16),q(RM,24),q(kM,24))};static \u0275pipe=d0({name:"date",type:n,pure:!0})}return n})();var mr=(()=>{class n{_locale;constructor(t){this._locale=t}transform(t,r,i){if(!$B(t))return null;i||=this._locale;try{let o=zB(t);return OM(o,i,r)}catch(o){throw NM(n,o.message)}}static \u0275fac=function(r){return new(r||n)(q(tu,16))};static \u0275pipe=d0({name:"number",type:n,pure:!0})}return n})();function $B(n){return!(n==null||n===""||n!==n)}function zB(n){if(typeof n=="string"&&!isNaN(Number(n)-parseFloat(n)))return Number(n);if(typeof n!="number")throw new Error(`${n} is not a number`);return n}var Ot=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275mod=$r({type:n});static \u0275inj=jr({})}return n})();function b0(n,e){e=encodeURIComponent(e);for(let t of n.split(";")){let r=t.indexOf("="),[i,o]=r==-1?[t,""]:[t.slice(0,r),t.slice(r+1)];if(i.trim()===e)return decodeURIComponent(o)}return null}var I0="browser",FM="server";function lp(n){return n===FM}var du=class{};var LM=(()=>{class n{static \u0275prov=H({token:n,providedIn:"root",factory:()=>new E0(j(At),window)})}return n})(),E0=class{document;window;offset=()=>[0,0];constructor(e,t){this.document=e,this.window=t}setOffset(e){Array.isArray(e)?this.offset=()=>e:this.offset=e}getScrollPosition(){return[this.window.scrollX,this.window.scrollY]}scrollToPosition(e){this.window.scrollTo(e[0],e[1])}scrollToAnchor(e){let t=HB(this.document,e);t&&(this.scrollToElement(t),t.focus())}setHistoryScrollRestoration(e){this.window.history.scrollRestoration=e}scrollToElement(e){let t=e.getBoundingClientRect(),r=t.left+this.window.pageXOffset,i=t.top+this.window.pageYOffset,o=this.offset();this.window.scrollTo(r-o[0],i-o[1])}};function HB(n,e){let t=n.getElementById(e)||n.getElementsByName(e)[0];if(t)return t;if(typeof n.createTreeWalker=="function"&&n.body&&typeof n.body.attachShadow=="function"){let r=n.createTreeWalker(n.body,NodeFilter.SHOW_ELEMENT),i=r.currentNode;for(;i;){let o=i.shadowRoot;if(o){let s=o.getElementById(e)||o.querySelector(`[name="${e}"]`);if(s)return s}i=r.nextNode()}}return null}var hp=new J(""),D0=(()=>{class n{_zone;_plugins;_eventNameToPlugin=new Map;constructor(t,r){this._zone=r,t.forEach(i=>{i.manager=this}),this._plugins=t.slice().reverse()}addEventListener(t,r,i,o){return this._findPluginFor(r).addEventListener(t,r,i,o)}getZone(){return this._zone}_findPluginFor(t){let r=this._eventNameToPlugin.get(t);if(r)return r;if(r=this._plugins.find(o=>o.supports(t)),!r)throw new Z(5101,!1);return this._eventNameToPlugin.set(t,r),r}static \u0275fac=function(r){return new(r||n)(ee(hp),ee(Pe))};static \u0275prov=H({token:n,factory:n.\u0275fac})}return n})(),hu=class{_doc;constructor(e){this._doc=e}manager},up="ng-app-id";function VM(n){for(let e of n)e.remove()}function jM(n,e){let t=e.createElement("style");return t.textContent=n,t}function WB(n,e,t,r){let i=n.head?.querySelectorAll(`style[${up}="${e}"],link[${up}="${e}"]`);if(i)for(let o of i)o.removeAttribute(up),o instanceof HTMLLinkElement?r.set(o.href.slice(o.href.lastIndexOf("/")+1),{usage:0,elements:[o]}):o.textContent&&t.set(o.textContent,{usage:0,elements:[o]})}function S0(n,e){let t=e.createElement("link");return t.setAttribute("rel","stylesheet"),t.setAttribute("href",n),t}var M0=(()=>{class n{doc;appId;nonce;inline=new Map;external=new Map;hosts=new Set;isServer;constructor(t,r,i,o={}){this.doc=t,this.appId=r,this.nonce=i,this.isServer=lp(o),WB(t,r,this.inline,this.external),this.hosts.add(t.head)}addStyles(t,r){for(let i of t)this.addUsage(i,this.inline,jM);r?.forEach(i=>this.addUsage(i,this.external,S0))}removeStyles(t,r){for(let i of t)this.removeUsage(i,this.inline);r?.forEach(i=>this.removeUsage(i,this.external))}addUsage(t,r,i){let o=r.get(t);o?o.usage++:r.set(t,{usage:1,elements:[...this.hosts].map(s=>this.addElement(s,i(t,this.doc)))})}removeUsage(t,r){let i=r.get(t);i&&(i.usage--,i.usage<=0&&(VM(i.elements),r.delete(t)))}ngOnDestroy(){for(let[,{elements:t}]of[...this.inline,...this.external])VM(t);this.hosts.clear()}addHost(t){this.hosts.add(t);for(let[r,{elements:i}]of this.inline)i.push(this.addElement(t,jM(r,this.doc)));for(let[r,{elements:i}]of this.external)i.push(this.addElement(t,S0(r,this.doc)))}removeHost(t){this.hosts.delete(t)}addElement(t,r){return this.nonce&&r.setAttribute("nonce",this.nonce),this.isServer&&r.setAttribute(up,this.appId),t.appendChild(r)}static \u0275fac=function(r){return new(r||n)(ee(At),ee(Wy),ee(Gy,8),ee(co))};static \u0275prov=H({token:n,factory:n.\u0275fac})}return n})(),x0={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/Math/MathML"},P0=/%COMP%/g;var UM="%COMP%",qB=`_nghost-${UM}`,GB=`_ngcontent-${UM}`,KB=!0,YB=new J("",{providedIn:"root",factory:()=>KB});function QB(n){return GB.replace(P0,n)}function ZB(n){return qB.replace(P0,n)}function $M(n,e){return e.map(t=>t.replace(P0,n))}var A0=(()=>{class n{eventManager;sharedStylesHost;appId;removeStylesOnCompDestroy;doc;platformId;ngZone;nonce;tracingService;rendererByCompId=new Map;defaultRenderer;platformIsServer;constructor(t,r,i,o,s,a,c,u=null,d=null){this.eventManager=t,this.sharedStylesHost=r,this.appId=i,this.removeStylesOnCompDestroy=o,this.doc=s,this.platformId=a,this.ngZone=c,this.nonce=u,this.tracingService=d,this.platformIsServer=lp(a),this.defaultRenderer=new fu(t,s,c,this.platformIsServer,this.tracingService)}createRenderer(t,r){if(!t||!r)return this.defaultRenderer;this.platformIsServer&&r.encapsulation===Lr.ShadowDom&&(r=le(L({},r),{encapsulation:Lr.Emulated}));let i=this.getOrCreateRenderer(t,r);return i instanceof dp?i.applyToHost(t):i instanceof pu&&i.applyStyles(),i}getOrCreateRenderer(t,r){let i=this.rendererByCompId,o=i.get(r.id);if(!o){let s=this.doc,a=this.ngZone,c=this.eventManager,u=this.sharedStylesHost,d=this.removeStylesOnCompDestroy,f=this.platformIsServer,v=this.tracingService;switch(r.encapsulation){case Lr.Emulated:o=new dp(c,u,r,this.appId,d,s,a,f,v);break;case Lr.ShadowDom:return new T0(c,u,t,r,s,a,this.nonce,f,v);default:o=new pu(c,u,r,d,s,a,f,v);break}i.set(r.id,o)}return o}ngOnDestroy(){this.rendererByCompId.clear()}componentReplaced(t){this.rendererByCompId.delete(t)}static \u0275fac=function(r){return new(r||n)(ee(D0),ee(M0),ee(Wy),ee(YB),ee(At),ee(co),ee(Pe),ee(Gy),ee(Wa,8))};static \u0275prov=H({token:n,factory:n.\u0275fac})}return n})(),fu=class{eventManager;doc;ngZone;platformIsServer;tracingService;data=Object.create(null);throwOnSyntheticProps=!0;constructor(e,t,r,i,o){this.eventManager=e,this.doc=t,this.ngZone=r,this.platformIsServer=i,this.tracingService=o}destroy(){}destroyNode=null;createElement(e,t){return t?this.doc.createElementNS(x0[t]||t,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,t){(BM(e)?e.content:e).appendChild(t)}insertBefore(e,t,r){e&&(BM(e)?e.content:e).insertBefore(t,r)}removeChild(e,t){t.remove()}selectRootElement(e,t){let r=typeof e=="string"?this.doc.querySelector(e):e;if(!r)throw new Z(-5104,!1);return t||(r.textContent=""),r}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,r,i){if(i){t=i+":"+t;let o=x0[i];o?e.setAttributeNS(o,t,r):e.setAttribute(t,r)}else e.setAttribute(t,r)}removeAttribute(e,t,r){if(r){let i=x0[r];i?e.removeAttributeNS(i,t):e.removeAttribute(`${r}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,r,i){i&(Ei.DashCase|Ei.Important)?e.style.setProperty(t,r,i&Ei.Important?"important":""):e.style[t]=r}removeStyle(e,t,r){r&Ei.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,r){e!=null&&(e[t]=r)}setValue(e,t){e.nodeValue=t}listen(e,t,r,i){if(typeof e=="string"&&(e=Kn().getGlobalEventTarget(this.doc,e),!e))throw new Z(5102,!1);let o=this.decoratePreventDefault(r);return this.tracingService?.wrapEventListener&&(o=this.tracingService.wrapEventListener(e,t,o)),this.eventManager.addEventListener(e,t,o,i)}decoratePreventDefault(e){return t=>{if(t==="__ngUnwrap__")return e;(this.platformIsServer?this.ngZone.runGuarded(()=>e(t)):e(t))===!1&&t.preventDefault()}}};function BM(n){return n.tagName==="TEMPLATE"&&n.content!==void 0}var T0=class extends fu{sharedStylesHost;hostEl;shadowRoot;constructor(e,t,r,i,o,s,a,c,u){super(e,o,s,c,u),this.sharedStylesHost=t,this.hostEl=r,this.shadowRoot=r.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);let d=i.styles;d=$M(i.id,d);for(let v of d){let _=document.createElement("style");a&&_.setAttribute("nonce",a),_.textContent=v,this.shadowRoot.appendChild(_)}let f=i.getExternalStyles?.();if(f)for(let v of f){let _=S0(v,o);a&&_.setAttribute("nonce",a),this.shadowRoot.appendChild(_)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,r){return super.insertBefore(this.nodeOrShadowRoot(e),t,r)}removeChild(e,t){return super.removeChild(null,t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}},pu=class extends fu{sharedStylesHost;removeStylesOnCompDestroy;styles;styleUrls;constructor(e,t,r,i,o,s,a,c,u){super(e,o,s,a,c),this.sharedStylesHost=t,this.removeStylesOnCompDestroy=i;let d=r.styles;this.styles=u?$M(u,d):d,this.styleUrls=r.getExternalStyles?.(u)}applyStyles(){this.sharedStylesHost.addStyles(this.styles,this.styleUrls)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles,this.styleUrls)}},dp=class extends pu{contentAttr;hostAttr;constructor(e,t,r,i,o,s,a,c,u){let d=i+"-"+r.id;super(e,t,r,o,s,a,c,u,d),this.contentAttr=QB(d),this.hostAttr=ZB(d)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,t){let r=super.createElement(e,t);return super.setAttribute(r,this.contentAttr,""),r}};var fp=class n extends iu{supportsDOMEvents=!0;static makeCurrent(){f0(new n)}onAndCancel(e,t,r,i){return e.addEventListener(t,r,i),()=>{e.removeEventListener(t,r,i)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.remove()}createElement(e,t){return t=t||this.getDefaultDocument(),t.createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return t==="window"?window:t==="document"?e:t==="body"?e.body:null}getBaseHref(e){let t=JB();return t==null?null:XB(t)}resetBaseElement(){mu=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return b0(document.cookie,e)}},mu=null;function JB(){return mu=mu||document.head.querySelector("base"),mu?mu.getAttribute("href"):null}function XB(n){return new URL(n,document.baseURI).pathname}var e6=(()=>{class n{build(){return new XMLHttpRequest}static \u0275fac=function(r){return new(r||n)};static \u0275prov=H({token:n,factory:n.\u0275fac})}return n})(),HM=(()=>{class n extends hu{constructor(t){super(t)}supports(t){return!0}addEventListener(t,r,i,o){return t.addEventListener(r,i,o),()=>this.removeEventListener(t,r,i,o)}removeEventListener(t,r,i,o){return t.removeEventListener(r,i,o)}static \u0275fac=function(r){return new(r||n)(ee(At))};static \u0275prov=H({token:n,factory:n.\u0275fac})}return n})(),zM=["alt","control","meta","shift"],t6={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},n6={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey},WM=(()=>{class n extends hu{constructor(t){super(t)}supports(t){return n.parseEventName(t)!=null}addEventListener(t,r,i,o){let s=n.parseEventName(r),a=n.eventCallback(s.fullKey,i,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>Kn().onAndCancel(t,s.domEventName,a,o))}static parseEventName(t){let r=t.toLowerCase().split("."),i=r.shift();if(r.length===0||!(i==="keydown"||i==="keyup"))return null;let o=n._normalizeKey(r.pop()),s="",a=r.indexOf("code");if(a>-1&&(r.splice(a,1),s="code."),zM.forEach(u=>{let d=r.indexOf(u);d>-1&&(r.splice(d,1),s+=u+".")}),s+=o,r.length!=0||o.length===0)return null;let c={};return c.domEventName=i,c.fullKey=s,c}static matchEventFullKeyCode(t,r){let i=t6[t.key]||t.key,o="";return r.indexOf("code.")>-1&&(i=t.code,o="code."),i==null||!i?!1:(i=i.toLowerCase(),i===" "?i="space":i==="."&&(i="dot"),zM.forEach(s=>{if(s!==i){let a=n6[s];a(t)&&(o+=s+".")}}),o+=i,o===r)}static eventCallback(t,r,i){return o=>{n.matchEventFullKeyCode(o,t)&&i.runGuarded(()=>r(o))}}static _normalizeKey(t){return t==="esc"?"escape":t}static \u0275fac=function(r){return new(r||n)(ee(At))};static \u0275prov=H({token:n,factory:n.\u0275fac})}return n})();function O0(n,e){return uM(L({rootComponent:n},r6(e)))}function r6(n){return{appProviders:[...c6,...n?.providers??[]],platformProviders:a6}}function i6(){fp.makeCurrent()}function o6(){return new Fr}function s6(){return XD(document),document}var a6=[{provide:co,useValue:I0},{provide:qy,useValue:i6,multi:!0},{provide:At,useFactory:s6}];var c6=[{provide:Bf,useValue:"root"},{provide:Fr,useFactory:o6},{provide:hp,useClass:HM,multi:!0,deps:[At]},{provide:hp,useClass:WM,multi:!0,deps:[At]},A0,M0,D0,{provide:Fa,useExisting:A0},{provide:du,useClass:e6},[]];var qM=(()=>{class n{_doc;constructor(t){this._doc=t}getTitle(){return this._doc.title}setTitle(t){this._doc.title=t||""}static \u0275fac=function(r){return new(r||n)(ee(At))};static \u0275prov=H({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var Ce="primary",Du=Symbol("RouteTitle"),L0=class{params;constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}};function Cs(n){return new L0(n)}function eP(n,e,t){let r=t.path.split("/");if(r.length>n.length||t.pathMatch==="full"&&(e.hasChildren()||r.length<n.length))return null;let i={};for(let o=0;o<r.length;o++){let s=r[o],a=n[o];if(s[0]===":")i[s.substring(1)]=a;else if(s!==a.path)return null}return{consumed:n.slice(0,r.length),posParams:i}}function u6(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;++t)if(!Wr(n[t],e[t]))return!1;return!0}function Wr(n,e){let t=n?V0(n):void 0,r=e?V0(e):void 0;if(!t||!r||t.length!=r.length)return!1;let i;for(let o=0;o<t.length;o++)if(i=t[o],!tP(n[i],e[i]))return!1;return!0}function V0(n){return[...Object.keys(n),...Object.getOwnPropertySymbols(n)]}function tP(n,e){if(Array.isArray(n)&&Array.isArray(e)){if(n.length!==e.length)return!1;let t=[...n].sort(),r=[...e].sort();return t.every((i,o)=>r[o]===i)}else return n===e}function nP(n){return n.length>0?n[n.length-1]:null}function go(n){return __(n)?n:gs(n)?nt(Promise.resolve(n)):fe(n)}var d6={exact:iP,subset:oP},rP={exact:h6,subset:f6,ignored:()=>!0};function GM(n,e,t){return d6[t.paths](n.root,e.root,t.matrixParams)&&rP[t.queryParams](n.queryParams,e.queryParams)&&!(t.fragment==="exact"&&n.fragment!==e.fragment)}function h6(n,e){return Wr(n,e)}function iP(n,e,t){if(!ys(n.segments,e.segments)||!gp(n.segments,e.segments,t)||n.numberOfChildren!==e.numberOfChildren)return!1;for(let r in e.children)if(!n.children[r]||!iP(n.children[r],e.children[r],t))return!1;return!0}function f6(n,e){return Object.keys(e).length<=Object.keys(n).length&&Object.keys(e).every(t=>tP(n[t],e[t]))}function oP(n,e,t){return sP(n,e,e.segments,t)}function sP(n,e,t,r){if(n.segments.length>t.length){let i=n.segments.slice(0,t.length);return!(!ys(i,t)||e.hasChildren()||!gp(i,t,r))}else if(n.segments.length===t.length){if(!ys(n.segments,t)||!gp(n.segments,t,r))return!1;for(let i in e.children)if(!n.children[i]||!oP(n.children[i],e.children[i],r))return!1;return!0}else{let i=t.slice(0,n.segments.length),o=t.slice(n.segments.length);return!ys(n.segments,i)||!gp(n.segments,i,r)||!n.children[Ce]?!1:sP(n.children[Ce],e,o,r)}}function gp(n,e,t){return e.every((r,i)=>rP[t](n[i].parameters,r.parameters))}var Gr=class{root;queryParams;fragment;_queryParamMap;constructor(e=new Be([],{}),t={},r=null){this.root=e,this.queryParams=t,this.fragment=r}get queryParamMap(){return this._queryParamMap??=Cs(this.queryParams),this._queryParamMap}toString(){return g6.serialize(this)}},Be=class{segments;children;parent=null;constructor(e,t){this.segments=e,this.children=t,Object.values(t).forEach(r=>r.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return vp(this)}},fo=class{path;parameters;_parameterMap;constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap??=Cs(this.parameters),this._parameterMap}toString(){return cP(this)}};function p6(n,e){return ys(n,e)&&n.every((t,r)=>Wr(t.parameters,e[r].parameters))}function ys(n,e){return n.length!==e.length?!1:n.every((t,r)=>t.path===e[r].path)}function m6(n,e){let t=[];return Object.entries(n.children).forEach(([r,i])=>{r===Ce&&(t=t.concat(e(i,r)))}),Object.entries(n.children).forEach(([r,i])=>{r!==Ce&&(t=t.concat(e(i,r)))}),t}var bs=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275prov=H({token:n,factory:()=>new po,providedIn:"root"})}return n})(),po=class{parse(e){let t=new B0(e);return new Gr(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){let t=`/${gu(e.root,!0)}`,r=y6(e.queryParams),i=typeof e.fragment=="string"?`#${v6(e.fragment)}`:"";return`${t}${r}${i}`}},g6=new po;function vp(n){return n.segments.map(e=>cP(e)).join("/")}function gu(n,e){if(!n.hasChildren())return vp(n);if(e){let t=n.children[Ce]?gu(n.children[Ce],!1):"",r=[];return Object.entries(n.children).forEach(([i,o])=>{i!==Ce&&r.push(`${i}:${gu(o,!1)}`)}),r.length>0?`${t}(${r.join("//")})`:t}else{let t=m6(n,(r,i)=>i===Ce?[gu(n.children[Ce],!1)]:[`${i}:${gu(r,!1)}`]);return Object.keys(n.children).length===1&&n.children[Ce]!=null?`${vp(n)}/${t[0]}`:`${vp(n)}/(${t.join("//")})`}}function aP(n){return encodeURIComponent(n).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function pp(n){return aP(n).replace(/%3B/gi,";")}function v6(n){return encodeURI(n)}function j0(n){return aP(n).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function _p(n){return decodeURIComponent(n)}function KM(n){return _p(n.replace(/\+/g,"%20"))}function cP(n){return`${j0(n.path)}${_6(n.parameters)}`}function _6(n){return Object.entries(n).map(([e,t])=>`;${j0(e)}=${j0(t)}`).join("")}function y6(n){let e=Object.entries(n).map(([t,r])=>Array.isArray(r)?r.map(i=>`${pp(t)}=${pp(i)}`).join("&"):`${pp(t)}=${pp(r)}`).filter(t=>t);return e.length?`?${e.join("&")}`:""}var w6=/^[^\/()?;#]+/;function N0(n){let e=n.match(w6);return e?e[0]:""}var C6=/^[^\/()?;=#]+/;function b6(n){let e=n.match(C6);return e?e[0]:""}var I6=/^[^=?&#]+/;function E6(n){let e=n.match(I6);return e?e[0]:""}var x6=/^[^&#]+/;function S6(n){let e=n.match(x6);return e?e[0]:""}var B0=class{url;remaining;constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),this.remaining===""||this.peekStartsWith("?")||this.peekStartsWith("#")?new Be([],{}):new Be([],this.parseChildren())}parseQueryParams(){let e={};if(this.consumeOptional("?"))do this.parseQueryParam(e);while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(this.remaining==="")return{};this.consumeOptional("/");let e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let r={};return this.peekStartsWith("(")&&(r=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(r[Ce]=new Be(e,t)),r}parseSegment(){let e=N0(this.remaining);if(e===""&&this.peekStartsWith(";"))throw new Z(4009,!1);return this.capture(e),new fo(_p(e),this.parseMatrixParams())}parseMatrixParams(){let e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){let t=b6(this.remaining);if(!t)return;this.capture(t);let r="";if(this.consumeOptional("=")){let i=N0(this.remaining);i&&(r=i,this.capture(r))}e[_p(t)]=_p(r)}parseQueryParam(e){let t=E6(this.remaining);if(!t)return;this.capture(t);let r="";if(this.consumeOptional("=")){let s=S6(this.remaining);s&&(r=s,this.capture(r))}let i=KM(t),o=KM(r);if(e.hasOwnProperty(i)){let s=e[i];Array.isArray(s)||(s=[s],e[i]=s),s.push(o)}else e[i]=o}parseParens(e){let t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){let r=N0(this.remaining),i=this.remaining[r.length];if(i!=="/"&&i!==")"&&i!==";")throw new Z(4010,!1);let o;r.indexOf(":")>-1?(o=r.slice(0,r.indexOf(":")),this.capture(o),this.capture(":")):e&&(o=Ce);let s=this.parseChildren();t[o]=Object.keys(s).length===1?s[Ce]:new Be([],s),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return this.peekStartsWith(e)?(this.remaining=this.remaining.substring(e.length),!0):!1}capture(e){if(!this.consumeOptional(e))throw new Z(4011,!1)}};function lP(n){return n.segments.length>0?new Be([],{[Ce]:n}):n}function uP(n){let e={};for(let[r,i]of Object.entries(n.children)){let o=uP(i);if(r===Ce&&o.segments.length===0&&o.hasChildren())for(let[s,a]of Object.entries(o.children))e[s]=a;else(o.segments.length>0||o.hasChildren())&&(e[r]=o)}let t=new Be(n.segments,e);return T6(t)}function T6(n){if(n.numberOfChildren===1&&n.children[Ce]){let e=n.children[Ce];return new Be(n.segments.concat(e.segments),e.children)}return n}function Xa(n){return n instanceof Gr}function dP(n,e,t=null,r=null){let i=hP(n);return fP(i,e,t,r)}function hP(n){let e;function t(o){let s={};for(let c of o.children){let u=t(c);s[c.outlet]=u}let a=new Be(o.url,s);return o===n&&(e=a),a}let r=t(n.root),i=lP(r);return e??i}function fP(n,e,t,r){let i=n;for(;i.parent;)i=i.parent;if(e.length===0)return R0(i,i,i,t,r);let o=D6(e);if(o.toRoot())return R0(i,i,new Be([],{}),t,r);let s=M6(o,i,n),a=s.processChildren?_u(s.segmentGroup,s.index,o.commands):mP(s.segmentGroup,s.index,o.commands);return R0(i,s.segmentGroup,a,t,r)}function wp(n){return typeof n=="object"&&n!=null&&!n.outlets&&!n.segmentPath}function wu(n){return typeof n=="object"&&n!=null&&n.outlets}function R0(n,e,t,r,i){let o={};r&&Object.entries(r).forEach(([c,u])=>{o[c]=Array.isArray(u)?u.map(d=>`${d}`):`${u}`});let s;n===e?s=t:s=pP(n,e,t);let a=lP(uP(s));return new Gr(a,o,i)}function pP(n,e,t){let r={};return Object.entries(n.children).forEach(([i,o])=>{o===e?r[i]=t:r[i]=pP(o,e,t)}),new Be(n.segments,r)}var Cp=class{isAbsolute;numberOfDoubleDots;commands;constructor(e,t,r){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=r,e&&r.length>0&&wp(r[0]))throw new Z(4003,!1);let i=r.find(wu);if(i&&i!==nP(r))throw new Z(4004,!1)}toRoot(){return this.isAbsolute&&this.commands.length===1&&this.commands[0]=="/"}};function D6(n){if(typeof n[0]=="string"&&n.length===1&&n[0]==="/")return new Cp(!0,0,n);let e=0,t=!1,r=n.reduce((i,o,s)=>{if(typeof o=="object"&&o!=null){if(o.outlets){let a={};return Object.entries(o.outlets).forEach(([c,u])=>{a[c]=typeof u=="string"?u.split("/"):u}),[...i,{outlets:a}]}if(o.segmentPath)return[...i,o.segmentPath]}return typeof o!="string"?[...i,o]:s===0?(o.split("/").forEach((a,c)=>{c==0&&a==="."||(c==0&&a===""?t=!0:a===".."?e++:a!=""&&i.push(a))}),i):[...i,o]},[]);return new Cp(t,e,r)}var Za=class{segmentGroup;processChildren;index;constructor(e,t,r){this.segmentGroup=e,this.processChildren=t,this.index=r}};function M6(n,e,t){if(n.isAbsolute)return new Za(e,!0,0);if(!t)return new Za(e,!1,NaN);if(t.parent===null)return new Za(t,!0,0);let r=wp(n.commands[0])?0:1,i=t.segments.length-1+r;return P6(t,i,n.numberOfDoubleDots)}function P6(n,e,t){let r=n,i=e,o=t;for(;o>i;){if(o-=i,r=r.parent,!r)throw new Z(4005,!1);i=r.segments.length}return new Za(r,!1,i-o)}function A6(n){return wu(n[0])?n[0].outlets:{[Ce]:n}}function mP(n,e,t){if(n??=new Be([],{}),n.segments.length===0&&n.hasChildren())return _u(n,e,t);let r=O6(n,e,t),i=t.slice(r.commandIndex);if(r.match&&r.pathIndex<n.segments.length){let o=new Be(n.segments.slice(0,r.pathIndex),{});return o.children[Ce]=new Be(n.segments.slice(r.pathIndex),n.children),_u(o,0,i)}else return r.match&&i.length===0?new Be(n.segments,{}):r.match&&!n.hasChildren()?U0(n,e,t):r.match?_u(n,0,i):U0(n,e,t)}function _u(n,e,t){if(t.length===0)return new Be(n.segments,{});{let r=A6(t),i={};if(Object.keys(r).some(o=>o!==Ce)&&n.children[Ce]&&n.numberOfChildren===1&&n.children[Ce].segments.length===0){let o=_u(n.children[Ce],e,t);return new Be(n.segments,o.children)}return Object.entries(r).forEach(([o,s])=>{typeof s=="string"&&(s=[s]),s!==null&&(i[o]=mP(n.children[o],e,s))}),Object.entries(n.children).forEach(([o,s])=>{r[o]===void 0&&(i[o]=s)}),new Be(n.segments,i)}}function O6(n,e,t){let r=0,i=e,o={match:!1,pathIndex:0,commandIndex:0};for(;i<n.segments.length;){if(r>=t.length)return o;let s=n.segments[i],a=t[r];if(wu(a))break;let c=`${a}`,u=r<t.length-1?t[r+1]:null;if(i>0&&c===void 0)break;if(c&&u&&typeof u=="object"&&u.outlets===void 0){if(!QM(c,u,s))return o;r+=2}else{if(!QM(c,{},s))return o;r++}i++}return{match:!0,pathIndex:i,commandIndex:r}}function U0(n,e,t){let r=n.segments.slice(0,e),i=0;for(;i<t.length;){let o=t[i];if(wu(o)){let c=N6(o.outlets);return new Be(r,c)}if(i===0&&wp(t[0])){let c=n.segments[e];r.push(new fo(c.path,YM(t[0]))),i++;continue}let s=wu(o)?o.outlets[Ce]:`${o}`,a=i<t.length-1?t[i+1]:null;s&&a&&wp(a)?(r.push(new fo(s,YM(a))),i+=2):(r.push(new fo(s,{})),i++)}return new Be(r,{})}function N6(n){let e={};return Object.entries(n).forEach(([t,r])=>{typeof r=="string"&&(r=[r]),r!==null&&(e[t]=U0(new Be([],{}),0,r))}),e}function YM(n){let e={};return Object.entries(n).forEach(([t,r])=>e[t]=`${r}`),e}function QM(n,e,t){return n==t.path&&Wr(e,t.parameters)}var yp="imperative",Tt=function(n){return n[n.NavigationStart=0]="NavigationStart",n[n.NavigationEnd=1]="NavigationEnd",n[n.NavigationCancel=2]="NavigationCancel",n[n.NavigationError=3]="NavigationError",n[n.RoutesRecognized=4]="RoutesRecognized",n[n.ResolveStart=5]="ResolveStart",n[n.ResolveEnd=6]="ResolveEnd",n[n.GuardsCheckStart=7]="GuardsCheckStart",n[n.GuardsCheckEnd=8]="GuardsCheckEnd",n[n.RouteConfigLoadStart=9]="RouteConfigLoadStart",n[n.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",n[n.ChildActivationStart=11]="ChildActivationStart",n[n.ChildActivationEnd=12]="ChildActivationEnd",n[n.ActivationStart=13]="ActivationStart",n[n.ActivationEnd=14]="ActivationEnd",n[n.Scroll=15]="Scroll",n[n.NavigationSkipped=16]="NavigationSkipped",n}(Tt||{}),Vn=class{id;url;constructor(e,t){this.id=e,this.url=t}},mo=class extends Vn{type=Tt.NavigationStart;navigationTrigger;restoredState;constructor(e,t,r="imperative",i=null){super(e,t),this.navigationTrigger=r,this.restoredState=i}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}},vr=class extends Vn{urlAfterRedirects;type=Tt.NavigationEnd;constructor(e,t,r){super(e,t),this.urlAfterRedirects=r}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}},Dn=function(n){return n[n.Redirect=0]="Redirect",n[n.SupersededByNewNavigation=1]="SupersededByNewNavigation",n[n.NoDataFromResolver=2]="NoDataFromResolver",n[n.GuardRejected=3]="GuardRejected",n}(Dn||{}),ec=function(n){return n[n.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",n[n.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",n}(ec||{}),qr=class extends Vn{reason;code;type=Tt.NavigationCancel;constructor(e,t,r,i){super(e,t),this.reason=r,this.code=i}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}},Kr=class extends Vn{reason;code;type=Tt.NavigationSkipped;constructor(e,t,r,i){super(e,t),this.reason=r,this.code=i}},tc=class extends Vn{error;target;type=Tt.NavigationError;constructor(e,t,r,i){super(e,t),this.error=r,this.target=i}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}},Cu=class extends Vn{urlAfterRedirects;state;type=Tt.RoutesRecognized;constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},bp=class extends Vn{urlAfterRedirects;state;type=Tt.GuardsCheckStart;constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Ip=class extends Vn{urlAfterRedirects;state;shouldActivate;type=Tt.GuardsCheckEnd;constructor(e,t,r,i,o){super(e,t),this.urlAfterRedirects=r,this.state=i,this.shouldActivate=o}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}},Ep=class extends Vn{urlAfterRedirects;state;type=Tt.ResolveStart;constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},xp=class extends Vn{urlAfterRedirects;state;type=Tt.ResolveEnd;constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Sp=class{route;type=Tt.RouteConfigLoadStart;constructor(e){this.route=e}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}},Tp=class{route;type=Tt.RouteConfigLoadEnd;constructor(e){this.route=e}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}},Dp=class{snapshot;type=Tt.ChildActivationStart;constructor(e){this.snapshot=e}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Mp=class{snapshot;type=Tt.ChildActivationEnd;constructor(e){this.snapshot=e}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Pp=class{snapshot;type=Tt.ActivationStart;constructor(e){this.snapshot=e}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Ap=class{snapshot;type=Tt.ActivationEnd;constructor(e){this.snapshot=e}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},nc=class{routerEvent;position;anchor;type=Tt.Scroll;constructor(e,t,r){this.routerEvent=e,this.position=t,this.anchor=r}toString(){let e=this.position?`${this.position[0]}, ${this.position[1]}`:null;return`Scroll(anchor: '${this.anchor}', position: '${e}')`}},bu=class{},rc=class{url;navigationBehaviorOptions;constructor(e,t){this.url=e,this.navigationBehaviorOptions=t}};function R6(n,e){return n.providers&&!n._injector&&(n._injector=Jl(n.providers,e,`Route: ${n.path}`)),n._injector??e}function gr(n){return n.outlet||Ce}function k6(n,e){let t=n.filter(r=>gr(r)===e);return t.push(...n.filter(r=>gr(r)!==e)),t}function Mu(n){if(!n)return null;if(n.routeConfig?._injector)return n.routeConfig._injector;for(let e=n.parent;e;e=e.parent){let t=e.routeConfig;if(t?._loadedInjector)return t._loadedInjector;if(t?._injector)return t._injector}return null}var Op=class{rootInjector;outlet=null;route=null;children;attachRef=null;get injector(){return Mu(this.route?.snapshot)??this.rootInjector}constructor(e){this.rootInjector=e,this.children=new Is(this.rootInjector)}},Is=(()=>{class n{rootInjector;contexts=new Map;constructor(t){this.rootInjector=t}onChildOutletCreated(t,r){let i=this.getOrCreateContext(t);i.outlet=r,this.contexts.set(t,i)}onChildOutletDestroyed(t){let r=this.getContext(t);r&&(r.outlet=null,r.attachRef=null)}onOutletDeactivated(){let t=this.contexts;return this.contexts=new Map,t}onOutletReAttached(t){this.contexts=t}getOrCreateContext(t){let r=this.getContext(t);return r||(r=new Op(this.rootInjector),this.contexts.set(t,r)),r}getContext(t){return this.contexts.get(t)||null}static \u0275fac=function(r){return new(r||n)(ee(en))};static \u0275prov=H({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),Np=class{_root;constructor(e){this._root=e}get root(){return this._root.value}parent(e){let t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){let t=$0(e,this._root);return t?t.children.map(r=>r.value):[]}firstChild(e){let t=$0(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){let t=z0(e,this._root);return t.length<2?[]:t[t.length-2].children.map(i=>i.value).filter(i=>i!==e)}pathFromRoot(e){return z0(e,this._root).map(t=>t.value)}};function $0(n,e){if(n===e.value)return e;for(let t of e.children){let r=$0(n,t);if(r)return r}return null}function z0(n,e){if(n===e.value)return[e];for(let t of e.children){let r=z0(n,t);if(r.length)return r.unshift(e),r}return[]}var Ln=class{value;children;constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}};function Qa(n){let e={};return n&&n.children.forEach(t=>e[t.value.outlet]=t),e}var Iu=class extends Np{snapshot;constructor(e,t){super(e),this.snapshot=t,Z0(this,e)}toString(){return this.snapshot.toString()}};function gP(n){let e=F6(n),t=new Bt([new fo("",{})]),r=new Bt({}),i=new Bt({}),o=new Bt({}),s=new Bt(""),a=new qt(t,r,o,s,i,Ce,n,e.root);return a.snapshot=e.root,new Iu(new Ln(a,[]),e)}function F6(n){let e={},t={},r={},i="",o=new ws([],e,r,i,t,Ce,n,null,{});return new Eu("",new Ln(o,[]))}var qt=class{urlSubject;paramsSubject;queryParamsSubject;fragmentSubject;dataSubject;outlet;component;snapshot;_futureSnapshot;_routerState;_paramMap;_queryParamMap;title;url;params;queryParams;fragment;data;constructor(e,t,r,i,o,s,a,c){this.urlSubject=e,this.paramsSubject=t,this.queryParamsSubject=r,this.fragmentSubject=i,this.dataSubject=o,this.outlet=s,this.component=a,this._futureSnapshot=c,this.title=this.dataSubject?.pipe(_e(u=>u[Du]))??fe(void 0),this.url=e,this.params=t,this.queryParams=r,this.fragment=i,this.data=o}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(_e(e=>Cs(e))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(_e(e=>Cs(e))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}};function Rp(n,e,t="emptyOnly"){let r,{routeConfig:i}=n;return e!==null&&(t==="always"||i?.path===""||!e.component&&!e.routeConfig?.loadComponent)?r={params:L(L({},e.params),n.params),data:L(L({},e.data),n.data),resolve:L(L(L(L({},n.data),e.data),i?.data),n._resolvedData)}:r={params:L({},n.params),data:L({},n.data),resolve:L(L({},n.data),n._resolvedData??{})},i&&_P(i)&&(r.resolve[Du]=i.title),r}var ws=class{url;params;queryParams;fragment;data;outlet;component;routeConfig;_resolve;_resolvedData;_routerState;_paramMap;_queryParamMap;get title(){return this.data?.[Du]}constructor(e,t,r,i,o,s,a,c,u){this.url=e,this.params=t,this.queryParams=r,this.fragment=i,this.data=o,this.outlet=s,this.component=a,this.routeConfig=c,this._resolve=u}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=Cs(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=Cs(this.queryParams),this._queryParamMap}toString(){let e=this.url.map(r=>r.toString()).join("/"),t=this.routeConfig?this.routeConfig.path:"";return`Route(url:'${e}', path:'${t}')`}},Eu=class extends Np{url;constructor(e,t){super(t),this.url=e,Z0(this,t)}toString(){return vP(this._root)}};function Z0(n,e){e.value._routerState=n,e.children.forEach(t=>Z0(n,t))}function vP(n){let e=n.children.length>0?` { ${n.children.map(vP).join(", ")} } `:"";return`${n.value}${e}`}function k0(n){if(n.snapshot){let e=n.snapshot,t=n._futureSnapshot;n.snapshot=t,Wr(e.queryParams,t.queryParams)||n.queryParamsSubject.next(t.queryParams),e.fragment!==t.fragment&&n.fragmentSubject.next(t.fragment),Wr(e.params,t.params)||n.paramsSubject.next(t.params),u6(e.url,t.url)||n.urlSubject.next(t.url),Wr(e.data,t.data)||n.dataSubject.next(t.data)}else n.snapshot=n._futureSnapshot,n.dataSubject.next(n._futureSnapshot.data)}function H0(n,e){let t=Wr(n.params,e.params)&&p6(n.url,e.url),r=!n.parent!=!e.parent;return t&&!r&&(!n.parent||H0(n.parent,e.parent))}function _P(n){return typeof n.title=="string"||n.title===null}var yP=new J(""),Pu=(()=>{class n{activated=null;get activatedComponentRef(){return this.activated}_activatedRoute=null;name=Ce;activateEvents=new St;deactivateEvents=new St;attachEvents=new St;detachEvents=new St;routerOutletData=WD(void 0);parentContexts=j(Is);location=j(Ga);changeDetector=j(_s);inputBinder=j(Au,{optional:!0});supportsBindingToComponentInputs=!0;ngOnChanges(t){if(t.name){let{firstChange:r,previousValue:i}=t.name;if(r)return;this.isTrackedInParentContexts(i)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(i)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(t){return this.parentContexts.getContext(t)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;let t=this.parentContexts.getContext(this.name);t?.route&&(t.attachRef?this.attach(t.attachRef,t.route):this.activateWith(t.route,t.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new Z(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new Z(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new Z(4012,!1);this.location.detach();let t=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(t.instance),t}attach(t,r){this.activated=t,this._activatedRoute=r,this.location.insert(t.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(t.instance)}deactivate(){if(this.activated){let t=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(t)}}activateWith(t,r){if(this.isActivated)throw new Z(4013,!1);this._activatedRoute=t;let i=this.location,s=t.snapshot.component,a=this.parentContexts.getOrCreateContext(this.name).children,c=new W0(t,a,i.injector,this.routerOutletData);this.activated=i.createComponent(s,{index:i.length,injector:c,environmentInjector:r}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}static \u0275fac=function(r){return new(r||n)};static \u0275dir=Qe({type:n,selectors:[["router-outlet"]],inputs:{name:"name",routerOutletData:[1,"routerOutletData"]},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],features:[ps]})}return n})(),W0=class{route;childContexts;parent;outletData;constructor(e,t,r,i){this.route=e,this.childContexts=t,this.parent=r,this.outletData=i}get(e,t){return e===qt?this.route:e===Is?this.childContexts:e===yP?this.outletData:this.parent.get(e,t)}},Au=new J(""),J0=(()=>{class n{outletDataSubscriptions=new Map;bindActivatedRouteToOutletComponent(t){this.unsubscribeFromRouteData(t),this.subscribeToRouteData(t)}unsubscribeFromRouteData(t){this.outletDataSubscriptions.get(t)?.unsubscribe(),this.outletDataSubscriptions.delete(t)}subscribeToRouteData(t){let{activatedRoute:r}=t,i=Nl([r.queryParams,r.params,r.data]).pipe($t(([o,s,a],c)=>(a=L(L(L({},o),s),a),c===0?fe(a):Promise.resolve(a)))).subscribe(o=>{if(!t.isActivated||!t.activatedComponentRef||t.activatedRoute!==r||r.component===null){this.unsubscribeFromRouteData(t);return}let s=dM(r.component);if(!s){this.unsubscribeFromRouteData(t);return}for(let{templateName:a}of s.inputs)t.activatedComponentRef.setInput(a,o[a])});this.outletDataSubscriptions.set(t,i)}static \u0275fac=function(r){return new(r||n)};static \u0275prov=H({token:n,factory:n.\u0275fac})}return n})(),X0=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275cmp=Pt({type:n,selectors:[["ng-component"]],exportAs:["emptyRouterOutlet"],decls:1,vars:0,template:function(r,i){r&1&&K(0,"router-outlet")},dependencies:[Pu],encapsulation:2})}return n})();function ew(n){let e=n.children&&n.children.map(ew),t=e?le(L({},n),{children:e}):L({},n);return!t.component&&!t.loadComponent&&(e||t.loadChildren)&&t.outlet&&t.outlet!==Ce&&(t.component=X0),t}function L6(n,e,t){let r=xu(n,e._root,t?t._root:void 0);return new Iu(r,e)}function xu(n,e,t){if(t&&n.shouldReuseRoute(e.value,t.value.snapshot)){let r=t.value;r._futureSnapshot=e.value;let i=V6(n,e,t);return new Ln(r,i)}else{if(n.shouldAttach(e.value)){let o=n.retrieve(e.value);if(o!==null){let s=o.route;return s.value._futureSnapshot=e.value,s.children=e.children.map(a=>xu(n,a)),s}}let r=j6(e.value),i=e.children.map(o=>xu(n,o));return new Ln(r,i)}}function V6(n,e,t){return e.children.map(r=>{for(let i of t.children)if(n.shouldReuseRoute(r.value,i.value.snapshot))return xu(n,r,i);return xu(n,r)})}function j6(n){return new qt(new Bt(n.url),new Bt(n.params),new Bt(n.queryParams),new Bt(n.fragment),new Bt(n.data),n.outlet,n.component,n)}var ic=class{redirectTo;navigationBehaviorOptions;constructor(e,t){this.redirectTo=e,this.navigationBehaviorOptions=t}},wP="ngNavigationCancelingError";function kp(n,e){let{redirectTo:t,navigationBehaviorOptions:r}=Xa(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,i=CP(!1,Dn.Redirect);return i.url=t,i.navigationBehaviorOptions=r,i}function CP(n,e){let t=new Error(`NavigationCancelingError: ${n||""}`);return t[wP]=!0,t.cancellationCode=e,t}function B6(n){return bP(n)&&Xa(n.url)}function bP(n){return!!n&&n[wP]}var U6=(n,e,t,r)=>_e(i=>(new q0(e,i.targetRouterState,i.currentRouterState,t,r).activate(n),i)),q0=class{routeReuseStrategy;futureState;currState;forwardEvent;inputBindingEnabled;constructor(e,t,r,i,o){this.routeReuseStrategy=e,this.futureState=t,this.currState=r,this.forwardEvent=i,this.inputBindingEnabled=o}activate(e){let t=this.futureState._root,r=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,r,e),k0(this.futureState.root),this.activateChildRoutes(t,r,e)}deactivateChildRoutes(e,t,r){let i=Qa(t);e.children.forEach(o=>{let s=o.value.outlet;this.deactivateRoutes(o,i[s],r),delete i[s]}),Object.values(i).forEach(o=>{this.deactivateRouteAndItsChildren(o,r)})}deactivateRoutes(e,t,r){let i=e.value,o=t?t.value:null;if(i===o)if(i.component){let s=r.getContext(i.outlet);s&&this.deactivateChildRoutes(e,t,s.children)}else this.deactivateChildRoutes(e,t,r);else o&&this.deactivateRouteAndItsChildren(t,r)}deactivateRouteAndItsChildren(e,t){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){let r=t.getContext(e.value.outlet),i=r&&e.value.component?r.children:t,o=Qa(e);for(let s of Object.values(o))this.deactivateRouteAndItsChildren(s,i);if(r&&r.outlet){let s=r.outlet.detach(),a=r.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:s,route:e,contexts:a})}}deactivateRouteAndOutlet(e,t){let r=t.getContext(e.value.outlet),i=r&&e.value.component?r.children:t,o=Qa(e);for(let s of Object.values(o))this.deactivateRouteAndItsChildren(s,i);r&&(r.outlet&&(r.outlet.deactivate(),r.children.onOutletDeactivated()),r.attachRef=null,r.route=null)}activateChildRoutes(e,t,r){let i=Qa(t);e.children.forEach(o=>{this.activateRoutes(o,i[o.value.outlet],r),this.forwardEvent(new Ap(o.value.snapshot))}),e.children.length&&this.forwardEvent(new Mp(e.value.snapshot))}activateRoutes(e,t,r){let i=e.value,o=t?t.value:null;if(k0(i),i===o)if(i.component){let s=r.getOrCreateContext(i.outlet);this.activateChildRoutes(e,t,s.children)}else this.activateChildRoutes(e,t,r);else if(i.component){let s=r.getOrCreateContext(i.outlet);if(this.routeReuseStrategy.shouldAttach(i.snapshot)){let a=this.routeReuseStrategy.retrieve(i.snapshot);this.routeReuseStrategy.store(i.snapshot,null),s.children.onOutletReAttached(a.contexts),s.attachRef=a.componentRef,s.route=a.route.value,s.outlet&&s.outlet.attach(a.componentRef,a.route.value),k0(a.route.value),this.activateChildRoutes(e,null,s.children)}else s.attachRef=null,s.route=i,s.outlet&&s.outlet.activateWith(i,s.injector),this.activateChildRoutes(e,null,s.children)}else this.activateChildRoutes(e,null,r)}},Fp=class{path;route;constructor(e){this.path=e,this.route=this.path[this.path.length-1]}},Ja=class{component;route;constructor(e,t){this.component=e,this.route=t}};function $6(n,e,t){let r=n._root,i=e?e._root:null;return vu(r,i,t,[r.value])}function z6(n){let e=n.routeConfig?n.routeConfig.canActivateChild:null;return!e||e.length===0?null:{node:n,guards:e}}function sc(n,e){let t=Symbol(),r=e.get(n,t);return r===t?typeof n=="function"&&!FT(n)?n:e.get(n):r}function vu(n,e,t,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let o=Qa(e);return n.children.forEach(s=>{H6(s,o[s.value.outlet],t,r.concat([s.value]),i),delete o[s.value.outlet]}),Object.entries(o).forEach(([s,a])=>yu(a,t.getContext(s),i)),i}function H6(n,e,t,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let o=n.value,s=e?e.value:null,a=t?t.getContext(n.value.outlet):null;if(s&&o.routeConfig===s.routeConfig){let c=W6(s,o,o.routeConfig.runGuardsAndResolvers);c?i.canActivateChecks.push(new Fp(r)):(o.data=s.data,o._resolvedData=s._resolvedData),o.component?vu(n,e,a?a.children:null,r,i):vu(n,e,t,r,i),c&&a&&a.outlet&&a.outlet.isActivated&&i.canDeactivateChecks.push(new Ja(a.outlet.component,s))}else s&&yu(e,a,i),i.canActivateChecks.push(new Fp(r)),o.component?vu(n,null,a?a.children:null,r,i):vu(n,null,t,r,i);return i}function W6(n,e,t){if(typeof t=="function")return t(n,e);switch(t){case"pathParamsChange":return!ys(n.url,e.url);case"pathParamsOrQueryParamsChange":return!ys(n.url,e.url)||!Wr(n.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!H0(n,e)||!Wr(n.queryParams,e.queryParams);case"paramsChange":default:return!H0(n,e)}}function yu(n,e,t){let r=Qa(n),i=n.value;Object.entries(r).forEach(([o,s])=>{i.component?e?yu(s,e.children.getContext(o),t):yu(s,null,t):yu(s,e,t)}),i.component?e&&e.outlet&&e.outlet.isActivated?t.canDeactivateChecks.push(new Ja(e.outlet.component,i)):t.canDeactivateChecks.push(new Ja(null,i)):t.canDeactivateChecks.push(new Ja(null,i))}function Ou(n){return typeof n=="function"}function q6(n){return typeof n=="boolean"}function G6(n){return n&&Ou(n.canLoad)}function K6(n){return n&&Ou(n.canActivate)}function Y6(n){return n&&Ou(n.canActivateChild)}function Q6(n){return n&&Ou(n.canDeactivate)}function Z6(n){return n&&Ou(n.canMatch)}function IP(n){return n instanceof Ci||n?.name==="EmptyError"}var mp=Symbol("INITIAL_VALUE");function oc(){return $t(n=>Nl(n.map(e=>e.pipe(hn(1),nf(mp)))).pipe(_e(e=>{for(let t of e)if(t!==!0){if(t===mp)return mp;if(t===!1||J6(t))return t}return!0}),Ut(e=>e!==mp),hn(1)))}function J6(n){return Xa(n)||n instanceof ic}function X6(n,e){return mt(t=>{let{targetSnapshot:r,currentSnapshot:i,guards:{canActivateChecks:o,canDeactivateChecks:s}}=t;return s.length===0&&o.length===0?fe(le(L({},t),{guardsResult:!0})):eU(s,r,i,n).pipe(mt(a=>a&&q6(a)?tU(r,o,n,e):fe(a)),_e(a=>le(L({},t),{guardsResult:a})))})}function eU(n,e,t,r){return nt(n).pipe(mt(i=>sU(i.component,i.route,t,e,r)),Ii(i=>i!==!0,!0))}function tU(n,e,t,r){return nt(e).pipe(to(i=>Ea(rU(i.route.parent,r),nU(i.route,r),oU(n,i.path,t),iU(n,i.route,t))),Ii(i=>i!==!0,!0))}function nU(n,e){return n!==null&&e&&e(new Pp(n)),fe(!0)}function rU(n,e){return n!==null&&e&&e(new Dp(n)),fe(!0)}function iU(n,e,t){let r=e.routeConfig?e.routeConfig.canActivate:null;if(!r||r.length===0)return fe(!0);let i=r.map(o=>Xh(()=>{let s=Mu(e)??t,a=sc(o,s),c=K6(a)?a.canActivate(e,n):tn(s,()=>a(e,n));return go(c).pipe(Ii())}));return fe(i).pipe(oc())}function oU(n,e,t){let r=e[e.length-1],o=e.slice(0,e.length-1).reverse().map(s=>z6(s)).filter(s=>s!==null).map(s=>Xh(()=>{let a=s.guards.map(c=>{let u=Mu(s.node)??t,d=sc(c,u),f=Y6(d)?d.canActivateChild(r,n):tn(u,()=>d(r,n));return go(f).pipe(Ii())});return fe(a).pipe(oc())}));return fe(o).pipe(oc())}function sU(n,e,t,r,i){let o=e&&e.routeConfig?e.routeConfig.canDeactivate:null;if(!o||o.length===0)return fe(!0);let s=o.map(a=>{let c=Mu(e)??i,u=sc(a,c),d=Q6(u)?u.canDeactivate(n,e,t,r):tn(c,()=>u(n,e,t,r));return go(d).pipe(Ii())});return fe(s).pipe(oc())}function aU(n,e,t,r){let i=e.canLoad;if(i===void 0||i.length===0)return fe(!0);let o=i.map(s=>{let a=sc(s,n),c=G6(a)?a.canLoad(e,t):tn(n,()=>a(e,t));return go(c)});return fe(o).pipe(oc(),EP(r))}function EP(n){return Rh(zt(e=>{if(typeof e!="boolean")throw kp(n,e)}),_e(e=>e===!0))}function cU(n,e,t,r){let i=e.canMatch;if(!i||i.length===0)return fe(!0);let o=i.map(s=>{let a=sc(s,n),c=Z6(a)?a.canMatch(e,t):tn(n,()=>a(e,t));return go(c)});return fe(o).pipe(oc(),EP(r))}var Su=class{segmentGroup;constructor(e){this.segmentGroup=e||null}},Tu=class extends Error{urlTree;constructor(e){super(),this.urlTree=e}};function Ya(n){return ba(new Su(n))}function lU(n){return ba(new Z(4e3,!1))}function uU(n){return ba(CP(!1,Dn.GuardRejected))}var G0=class{urlSerializer;urlTree;constructor(e,t){this.urlSerializer=e,this.urlTree=t}lineralizeSegments(e,t){let r=[],i=t.root;for(;;){if(r=r.concat(i.segments),i.numberOfChildren===0)return fe(r);if(i.numberOfChildren>1||!i.children[Ce])return lU(`${e.redirectTo}`);i=i.children[Ce]}}applyRedirectCommands(e,t,r,i,o){if(typeof t!="string"){let a=t,{queryParams:c,fragment:u,routeConfig:d,url:f,outlet:v,params:_,data:b,title:N}=i,R=tn(o,()=>a({params:_,data:b,queryParams:c,fragment:u,routeConfig:d,url:f,outlet:v,title:N}));if(R instanceof Gr)throw new Tu(R);t=R}let s=this.applyRedirectCreateUrlTree(t,this.urlSerializer.parse(t),e,r);if(t[0]==="/")throw new Tu(s);return s}applyRedirectCreateUrlTree(e,t,r,i){let o=this.createSegmentGroup(e,t.root,r,i);return new Gr(o,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){let r={};return Object.entries(e).forEach(([i,o])=>{if(typeof o=="string"&&o[0]===":"){let a=o.substring(1);r[i]=t[a]}else r[i]=o}),r}createSegmentGroup(e,t,r,i){let o=this.createSegments(e,t.segments,r,i),s={};return Object.entries(t.children).forEach(([a,c])=>{s[a]=this.createSegmentGroup(e,c,r,i)}),new Be(o,s)}createSegments(e,t,r,i){return t.map(o=>o.path[0]===":"?this.findPosParam(e,o,i):this.findOrReturn(o,r))}findPosParam(e,t,r){let i=r[t.path.substring(1)];if(!i)throw new Z(4001,!1);return i}findOrReturn(e,t){let r=0;for(let i of t){if(i.path===e.path)return t.splice(r),i;r++}return e}},K0={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function dU(n,e,t,r,i){let o=xP(n,e,t);return o.matched?(r=R6(e,r),cU(r,e,t,i).pipe(_e(s=>s===!0?o:L({},K0)))):fe(o)}function xP(n,e,t){if(e.path==="**")return hU(t);if(e.path==="")return e.pathMatch==="full"&&(n.hasChildren()||t.length>0)?L({},K0):{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};let i=(e.matcher||eP)(t,n,e);if(!i)return L({},K0);let o={};Object.entries(i.posParams??{}).forEach(([a,c])=>{o[a]=c.path});let s=i.consumed.length>0?L(L({},o),i.consumed[i.consumed.length-1].parameters):o;return{matched:!0,consumedSegments:i.consumed,remainingSegments:t.slice(i.consumed.length),parameters:s,positionalParamSegments:i.posParams??{}}}function hU(n){return{matched:!0,parameters:n.length>0?nP(n).parameters:{},consumedSegments:n,remainingSegments:[],positionalParamSegments:{}}}function ZM(n,e,t,r){return t.length>0&&mU(n,t,r)?{segmentGroup:new Be(e,pU(r,new Be(t,n.children))),slicedSegments:[]}:t.length===0&&gU(n,t,r)?{segmentGroup:new Be(n.segments,fU(n,t,r,n.children)),slicedSegments:t}:{segmentGroup:new Be(n.segments,n.children),slicedSegments:t}}function fU(n,e,t,r){let i={};for(let o of t)if(Vp(n,e,o)&&!r[gr(o)]){let s=new Be([],{});i[gr(o)]=s}return L(L({},r),i)}function pU(n,e){let t={};t[Ce]=e;for(let r of n)if(r.path===""&&gr(r)!==Ce){let i=new Be([],{});t[gr(r)]=i}return t}function mU(n,e,t){return t.some(r=>Vp(n,e,r)&&gr(r)!==Ce)}function gU(n,e,t){return t.some(r=>Vp(n,e,r))}function Vp(n,e,t){return(n.hasChildren()||e.length>0)&&t.pathMatch==="full"?!1:t.path===""}function vU(n,e,t){return e.length===0&&!n.children[t]}var Y0=class{};function _U(n,e,t,r,i,o,s="emptyOnly"){return new Q0(n,e,t,r,i,s,o).recognize()}var yU=31,Q0=class{injector;configLoader;rootComponentType;config;urlTree;paramsInheritanceStrategy;urlSerializer;applyRedirects;absoluteRedirectCount=0;allowRedirects=!0;constructor(e,t,r,i,o,s,a){this.injector=e,this.configLoader=t,this.rootComponentType=r,this.config=i,this.urlTree=o,this.paramsInheritanceStrategy=s,this.urlSerializer=a,this.applyRedirects=new G0(this.urlSerializer,this.urlTree)}noMatchError(e){return new Z(4002,`'${e.segmentGroup}'`)}recognize(){let e=ZM(this.urlTree.root,[],[],this.config).segmentGroup;return this.match(e).pipe(_e(({children:t,rootSnapshot:r})=>{let i=new Ln(r,t),o=new Eu("",i),s=dP(r,[],this.urlTree.queryParams,this.urlTree.fragment);return s.queryParams=this.urlTree.queryParams,o.url=this.urlSerializer.serialize(s),{state:o,tree:s}}))}match(e){let t=new ws([],Object.freeze({}),Object.freeze(L({},this.urlTree.queryParams)),this.urlTree.fragment,Object.freeze({}),Ce,this.rootComponentType,null,{});return this.processSegmentGroup(this.injector,this.config,e,Ce,t).pipe(_e(r=>({children:r,rootSnapshot:t})),bi(r=>{if(r instanceof Tu)return this.urlTree=r.urlTree,this.match(r.urlTree.root);throw r instanceof Su?this.noMatchError(r):r}))}processSegmentGroup(e,t,r,i,o){return r.segments.length===0&&r.hasChildren()?this.processChildren(e,t,r,o):this.processSegment(e,t,r,r.segments,i,!0,o).pipe(_e(s=>s instanceof Ln?[s]:[]))}processChildren(e,t,r,i){let o=[];for(let s of Object.keys(r.children))s==="primary"?o.unshift(s):o.push(s);return nt(o).pipe(to(s=>{let a=r.children[s],c=k6(t,s);return this.processSegmentGroup(e,c,a,s,i)}),tf((s,a)=>(s.push(...a),s)),no(null),w_(),mt(s=>{if(s===null)return Ya(r);let a=SP(s);return wU(a),fe(a)}))}processSegment(e,t,r,i,o,s,a){return nt(t).pipe(to(c=>this.processSegmentAgainstRoute(c._injector??e,t,c,r,i,o,s,a).pipe(bi(u=>{if(u instanceof Su)return fe(null);throw u}))),Ii(c=>!!c),bi(c=>{if(IP(c))return vU(r,i,o)?fe(new Y0):Ya(r);throw c}))}processSegmentAgainstRoute(e,t,r,i,o,s,a,c){return gr(r)!==s&&(s===Ce||!Vp(i,o,r))?Ya(i):r.redirectTo===void 0?this.matchSegmentAgainstRoute(e,i,r,o,s,c):this.allowRedirects&&a?this.expandSegmentAgainstRouteUsingRedirect(e,i,t,r,o,s,c):Ya(i)}expandSegmentAgainstRouteUsingRedirect(e,t,r,i,o,s,a){let{matched:c,parameters:u,consumedSegments:d,positionalParamSegments:f,remainingSegments:v}=xP(t,i,o);if(!c)return Ya(t);typeof i.redirectTo=="string"&&i.redirectTo[0]==="/"&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>yU&&(this.allowRedirects=!1));let _=new ws(o,u,Object.freeze(L({},this.urlTree.queryParams)),this.urlTree.fragment,JM(i),gr(i),i.component??i._loadedComponent??null,i,XM(i)),b=Rp(_,a,this.paramsInheritanceStrategy);_.params=Object.freeze(b.params),_.data=Object.freeze(b.data);let N=this.applyRedirects.applyRedirectCommands(d,i.redirectTo,f,_,e);return this.applyRedirects.lineralizeSegments(i,N).pipe(mt(R=>this.processSegment(e,r,t,R.concat(v),s,!1,a)))}matchSegmentAgainstRoute(e,t,r,i,o,s){let a=dU(t,r,i,e,this.urlSerializer);return r.path==="**"&&(t.children={}),a.pipe($t(c=>c.matched?(e=r._injector??e,this.getChildConfig(e,r,i).pipe($t(({routes:u})=>{let d=r._loadedInjector??e,{parameters:f,consumedSegments:v,remainingSegments:_}=c,b=new ws(v,f,Object.freeze(L({},this.urlTree.queryParams)),this.urlTree.fragment,JM(r),gr(r),r.component??r._loadedComponent??null,r,XM(r)),N=Rp(b,s,this.paramsInheritanceStrategy);b.params=Object.freeze(N.params),b.data=Object.freeze(N.data);let{segmentGroup:R,slicedSegments:G}=ZM(t,v,_,u);if(G.length===0&&R.hasChildren())return this.processChildren(d,u,R,b).pipe(_e(ce=>new Ln(b,ce)));if(u.length===0&&G.length===0)return fe(new Ln(b,[]));let oe=gr(r)===o;return this.processSegment(d,u,R,G,oe?Ce:o,!0,b).pipe(_e(ce=>new Ln(b,ce instanceof Ln?[ce]:[])))}))):Ya(t)))}getChildConfig(e,t,r){return t.children?fe({routes:t.children,injector:e}):t.loadChildren?t._loadedRoutes!==void 0?fe({routes:t._loadedRoutes,injector:t._loadedInjector}):aU(e,t,r,this.urlSerializer).pipe(mt(i=>i?this.configLoader.loadChildren(e,t).pipe(zt(o=>{t._loadedRoutes=o.routes,t._loadedInjector=o.injector})):uU(t))):fe({routes:[],injector:e})}};function wU(n){n.sort((e,t)=>e.value.outlet===Ce?-1:t.value.outlet===Ce?1:e.value.outlet.localeCompare(t.value.outlet))}function CU(n){let e=n.value.routeConfig;return e&&e.path===""}function SP(n){let e=[],t=new Set;for(let r of n){if(!CU(r)){e.push(r);continue}let i=e.find(o=>r.value.routeConfig===o.value.routeConfig);i!==void 0?(i.children.push(...r.children),t.add(i)):e.push(r)}for(let r of t){let i=SP(r.children);e.push(new Ln(r.value,i))}return e.filter(r=>!t.has(r))}function JM(n){return n.data||{}}function XM(n){return n.resolve||{}}function bU(n,e,t,r,i,o){return mt(s=>_U(n,e,t,r,s.extractedUrl,i,o).pipe(_e(({state:a,tree:c})=>le(L({},s),{targetSnapshot:a,urlAfterRedirects:c}))))}function IU(n,e){return mt(t=>{let{targetSnapshot:r,guards:{canActivateChecks:i}}=t;if(!i.length)return fe(t);let o=new Set(i.map(c=>c.route)),s=new Set;for(let c of o)if(!s.has(c))for(let u of TP(c))s.add(u);let a=0;return nt(s).pipe(to(c=>o.has(c)?EU(c,r,n,e):(c.data=Rp(c,c.parent,n).resolve,fe(void 0))),zt(()=>a++),xa(1),mt(c=>a===s.size?fe(t):_n))})}function TP(n){let e=n.children.map(t=>TP(t)).flat();return[n,...e]}function EU(n,e,t,r){let i=n.routeConfig,o=n._resolve;return i?.title!==void 0&&!_P(i)&&(o[Du]=i.title),xU(o,n,e,r).pipe(_e(s=>(n._resolvedData=s,n.data=Rp(n,n.parent,t).resolve,null)))}function xU(n,e,t,r){let i=V0(n);if(i.length===0)return fe({});let o={};return nt(i).pipe(mt(s=>SU(n[s],e,t,r).pipe(Ii(),zt(a=>{if(a instanceof ic)throw kp(new po,a);o[s]=a}))),xa(1),_e(()=>o),bi(s=>IP(s)?_n:ba(s)))}function SU(n,e,t,r){let i=Mu(e)??r,o=sc(n,i),s=o.resolve?o.resolve(e,t):tn(i,()=>o(e,t));return go(s)}function F0(n){return $t(e=>{let t=n(e);return t?nt(t).pipe(_e(()=>e)):fe(e)})}var tw=(()=>{class n{buildTitle(t){let r,i=t.root;for(;i!==void 0;)r=this.getResolvedTitleForRoute(i)??r,i=i.children.find(o=>o.outlet===Ce);return r}getResolvedTitleForRoute(t){return t.data[Du]}static \u0275fac=function(r){return new(r||n)};static \u0275prov=H({token:n,factory:()=>j(DP),providedIn:"root"})}return n})(),DP=(()=>{class n extends tw{title;constructor(t){super(),this.title=t}updateTitle(t){let r=this.buildTitle(t);r!==void 0&&this.title.setTitle(r)}static \u0275fac=function(r){return new(r||n)(ee(qM))};static \u0275prov=H({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),Es=new J("",{providedIn:"root",factory:()=>({})}),xs=new J(""),jp=(()=>{class n{componentLoaders=new WeakMap;childrenLoaders=new WeakMap;onLoadStartListener;onLoadEndListener;compiler=j(sM);loadComponent(t){if(this.componentLoaders.get(t))return this.componentLoaders.get(t);if(t._loadedComponent)return fe(t._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(t);let r=go(t.loadComponent()).pipe(_e(PP),zt(o=>{this.onLoadEndListener&&this.onLoadEndListener(t),t._loadedComponent=o}),Rl(()=>{this.componentLoaders.delete(t)})),i=new _a(r,()=>new ct).pipe(va());return this.componentLoaders.set(t,i),i}loadChildren(t,r){if(this.childrenLoaders.get(r))return this.childrenLoaders.get(r);if(r._loadedRoutes)return fe({routes:r._loadedRoutes,injector:r._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(r);let o=MP(r,this.compiler,t,this.onLoadEndListener).pipe(Rl(()=>{this.childrenLoaders.delete(r)})),s=new _a(o,()=>new ct).pipe(va());return this.childrenLoaders.set(r,s),s}static \u0275fac=function(r){return new(r||n)};static \u0275prov=H({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function MP(n,e,t,r){return go(n.loadChildren()).pipe(_e(PP),mt(i=>i instanceof u0||Array.isArray(i)?fe(i):nt(e.compileModuleAsync(i))),_e(i=>{r&&r(n);let o,s,a=!1;return Array.isArray(i)?(s=i,a=!0):(o=i.create(t).injector,s=o.get(xs,[],{optional:!0,self:!0}).flat()),{routes:s.map(ew),injector:o}}))}function TU(n){return n&&typeof n=="object"&&"default"in n}function PP(n){return TU(n)?n.default:n}var Bp=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275prov=H({token:n,factory:()=>j(DU),providedIn:"root"})}return n})(),DU=(()=>{class n{shouldProcessUrl(t){return!0}extract(t){return t}merge(t,r){return t}static \u0275fac=function(r){return new(r||n)};static \u0275prov=H({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),nw=new J(""),rw=new J("");function AP(n,e,t){let r=n.get(rw),i=n.get(At);return n.get(Pe).runOutsideAngular(()=>{if(!i.startViewTransition||r.skipNextTransition)return r.skipNextTransition=!1,new Promise(u=>setTimeout(u));let o,s=new Promise(u=>{o=u}),a=i.startViewTransition(()=>(o(),MU(n))),{onViewTransitionCreated:c}=r;return c&&tn(n,()=>c({transition:a,from:e,to:t})),s})}function MU(n){return new Promise(e=>{Yy({read:()=>setTimeout(e)},{injector:n})})}var iw=new J(""),Up=(()=>{class n{currentNavigation=null;currentTransition=null;lastSuccessfulNavigation=null;events=new ct;transitionAbortSubject=new ct;configLoader=j(jp);environmentInjector=j(en);destroyRef=j(za);urlSerializer=j(bs);rootContexts=j(Is);location=j(uo);inputBindingEnabled=j(Au,{optional:!0})!==null;titleStrategy=j(tw);options=j(Es,{optional:!0})||{};paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly";urlHandlingStrategy=j(Bp);createViewTransition=j(nw,{optional:!0});navigationErrorHandler=j(iw,{optional:!0});navigationId=0;get hasRequestedNavigation(){return this.navigationId!==0}transitions;afterPreactivation=()=>fe(void 0);rootComponentType=null;destroyed=!1;constructor(){let t=i=>this.events.next(new Sp(i)),r=i=>this.events.next(new Tp(i));this.configLoader.onLoadEndListener=r,this.configLoader.onLoadStartListener=t,this.destroyRef.onDestroy(()=>{this.destroyed=!0})}complete(){this.transitions?.complete()}handleNavigationRequest(t){let r=++this.navigationId;this.transitions?.next(le(L({},t),{extractedUrl:this.urlHandlingStrategy.extract(t.rawUrl),targetSnapshot:null,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null,id:r}))}setupNavigations(t){return this.transitions=new Bt(null),this.transitions.pipe(Ut(r=>r!==null),$t(r=>{let i=!1,o=!1;return fe(r).pipe($t(s=>{if(this.navigationId>r.id)return this.cancelNavigationTransition(r,"",Dn.SupersededByNewNavigation),_n;this.currentTransition=r,this.currentNavigation={id:s.id,initialUrl:s.rawUrl,extractedUrl:s.extractedUrl,targetBrowserUrl:typeof s.extras.browserUrl=="string"?this.urlSerializer.parse(s.extras.browserUrl):s.extras.browserUrl,trigger:s.source,extras:s.extras,previousNavigation:this.lastSuccessfulNavigation?le(L({},this.lastSuccessfulNavigation),{previousNavigation:null}):null};let a=!t.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl(),c=s.extras.onSameUrlNavigation??t.onSameUrlNavigation;if(!a&&c!=="reload"){let u="";return this.events.next(new Kr(s.id,this.urlSerializer.serialize(s.rawUrl),u,ec.IgnoredSameUrlNavigation)),s.resolve(!1),_n}if(this.urlHandlingStrategy.shouldProcessUrl(s.rawUrl))return fe(s).pipe($t(u=>(this.events.next(new mo(u.id,this.urlSerializer.serialize(u.extractedUrl),u.source,u.restoredState)),u.id!==this.navigationId?_n:Promise.resolve(u))),bU(this.environmentInjector,this.configLoader,this.rootComponentType,t.config,this.urlSerializer,this.paramsInheritanceStrategy),zt(u=>{r.targetSnapshot=u.targetSnapshot,r.urlAfterRedirects=u.urlAfterRedirects,this.currentNavigation=le(L({},this.currentNavigation),{finalUrl:u.urlAfterRedirects});let d=new Cu(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(u.urlAfterRedirects),u.targetSnapshot);this.events.next(d)}));if(a&&this.urlHandlingStrategy.shouldProcessUrl(s.currentRawUrl)){let{id:u,extractedUrl:d,source:f,restoredState:v,extras:_}=s,b=new mo(u,this.urlSerializer.serialize(d),f,v);this.events.next(b);let N=gP(this.rootComponentType).snapshot;return this.currentTransition=r=le(L({},s),{targetSnapshot:N,urlAfterRedirects:d,extras:le(L({},_),{skipLocationChange:!1,replaceUrl:!1})}),this.currentNavigation.finalUrl=d,fe(r)}else{let u="";return this.events.next(new Kr(s.id,this.urlSerializer.serialize(s.extractedUrl),u,ec.IgnoredByUrlHandlingStrategy)),s.resolve(!1),_n}}),zt(s=>{let a=new bp(s.id,this.urlSerializer.serialize(s.extractedUrl),this.urlSerializer.serialize(s.urlAfterRedirects),s.targetSnapshot);this.events.next(a)}),_e(s=>(this.currentTransition=r=le(L({},s),{guards:$6(s.targetSnapshot,s.currentSnapshot,this.rootContexts)}),r)),X6(this.environmentInjector,s=>this.events.next(s)),zt(s=>{if(r.guardsResult=s.guardsResult,s.guardsResult&&typeof s.guardsResult!="boolean")throw kp(this.urlSerializer,s.guardsResult);let a=new Ip(s.id,this.urlSerializer.serialize(s.extractedUrl),this.urlSerializer.serialize(s.urlAfterRedirects),s.targetSnapshot,!!s.guardsResult);this.events.next(a)}),Ut(s=>s.guardsResult?!0:(this.cancelNavigationTransition(s,"",Dn.GuardRejected),!1)),F0(s=>{if(s.guards.canActivateChecks.length!==0)return fe(s).pipe(zt(a=>{let c=new Ep(a.id,this.urlSerializer.serialize(a.extractedUrl),this.urlSerializer.serialize(a.urlAfterRedirects),a.targetSnapshot);this.events.next(c)}),$t(a=>{let c=!1;return fe(a).pipe(IU(this.paramsInheritanceStrategy,this.environmentInjector),zt({next:()=>c=!0,complete:()=>{c||this.cancelNavigationTransition(a,"",Dn.NoDataFromResolver)}}))}),zt(a=>{let c=new xp(a.id,this.urlSerializer.serialize(a.extractedUrl),this.urlSerializer.serialize(a.urlAfterRedirects),a.targetSnapshot);this.events.next(c)}))}),F0(s=>{let a=c=>{let u=[];c.routeConfig?.loadComponent&&!c.routeConfig._loadedComponent&&u.push(this.configLoader.loadComponent(c.routeConfig).pipe(zt(d=>{c.component=d}),_e(()=>{})));for(let d of c.children)u.push(...a(d));return u};return Nl(a(s.targetSnapshot.root)).pipe(no(null),hn(1))}),F0(()=>this.afterPreactivation()),$t(()=>{let{currentSnapshot:s,targetSnapshot:a}=r,c=this.createViewTransition?.(this.environmentInjector,s.root,a.root);return c?nt(c).pipe(_e(()=>r)):fe(r)}),_e(s=>{let a=L6(t.routeReuseStrategy,s.targetSnapshot,s.currentRouterState);return this.currentTransition=r=le(L({},s),{targetRouterState:a}),this.currentNavigation.targetRouterState=a,r}),zt(()=>{this.events.next(new bu)}),U6(this.rootContexts,t.routeReuseStrategy,s=>this.events.next(s),this.inputBindingEnabled),hn(1),zt({next:s=>{i=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new vr(s.id,this.urlSerializer.serialize(s.extractedUrl),this.urlSerializer.serialize(s.urlAfterRedirects))),this.titleStrategy?.updateTitle(s.targetRouterState.snapshot),s.resolve(!0)},complete:()=>{i=!0}}),C_(this.transitionAbortSubject.pipe(zt(s=>{throw s}))),Rl(()=>{!i&&!o&&this.cancelNavigationTransition(r,"",Dn.SupersededByNewNavigation),this.currentTransition?.id===r.id&&(this.currentNavigation=null,this.currentTransition=null)}),bi(s=>{if(this.destroyed)return r.resolve(!1),_n;if(o=!0,bP(s))this.events.next(new qr(r.id,this.urlSerializer.serialize(r.extractedUrl),s.message,s.cancellationCode)),B6(s)?this.events.next(new rc(s.url,s.navigationBehaviorOptions)):r.resolve(!1);else{let a=new tc(r.id,this.urlSerializer.serialize(r.extractedUrl),s,r.targetSnapshot??void 0);try{let c=tn(this.environmentInjector,()=>this.navigationErrorHandler?.(a));if(c instanceof ic){let{message:u,cancellationCode:d}=kp(this.urlSerializer,c);this.events.next(new qr(r.id,this.urlSerializer.serialize(r.extractedUrl),u,d)),this.events.next(new rc(c.redirectTo,c.navigationBehaviorOptions))}else throw this.events.next(a),s}catch(c){this.options.resolveNavigationPromiseOnError?r.resolve(!1):r.reject(c)}}return _n}))}))}cancelNavigationTransition(t,r,i){let o=new qr(t.id,this.urlSerializer.serialize(t.extractedUrl),r,i);this.events.next(o),t.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){let t=this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))),r=this.currentNavigation?.targetBrowserUrl??this.currentNavigation?.extractedUrl;return t.toString()!==r?.toString()&&!this.currentNavigation?.extras.skipLocationChange}static \u0275fac=function(r){return new(r||n)};static \u0275prov=H({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function PU(n){return n!==yp}var OP=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275prov=H({token:n,factory:()=>j(AU),providedIn:"root"})}return n})(),Lp=class{shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}},AU=(()=>{class n extends Lp{static \u0275fac=(()=>{let t;return function(i){return(t||(t=Rn(n)))(i||n)}})();static \u0275prov=H({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),NP=(()=>{class n{urlSerializer=j(bs);options=j(Es,{optional:!0})||{};canceledNavigationResolution=this.options.canceledNavigationResolution||"replace";location=j(uo);urlHandlingStrategy=j(Bp);urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred";currentUrlTree=new Gr;getCurrentUrlTree(){return this.currentUrlTree}rawUrlTree=this.currentUrlTree;getRawUrlTree(){return this.rawUrlTree}createBrowserPath({finalUrl:t,initialUrl:r,targetBrowserUrl:i}){let o=t!==void 0?this.urlHandlingStrategy.merge(t,r):r,s=i??o;return s instanceof Gr?this.urlSerializer.serialize(s):s}commitTransition({targetRouterState:t,finalUrl:r,initialUrl:i}){r&&t?(this.currentUrlTree=r,this.rawUrlTree=this.urlHandlingStrategy.merge(r,i),this.routerState=t):this.rawUrlTree=i}routerState=gP(null);getRouterState(){return this.routerState}stateMemento=this.createStateMemento();updateStateMemento(){this.stateMemento=this.createStateMemento()}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}resetInternalState({finalUrl:t}){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,t??this.rawUrlTree)}static \u0275fac=function(r){return new(r||n)};static \u0275prov=H({token:n,factory:()=>j(OU),providedIn:"root"})}return n})(),OU=(()=>{class n extends NP{currentPageId=0;lastSuccessfulId=-1;restoredState(){return this.location.getState()}get browserPageId(){return this.canceledNavigationResolution!=="computed"?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}registerNonRouterCurrentEntryChangeListener(t){return this.location.subscribe(r=>{r.type==="popstate"&&setTimeout(()=>{t(r.url,r.state,"popstate")})})}handleRouterEvent(t,r){t instanceof mo?this.updateStateMemento():t instanceof Kr?this.commitTransition(r):t instanceof Cu?this.urlUpdateStrategy==="eager"&&(r.extras.skipLocationChange||this.setBrowserUrl(this.createBrowserPath(r),r)):t instanceof bu?(this.commitTransition(r),this.urlUpdateStrategy==="deferred"&&!r.extras.skipLocationChange&&this.setBrowserUrl(this.createBrowserPath(r),r)):t instanceof qr&&(t.code===Dn.GuardRejected||t.code===Dn.NoDataFromResolver)?this.restoreHistory(r):t instanceof tc?this.restoreHistory(r,!0):t instanceof vr&&(this.lastSuccessfulId=t.id,this.currentPageId=this.browserPageId)}setBrowserUrl(t,{extras:r,id:i}){let{replaceUrl:o,state:s}=r;if(this.location.isCurrentPathEqualTo(t)||o){let a=this.browserPageId,c=L(L({},s),this.generateNgRouterState(i,a));this.location.replaceState(t,"",c)}else{let a=L(L({},s),this.generateNgRouterState(i,this.browserPageId+1));this.location.go(t,"",a)}}restoreHistory(t,r=!1){if(this.canceledNavigationResolution==="computed"){let i=this.browserPageId,o=this.currentPageId-i;o!==0?this.location.historyGo(o):this.getCurrentUrlTree()===t.finalUrl&&o===0&&(this.resetInternalState(t),this.resetUrlToCurrentUrlTree())}else this.canceledNavigationResolution==="replace"&&(r&&this.resetInternalState(t),this.resetUrlToCurrentUrlTree())}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.getRawUrlTree()),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(t,r){return this.canceledNavigationResolution==="computed"?{navigationId:t,\u0275routerPageId:r}:{navigationId:t}}static \u0275fac=(()=>{let t;return function(i){return(t||(t=Rn(n)))(i||n)}})();static \u0275prov=H({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function $p(n,e){n.events.pipe(Ut(t=>t instanceof vr||t instanceof qr||t instanceof tc||t instanceof Kr),_e(t=>t instanceof vr||t instanceof Kr?0:(t instanceof qr?t.code===Dn.Redirect||t.code===Dn.SupersededByNewNavigation:!1)?2:1),Ut(t=>t!==2),hn(1)).subscribe(()=>{e()})}var NU={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},RU={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},it=(()=>{class n{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}disposed=!1;nonRouterCurrentEntryChangeSubscription;console=j(H1);stateManager=j(NP);options=j(Es,{optional:!0})||{};pendingTasks=j(ms);urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred";navigationTransitions=j(Up);urlSerializer=j(bs);location=j(uo);urlHandlingStrategy=j(Bp);_events=new ct;get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}navigated=!1;routeReuseStrategy=j(OP);onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore";config=j(xs,{optional:!0})?.flat()??[];componentInputBindingEnabled=!!j(Au,{optional:!0});constructor(){this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this).subscribe({error:t=>{this.console.warn(t)}}),this.subscribeToNavigationEvents()}eventsSubscription=new ht;subscribeToNavigationEvents(){let t=this.navigationTransitions.events.subscribe(r=>{try{let i=this.navigationTransitions.currentTransition,o=this.navigationTransitions.currentNavigation;if(i!==null&&o!==null){if(this.stateManager.handleRouterEvent(r,o),r instanceof qr&&r.code!==Dn.Redirect&&r.code!==Dn.SupersededByNewNavigation)this.navigated=!0;else if(r instanceof vr)this.navigated=!0;else if(r instanceof rc){let s=r.navigationBehaviorOptions,a=this.urlHandlingStrategy.merge(r.url,i.currentRawUrl),c=L({browserUrl:i.extras.browserUrl,info:i.extras.info,skipLocationChange:i.extras.skipLocationChange,replaceUrl:i.extras.replaceUrl||this.urlUpdateStrategy==="eager"||PU(i.source)},s);this.scheduleNavigation(a,yp,null,c,{resolve:i.resolve,reject:i.reject,promise:i.promise})}}FU(r)&&this._events.next(r)}catch(i){this.navigationTransitions.transitionAbortSubject.next(i)}});this.eventsSubscription.add(t)}resetRootComponentType(t){this.routerState.root.component=t,this.navigationTransitions.rootComponentType=t}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),yp,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((t,r,i)=>{this.navigateToSyncWithBrowser(t,i,r)})}navigateToSyncWithBrowser(t,r,i){let o={replaceUrl:!0},s=i?.navigationId?i:null;if(i){let c=L({},i);delete c.navigationId,delete c.\u0275routerPageId,Object.keys(c).length!==0&&(o.state=c)}let a=this.parseUrl(t);this.scheduleNavigation(a,r,s,o)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(t){this.config=t.map(ew),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this._events.unsubscribe(),this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription&&(this.nonRouterCurrentEntryChangeSubscription.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(t,r={}){let{relativeTo:i,queryParams:o,fragment:s,queryParamsHandling:a,preserveFragment:c}=r,u=c?this.currentUrlTree.fragment:s,d=null;switch(a??this.options.defaultQueryParamsHandling){case"merge":d=L(L({},this.currentUrlTree.queryParams),o);break;case"preserve":d=this.currentUrlTree.queryParams;break;default:d=o||null}d!==null&&(d=this.removeEmptyProps(d));let f;try{let v=i?i.snapshot:this.routerState.snapshot.root;f=hP(v)}catch{(typeof t[0]!="string"||t[0][0]!=="/")&&(t=[]),f=this.currentUrlTree.root}return fP(f,t,d,u??null)}navigateByUrl(t,r={skipLocationChange:!1}){let i=Xa(t)?t:this.parseUrl(t),o=this.urlHandlingStrategy.merge(i,this.rawUrlTree);return this.scheduleNavigation(o,yp,null,r)}navigate(t,r={skipLocationChange:!1}){return kU(t),this.navigateByUrl(this.createUrlTree(t,r),r)}serializeUrl(t){return this.urlSerializer.serialize(t)}parseUrl(t){try{return this.urlSerializer.parse(t)}catch{return this.urlSerializer.parse("/")}}isActive(t,r){let i;if(r===!0?i=L({},NU):r===!1?i=L({},RU):i=r,Xa(t))return GM(this.currentUrlTree,t,i);let o=this.parseUrl(t);return GM(this.currentUrlTree,o,i)}removeEmptyProps(t){return Object.entries(t).reduce((r,[i,o])=>(o!=null&&(r[i]=o),r),{})}scheduleNavigation(t,r,i,o,s){if(this.disposed)return Promise.resolve(!1);let a,c,u;s?(a=s.resolve,c=s.reject,u=s.promise):u=new Promise((f,v)=>{a=f,c=v});let d=this.pendingTasks.add();return $p(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(d))}),this.navigationTransitions.handleNavigationRequest({source:r,restoredState:i,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:t,extras:o,resolve:a,reject:c,promise:u,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),u.catch(f=>Promise.reject(f))}static \u0275fac=function(r){return new(r||n)};static \u0275prov=H({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function kU(n){for(let e=0;e<n.length;e++)if(n[e]==null)throw new Z(4008,!1)}function FU(n){return!(n instanceof bu)&&!(n instanceof rc)}var Nu=class{};var RP=(()=>{class n{router;injector;preloadingStrategy;loader;subscription;constructor(t,r,i,o){this.router=t,this.injector=r,this.preloadingStrategy=i,this.loader=o}setUpPreloading(){this.subscription=this.router.events.pipe(Ut(t=>t instanceof vr),to(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(t,r){let i=[];for(let o of r){o.providers&&!o._injector&&(o._injector=Jl(o.providers,t,`Route: ${o.path}`));let s=o._injector??t,a=o._loadedInjector??s;(o.loadChildren&&!o._loadedRoutes&&o.canLoad===void 0||o.loadComponent&&!o._loadedComponent)&&i.push(this.preloadConfig(s,o)),(o.children||o._loadedRoutes)&&i.push(this.processRoutes(a,o.children??o._loadedRoutes))}return nt(i).pipe(Ia())}preloadConfig(t,r){return this.preloadingStrategy.preload(r,()=>{let i;r.loadChildren&&r.canLoad===void 0?i=this.loader.loadChildren(t,r):i=fe(null);let o=i.pipe(mt(s=>s===null?fe(void 0):(r._loadedRoutes=s.routes,r._loadedInjector=s.injector,this.processRoutes(s.injector??t,s.routes))));if(r.loadComponent&&!r._loadedComponent){let s=this.loader.loadComponent(r);return nt([o,s]).pipe(Ia())}else return o})}static \u0275fac=function(r){return new(r||n)(ee(it),ee(en),ee(Nu),ee(jp))};static \u0275prov=H({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),kP=new J(""),LU=(()=>{class n{urlSerializer;transitions;viewportScroller;zone;options;routerEventsSubscription;scrollEventsSubscription;lastId=0;lastSource="imperative";restoredId=0;store={};constructor(t,r,i,o,s={}){this.urlSerializer=t,this.transitions=r,this.viewportScroller=i,this.zone=o,this.options=s,s.scrollPositionRestoration||="disabled",s.anchorScrolling||="disabled"}init(){this.options.scrollPositionRestoration!=="disabled"&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(t=>{t instanceof mo?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=t.navigationTrigger,this.restoredId=t.restoredState?t.restoredState.navigationId:0):t instanceof vr?(this.lastId=t.id,this.scheduleScrollEvent(t,this.urlSerializer.parse(t.urlAfterRedirects).fragment)):t instanceof Kr&&t.code===ec.IgnoredSameUrlNavigation&&(this.lastSource=void 0,this.restoredId=0,this.scheduleScrollEvent(t,this.urlSerializer.parse(t.url).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(t=>{t instanceof nc&&(t.position?this.options.scrollPositionRestoration==="top"?this.viewportScroller.scrollToPosition([0,0]):this.options.scrollPositionRestoration==="enabled"&&this.viewportScroller.scrollToPosition(t.position):t.anchor&&this.options.anchorScrolling==="enabled"?this.viewportScroller.scrollToAnchor(t.anchor):this.options.scrollPositionRestoration!=="disabled"&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(t,r){this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.zone.run(()=>{this.transitions.events.next(new nc(t,this.lastSource==="popstate"?this.store[this.restoredId]:null,r))})},0)})}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}static \u0275fac=function(r){N1()};static \u0275prov=H({token:n,factory:n.\u0275fac})}return n})();function sw(n,...e){return En([{provide:xs,multi:!0,useValue:n},[],{provide:qt,useFactory:FP,deps:[it]},{provide:Qf,multi:!0,useFactory:LP},e.map(t=>t.\u0275providers)])}function FP(n){return n.routerState.root}function Ru(n,e){return{\u0275kind:n,\u0275providers:e}}function LP(){let n=j(rt);return e=>{let t=n.get(Vr);if(e!==t.components[0])return;let r=n.get(it),i=n.get(VP);n.get(aw)===1&&r.initialNavigation(),n.get(UP,null,be.Optional)?.setUpPreloading(),n.get(kP,null,be.Optional)?.init(),r.resetRootComponentType(t.componentTypes[0]),i.closed||(i.next(),i.complete(),i.unsubscribe())}}var VP=new J("",{factory:()=>new ct}),aw=new J("",{providedIn:"root",factory:()=>1});function jP(){let n=[{provide:aw,useValue:0},Xl(()=>{let e=j(rt);return e.get(p0,Promise.resolve()).then(()=>new Promise(r=>{let i=e.get(it),o=e.get(VP);$p(i,()=>{r(!0)}),e.get(Up).afterPreactivation=()=>(r(!0),o.closed?fe(void 0):o),i.initialNavigation()}))})];return Ru(2,n)}function BP(){let n=[Xl(()=>{j(it).setUpLocationChangeListener()}),{provide:aw,useValue:2}];return Ru(3,n)}var UP=new J("");function $P(n){return Ru(0,[{provide:UP,useExisting:RP},{provide:Nu,useExisting:n}])}function zP(){return Ru(8,[J0,{provide:Au,useExisting:J0}])}function HP(n){qa("NgRouterViewTransitions");let e=[{provide:nw,useValue:AP},{provide:rw,useValue:L({skipNextTransition:!!n?.skipInitialTransition},n)}];return Ru(9,e)}var WP=[uo,{provide:bs,useClass:po},it,Is,{provide:qt,useFactory:FP,deps:[it]},jp,[]],Ss=(()=>{class n{constructor(){}static forRoot(t,r){return{ngModule:n,providers:[WP,[],{provide:xs,multi:!0,useValue:t},[],r?.errorHandler?{provide:iw,useValue:r.errorHandler}:[],{provide:Es,useValue:r||{}},r?.useHash?jU():BU(),VU(),r?.preloadingStrategy?$P(r.preloadingStrategy).\u0275providers:[],r?.initialNavigation?UU(r):[],r?.bindToComponentInputs?zP().\u0275providers:[],r?.enableViewTransitions?HP().\u0275providers:[],$U()]}}static forChild(t){return{ngModule:n,providers:[{provide:xs,multi:!0,useValue:t}]}}static \u0275fac=function(r){return new(r||n)};static \u0275mod=$r({type:n});static \u0275inj=jr({})}return n})();function VU(){return{provide:kP,useFactory:()=>{let n=j(LM),e=j(Pe),t=j(Es),r=j(Up),i=j(bs);return t.scrollOffset&&n.setOffset(t.scrollOffset),new LU(i,r,n,e,t)}}}function jU(){return{provide:Di,useClass:w0}}function BU(){return{provide:Di,useClass:Xf}}function UU(n){return[n.initialNavigation==="disabled"?BP().\u0275providers:[],n.initialNavigation==="enabledBlocking"?jP().\u0275providers:[]]}var ow=new J("");function $U(){return[{provide:ow,useFactory:LP},{provide:Qf,multi:!0,useExisting:ow}]}var qP=()=>{};var lw={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"};var Y=function(n,e){if(!n)throw Ts(e)},Ts=function(n){return new Error("Firebase Database ("+lw.SDK_VERSION+") INTERNAL ASSERT FAILED: "+n)};var YP=function(n){let e=[],t=0;for(let r=0;r<n.length;r++){let i=n.charCodeAt(r);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):(i&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},HU=function(n){let e=[],t=0,r=0;for(;t<n.length;){let i=n[t++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){let o=n[t++];e[r++]=String.fromCharCode((i&31)<<6|o&63)}else if(i>239&&i<365){let o=n[t++],s=n[t++],a=n[t++],c=((i&7)<<18|(o&63)<<12|(s&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(c>>10)),e[r++]=String.fromCharCode(56320+(c&1023))}else{let o=n[t++],s=n[t++];e[r++]=String.fromCharCode((i&15)<<12|(o&63)<<6|s&63)}}return e.join("")},lc={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();let t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<n.length;i+=3){let o=n[i],s=i+1<n.length,a=s?n[i+1]:0,c=i+2<n.length,u=c?n[i+2]:0,d=o>>2,f=(o&3)<<4|a>>4,v=(a&15)<<2|u>>6,_=u&63;c||(_=64,s||(v=64)),r.push(t[d],t[f],t[v],t[_])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(YP(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):HU(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();let t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<n.length;){let o=t[n.charAt(i++)],a=i<n.length?t[n.charAt(i)]:0;++i;let u=i<n.length?t[n.charAt(i)]:64;++i;let f=i<n.length?t[n.charAt(i)]:64;if(++i,o==null||a==null||u==null||f==null)throw new uw;let v=o<<2|a>>4;if(r.push(v),u!==64){let _=a<<4&240|u>>2;if(r.push(_),f!==64){let b=u<<6&192|f;r.push(b)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}},uw=class extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}},hw=function(n){let e=YP(n);return lc.encodeByteArray(e,!0)},Fu=function(n){return hw(n).replace(/\./g,"")},ac=function(n){try{return lc.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function QP(n){return ZP(void 0,n)}function ZP(n,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:let t=e;return new Date(t.getTime());case Object:n===void 0&&(n={});break;case Array:n=[];break;default:return e}for(let t in e)!e.hasOwnProperty(t)||!WU(t)||(n[t]=ZP(n[t],e[t]));return n}function WU(n){return n!=="__proto__"}function fw(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}var qU=()=>fw().__FIREBASE_DEFAULTS__,GU=()=>{if(typeof process>"u"||typeof process.env>"u")return;let n=process.env.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},KU=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}let e=n&&ac(n[1]);return e&&JSON.parse(e)},Hp=()=>{try{return qP()||qU()||GU()||KU()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},pw=n=>{var e,t;return(t=(e=Hp())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[n]},Wp=n=>{let e=pw(n);if(!e)return;let t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);let r=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),r]:[e.substring(0,t),r]},mw=()=>{var n;return(n=Hp())===null||n===void 0?void 0:n.config},gw=n=>{var e;return(e=Hp())===null||e===void 0?void 0:e[`_${n}`]};var Yr=class{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}};function yr(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}function uc(n){return w(this,null,function*(){return(yield fetch(n,{credentials:"include"})).ok})}function qp(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');let t={alg:"none",type:"JWT"},r=e||"demo-project",i=n.iat||0,o=n.sub||n.user_id;if(!o)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");let s=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:o,user_id:o,firebase:{sign_in_provider:"custom",identities:{}}},n);return[Fu(JSON.stringify(t)),Fu(JSON.stringify(s)),""].join(".")}var ku={};function YU(){let n={prod:[],emulator:[]};for(let e of Object.keys(ku))ku[e]?n.emulator.push(e):n.prod.push(e);return n}function QU(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}var GP=!1;function dc(n,e){if(typeof window>"u"||typeof document>"u"||!yr(window.location.host)||ku[n]===e||ku[n]||GP)return;ku[n]=e;function t(v){return`__firebase__banner__${v}`}let r="__firebase__banner",o=YU().prod.length>0;function s(){let v=document.getElementById(r);v&&v.remove()}function a(v){v.style.display="flex",v.style.background="#7faaf0",v.style.position="fixed",v.style.bottom="5px",v.style.left="5px",v.style.padding=".5em",v.style.borderRadius="5px",v.style.alignItems="center"}function c(v,_){v.setAttribute("width","24"),v.setAttribute("id",_),v.setAttribute("height","24"),v.setAttribute("viewBox","0 0 24 24"),v.setAttribute("fill","none"),v.style.marginLeft="-6px"}function u(){let v=document.createElement("span");return v.style.cursor="pointer",v.style.marginLeft="16px",v.style.fontSize="24px",v.innerHTML=" &times;",v.onclick=()=>{GP=!0,s()},v}function d(v,_){v.setAttribute("id",_),v.innerText="Learn more",v.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",v.setAttribute("target","__blank"),v.style.paddingLeft="5px",v.style.textDecoration="underline"}function f(){let v=QU(r),_=t("text"),b=document.getElementById(_)||document.createElement("span"),N=t("learnmore"),R=document.getElementById(N)||document.createElement("a"),G=t("preprendIcon"),oe=document.getElementById(G)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(v.created){let ce=v.element;a(ce),d(R,N);let Fe=u();c(oe,G),ce.append(oe,b,R,Fe),document.body.appendChild(ce)}o?(b.innerText="Preview backend disconnected.",oe.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(oe.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,b.innerText="Preview backend running in this workspace."),b.setAttribute("id",_)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",f):f()}function Nt(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function Lu(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Nt())}function ZU(){var n;let e=(n=Hp())===null||n===void 0?void 0:n.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function JP(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function XP(){let n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function Gp(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function eA(){let n=Nt();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function Qr(){return lw.NODE_CLIENT===!0||lw.NODE_ADMIN===!0}function tA(){return!ZU()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Vu(){try{return typeof indexedDB=="object"}catch{return!1}}function nA(){return new Promise((n,e)=>{try{let t=!0,r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{var o;e(((o=i.error)===null||o===void 0?void 0:o.message)||"")}}catch(t){e(t)}})}var JU="FirebaseError",jn=class n extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=JU,Object.setPrototypeOf(this,n.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,_r.prototype.create)}},_r=class{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){let r=t[0]||{},i=`${this.service}/${e}`,o=this.errors[e],s=o?XU(o,r):"Error",a=`${this.serviceName}: ${s} (${i}).`;return new jn(i,a,r)}};function XU(n,e){return n.replace(e$,(t,r)=>{let i=e[r];return i!=null?String(i):`<${r}?>`})}var e$=/\{\$([^}]+)}/g;function cc(n){return JSON.parse(n)}function Rt(n){return JSON.stringify(n)}var rA=function(n){let e={},t={},r={},i="";try{let o=n.split(".");e=cc(ac(o[0])||""),t=cc(ac(o[1])||""),i=o[2],r=t.d||{},delete t.d}catch{}return{header:e,claims:t,data:r,signature:i}};var iA=function(n){let e=rA(n),t=e.claims;return!!t&&typeof t=="object"&&t.hasOwnProperty("iat")},oA=function(n){let e=rA(n).claims;return typeof e=="object"&&e.admin===!0};function Zr(n,e){return Object.prototype.hasOwnProperty.call(n,e)}function Ds(n,e){if(Object.prototype.hasOwnProperty.call(n,e))return n[e]}function ju(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function Bu(n,e,t){let r={};for(let i in n)Object.prototype.hasOwnProperty.call(n,i)&&(r[i]=e.call(t,n[i],i,n));return r}function Qn(n,e){if(n===e)return!0;let t=Object.keys(n),r=Object.keys(e);for(let i of t){if(!r.includes(i))return!1;let o=n[i],s=e[i];if(KP(o)&&KP(s)){if(!Qn(o,s))return!1}else if(o!==s)return!1}for(let i of r)if(!t.includes(i))return!1;return!0}function KP(n){return n!==null&&typeof n=="object"}function Ms(n){let e=[];for(let[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function hc(n){let e={};return n.replace(/^\?/,"").split("&").forEach(r=>{if(r){let[i,o]=r.split("=");e[decodeURIComponent(i)]=decodeURIComponent(o)}}),e}function fc(n){let e=n.indexOf("?");if(!e)return"";let t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}var zp=class{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=512/8,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,t){t||(t=0);let r=this.W_;if(typeof e=="string")for(let f=0;f<16;f++)r[f]=e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|e.charCodeAt(t+3),t+=4;else for(let f=0;f<16;f++)r[f]=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3],t+=4;for(let f=16;f<80;f++){let v=r[f-3]^r[f-8]^r[f-14]^r[f-16];r[f]=(v<<1|v>>>31)&4294967295}let i=this.chain_[0],o=this.chain_[1],s=this.chain_[2],a=this.chain_[3],c=this.chain_[4],u,d;for(let f=0;f<80;f++){f<40?f<20?(u=a^o&(s^a),d=1518500249):(u=o^s^a,d=1859775393):f<60?(u=o&s|a&(o|s),d=2400959708):(u=o^s^a,d=3395469782);let v=(i<<5|i>>>27)+u+c+d+r[f]&4294967295;c=a,a=s,s=(o<<30|o>>>2)&4294967295,o=i,i=v}this.chain_[0]=this.chain_[0]+i&4294967295,this.chain_[1]=this.chain_[1]+o&4294967295,this.chain_[2]=this.chain_[2]+s&4294967295,this.chain_[3]=this.chain_[3]+a&4294967295,this.chain_[4]=this.chain_[4]+c&4294967295}update(e,t){if(e==null)return;t===void 0&&(t=e.length);let r=t-this.blockSize,i=0,o=this.buf_,s=this.inbuf_;for(;i<t;){if(s===0)for(;i<=r;)this.compress_(e,i),i+=this.blockSize;if(typeof e=="string"){for(;i<t;)if(o[s]=e.charCodeAt(i),++s,++i,s===this.blockSize){this.compress_(o),s=0;break}}else for(;i<t;)if(o[s]=e[i],++s,++i,s===this.blockSize){this.compress_(o),s=0;break}}this.inbuf_=s,this.total_+=t}digest(){let e=[],t=this.total_*8;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let i=this.blockSize-1;i>=56;i--)this.buf_[i]=t&255,t/=256;this.compress_(this.buf_);let r=0;for(let i=0;i<5;i++)for(let o=24;o>=0;o-=8)e[r]=this.chain_[i]>>o&255,++r;return e}};function sA(n,e){let t=new dw(n,e);return t.subscribe.bind(t)}var dw=class{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let i;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");t$(e,["next","error","complete"])?i=e:i={next:e,error:t,complete:r},i.next===void 0&&(i.next=cw),i.error===void 0&&(i.error=cw),i.complete===void 0&&(i.complete=cw);let o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),o}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}};function t$(n,e){if(typeof n!="object"||n===null)return!1;for(let t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function cw(){}function aA(n,e){return`${n} failed: ${e} argument `}var cA=function(n){let e=[],t=0;for(let r=0;r<n.length;r++){let i=n.charCodeAt(r);if(i>=55296&&i<=56319){let o=i-55296;r++,Y(r<n.length,"Surrogate pair missing trail surrogate.");let s=n.charCodeAt(r)-56320;i=65536+(o<<10)+s}i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):i<65536?(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},Uu=function(n){let e=0;for(let t=0;t<n.length;t++){let r=n.charCodeAt(t);r<128?e++:r<2048?e+=2:r>=55296&&r<=56319?(e+=4,t++):e+=3}return e};var hse=4*60*60*1e3;function lt(n){return n&&n._delegate?n._delegate:n}var Gt=class{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}};var Ps="[DEFAULT]";var Kp=class{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){let t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){let r=new Yr;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{let i=this.getOrInitializeService({instanceIdentifier:t});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;let r=this.normalizeInstanceIdentifier(e?.identifier),i=(t=e?.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(o){if(i)return null;throw o}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(r$(e))try{this.getOrInitializeService({instanceIdentifier:Ps})}catch{}for(let[t,r]of this.instancesDeferred.entries()){let i=this.normalizeInstanceIdentifier(t);try{let o=this.getOrInitializeService({instanceIdentifier:i});r.resolve(o)}catch{}}}}clearInstance(e=Ps){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}delete(){return w(this,null,function*(){let e=Array.from(this.instances.values());yield Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])})}isComponentSet(){return this.component!=null}isInitialized(e=Ps){return this.instances.has(e)}getOptions(e=Ps){return this.instancesOptions.get(e)||{}}initialize(e={}){let{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);let i=this.getOrInitializeService({instanceIdentifier:r,options:t});for(let[o,s]of this.instancesDeferred.entries()){let a=this.normalizeInstanceIdentifier(o);r===a&&s.resolve(i)}return i}onInit(e,t){var r;let i=this.normalizeInstanceIdentifier(t),o=(r=this.onInitCallbacks.get(i))!==null&&r!==void 0?r:new Set;o.add(e),this.onInitCallbacks.set(i,o);let s=this.instances.get(i);return s&&e(s,i),()=>{o.delete(e)}}invokeOnInitCallbacks(e,t){let r=this.onInitCallbacks.get(t);if(r)for(let i of r)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:n$(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Ps){return this.component?this.component.multipleInstances?e:Ps:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}};function n$(n){return n===Ps?void 0:n}function r$(n){return n.instantiationMode==="EAGER"}var $u=class{constructor(e){this.name=e,this.providers=new Map}addComponent(e){let t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);let t=new Kp(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}};var i$=[],Ee=function(n){return n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT",n}(Ee||{}),o$={debug:Ee.DEBUG,verbose:Ee.VERBOSE,info:Ee.INFO,warn:Ee.WARN,error:Ee.ERROR,silent:Ee.SILENT},s$=Ee.INFO,a$={[Ee.DEBUG]:"log",[Ee.VERBOSE]:"log",[Ee.INFO]:"info",[Ee.WARN]:"warn",[Ee.ERROR]:"error"},c$=(n,e,...t)=>{if(e<n.logLevel)return;let r=new Date().toISOString(),i=a$[e];if(i)console[i](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)},Zn=class{constructor(e){this.name=e,this._logLevel=s$,this._logHandler=c$,this._userLogHandler=null,i$.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Ee))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?o$[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Ee.DEBUG,...e),this._logHandler(this,Ee.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Ee.VERBOSE,...e),this._logHandler(this,Ee.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Ee.INFO,...e),this._logHandler(this,Ee.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Ee.WARN,...e),this._logHandler(this,Ee.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Ee.ERROR,...e),this._logHandler(this,Ee.ERROR,...e)}};var l$=(n,e)=>e.some(t=>n instanceof t),lA,uA;function u$(){return lA||(lA=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function d$(){return uA||(uA=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}var dA=new WeakMap,_w=new WeakMap,hA=new WeakMap,vw=new WeakMap,ww=new WeakMap;function h$(n){let e=new Promise((t,r)=>{let i=()=>{n.removeEventListener("success",o),n.removeEventListener("error",s)},o=()=>{t(Jr(n.result)),i()},s=()=>{r(n.error),i()};n.addEventListener("success",o),n.addEventListener("error",s)});return e.then(t=>{t instanceof IDBCursor&&dA.set(t,n)}).catch(()=>{}),ww.set(e,n),e}function f$(n){if(_w.has(n))return;let e=new Promise((t,r)=>{let i=()=>{n.removeEventListener("complete",o),n.removeEventListener("error",s),n.removeEventListener("abort",s)},o=()=>{t(),i()},s=()=>{r(n.error||new DOMException("AbortError","AbortError")),i()};n.addEventListener("complete",o),n.addEventListener("error",s),n.addEventListener("abort",s)});_w.set(n,e)}var yw={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return _w.get(n);if(e==="objectStoreNames")return n.objectStoreNames||hA.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Jr(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function fA(n){yw=n(yw)}function p$(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){let r=n.call(Yp(this),e,...t);return hA.set(r,e.sort?e.sort():[e]),Jr(r)}:d$().includes(n)?function(...e){return n.apply(Yp(this),e),Jr(dA.get(this))}:function(...e){return Jr(n.apply(Yp(this),e))}}function m$(n){return typeof n=="function"?p$(n):(n instanceof IDBTransaction&&f$(n),l$(n,u$())?new Proxy(n,yw):n)}function Jr(n){if(n instanceof IDBRequest)return h$(n);if(vw.has(n))return vw.get(n);let e=m$(n);return e!==n&&(vw.set(n,e),ww.set(e,n)),e}var Yp=n=>ww.get(n);function mA(n,e,{blocked:t,upgrade:r,blocking:i,terminated:o}={}){let s=indexedDB.open(n,e),a=Jr(s);return r&&s.addEventListener("upgradeneeded",c=>{r(Jr(s.result),c.oldVersion,c.newVersion,Jr(s.transaction),c)}),t&&s.addEventListener("blocked",c=>t(c.oldVersion,c.newVersion,c)),a.then(c=>{o&&c.addEventListener("close",()=>o()),i&&c.addEventListener("versionchange",u=>i(u.oldVersion,u.newVersion,u))}).catch(()=>{}),a}var g$=["get","getKey","getAll","getAllKeys","count"],v$=["put","add","delete","clear"],Cw=new Map;function pA(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(Cw.get(e))return Cw.get(e);let t=e.replace(/FromIndex$/,""),r=e!==t,i=v$.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(i||g$.includes(t)))return;let o=function(s,...a){return w(this,null,function*(){let c=this.transaction(s,i?"readwrite":"readonly"),u=c.store;return r&&(u=u.index(a.shift())),(yield Promise.all([u[t](...a),i&&c.done]))[0]})};return Cw.set(e,o),o}fA(n=>le(L({},n),{get:(e,t,r)=>pA(e,t)||n.get(e,t,r),has:(e,t)=>!!pA(e,t)||n.has(e,t)}));var Iw=class{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(_$(t)){let r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}};function _$(n){let e=n.getComponent();return e?.type==="VERSION"}var Ew="@firebase/app",gA="0.13.2";var Pi=new Zn("@firebase/app"),y$="@firebase/app-compat",w$="@firebase/analytics-compat",C$="@firebase/analytics",b$="@firebase/app-check-compat",I$="@firebase/app-check",E$="@firebase/auth",x$="@firebase/auth-compat",S$="@firebase/database",T$="@firebase/data-connect",D$="@firebase/database-compat",M$="@firebase/functions",P$="@firebase/functions-compat",A$="@firebase/installations",O$="@firebase/installations-compat",N$="@firebase/messaging",R$="@firebase/messaging-compat",k$="@firebase/performance",F$="@firebase/performance-compat",L$="@firebase/remote-config",V$="@firebase/remote-config-compat",j$="@firebase/storage",B$="@firebase/storage-compat",U$="@firebase/firestore",$$="@firebase/ai",z$="@firebase/firestore-compat",H$="firebase",W$="11.10.0";var xw="[DEFAULT]",q$={[Ew]:"fire-core",[y$]:"fire-core-compat",[C$]:"fire-analytics",[w$]:"fire-analytics-compat",[I$]:"fire-app-check",[b$]:"fire-app-check-compat",[E$]:"fire-auth",[x$]:"fire-auth-compat",[S$]:"fire-rtdb",[T$]:"fire-data-connect",[D$]:"fire-rtdb-compat",[M$]:"fire-fn",[P$]:"fire-fn-compat",[A$]:"fire-iid",[O$]:"fire-iid-compat",[N$]:"fire-fcm",[R$]:"fire-fcm-compat",[k$]:"fire-perf",[F$]:"fire-perf-compat",[L$]:"fire-rc",[V$]:"fire-rc-compat",[j$]:"fire-gcs",[B$]:"fire-gcs-compat",[U$]:"fire-fst",[z$]:"fire-fst-compat",[$$]:"fire-vertex","fire-js":"fire-js",[H$]:"fire-js-all"};var zu=new Map,G$=new Map,Sw=new Map;function vA(n,e){try{n.container.addComponent(e)}catch(t){Pi.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function Bn(n){let e=n.name;if(Sw.has(e))return Pi.debug(`There were multiple attempts to register component ${e}.`),!1;Sw.set(e,n);for(let t of zu.values())vA(t,n);for(let t of G$.values())vA(t,n);return!0}function yo(n,e){let t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function vn(n){return n==null?!1:n.settings!==void 0}var K$={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},_o=new _r("app","Firebase",K$);var Tw=class{constructor(e,t,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Gt("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw _o.create("app-deleted",{appName:this._name})}};var Xr=W$;function Pw(n,e={}){let t=n;typeof e!="object"&&(e={name:e});let r=Object.assign({name:xw,automaticDataCollectionEnabled:!0},e),i=r.name;if(typeof i!="string"||!i)throw _o.create("bad-app-name",{appName:String(i)});if(t||(t=mw()),!t)throw _o.create("no-options");let o=zu.get(i);if(o){if(Qn(t,o.options)&&Qn(r,o.config))return o;throw _o.create("duplicate-app",{appName:i})}let s=new $u(i);for(let c of Sw.values())s.addComponent(c);let a=new Tw(t,r,s);return zu.set(i,a),a}function Ai(n=xw){let e=zu.get(n);if(!e&&n===xw&&mw())return Pw();if(!e)throw _o.create("no-app",{appName:n});return e}function Qp(){return Array.from(zu.values())}function Je(n,e,t){var r;let i=(r=q$[n])!==null&&r!==void 0?r:n;t&&(i+=`-${t}`);let o=i.match(/\s|\//),s=e.match(/\s|\//);if(o||s){let a=[`Unable to register library "${i}" with version "${e}":`];o&&a.push(`library name "${i}" contains illegal characters (whitespace or "/")`),o&&s&&a.push("and"),s&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Pi.warn(a.join(" "));return}Bn(new Gt(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}var Y$="firebase-heartbeat-database",Q$=1,Hu="firebase-heartbeat-store",bw=null;function CA(){return bw||(bw=mA(Y$,Q$,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(Hu)}catch(t){console.warn(t)}}}}).catch(n=>{throw _o.create("idb-open",{originalErrorMessage:n.message})})),bw}function Z$(n){return w(this,null,function*(){try{let t=(yield CA()).transaction(Hu),r=yield t.objectStore(Hu).get(bA(n));return yield t.done,r}catch(e){if(e instanceof jn)Pi.warn(e.message);else{let t=_o.create("idb-get",{originalErrorMessage:e?.message});Pi.warn(t.message)}}})}function _A(n,e){return w(this,null,function*(){try{let r=(yield CA()).transaction(Hu,"readwrite");yield r.objectStore(Hu).put(e,bA(n)),yield r.done}catch(t){if(t instanceof jn)Pi.warn(t.message);else{let r=_o.create("idb-set",{originalErrorMessage:t?.message});Pi.warn(r.message)}}})}function bA(n){return`${n.name}!${n.options.appId}`}var J$=1024,X$=30,Dw=class{constructor(e){this.container=e,this._heartbeatsCache=null;let t=this.container.getProvider("app").getImmediate();this._storage=new Mw(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}triggerHeartbeat(){return w(this,null,function*(){var e,t;try{let i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),o=yA();if(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=yield this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===o||this._heartbeatsCache.heartbeats.some(s=>s.date===o))return;if(this._heartbeatsCache.heartbeats.push({date:o,agent:i}),this._heartbeatsCache.heartbeats.length>X$){let s=t8(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(s,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){Pi.warn(r)}})}getHeartbeatsHeader(){return w(this,null,function*(){var e;try{if(this._heartbeatsCache===null&&(yield this._heartbeatsCachePromise),((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";let t=yA(),{heartbeatsToSend:r,unsentEntries:i}=e8(this._heartbeatsCache.heartbeats),o=Fu(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=t,i.length>0?(this._heartbeatsCache.heartbeats=i,yield this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),o}catch(t){return Pi.warn(t),""}})}};function yA(){return new Date().toISOString().substring(0,10)}function e8(n,e=J$){let t=[],r=n.slice();for(let i of n){let o=t.find(s=>s.agent===i.agent);if(o){if(o.dates.push(i.date),wA(t)>e){o.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),wA(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}var Mw=class{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}runIndexedDBEnvironmentCheck(){return w(this,null,function*(){return Vu()?nA().then(()=>!0).catch(()=>!1):!1})}read(){return w(this,null,function*(){if(yield this._canUseIndexedDBPromise){let t=yield Z$(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}})}overwrite(e){return w(this,null,function*(){var t;if(yield this._canUseIndexedDBPromise){let i=yield this.read();return _A(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return})}add(e){return w(this,null,function*(){var t;if(yield this._canUseIndexedDBPromise){let i=yield this.read();return _A(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return})}};function wA(n){return Fu(JSON.stringify({version:2,heartbeats:n})).length}function t8(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let r=1;r<n.length;r++)n[r].date<t&&(t=n[r].date,e=r);return e}function n8(n){Bn(new Gt("platform-logger",e=>new Iw(e),"PRIVATE")),Bn(new Gt("heartbeat",e=>new Dw(e),"PRIVATE")),Je(Ew,gA,n),Je(Ew,gA,"esm2017"),Je("fire-js","")}n8("");var r8="firebase",i8="11.10.0";Je(r8,i8,"app");function Aw(n){n===void 0&&(Oy(Aw),n=j(rt));let e=n.get(Hf);return t=>new me(r=>{let i=e.add(),o=!1;function s(){o||(i(),o=!0)}let a=t.subscribe({next:c=>{r.next(c),s()},complete:()=>{r.complete(),s()},error:c=>{r.error(c),s()}});return a.add(()=>{r.unsubscribe(),s()}),a})}var ei=new fs("ANGULARFIRE2_VERSION");function Os(n,e,t){if(e){if(e.length===1)return e[0];let o=e.filter(s=>s.app===t);if(o.length===1)return o[0]}return t.container.getProvider(n).getImmediate({optional:!0})}var wo=(n,e)=>{let t=e?[e]:Qp(),r=[];return t.forEach(i=>{i.container.getProvider(n).instances.forEach(s=>{r.includes(s)||r.push(s)})}),r},pc=function(n){return n[n.SILENT=0]="SILENT",n[n.WARN=1]="WARN",n[n.VERBOSE=2]="VERBOSE",n}(pc||{}),IA=nu()&&typeof Zone<"u"?pc.WARN:pc.SILENT;var Zp=class{zone;delegate;constructor(e,t=g_){this.zone=e,this.delegate=t}now(){return this.delegate.now()}schedule(e,t,r){let i=this.zone,o=function(s){i?i.runGuarded(()=>{e.apply(this,[s])}):e.apply(this,[s])};return this.delegate.schedule(o,t,r)}},ti=(()=>{class n{outsideAngular;insideAngular;constructor(){let t=j(Pe);this.outsideAngular=t.runOutsideAngular(()=>new Zp(typeof Zone>"u"?void 0:Zone.current)),this.insideAngular=t.run(()=>new Zp(typeof Zone>"u"?void 0:Zone.current,m_))}static \u0275fac=function(r){return new(r||n)};static \u0275prov=H({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),EA=!1;function o8(n,e){!EA&&(IA>pc.SILENT||nu())&&(EA=!0,console.warn("Calling Firebase APIs outside of an Injection context may destabilize your application leading to subtle change-detection and hydration bugs. Find more at https://github.com/angular/angularfire/blob/main/docs/zones.md")),IA>=e&&console.warn(`Firebase API called outside injection context: ${n.name}`)}function s8(n){let e=j(Pe,{optional:!0});return e?e.runOutsideAngular(()=>n()):n()}function As(n){let e=j(Pe,{optional:!0});return e?e.run(()=>n()):n()}var a8=(n,e,t)=>(...r)=>(e&&setTimeout(e,0),tn(t,()=>As(()=>n.apply(void 0,r)))),gt=(n,e,t)=>(t||=e?pc.WARN:pc.VERBOSE,function(){let r,i=arguments,o,s,a;try{o=j(ti),s=j(Hf),a=j(en)}catch{return o8(n,t),n.apply(this,i)}for(let u=0;u<arguments.length;u++)typeof i[u]=="function"&&(e&&(r||=As(()=>s.add())),i[u]=a8(i[u],r,a));let c=s8(()=>n.apply(this,i));return e?c instanceof me?c.pipe(eo(o.outsideAngular),Xi(o.insideAngular),Aw(a)):c instanceof Promise?As(()=>new Promise((u,d)=>{s.run(()=>c).then(f=>tn(a,()=>As(()=>u(f))),f=>tn(a,()=>As(()=>d(f))))})):typeof c=="function"&&r?function(){return setTimeout(r,0),c.apply(this,arguments)}:As(()=>c):c instanceof me?c.pipe(eo(o.outsideAngular),Xi(o.insideAngular)):As(()=>c)});var wr=class{constructor(e){return e}},Oi=class{constructor(){return Qp()}};function c8(n){return n&&n.length===1?n[0]:new wr(Ai())}var Ow=new J("angularfire2._apps"),l8={provide:wr,useFactory:c8,deps:[[new Mt,Ow]]},u8={provide:Oi,deps:[[new Mt,Ow]]};function d8(n){return(e,t)=>{let r=t.get(co);Je("angularfire",ei.full,"core"),Je("angularfire",ei.full,"app"),Je("angular",oM.full,r.toString());let i=e.runOutsideAngular(()=>n(t));return new wr(i)}}function xA(n,...e){return En([l8,u8,{provide:Ow,useFactory:d8(n),multi:!0,deps:[Pe,rt,ti,...e]}])}var SA=gt(Pw,!0);var h8=new Map,f8={activated:!1,tokenObservers:[]},p8={initialized:!1,enabled:!1};function Cr(n){return h8.get(n)||Object.assign({},f8)}function PA(){return p8}var m8="https://content-firebaseappcheck.googleapis.com/v1";var g8="exchangeDebugToken",TA={OFFSET_DURATION:5*60*1e3,RETRIAL_MIN_WAIT:30*1e3,RETRIAL_MAX_WAIT:16*60*1e3},_ae=24*60*60*1e3;var kw=class{constructor(e,t,r,i,o){if(this.operation=e,this.retryPolicy=t,this.getWaitDuration=r,this.lowerBound=i,this.upperBound=o,this.pending=null,this.nextErrorWaitInterval=i,i>o)throw new Error("Proactive refresh lower bound greater than upper bound!")}start(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(()=>{})}stop(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}isRunning(){return!!this.pending}process(e){return w(this,null,function*(){this.stop();try{this.pending=new Yr,this.pending.promise.catch(t=>{}),yield v8(this.getNextRun(e)),this.pending.resolve(),yield this.pending.promise,this.pending=new Yr,this.pending.promise.catch(t=>{}),yield this.operation(),this.pending.resolve(),yield this.pending.promise,this.process(!0).catch(()=>{})}catch(t){this.retryPolicy(t)?this.process(!1).catch(()=>{}):this.stop()}})}getNextRun(e){if(e)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();{let t=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),t}}};function v8(n){return new Promise(e=>{setTimeout(e,n)})}var _8={"already-initialized":"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.","use-before-activation":"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.","fetch-network-error":"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-parse-error":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status-error":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","recaptcha-error":"ReCAPTCHA error.","initial-throttle":"{$httpStatus} error. Attempts allowed again after {$time}",throttled:"Requests throttled due to previous {$httpStatus} error. Attempts allowed again after {$time}"},Co=new _r("appCheck","AppCheck",_8);function AA(n){if(!Cr(n).activated)throw Co.create("use-before-activation",{appName:n.name})}function OA(r,i){return w(this,arguments,function*({url:n,body:e},t){let o={"Content-Type":"application/json"},s=t.getImmediate({optional:!0});if(s){let _=yield s.getHeartbeatsHeader();_&&(o["X-Firebase-Client"]=_)}let a={method:"POST",body:JSON.stringify(e),headers:o},c;try{c=yield fetch(n,a)}catch(_){throw Co.create("fetch-network-error",{originalErrorMessage:_?.message})}if(c.status!==200)throw Co.create("fetch-status-error",{httpStatus:c.status});let u;try{u=yield c.json()}catch(_){throw Co.create("fetch-parse-error",{originalErrorMessage:_?.message})}let d=u.ttl.match(/^([\d.]+)(s)$/);if(!d||!d[2]||isNaN(Number(d[1])))throw Co.create("fetch-parse-error",{originalErrorMessage:`ttl field (timeToLive) is not in standard Protobuf Duration format: ${u.ttl}`});let f=Number(d[1])*1e3,v=Date.now();return{token:u.token,expireTimeMillis:v+f,issuedAtTimeMillis:v}})}function NA(n,e){let{projectId:t,appId:r,apiKey:i}=n.options;return{url:`${m8}/projects/${t}/apps/${r}:${g8}?key=${i}`,body:{debug_token:e}}}var y8="firebase-app-check-database",w8=1,Fw="firebase-app-check-store";var Jp=null;function C8(){return Jp||(Jp=new Promise((n,e)=>{try{let t=indexedDB.open(y8,w8);t.onsuccess=r=>{n(r.target.result)},t.onerror=r=>{var i;e(Co.create("storage-open",{originalErrorMessage:(i=r.target.error)===null||i===void 0?void 0:i.message}))},t.onupgradeneeded=r=>{let i=r.target.result;switch(r.oldVersion){case 0:i.createObjectStore(Fw,{keyPath:"compositeKey"})}}}catch(t){e(Co.create("storage-open",{originalErrorMessage:t?.message}))}}),Jp)}function b8(n,e){return I8(E8(n),e)}function I8(n,e){return w(this,null,function*(){let r=(yield C8()).transaction(Fw,"readwrite"),o=r.objectStore(Fw).put({compositeKey:n,value:e});return new Promise((s,a)=>{o.onsuccess=c=>{s()},r.onerror=c=>{var u;a(Co.create("storage-set",{originalErrorMessage:(u=c.target.error)===null||u===void 0?void 0:u.message}))}})})}function E8(n){return`${n.options.appId}-${n.name}`}var Wu=new Zn("@firebase/app-check");function Nw(n,e){return Vu()?b8(n,e).catch(t=>{Wu.warn(`Failed to write token to IndexedDB. Error: ${t}`)}):Promise.resolve()}function RA(){return PA().enabled}function kA(){return w(this,null,function*(){let n=PA();if(n.enabled&&n.token)return n.token.promise;throw Error(`
            Can't get debug token in production mode.
        `)})}var x8={error:"UNKNOWN_ERROR"};function S8(n){return lc.encodeString(JSON.stringify(n),!1)}function Lw(n,e=!1,t=!1){return w(this,null,function*(){let r=n.app;AA(r);let i=Cr(r),o=i.token,s;if(o&&!qu(o)&&(i.token=void 0,o=void 0),!o){let u=yield i.cachedTokenPromise;u&&(qu(u)?o=u:yield Nw(r,void 0))}if(!e&&o&&qu(o))return{token:o.token};let a=!1;if(RA())try{i.exchangeTokenPromise||(i.exchangeTokenPromise=OA(NA(r,yield kA()),n.heartbeatServiceProvider).finally(()=>{i.exchangeTokenPromise=void 0}),a=!0);let u=yield i.exchangeTokenPromise;return yield Nw(r,u),i.token=u,{token:u.token}}catch(u){return u.code==="appCheck/throttled"||u.code==="appCheck/initial-throttle"?Wu.warn(u.message):t&&Wu.error(u),Rw(u)}try{i.exchangeTokenPromise||(i.exchangeTokenPromise=i.provider.getToken().finally(()=>{i.exchangeTokenPromise=void 0}),a=!0),o=yield Cr(r).exchangeTokenPromise}catch(u){u.code==="appCheck/throttled"||u.code==="appCheck/initial-throttle"?Wu.warn(u.message):t&&Wu.error(u),s=u}let c;return o?s?qu(o)?c={token:o.token,internalError:s}:c=Rw(s):(c={token:o.token},i.token=o,yield Nw(r,o)):c=Rw(s),a&&P8(r,c),c})}function T8(n){return w(this,null,function*(){let e=n.app;AA(e);let{provider:t}=Cr(e);if(RA()){let r=yield kA(),{token:i}=yield OA(NA(e,r),n.heartbeatServiceProvider);return{token:i}}else{let{token:r}=yield t.getToken();return{token:r}}})}function D8(n,e,t,r){let{app:i}=n,o=Cr(i),s={next:t,error:r,type:e};if(o.tokenObservers=[...o.tokenObservers,s],o.token&&qu(o.token)){let a=o.token;Promise.resolve().then(()=>{t({token:a.token}),DA(n)}).catch(()=>{})}o.cachedTokenPromise.then(()=>DA(n))}function FA(n,e){let t=Cr(n),r=t.tokenObservers.filter(i=>i.next!==e);r.length===0&&t.tokenRefresher&&t.tokenRefresher.isRunning()&&t.tokenRefresher.stop(),t.tokenObservers=r}function DA(n){let{app:e}=n,t=Cr(e),r=t.tokenRefresher;r||(r=M8(n),t.tokenRefresher=r),!r.isRunning()&&t.isTokenAutoRefreshEnabled&&r.start()}function M8(n){let{app:e}=n;return new kw(()=>w(null,null,function*(){let t=Cr(e),r;if(t.token?r=yield Lw(n,!0):r=yield Lw(n),r.error)throw r.error;if(r.internalError)throw r.internalError}),()=>!0,()=>{let t=Cr(e);if(t.token){let r=t.token.issuedAtTimeMillis+(t.token.expireTimeMillis-t.token.issuedAtTimeMillis)*.5+3e5,i=t.token.expireTimeMillis-5*60*1e3;return r=Math.min(r,i),Math.max(0,r-Date.now())}else return 0},TA.RETRIAL_MIN_WAIT,TA.RETRIAL_MAX_WAIT)}function P8(n,e){let t=Cr(n).tokenObservers;for(let r of t)try{r.type==="EXTERNAL"&&e.error!=null?r.error(e.error):r.next(e)}catch{}}function qu(n){return n.expireTimeMillis-Date.now()>0}function Rw(n){return{token:S8(x8),error:n}}var Vw=class{constructor(e,t){this.app=e,this.heartbeatServiceProvider=t}_delete(){let{tokenObservers:e}=Cr(this.app);for(let t of e)FA(this.app,t.next);return Promise.resolve()}};function A8(n,e){return new Vw(n,e)}function O8(n){return{getToken:e=>Lw(n,e),getLimitedUseToken:()=>T8(n),addTokenListener:e=>D8(n,"INTERNAL",e),removeTokenListener:e=>FA(n.app,e)}}var N8="@firebase/app-check",R8="0.10.1";var k8="app-check",MA="app-check-internal";function F8(){Bn(new Gt(k8,n=>{let e=n.getProvider("app").getImmediate(),t=n.getProvider("heartbeat");return A8(e,t)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((n,e,t)=>{n.getProvider(MA).initialize()})),Bn(new Gt(MA,n=>{let e=n.getProvider("app-check").getImmediate();return O8(e)},"PUBLIC").setInstantiationMode("EXPLICIT")),Je(N8,R8)}F8();var L8="app-check";var bo=class{constructor(){return wo(L8)}};var V8=["localhost","0.0.0.0","127.0.0.1"],Aae=typeof window<"u"&&V8.includes(window.location.hostname);function XA(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}var eO=XA,tO=new _r("auth","Firebase",XA());var im=new Zn("@firebase/auth");function j8(n,...e){im.logLevel<=Ee.WARN&&im.warn(`Auth (${Xr}): ${n}`,...e)}function em(n,...e){im.logLevel<=Ee.ERROR&&im.error(`Auth (${Xr}): ${n}`,...e)}function ri(n,...e){throw cC(n,...e)}function Ns(n,...e){return cC(n,...e)}function nO(n,e,t){let r=Object.assign(Object.assign({},eO()),{[e]:t});return new _r("auth","Firebase",r).create(e,{appName:n.name})}function xo(n){return nO(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function cC(n,...e){if(typeof n!="string"){let t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return tO.create(n,...e)}function he(n,e,...t){if(!n)throw cC(e,...t)}function Ni(n){let e="INTERNAL ASSERTION FAILED: "+n;throw em(e),new Error(e)}function So(n,e){n||Ni(e)}function $w(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.href)||""}function B8(){return LA()==="http:"||LA()==="https:"}function LA(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.protocol)||null}function U8(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(B8()||XP()||"connection"in navigator)?navigator.onLine:!0}function $8(){if(typeof navigator>"u")return null;let n=navigator;return n.languages&&n.languages[0]||n.language||null}var Rs=class{constructor(e,t){this.shortDelay=e,this.longDelay=t,So(t>e,"Short delay should be less than long delay!"),this.isMobile=Lu()||Gp()}get(){return U8()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}};function lC(n,e){So(n.emulator,"Emulator should always be set here");let{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}var om=class{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Ni("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Ni("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Ni("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}};var z8={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};var H8=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],W8=new Rs(3e4,6e4);function Fs(n,e){return n.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:n.tenantId}):e}function To(o,s,a,c){return w(this,arguments,function*(n,e,t,r,i={}){return rO(n,i,()=>w(null,null,function*(){let u={},d={};r&&(e==="GET"?d=r:u={body:JSON.stringify(r)});let f=Ms(Object.assign({key:n.config.apiKey},d)).slice(1),v=yield n._getAdditionalHeaders();v["Content-Type"]="application/json",n.languageCode&&(v["X-Firebase-Locale"]=n.languageCode);let _=Object.assign({method:e,headers:v},u);return JP()||(_.referrerPolicy="no-referrer"),n.emulatorConfig&&yr(n.emulatorConfig.host)&&(_.credentials="include"),om.fetch()(yield iO(n,n.config.apiHost,t,f),_)}))})}function rO(n,e,t){return w(this,null,function*(){n._canInitEmulator=!1;let r=Object.assign(Object.assign({},z8),e);try{let i=new zw(n),o=yield Promise.race([t(),i.promise]);i.clearNetworkTimeout();let s=yield o.json();if("needConfirmation"in s)throw Xp(n,"account-exists-with-different-credential",s);if(o.ok&&!("errorMessage"in s))return s;{let a=o.ok?s.errorMessage:s.error.message,[c,u]=a.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw Xp(n,"credential-already-in-use",s);if(c==="EMAIL_EXISTS")throw Xp(n,"email-already-in-use",s);if(c==="USER_DISABLED")throw Xp(n,"user-disabled",s);let d=r[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(u)throw nO(n,d,u);ri(n,d)}}catch(i){if(i instanceof jn)throw i;ri(n,"network-request-failed",{message:String(i)})}})}function gm(o,s,a,c){return w(this,arguments,function*(n,e,t,r,i={}){let u=yield To(n,e,t,r,i);return"mfaPendingCredential"in u&&ri(n,"multi-factor-auth-required",{_serverResponse:u}),u})}function iO(n,e,t,r){return w(this,null,function*(){let i=`${e}${t}?${r}`,o=n,s=o.config.emulator?lC(n.config,i):`${n.config.apiScheme}://${i}`;return H8.includes(t)&&(yield o._persistenceManagerAvailable,o._getPersistenceType()==="COOKIE")?o._getPersistence()._getFinalTarget(s).toString():s})}function q8(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}var zw=class{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(Ns(this.auth,"network-request-failed")),W8.get())})}};function Xp(n,e,t){let r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);let i=Ns(n,e,r);return i.customData._tokenResponse=t,i}function VA(n){return n!==void 0&&n.enterprise!==void 0}var Hw=class{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(let t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return q8(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}};function G8(n,e){return w(this,null,function*(){return To(n,"GET","/v2/recaptchaConfig",Fs(n,e))})}function K8(n,e){return w(this,null,function*(){return To(n,"POST","/v1/accounts:delete",e)})}function sm(n,e){return w(this,null,function*(){return To(n,"POST","/v1/accounts:lookup",e)})}function Ku(n){if(n)try{let e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}function uC(n,e=!1){return w(this,null,function*(){let t=lt(n),r=yield t.getIdToken(e),i=dC(r);he(i&&i.exp&&i.auth_time&&i.iat,t.auth,"internal-error");let o=typeof i.firebase=="object"?i.firebase:void 0,s=o?.sign_in_provider;return{claims:i,token:r,authTime:Ku(jw(i.auth_time)),issuedAtTime:Ku(jw(i.iat)),expirationTime:Ku(jw(i.exp)),signInProvider:s||null,signInSecondFactor:o?.sign_in_second_factor||null}})}function jw(n){return Number(n)*1e3}function dC(n){let[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return em("JWT malformed, contained fewer than 3 sections"),null;try{let i=ac(t);return i?JSON.parse(i):(em("Failed to decode base64 JWT payload"),null)}catch(i){return em("Caught error parsing JWT payload as JSON",i?.toString()),null}}function jA(n){let e=dC(n);return he(e,"internal-error"),he(typeof e.exp<"u","internal-error"),he(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}function Qu(n,e,t=!1){return w(this,null,function*(){if(t)return e;try{return yield e}catch(r){throw r instanceof jn&&Y8(r)&&n.auth.currentUser===n&&(yield n.auth.signOut()),r}})}function Y8({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}var Ww=class{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){let r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;let i=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;let t=this.getInterval(e);this.timerId=setTimeout(()=>w(this,null,function*(){yield this.iteration()}),t)}iteration(){return w(this,null,function*(){try{yield this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()})}};var Zu=class{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Ku(this.lastLoginAt),this.creationTime=Ku(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}};function am(n){return w(this,null,function*(){var e;let t=n.auth,r=yield n.getIdToken(),i=yield Qu(n,sm(t,{idToken:r}));he(i?.users.length,t,"internal-error");let o=i.users[0];n._notifyReloadListener(o);let s=!((e=o.providerUserInfo)===null||e===void 0)&&e.length?oO(o.providerUserInfo):[],a=Q8(n.providerData,s),c=n.isAnonymous,u=!(n.email&&o.passwordHash)&&!a?.length,d=c?u:!1,f={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:a,metadata:new Zu(o.createdAt,o.lastLoginAt),isAnonymous:d};Object.assign(n,f)})}function hC(n){return w(this,null,function*(){let e=lt(n);yield am(e),yield e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)})}function Q8(n,e){return[...n.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function oO(n){return n.map(e=>{var{providerId:t}=e,r=v_(e,["providerId"]);return{providerId:t,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}function Z8(n,e){return w(this,null,function*(){let t=yield rO(n,{},()=>w(null,null,function*(){let r=Ms({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:o}=n.config,s=yield iO(n,i,"/v1/token",`key=${o}`),a=yield n._getAdditionalHeaders();a["Content-Type"]="application/x-www-form-urlencoded";let c={method:"POST",headers:a,body:r};return n.emulatorConfig&&yr(n.emulatorConfig.host)&&(c.credentials="include"),om.fetch()(s,c)}));return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}})}function J8(n,e){return w(this,null,function*(){return To(n,"POST","/v2/accounts:revokeToken",Fs(n,e))})}var Yu=class n{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){he(e.idToken,"internal-error"),he(typeof e.idToken<"u","internal-error"),he(typeof e.refreshToken<"u","internal-error");let t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):jA(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){he(e.length!==0,"internal-error");let t=jA(e);this.updateTokensAndExpiration(e,null,t)}getToken(e,t=!1){return w(this,null,function*(){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(he(this.refreshToken,e,"user-token-expired"),this.refreshToken?(yield this.refresh(e,this.refreshToken),this.accessToken):null)})}clearRefreshToken(){this.refreshToken=null}refresh(e,t){return w(this,null,function*(){let{accessToken:r,refreshToken:i,expiresIn:o}=yield Z8(e,t);this.updateTokensAndExpiration(r,i,Number(o))})}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){let{refreshToken:r,accessToken:i,expirationTime:o}=t,s=new n;return r&&(he(typeof r=="string","internal-error",{appName:e}),s.refreshToken=r),i&&(he(typeof i=="string","internal-error",{appName:e}),s.accessToken=i),o&&(he(typeof o=="number","internal-error",{appName:e}),s.expirationTime=o),s}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new n,this.toJSON())}_performRefresh(){return Ni("not implemented")}};function Io(n,e){he(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}var Eo=class n{constructor(e){var{uid:t,auth:r,stsTokenManager:i}=e,o=v_(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new Ww(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=r,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=o.displayName||null,this.email=o.email||null,this.emailVerified=o.emailVerified||!1,this.phoneNumber=o.phoneNumber||null,this.photoURL=o.photoURL||null,this.isAnonymous=o.isAnonymous||!1,this.tenantId=o.tenantId||null,this.providerData=o.providerData?[...o.providerData]:[],this.metadata=new Zu(o.createdAt||void 0,o.lastLoginAt||void 0)}getIdToken(e){return w(this,null,function*(){let t=yield Qu(this,this.stsTokenManager.getToken(this.auth,e));return he(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,yield this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t})}getIdTokenResult(e){return uC(this,e)}reload(){return hC(this)}_assign(e){this!==e&&(he(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){let t=new n(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){he(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}_updateTokensIfNecessary(e,t=!1){return w(this,null,function*(){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&(yield am(this)),yield this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)})}delete(){return w(this,null,function*(){if(vn(this.auth.app))return Promise.reject(xo(this.auth));let e=yield this.getIdToken();return yield Qu(this,K8(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()})}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var r,i,o,s,a,c,u,d;let f=(r=t.displayName)!==null&&r!==void 0?r:void 0,v=(i=t.email)!==null&&i!==void 0?i:void 0,_=(o=t.phoneNumber)!==null&&o!==void 0?o:void 0,b=(s=t.photoURL)!==null&&s!==void 0?s:void 0,N=(a=t.tenantId)!==null&&a!==void 0?a:void 0,R=(c=t._redirectEventId)!==null&&c!==void 0?c:void 0,G=(u=t.createdAt)!==null&&u!==void 0?u:void 0,oe=(d=t.lastLoginAt)!==null&&d!==void 0?d:void 0,{uid:ce,emailVerified:Fe,isAnonymous:Dt,providerData:ze,stsTokenManager:D}=t;he(ce&&D,e,"internal-error");let E=Yu.fromJSON(this.name,D);he(typeof ce=="string",e,"internal-error"),Io(f,e.name),Io(v,e.name),he(typeof Fe=="boolean",e,"internal-error"),he(typeof Dt=="boolean",e,"internal-error"),Io(_,e.name),Io(b,e.name),Io(N,e.name),Io(R,e.name),Io(G,e.name),Io(oe,e.name);let S=new n({uid:ce,auth:e,email:v,emailVerified:Fe,displayName:f,isAnonymous:Dt,photoURL:b,phoneNumber:_,tenantId:N,stsTokenManager:E,createdAt:G,lastLoginAt:oe});return ze&&Array.isArray(ze)&&(S.providerData=ze.map(T=>Object.assign({},T))),R&&(S._redirectEventId=R),S}static _fromIdTokenResponse(e,t,r=!1){return w(this,null,function*(){let i=new Yu;i.updateFromServerResponse(t);let o=new n({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:r});return yield am(o),o})}static _fromGetAccountInfoResponse(e,t,r){return w(this,null,function*(){let i=t.users[0];he(i.localId!==void 0,"internal-error");let o=i.providerUserInfo!==void 0?oO(i.providerUserInfo):[],s=!(i.email&&i.passwordHash)&&!o?.length,a=new Yu;a.updateFromIdToken(r);let c=new n({uid:i.localId,auth:e,stsTokenManager:a,isAnonymous:s}),u={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:o,metadata:new Zu(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!o?.length};return Object.assign(c,u),c})}};var BA=new Map;function Ri(n){So(n instanceof Function,"Expected a class definition");let e=BA.get(n);return e?(So(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,BA.set(n,e),e)}var X8=(()=>{class n{constructor(){this.type="NONE",this.storage={}}_isAvailable(){return w(this,null,function*(){return!0})}_set(t,r){return w(this,null,function*(){this.storage[t]=r})}_get(t){return w(this,null,function*(){let r=this.storage[t];return r===void 0?null:r})}_remove(t){return w(this,null,function*(){delete this.storage[t]})}_addListener(t,r){}_removeListener(t,r){}}return n.type="NONE",n})(),qw=X8;function tm(n,e,t){return`firebase:${n}:${e}:${t}`}var cm=class n{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;let{config:i,name:o}=this.auth;this.fullUserKey=tm(this.userKey,i.apiKey,o),this.fullPersistenceKey=tm("persistence",i.apiKey,o),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}getCurrentUser(){return w(this,null,function*(){let e=yield this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){let t=yield sm(this.auth,{idToken:e}).catch(()=>{});return t?Eo._fromGetAccountInfoResponse(this.auth,t,e):null}return Eo._fromJSON(this.auth,e)})}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}setPersistence(e){return w(this,null,function*(){if(this.persistence===e)return;let t=yield this.getCurrentUser();if(yield this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)})}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static create(e,t,r="authUser"){return w(this,null,function*(){if(!t.length)return new n(Ri(qw),e,r);let i=(yield Promise.all(t.map(u=>w(null,null,function*(){if(yield u._isAvailable())return u})))).filter(u=>u),o=i[0]||Ri(qw),s=tm(r,e.config.apiKey,e.name),a=null;for(let u of t)try{let d=yield u._get(s);if(d){let f;if(typeof d=="string"){let v=yield sm(e,{idToken:d}).catch(()=>{});if(!v)break;f=yield Eo._fromGetAccountInfoResponse(e,v,d)}else f=Eo._fromJSON(e,d);u!==o&&(a=f),o=u;break}}catch{}let c=i.filter(u=>u._shouldAllowMigration);return!o._shouldAllowMigration||!c.length?new n(o,e,r):(o=c[0],a&&(yield o._set(s,a.toJSON())),yield Promise.all(t.map(u=>w(null,null,function*(){if(u!==o)try{yield u._remove(s)}catch{}}))),new n(o,e,r))})}};function UA(n){let e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(lO(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(sO(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(dO(e))return"Blackberry";if(hO(e))return"Webos";if(aO(e))return"Safari";if((e.includes("chrome/")||cO(e))&&!e.includes("edge/"))return"Chrome";if(uO(e))return"Android";{let t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if(r?.length===2)return r[1]}return"Other"}function sO(n=Nt()){return/firefox\//i.test(n)}function aO(n=Nt()){let e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function cO(n=Nt()){return/crios\//i.test(n)}function lO(n=Nt()){return/iemobile/i.test(n)}function uO(n=Nt()){return/android/i.test(n)}function dO(n=Nt()){return/blackberry/i.test(n)}function hO(n=Nt()){return/webos/i.test(n)}function fC(n=Nt()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function ez(n=Nt()){var e;return fC(n)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function tz(){return eA()&&document.documentMode===10}function fO(n=Nt()){return fC(n)||uO(n)||hO(n)||dO(n)||/windows phone/i.test(n)||lO(n)}function pO(n,e=[]){let t;switch(n){case"Browser":t=UA(Nt());break;case"Worker":t=`${UA(Nt())}-${n}`;break;default:t=n}let r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Xr}/${r}`}var Gw=class{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){let r=o=>new Promise((s,a)=>{try{let c=e(o);s(c)}catch(c){a(c)}});r.onAbort=t,this.queue.push(r);let i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}runMiddleware(e){return w(this,null,function*(){if(this.auth.currentUser===e)return;let t=[];try{for(let r of this.queue)yield r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(let i of t)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r?.message})}})}};function nz(t){return w(this,arguments,function*(n,e={}){return To(n,"GET","/v2/passwordPolicy",Fs(n,e))})}var rz=6,Kw=class{constructor(e){var t,r,i,o;let s=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=s.minPasswordLength)!==null&&t!==void 0?t:rz,s.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=s.maxPasswordLength),s.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=s.containsLowercaseCharacter),s.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=s.containsUppercaseCharacter),s.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=s.containsNumericCharacter),s.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=s.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(o=e.forceUpgradeOnSignin)!==null&&o!==void 0?o:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,r,i,o,s,a;let c={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,c),this.validatePasswordCharacterOptions(e,c),c.isValid&&(c.isValid=(t=c.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),c.isValid&&(c.isValid=(r=c.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),c.isValid&&(c.isValid=(i=c.containsLowercaseLetter)!==null&&i!==void 0?i:!0),c.isValid&&(c.isValid=(o=c.containsUppercaseLetter)!==null&&o!==void 0?o:!0),c.isValid&&(c.isValid=(s=c.containsNumericCharacter)!==null&&s!==void 0?s:!0),c.isValid&&(c.isValid=(a=c.containsNonAlphanumericCharacter)!==null&&a!==void 0?a:!0),c}validatePasswordLengthOptions(e,t){let r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),i&&(t.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,i,o){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=o))}};var Yw=class{constructor(e,t,r,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new lm(this),this.idTokenSubscription=new lm(this),this.beforeStateQueue=new Gw(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=tO,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(o=>this._resolvePersistenceManagerAvailable=o)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Ri(t)),this._initializationPromise=this.queue(()=>w(this,null,function*(){var r,i,o;if(!this._deleted&&(this.persistenceManager=yield cm.create(this,e),(r=this._resolvePersistenceManagerAvailable)===null||r===void 0||r.call(this),!this._deleted)){if(!((i=this._popupRedirectResolver)===null||i===void 0)&&i._shouldInitProactively)try{yield this._popupRedirectResolver._initialize(this)}catch{}yield this.initializeCurrentUser(t),this.lastNotifiedUid=((o=this.currentUser)===null||o===void 0?void 0:o.uid)||null,!this._deleted&&(this._isInitialized=!0)}})),this._initializationPromise}_onStorageEvent(){return w(this,null,function*(){if(this._deleted)return;let e=yield this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),yield this.currentUser.getIdToken();return}yield this._updateCurrentUser(e,!0)}})}initializeCurrentUserFromIdToken(e){return w(this,null,function*(){try{let t=yield sm(this,{idToken:e}),r=yield Eo._fromGetAccountInfoResponse(this,t,e);yield this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),yield this.directlySetCurrentUser(null)}})}initializeCurrentUser(e){return w(this,null,function*(){var t;if(vn(this.app)){let s=this.app.settings.authIdToken;return s?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(s).then(a,a))}):this.directlySetCurrentUser(null)}let r=yield this.assertedPersistence.getCurrentUser(),i=r,o=!1;if(e&&this.config.authDomain){yield this.getOrInitRedirectPersistenceManager();let s=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,a=i?._redirectEventId,c=yield this.tryRedirectSignIn(e);(!s||s===a)&&c?.user&&(i=c.user,o=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(o)try{yield this.beforeStateQueue.runMiddleware(i)}catch(s){i=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(s))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return he(this._popupRedirectResolver,this,"argument-error"),yield this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)})}tryRedirectSignIn(e){return w(this,null,function*(){let t=null;try{t=yield this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{yield this._setRedirectUser(null)}return t})}reloadAndSetCurrentUserOrClear(e){return w(this,null,function*(){try{yield am(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)})}useDeviceLanguage(){this.languageCode=$8()}_delete(){return w(this,null,function*(){this._deleted=!0})}updateCurrentUser(e){return w(this,null,function*(){if(vn(this.app))return Promise.reject(xo(this));let t=e?lt(e):null;return t&&he(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))})}_updateCurrentUser(e,t=!1){return w(this,null,function*(){if(!this._deleted)return e&&he(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||(yield this.beforeStateQueue.runMiddleware(e)),this.queue(()=>w(this,null,function*(){yield this.directlySetCurrentUser(e),this.notifyAuthListeners()}))})}signOut(){return w(this,null,function*(){return vn(this.app)?Promise.reject(xo(this)):(yield this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&(yield this._setRedirectUser(null)),this._updateCurrentUser(null,!0))})}setPersistence(e){return vn(this.app)?Promise.reject(xo(this)):this.queue(()=>w(this,null,function*(){yield this.assertedPersistence.setPersistence(Ri(e))}))}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}validatePassword(e){return w(this,null,function*(){this._getPasswordPolicyInternal()||(yield this._updatePasswordPolicy());let t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)})}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}_updatePasswordPolicy(){return w(this,null,function*(){let e=yield nz(this),t=new Kw(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t})}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new _r("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{let r=this.onAuthStateChanged(()=>{r(),e()},t)}})}revokeAccessToken(e){return w(this,null,function*(){if(this.currentUser){let t=yield this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),yield J8(this,r)}})}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}_setRedirectUser(e,t){return w(this,null,function*(){let r=yield this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)})}getOrInitRedirectPersistenceManager(e){return w(this,null,function*(){if(!this.redirectPersistenceManager){let t=e&&Ri(e)||this._popupRedirectResolver;he(t,this,"argument-error"),this.redirectPersistenceManager=yield cm.create(this,[Ri(t._redirectPersistence)],"redirectUser"),this.redirectUser=yield this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager})}_redirectUserForId(e){return w(this,null,function*(){var t,r;return this._isInitialized&&(yield this.queue(()=>w(this,null,function*(){}))),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null})}_persistUserIfCurrent(e){return w(this,null,function*(){if(e===this.currentUser)return this.queue(()=>w(this,null,function*(){return this.directlySetCurrentUser(e)}))})}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);let r=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,i){if(this._deleted)return()=>{};let o=typeof t=="function"?t:t.next.bind(t),s=!1,a=this._isInitialized?Promise.resolve():this._initializationPromise;if(he(a,this,"internal-error"),a.then(()=>{s||o(this.currentUser)}),typeof t=="function"){let c=e.addObserver(t,r,i);return()=>{s=!0,c()}}else{let c=e.addObserver(t);return()=>{s=!0,c()}}}directlySetCurrentUser(e){return w(this,null,function*(){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?yield this.assertedPersistence.setCurrentUser(e):yield this.assertedPersistence.removeCurrentUser()})}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return he(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=pO(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getAdditionalHeaders(){return w(this,null,function*(){var e;let t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);let r=yield(e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader();r&&(t["X-Firebase-Client"]=r);let i=yield this._getAppCheckToken();return i&&(t["X-Firebase-AppCheck"]=i),t})}_getAppCheckToken(){return w(this,null,function*(){var e;if(vn(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;let t=yield(e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken();return t?.error&&j8(`Error while retrieving App Check token: ${t.error}`),t?.token})}};function mc(n){return lt(n)}var lm=class{constructor(e){this.auth=e,this.observer=null,this.addObserver=sA(t=>this.observer=t)}get next(){return he(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}};var vm={loadJS(){return w(this,null,function*(){throw new Error("Unable to load external scripts")})},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function iz(n){vm=n}function mO(n){return vm.loadJS(n)}function oz(){return vm.recaptchaEnterpriseScript}function sz(){return vm.gapiScript}function gO(n){return`__${n}${Math.floor(Math.random()*1e6)}`}var Qw=class{constructor(){this.enterprise=new Zw}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}},Zw=class{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}};var az="recaptcha-enterprise",vO="NO_RECAPTCHA",Jw=class{constructor(e){this.type=az,this.auth=mc(e)}verify(e="verify",t=!1){return w(this,null,function*(){function r(o){return w(this,null,function*(){if(!t){if(o.tenantId==null&&o._agentRecaptchaConfig!=null)return o._agentRecaptchaConfig.siteKey;if(o.tenantId!=null&&o._tenantRecaptchaConfigs[o.tenantId]!==void 0)return o._tenantRecaptchaConfigs[o.tenantId].siteKey}return new Promise((s,a)=>w(null,null,function*(){G8(o,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(c=>{if(c.recaptchaKey===void 0)a(new Error("recaptcha Enterprise site key undefined"));else{let u=new Hw(c);return o.tenantId==null?o._agentRecaptchaConfig=u:o._tenantRecaptchaConfigs[o.tenantId]=u,s(u.siteKey)}}).catch(c=>{a(c)})}))})}function i(o,s,a){let c=window.grecaptcha;VA(c)?c.enterprise.ready(()=>{c.enterprise.execute(o,{action:e}).then(u=>{s(u)}).catch(()=>{s(vO)})}):a(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new Qw().execute("siteKey",{action:"verify"}):new Promise((o,s)=>{r(this.auth).then(a=>{if(!t&&VA(window.grecaptcha))i(a,o,s);else{if(typeof window>"u"){s(new Error("RecaptchaVerifier is only supported in browser"));return}let c=oz();c.length!==0&&(c+=a),mO(c).then(()=>{i(a,o,s)}).catch(u=>{s(u)})}}).catch(a=>{s(a)})})})}};function Gu(n,e,t,r=!1,i=!1){return w(this,null,function*(){let o=new Jw(n),s;if(i)s=vO;else try{s=yield o.verify(t)}catch{s=yield o.verify(t,!0)}let a=Object.assign({},e);if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in a){let c=a.phoneEnrollmentInfo.phoneNumber,u=a.phoneEnrollmentInfo.recaptchaToken;Object.assign(a,{phoneEnrollmentInfo:{phoneNumber:c,recaptchaToken:u,captchaResponse:s,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in a){let c=a.phoneSignInInfo.recaptchaToken;Object.assign(a,{phoneSignInInfo:{recaptchaToken:c,captchaResponse:s,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return a}return r?Object.assign(a,{captchaResp:s}):Object.assign(a,{captchaResponse:s}),Object.assign(a,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(a,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),a})}function $A(n,e,t,r,i){return w(this,null,function*(){var o,s;if(i==="EMAIL_PASSWORD_PROVIDER")if(!((o=n._getRecaptchaConfig())===null||o===void 0)&&o.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){let a=yield Gu(n,e,t,t==="getOobCode");return r(n,a)}else return r(n,e).catch(a=>w(null,null,function*(){if(a.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);let c=yield Gu(n,e,t,t==="getOobCode");return r(n,c)}else return Promise.reject(a)}));else if(i==="PHONE_PROVIDER")if(!((s=n._getRecaptchaConfig())===null||s===void 0)&&s.isProviderEnabled("PHONE_PROVIDER")){let a=yield Gu(n,e,t);return r(n,a).catch(c=>w(null,null,function*(){var u;if(((u=n._getRecaptchaConfig())===null||u===void 0?void 0:u.getProviderEnforcementState("PHONE_PROVIDER"))==="AUDIT"&&(c.code==="auth/missing-recaptcha-token"||c.code==="auth/invalid-app-credential")){console.log(`Failed to verify with reCAPTCHA Enterprise. Automatically triggering the reCAPTCHA v2 flow to complete the ${t} flow.`);let d=yield Gu(n,e,t,!1,!0);return r(n,d)}return Promise.reject(c)}))}else{let a=yield Gu(n,e,t,!1,!0);return r(n,a)}else return Promise.reject(i+" provider is not supported.")})}function pC(n,e){let t=yo(n,"auth");if(t.isInitialized()){let i=t.getImmediate(),o=t.getOptions();if(Qn(o,e??{}))return i;ri(i,"already-initialized")}return t.initialize({options:e})}function cz(n,e){let t=e?.persistence||[],r=(Array.isArray(t)?t:[t]).map(Ri);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e?.popupRedirectResolver)}function mC(n,e,t){let r=mc(n);he(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");let i=!!t?.disableWarnings,o=_O(e),{host:s,port:a}=lz(e),c=a===null?"":`:${a}`,u={url:`${o}//${s}${c}/`},d=Object.freeze({host:s,port:a,protocol:o.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!r._canInitEmulator){he(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),he(Qn(u,r.config.emulator)&&Qn(d,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=u,r.emulatorConfig=d,r.settings.appVerificationDisabledForTesting=!0,yr(s)?(uc(`${o}//${s}${c}`),dc("Auth",!0)):i||uz()}function _O(n){let e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function lz(n){let e=_O(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};let r=t[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){let o=i[1];return{host:o,port:zA(r.substr(o.length+1))}}else{let[o,s]=r.split(":");return{host:o,port:zA(s)}}}function zA(n){if(!n)return null;let e=Number(n);return isNaN(e)?null:e}function uz(){function n(){let e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}var Ju=class{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Ni("not implemented")}_getIdTokenResponse(e){return Ni("not implemented")}_linkToIdToken(e,t){return Ni("not implemented")}_getReauthenticationResolver(e){return Ni("not implemented")}};function dz(n,e){return w(this,null,function*(){return To(n,"POST","/v1/accounts:signUp",e)})}function hz(n,e){return w(this,null,function*(){return gm(n,"POST","/v1/accounts:signInWithPassword",Fs(n,e))})}function fz(n,e){return w(this,null,function*(){return gm(n,"POST","/v1/accounts:signInWithEmailLink",Fs(n,e))})}function pz(n,e){return w(this,null,function*(){return gm(n,"POST","/v1/accounts:signInWithEmailLink",Fs(n,e))})}var Xu=class n extends Ju{constructor(e,t,r,i=null){super("password",r),this._email=e,this._password=t,this._tenantId=i}static _fromEmailAndPassword(e,t){return new n(e,t,"password")}static _fromEmailAndCode(e,t,r=null){return new n(e,t,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){let t=typeof e=="string"?JSON.parse(e):e;if(t?.email&&t?.password){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}_getIdTokenResponse(e){return w(this,null,function*(){switch(this.signInMethod){case"password":let t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return $A(e,t,"signInWithPassword",hz,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return fz(e,{email:this._email,oobCode:this._password});default:ri(e,"internal-error")}})}_linkToIdToken(e,t){return w(this,null,function*(){switch(this.signInMethod){case"password":let r={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return $A(e,r,"signUpPassword",dz,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return pz(e,{idToken:t,email:this._email,oobCode:this._password});default:ri(e,"internal-error")}})}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}};function Bw(n,e){return w(this,null,function*(){return gm(n,"POST","/v1/accounts:signInWithIdp",Fs(n,e))})}function mz(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function gz(n){let e=hc(fc(n)).link,t=e?hc(fc(e)).deep_link_id:null,r=hc(fc(n)).deep_link_id;return(r?hc(fc(r)).link:null)||r||t||e||n}var um=class n{constructor(e){var t,r,i,o,s,a;let c=hc(fc(e)),u=(t=c.apiKey)!==null&&t!==void 0?t:null,d=(r=c.oobCode)!==null&&r!==void 0?r:null,f=mz((i=c.mode)!==null&&i!==void 0?i:null);he(u&&d&&f,"argument-error"),this.apiKey=u,this.operation=f,this.code=d,this.continueUrl=(o=c.continueUrl)!==null&&o!==void 0?o:null,this.languageCode=(s=c.lang)!==null&&s!==void 0?s:null,this.tenantId=(a=c.tenantId)!==null&&a!==void 0?a:null}static parseLink(e){let t=gz(e);try{return new n(t)}catch{return null}}};var yO=(()=>{class n{constructor(){this.providerId=n.PROVIDER_ID}static credential(t,r){return Xu._fromEmailAndPassword(t,r)}static credentialWithLink(t,r){let i=um.parseLink(r);return he(i,"argument-error"),Xu._fromEmailAndCode(t,i.code,i.tenantId)}}n.PROVIDER_ID="password",n.EMAIL_PASSWORD_SIGN_IN_METHOD="password",n.EMAIL_LINK_SIGN_IN_METHOD="emailLink";return n})(),dm=class{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}};var Xw=class extends dm{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}};var ed=class n{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static _fromIdTokenResponse(e,t,r,i=!1){return w(this,null,function*(){let o=yield Eo._fromIdTokenResponse(e,r,i),s=HA(r);return new n({user:o,providerId:s,_tokenResponse:r,operationType:t})})}static _forOperation(e,t,r){return w(this,null,function*(){yield e._updateTokensIfNecessary(r,!0);let i=HA(r);return new n({user:e,providerId:i,_tokenResponse:r,operationType:t})})}};function HA(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}var eC=class n extends jn{constructor(e,t,r,i){var o;super(t.code,t.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,n.prototype),this.customData={appName:e.name,tenantId:(o=e.tenantId)!==null&&o!==void 0?o:void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,i){return new n(e,t,r,i)}};function wO(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(o=>{throw o.code==="auth/multi-factor-auth-required"?eC._fromErrorAndOperation(n,o,e,r):o})}function vz(n,e,t=!1){return w(this,null,function*(){let r=yield Qu(n,e._linkToIdToken(n.auth,yield n.getIdToken()),t);return ed._forOperation(n,"link",r)})}function _z(n,e,t=!1){return w(this,null,function*(){let{auth:r}=n;if(vn(r.app))return Promise.reject(xo(r));let i="reauthenticate";try{let o=yield Qu(n,wO(r,i,e,n),t);he(o.idToken,r,"internal-error");let s=dC(o.idToken);he(s,r,"internal-error");let{sub:a}=s;return he(n.uid===a,r,"user-mismatch"),ed._forOperation(n,i,o)}catch(o){throw o?.code==="auth/user-not-found"&&ri(r,"user-mismatch"),o}})}function CO(n,e,t=!1){return w(this,null,function*(){if(vn(n.app))return Promise.reject(xo(n));let r="signIn",i=yield wO(n,r,e),o=yield ed._fromIdTokenResponse(n,r,i);return t||(yield n._updateCurrentUser(o.user)),o})}function gC(n,e){return w(this,null,function*(){return CO(mc(n),e)})}function yz(n){return w(this,null,function*(){let e=mc(n);e._getPasswordPolicyInternal()&&(yield e._updatePasswordPolicy())})}function vC(n,e,t){return vn(n.app)?Promise.reject(xo(n)):gC(lt(n),yO.credential(e,t)).catch(r=>w(null,null,function*(){throw r.code==="auth/password-does-not-meet-requirements"&&yz(n),r}))}function _C(n,e,t,r){return lt(n).onIdTokenChanged(e,t,r)}function yC(n,e,t){return lt(n).beforeAuthStateChanged(e,t)}var hm="__sak";var fm=class{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(hm,"1"),this.storage.removeItem(hm),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){let t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}};var wz=1e3,Cz=10,bz=(()=>{class n extends fm{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(t,r)=>this.onStorageEvent(t,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=fO(),this._shouldAllowMigration=!0}forAllChangedKeys(t){for(let r of Object.keys(this.listeners)){let i=this.storage.getItem(r),o=this.localCache[r];i!==o&&t(r,o,i)}}onStorageEvent(t,r=!1){if(!t.key){this.forAllChangedKeys((a,c,u)=>{this.notifyListeners(a,u)});return}let i=t.key;r?this.detachListener():this.stopPolling();let o=()=>{let a=this.storage.getItem(i);!r&&this.localCache[i]===a||this.notifyListeners(i,a)},s=this.storage.getItem(i);tz()&&s!==t.newValue&&t.newValue!==t.oldValue?setTimeout(o,Cz):o()}notifyListeners(t,r){this.localCache[t]=r;let i=this.listeners[t];if(i)for(let o of Array.from(i))o(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((t,r,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:t,oldValue:r,newValue:i}),!0)})},wz)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(t,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[t]||(this.listeners[t]=new Set,this.localCache[t]=this.storage.getItem(t)),this.listeners[t].add(r)}_removeListener(t,r){this.listeners[t]&&(this.listeners[t].delete(r),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}_set(t,r){return w(this,null,function*(){yield Zi(n.prototype,this,"_set").call(this,t,r),this.localCache[t]=JSON.stringify(r)})}_get(t){return w(this,null,function*(){let r=yield Zi(n.prototype,this,"_get").call(this,t);return this.localCache[t]=JSON.stringify(r),r})}_remove(t){return w(this,null,function*(){yield Zi(n.prototype,this,"_remove").call(this,t),delete this.localCache[t]})}}return n.type="LOCAL",n})(),bO=bz;var Iz=(()=>{class n extends fm{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(t,r){}_removeListener(t,r){}}return n.type="SESSION",n})(),wC=Iz;function Ez(n){return Promise.all(n.map(e=>w(null,null,function*(){try{return{fulfilled:!0,value:yield e}}catch(t){return{fulfilled:!1,reason:t}}})))}var xz=(()=>{class n{constructor(t){this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(t){let r=this.receivers.find(o=>o.isListeningto(t));if(r)return r;let i=new n(t);return this.receivers.push(i),i}isListeningto(t){return this.eventTarget===t}handleEvent(t){return w(this,null,function*(){let r=t,{eventId:i,eventType:o,data:s}=r.data,a=this.handlersMap[o];if(!a?.size)return;r.ports[0].postMessage({status:"ack",eventId:i,eventType:o});let c=Array.from(a).map(d=>w(this,null,function*(){return d(r.origin,s)})),u=yield Ez(c);r.ports[0].postMessage({status:"done",eventId:i,eventType:o,response:u})})}_subscribe(t,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[t]||(this.handlersMap[t]=new Set),this.handlersMap[t].add(r)}_unsubscribe(t,r){this.handlersMap[t]&&r&&this.handlersMap[t].delete(r),(!r||this.handlersMap[t].size===0)&&delete this.handlersMap[t],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}n.receivers=[];return n})();function IO(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}var tC=class{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}_send(e,t,r=50){return w(this,null,function*(){let i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let o,s;return new Promise((a,c)=>{let u=IO("",20);i.port1.start();let d=setTimeout(()=>{c(new Error("unsupported_event"))},r);s={messageChannel:i,onMessage(f){let v=f;if(v.data.eventId===u)switch(v.data.status){case"ack":clearTimeout(d),o=setTimeout(()=>{c(new Error("timeout"))},3e3);break;case"done":clearTimeout(o),a(v.data.response);break;default:clearTimeout(d),clearTimeout(o),c(new Error("invalid_response"));break}}},this.handlers.add(s),i.port1.addEventListener("message",s.onMessage),this.target.postMessage({eventType:e,eventId:u,data:t},[i.port2])}).finally(()=>{s&&this.removeMessageHandler(s)})})}};function ni(){return window}function Sz(n){ni().location.href=n}function EO(){return typeof ni().WorkerGlobalScope<"u"&&typeof ni().importScripts=="function"}function Tz(){return w(this,null,function*(){if(!navigator?.serviceWorker)return null;try{return(yield navigator.serviceWorker.ready).active}catch{return null}})}function Dz(){var n;return((n=navigator?.serviceWorker)===null||n===void 0?void 0:n.controller)||null}function Mz(){return EO()?self:null}var xO="firebaseLocalStorageDb",Pz=1,pm="firebaseLocalStorage",SO="fbase_key",ks=class{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}};function _m(n,e){return n.transaction([pm],e?"readwrite":"readonly").objectStore(pm)}function Az(){let n=indexedDB.deleteDatabase(xO);return new ks(n).toPromise()}function nC(){let n=indexedDB.open(xO,Pz);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{let r=n.result;try{r.createObjectStore(pm,{keyPath:SO})}catch(i){t(i)}}),n.addEventListener("success",()=>w(null,null,function*(){let r=n.result;r.objectStoreNames.contains(pm)?e(r):(r.close(),yield Az(),e(yield nC()))}))})}function WA(n,e,t){return w(this,null,function*(){let r=_m(n,!0).put({[SO]:e,value:t});return new ks(r).toPromise()})}function Oz(n,e){return w(this,null,function*(){let t=_m(n,!1).get(e),r=yield new ks(t).toPromise();return r===void 0?null:r.value})}function qA(n,e){let t=_m(n,!0).delete(e);return new ks(t).toPromise()}var Nz=800,Rz=3,kz=(()=>{class n{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}_openDb(){return w(this,null,function*(){return this.db?this.db:(this.db=yield nC(),this.db)})}_withRetries(t){return w(this,null,function*(){let r=0;for(;;)try{let i=yield this._openDb();return yield t(i)}catch(i){if(r++>Rz)throw i;this.db&&(this.db.close(),this.db=void 0)}})}initializeServiceWorkerMessaging(){return w(this,null,function*(){return EO()?this.initializeReceiver():this.initializeSender()})}initializeReceiver(){return w(this,null,function*(){this.receiver=xz._getInstance(Mz()),this.receiver._subscribe("keyChanged",(t,r)=>w(this,null,function*(){return{keyProcessed:(yield this._poll()).includes(r.key)}})),this.receiver._subscribe("ping",(t,r)=>w(this,null,function*(){return["keyChanged"]}))})}initializeSender(){return w(this,null,function*(){var t,r;if(this.activeServiceWorker=yield Tz(),!this.activeServiceWorker)return;this.sender=new tC(this.activeServiceWorker);let i=yield this.sender._send("ping",{},800);i&&!((t=i[0])===null||t===void 0)&&t.fulfilled&&!((r=i[0])===null||r===void 0)&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)})}notifyServiceWorker(t){return w(this,null,function*(){if(!(!this.sender||!this.activeServiceWorker||Dz()!==this.activeServiceWorker))try{yield this.sender._send("keyChanged",{key:t},this.serviceWorkerReceiverAvailable?800:50)}catch{}})}_isAvailable(){return w(this,null,function*(){try{if(!indexedDB)return!1;let t=yield nC();return yield WA(t,hm,"1"),yield qA(t,hm),!0}catch{}return!1})}_withPendingWrite(t){return w(this,null,function*(){this.pendingWrites++;try{yield t()}finally{this.pendingWrites--}})}_set(t,r){return w(this,null,function*(){return this._withPendingWrite(()=>w(this,null,function*(){return yield this._withRetries(i=>WA(i,t,r)),this.localCache[t]=r,this.notifyServiceWorker(t)}))})}_get(t){return w(this,null,function*(){let r=yield this._withRetries(i=>Oz(i,t));return this.localCache[t]=r,r})}_remove(t){return w(this,null,function*(){return this._withPendingWrite(()=>w(this,null,function*(){return yield this._withRetries(r=>qA(r,t)),delete this.localCache[t],this.notifyServiceWorker(t)}))})}_poll(){return w(this,null,function*(){let t=yield this._withRetries(o=>{let s=_m(o,!1).getAll();return new ks(s).toPromise()});if(!t)return[];if(this.pendingWrites!==0)return[];let r=[],i=new Set;if(t.length!==0)for(let{fbase_key:o,value:s}of t)i.add(o),JSON.stringify(this.localCache[o])!==JSON.stringify(s)&&(this.notifyListeners(o,s),r.push(o));for(let o of Object.keys(this.localCache))this.localCache[o]&&!i.has(o)&&(this.notifyListeners(o,null),r.push(o));return r})}notifyListeners(t,r){this.localCache[t]=r;let i=this.listeners[t];if(i)for(let o of Array.from(i))o(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>w(this,null,function*(){return this._poll()}),Nz)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(t,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[t]||(this.listeners[t]=new Set,this._get(t)),this.listeners[t].add(r)}_removeListener(t,r){this.listeners[t]&&(this.listeners[t].delete(r),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&this.stopPolling()}}return n.type="LOCAL",n})(),TO=kz;var jae=gO("rcb"),Bae=new Rs(3e4,6e4);function Fz(n,e){return e?Ri(e):(he(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}var td=class extends Ju{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Bw(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Bw(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Bw(e,this._buildIdpRequest())}_buildIdpRequest(e){let t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}};function Lz(n){return CO(n.auth,new td(n),n.bypassAuthState)}function Vz(n){let{auth:e,user:t}=n;return he(t,e,"internal-error"),_z(t,new td(n),n.bypassAuthState)}function jz(n){return w(this,null,function*(){let{auth:e,user:t}=n;return he(t,e,"internal-error"),vz(t,new td(n),n.bypassAuthState)})}var rC=class{constructor(e,t,r,i,o=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=o,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise((e,t)=>w(this,null,function*(){this.pendingPromise={resolve:e,reject:t};try{this.eventManager=yield this.resolver._initialize(this.auth),yield this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}}))}onAuthEvent(e){return w(this,null,function*(){let{urlResponse:t,sessionId:r,postBody:i,tenantId:o,error:s,type:a}=e;if(s){this.reject(s);return}let c={auth:this.auth,requestUri:t,sessionId:r,tenantId:o||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(yield this.getIdpTask(a)(c))}catch(u){this.reject(u)}})}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return Lz;case"linkViaPopup":case"linkViaRedirect":return jz;case"reauthViaPopup":case"reauthViaRedirect":return Vz;default:ri(this.auth,"internal-error")}}resolve(e){So(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){So(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}};var Uae=new Rs(2e3,1e4);var Bz="pendingRedirect",nm=new Map,iC=class n extends rC{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}execute(){return w(this,null,function*(){let e=nm.get(this.auth._key());if(!e){try{let r=(yield Uz(this.resolver,this.auth))?yield Zi(n.prototype,this,"execute").call(this):null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}nm.set(this.auth._key(),e)}return this.bypassAuthState||nm.set(this.auth._key(),()=>Promise.resolve(null)),e()})}onAuthEvent(e){return w(this,null,function*(){if(e.type==="signInViaRedirect")return Zi(n.prototype,this,"onAuthEvent").call(this,e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){let t=yield this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,Zi(n.prototype,this,"onAuthEvent").call(this,e);this.resolve(null)}})}onExecution(){return w(this,null,function*(){})}cleanUp(){}};function Uz(n,e){return w(this,null,function*(){let t=Hz(e),r=zz(n);if(!(yield r._isAvailable()))return!1;let i=(yield r._get(t))==="true";return yield r._remove(t),i})}function $z(n,e){nm.set(n._key(),e)}function zz(n){return Ri(n._redirectPersistence)}function Hz(n){return tm(Bz,n.config.apiKey,n.name)}function Wz(n,e,t=!1){return w(this,null,function*(){if(vn(n.app))return Promise.reject(xo(n));let r=mc(n),i=Fz(r,e),s=yield new iC(r,i,t).execute();return s&&!t&&(delete s.user._redirectEventId,yield r._persistUserIfCurrent(s.user),yield r._setRedirectUser(null,e)),s})}var qz=10*60*1e3,oC=class{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!Gz(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var r;if(e.error&&!DO(e)){let i=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";t.onError(Ns(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){let r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=qz&&this.cachedEventUids.clear(),this.cachedEventUids.has(GA(e))}saveEventToCache(e){this.cachedEventUids.add(GA(e)),this.lastProcessedEventTime=Date.now()}};function GA(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function DO({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function Gz(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return DO(n);default:return!1}}function Kz(t){return w(this,arguments,function*(n,e={}){return To(n,"GET","/v1/projects",e)})}var Yz=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Qz=/^https?/;function Zz(n){return w(this,null,function*(){if(n.config.emulator)return;let{authorizedDomains:e}=yield Kz(n);for(let t of e)try{if(Jz(t))return}catch{}ri(n,"unauthorized-domain")})}function Jz(n){let e=$w(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){let s=new URL(n);return s.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&s.hostname===r}if(!Qz.test(t))return!1;if(Yz.test(n))return r===n;let i=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}var Xz=new Rs(3e4,6e4);function KA(){let n=ni().___jsl;if(n?.H){for(let e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function eH(n){return new Promise((e,t)=>{var r,i,o;function s(){KA(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{KA(),t(Ns(n,"network-request-failed"))},timeout:Xz.get()})}if(!((i=(r=ni().gapi)===null||r===void 0?void 0:r.iframes)===null||i===void 0)&&i.Iframe)e(gapi.iframes.getContext());else if(!((o=ni().gapi)===null||o===void 0)&&o.load)s();else{let a=gO("iframefcb");return ni()[a]=()=>{gapi.load?s():t(Ns(n,"network-request-failed"))},mO(`${sz()}?onload=${a}`).catch(c=>t(c))}}).catch(e=>{throw rm=null,e})}var rm=null;function tH(n){return rm=rm||eH(n),rm}var nH=new Rs(5e3,15e3),rH="__/auth/iframe",iH="emulator/auth/iframe",oH={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},sH=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function aH(n){let e=n.config;he(e.authDomain,n,"auth-domain-config-required");let t=e.emulator?lC(e,iH):`https://${n.config.authDomain}/${rH}`,r={apiKey:e.apiKey,appName:n.name,v:Xr},i=sH.get(n.config.apiHost);i&&(r.eid=i);let o=n._getFrameworks();return o.length&&(r.fw=o.join(",")),`${t}?${Ms(r).slice(1)}`}function cH(n){return w(this,null,function*(){let e=yield tH(n),t=ni().gapi;return he(t,n,"internal-error"),e.open({where:document.body,url:aH(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:oH,dontclear:!0},r=>new Promise((i,o)=>w(null,null,function*(){yield r.restyle({setHideOnLeave:!1});let s=Ns(n,"network-request-failed"),a=ni().setTimeout(()=>{o(s)},nH.get());function c(){ni().clearTimeout(a),i(r)}r.ping(c).then(c,()=>{o(s)})})))})}var lH={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},uH=500,dH=600,hH="_blank",fH="http://localhost",mm=class{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}};function pH(n,e,t,r=uH,i=dH){let o=Math.max((window.screen.availHeight-i)/2,0).toString(),s=Math.max((window.screen.availWidth-r)/2,0).toString(),a="",c=Object.assign(Object.assign({},lH),{width:r.toString(),height:i.toString(),top:o,left:s}),u=Nt().toLowerCase();t&&(a=cO(u)?hH:t),sO(u)&&(e=e||fH,c.scrollbars="yes");let d=Object.entries(c).reduce((v,[_,b])=>`${v}${_}=${b},`,"");if(ez(u)&&a!=="_self")return mH(e||"",a),new mm(null);let f=window.open(e||"",a,d);he(f,n,"popup-blocked");try{f.focus()}catch{}return new mm(f)}function mH(n,e){let t=document.createElement("a");t.href=n,t.target=e;let r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}var gH="__/auth/handler",vH="emulator/auth/handler",_H=encodeURIComponent("fac");function YA(n,e,t,r,i,o){return w(this,null,function*(){he(n.config.authDomain,n,"auth-domain-config-required"),he(n.config.apiKey,n,"invalid-api-key");let s={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:Xr,eventId:i};if(e instanceof dm){e.setDefaultLanguage(n.languageCode),s.providerId=e.providerId||"",ju(e.getCustomParameters())||(s.customParameters=JSON.stringify(e.getCustomParameters()));for(let[d,f]of Object.entries(o||{}))s[d]=f}if(e instanceof Xw){let d=e.getScopes().filter(f=>f!=="");d.length>0&&(s.scopes=d.join(","))}n.tenantId&&(s.tid=n.tenantId);let a=s;for(let d of Object.keys(a))a[d]===void 0&&delete a[d];let c=yield n._getAppCheckToken(),u=c?`#${_H}=${encodeURIComponent(c)}`:"";return`${yH(n)}?${Ms(a).slice(1)}${u}`})}function yH({config:n}){return n.emulator?lC(n,vH):`https://${n.authDomain}/${gH}`}var Uw="webStorageSupport",sC=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=wC,this._completeRedirectFn=Wz,this._overrideRedirectResult=$z}_openPopup(e,t,r,i){return w(this,null,function*(){var o;So((o=this.eventManagers[e._key()])===null||o===void 0?void 0:o.manager,"_initialize() not called before _openPopup()");let s=yield YA(e,t,r,$w(),i);return pH(e,s,IO())})}_openRedirect(e,t,r,i){return w(this,null,function*(){yield this._originValidation(e);let o=yield YA(e,t,r,$w(),i);return Sz(o),new Promise(()=>{})})}_initialize(e){let t=e._key();if(this.eventManagers[t]){let{manager:i,promise:o}=this.eventManagers[t];return i?Promise.resolve(i):(So(o,"If manager is not set, promise should be"),o)}let r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}initAndGetManager(e){return w(this,null,function*(){let t=yield cH(e),r=new oC(e);return t.register("authEvent",i=>(he(i?.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r})}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Uw,{type:Uw},i=>{var o;let s=(o=i?.[0])===null||o===void 0?void 0:o[Uw];s!==void 0&&t(!!s),ri(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){let t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=Zz(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return fO()||aO()||fC()}},MO=sC;var QA="@firebase/auth",ZA="1.10.8";var aC=class{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}getToken(e){return w(this,null,function*(){return this.assertAuthConfigured(),yield this.auth._initializationPromise,this.auth.currentUser?{accessToken:yield this.auth.currentUser.getIdToken(e)}:null})}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;let t=this.auth.onIdTokenChanged(r=>{e(r?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();let t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){he(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}};function wH(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function CH(n){Bn(new Gt("auth",(e,{options:t})=>{let r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),o=e.getProvider("app-check-internal"),{apiKey:s,authDomain:a}=r.options;he(s&&!s.includes(":"),"invalid-api-key",{appName:r.name});let c={apiKey:s,authDomain:a,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:pO(n)},u=new Yw(r,i,o,c);return cz(u,t),u},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),Bn(new Gt("auth-internal",e=>{let t=mc(e.getProvider("auth").getImmediate());return(r=>new aC(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),Je(QA,ZA,wH(n)),Je(QA,ZA,"esm2017")}var bH=5*60,IH=gw("authIdTokenMaxAge")||bH,JA=null,EH=n=>e=>w(null,null,function*(){let t=e&&(yield e.getIdTokenResult()),r=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(r&&r>IH)return;let i=t?.token;JA!==i&&(JA=i,yield fetch(n,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))});function CC(n=Ai()){let e=yo(n,"auth");if(e.isInitialized())return e.getImmediate();let t=pC(n,{popupRedirectResolver:MO,persistence:[TO,bO,wC]}),r=gw("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){let o=new URL(r,location.origin);if(location.origin===o.origin){let s=EH(o.toString());yC(t,s,()=>s(t.currentUser)),_C(t,a=>s(a))}}let i=pw("auth");return i&&mC(t,`http://${i}`),t}function xH(){var n,e;return(e=(n=document.getElementsByTagName("head"))===null||n===void 0?void 0:n[0])!==null&&e!==void 0?e:document}iz({loadJS(n){return new Promise((e,t)=>{let r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=i=>{let o=Ns("internal-error");o.customData=i,t(o)},r.type="text/javascript",r.charset="UTF-8",xH().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});CH("Browser");var PO="auth",Ls=class{constructor(e){return e}},Vs=class{constructor(){return wo(PO)}};var bC=new J("angularfire2.auth-instances");function g9(n,e){let t=Os(PO,n,e);return t&&new Ls(t)}function v9(n){return(e,t)=>{let r=e.runOutsideAngular(()=>n(t));return new Ls(r)}}var _9={provide:Vs,deps:[[new Mt,bC]]},y9={provide:Ls,useFactory:g9,deps:[[new Mt,bC],wr]};function AO(n,...e){return Je("angularfire",ei.full,"auth"),En([y9,_9,{provide:bC,useFactory:v9(n),multi:!0,deps:[Pe,rt,ti,Oi,[new Mt,bo],...e]}])}var OO=gt(CC,!0);var NO=gt(vC,!0,2);var RO=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},kO={};var ki,IC;(function(){var n;function e(D,E){function S(){}S.prototype=E.prototype,D.D=E.prototype,D.prototype=new S,D.prototype.constructor=D,D.C=function(T,M,O){for(var x=Array(arguments.length-2),vi=2;vi<arguments.length;vi++)x[vi-2]=arguments[vi];return E.prototype[M].apply(T,x)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,t),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(D,E,S){S||(S=0);var T=Array(16);if(typeof E=="string")for(var M=0;16>M;++M)T[M]=E.charCodeAt(S++)|E.charCodeAt(S++)<<8|E.charCodeAt(S++)<<16|E.charCodeAt(S++)<<24;else for(M=0;16>M;++M)T[M]=E[S++]|E[S++]<<8|E[S++]<<16|E[S++]<<24;E=D.g[0],S=D.g[1],M=D.g[2];var O=D.g[3],x=E+(O^S&(M^O))+T[0]+3614090360&4294967295;E=S+(x<<7&4294967295|x>>>25),x=O+(M^E&(S^M))+T[1]+3905402710&4294967295,O=E+(x<<12&4294967295|x>>>20),x=M+(S^O&(E^S))+T[2]+606105819&4294967295,M=O+(x<<17&4294967295|x>>>15),x=S+(E^M&(O^E))+T[3]+3250441966&4294967295,S=M+(x<<22&4294967295|x>>>10),x=E+(O^S&(M^O))+T[4]+4118548399&4294967295,E=S+(x<<7&4294967295|x>>>25),x=O+(M^E&(S^M))+T[5]+1200080426&4294967295,O=E+(x<<12&4294967295|x>>>20),x=M+(S^O&(E^S))+T[6]+2821735955&4294967295,M=O+(x<<17&4294967295|x>>>15),x=S+(E^M&(O^E))+T[7]+4249261313&4294967295,S=M+(x<<22&4294967295|x>>>10),x=E+(O^S&(M^O))+T[8]+1770035416&4294967295,E=S+(x<<7&4294967295|x>>>25),x=O+(M^E&(S^M))+T[9]+2336552879&4294967295,O=E+(x<<12&4294967295|x>>>20),x=M+(S^O&(E^S))+T[10]+4294925233&4294967295,M=O+(x<<17&4294967295|x>>>15),x=S+(E^M&(O^E))+T[11]+2304563134&4294967295,S=M+(x<<22&4294967295|x>>>10),x=E+(O^S&(M^O))+T[12]+1804603682&4294967295,E=S+(x<<7&4294967295|x>>>25),x=O+(M^E&(S^M))+T[13]+4254626195&4294967295,O=E+(x<<12&4294967295|x>>>20),x=M+(S^O&(E^S))+T[14]+2792965006&4294967295,M=O+(x<<17&4294967295|x>>>15),x=S+(E^M&(O^E))+T[15]+1236535329&4294967295,S=M+(x<<22&4294967295|x>>>10),x=E+(M^O&(S^M))+T[1]+4129170786&4294967295,E=S+(x<<5&4294967295|x>>>27),x=O+(S^M&(E^S))+T[6]+3225465664&4294967295,O=E+(x<<9&4294967295|x>>>23),x=M+(E^S&(O^E))+T[11]+643717713&4294967295,M=O+(x<<14&4294967295|x>>>18),x=S+(O^E&(M^O))+T[0]+3921069994&4294967295,S=M+(x<<20&4294967295|x>>>12),x=E+(M^O&(S^M))+T[5]+3593408605&4294967295,E=S+(x<<5&4294967295|x>>>27),x=O+(S^M&(E^S))+T[10]+38016083&4294967295,O=E+(x<<9&4294967295|x>>>23),x=M+(E^S&(O^E))+T[15]+3634488961&4294967295,M=O+(x<<14&4294967295|x>>>18),x=S+(O^E&(M^O))+T[4]+3889429448&4294967295,S=M+(x<<20&4294967295|x>>>12),x=E+(M^O&(S^M))+T[9]+568446438&4294967295,E=S+(x<<5&4294967295|x>>>27),x=O+(S^M&(E^S))+T[14]+3275163606&4294967295,O=E+(x<<9&4294967295|x>>>23),x=M+(E^S&(O^E))+T[3]+4107603335&4294967295,M=O+(x<<14&4294967295|x>>>18),x=S+(O^E&(M^O))+T[8]+1163531501&4294967295,S=M+(x<<20&4294967295|x>>>12),x=E+(M^O&(S^M))+T[13]+2850285829&4294967295,E=S+(x<<5&4294967295|x>>>27),x=O+(S^M&(E^S))+T[2]+4243563512&4294967295,O=E+(x<<9&4294967295|x>>>23),x=M+(E^S&(O^E))+T[7]+1735328473&4294967295,M=O+(x<<14&4294967295|x>>>18),x=S+(O^E&(M^O))+T[12]+2368359562&4294967295,S=M+(x<<20&4294967295|x>>>12),x=E+(S^M^O)+T[5]+4294588738&4294967295,E=S+(x<<4&4294967295|x>>>28),x=O+(E^S^M)+T[8]+2272392833&4294967295,O=E+(x<<11&4294967295|x>>>21),x=M+(O^E^S)+T[11]+1839030562&4294967295,M=O+(x<<16&4294967295|x>>>16),x=S+(M^O^E)+T[14]+4259657740&4294967295,S=M+(x<<23&4294967295|x>>>9),x=E+(S^M^O)+T[1]+2763975236&4294967295,E=S+(x<<4&4294967295|x>>>28),x=O+(E^S^M)+T[4]+1272893353&4294967295,O=E+(x<<11&4294967295|x>>>21),x=M+(O^E^S)+T[7]+4139469664&4294967295,M=O+(x<<16&4294967295|x>>>16),x=S+(M^O^E)+T[10]+3200236656&4294967295,S=M+(x<<23&4294967295|x>>>9),x=E+(S^M^O)+T[13]+681279174&4294967295,E=S+(x<<4&4294967295|x>>>28),x=O+(E^S^M)+T[0]+3936430074&4294967295,O=E+(x<<11&4294967295|x>>>21),x=M+(O^E^S)+T[3]+3572445317&4294967295,M=O+(x<<16&4294967295|x>>>16),x=S+(M^O^E)+T[6]+76029189&4294967295,S=M+(x<<23&4294967295|x>>>9),x=E+(S^M^O)+T[9]+3654602809&4294967295,E=S+(x<<4&4294967295|x>>>28),x=O+(E^S^M)+T[12]+3873151461&4294967295,O=E+(x<<11&4294967295|x>>>21),x=M+(O^E^S)+T[15]+530742520&4294967295,M=O+(x<<16&4294967295|x>>>16),x=S+(M^O^E)+T[2]+3299628645&4294967295,S=M+(x<<23&4294967295|x>>>9),x=E+(M^(S|~O))+T[0]+4096336452&4294967295,E=S+(x<<6&4294967295|x>>>26),x=O+(S^(E|~M))+T[7]+1126891415&4294967295,O=E+(x<<10&4294967295|x>>>22),x=M+(E^(O|~S))+T[14]+2878612391&4294967295,M=O+(x<<15&4294967295|x>>>17),x=S+(O^(M|~E))+T[5]+4237533241&4294967295,S=M+(x<<21&4294967295|x>>>11),x=E+(M^(S|~O))+T[12]+1700485571&4294967295,E=S+(x<<6&4294967295|x>>>26),x=O+(S^(E|~M))+T[3]+2399980690&4294967295,O=E+(x<<10&4294967295|x>>>22),x=M+(E^(O|~S))+T[10]+4293915773&4294967295,M=O+(x<<15&4294967295|x>>>17),x=S+(O^(M|~E))+T[1]+2240044497&4294967295,S=M+(x<<21&4294967295|x>>>11),x=E+(M^(S|~O))+T[8]+1873313359&4294967295,E=S+(x<<6&4294967295|x>>>26),x=O+(S^(E|~M))+T[15]+4264355552&4294967295,O=E+(x<<10&4294967295|x>>>22),x=M+(E^(O|~S))+T[6]+2734768916&4294967295,M=O+(x<<15&4294967295|x>>>17),x=S+(O^(M|~E))+T[13]+1309151649&4294967295,S=M+(x<<21&4294967295|x>>>11),x=E+(M^(S|~O))+T[4]+4149444226&4294967295,E=S+(x<<6&4294967295|x>>>26),x=O+(S^(E|~M))+T[11]+3174756917&4294967295,O=E+(x<<10&4294967295|x>>>22),x=M+(E^(O|~S))+T[2]+718787259&4294967295,M=O+(x<<15&4294967295|x>>>17),x=S+(O^(M|~E))+T[9]+3951481745&4294967295,D.g[0]=D.g[0]+E&4294967295,D.g[1]=D.g[1]+(M+(x<<21&4294967295|x>>>11))&4294967295,D.g[2]=D.g[2]+M&4294967295,D.g[3]=D.g[3]+O&4294967295}r.prototype.u=function(D,E){E===void 0&&(E=D.length);for(var S=E-this.blockSize,T=this.B,M=this.h,O=0;O<E;){if(M==0)for(;O<=S;)i(this,D,O),O+=this.blockSize;if(typeof D=="string"){for(;O<E;)if(T[M++]=D.charCodeAt(O++),M==this.blockSize){i(this,T),M=0;break}}else for(;O<E;)if(T[M++]=D[O++],M==this.blockSize){i(this,T),M=0;break}}this.h=M,this.o+=E},r.prototype.v=function(){var D=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);D[0]=128;for(var E=1;E<D.length-8;++E)D[E]=0;var S=8*this.o;for(E=D.length-8;E<D.length;++E)D[E]=S&255,S/=256;for(this.u(D),D=Array(16),E=S=0;4>E;++E)for(var T=0;32>T;T+=8)D[S++]=this.g[E]>>>T&255;return D};function o(D,E){var S=a;return Object.prototype.hasOwnProperty.call(S,D)?S[D]:S[D]=E(D)}function s(D,E){this.h=E;for(var S=[],T=!0,M=D.length-1;0<=M;M--){var O=D[M]|0;T&&O==E||(S[M]=O,T=!1)}this.g=S}var a={};function c(D){return-128<=D&&128>D?o(D,function(E){return new s([E|0],0>E?-1:0)}):new s([D|0],0>D?-1:0)}function u(D){if(isNaN(D)||!isFinite(D))return f;if(0>D)return R(u(-D));for(var E=[],S=1,T=0;D>=S;T++)E[T]=D/S|0,S*=4294967296;return new s(E,0)}function d(D,E){if(D.length==0)throw Error("number format error: empty string");if(E=E||10,2>E||36<E)throw Error("radix out of range: "+E);if(D.charAt(0)=="-")return R(d(D.substring(1),E));if(0<=D.indexOf("-"))throw Error('number format error: interior "-" character');for(var S=u(Math.pow(E,8)),T=f,M=0;M<D.length;M+=8){var O=Math.min(8,D.length-M),x=parseInt(D.substring(M,M+O),E);8>O?(O=u(Math.pow(E,O)),T=T.j(O).add(u(x))):(T=T.j(S),T=T.add(u(x)))}return T}var f=c(0),v=c(1),_=c(16777216);n=s.prototype,n.m=function(){if(N(this))return-R(this).m();for(var D=0,E=1,S=0;S<this.g.length;S++){var T=this.i(S);D+=(0<=T?T:4294967296+T)*E,E*=4294967296}return D},n.toString=function(D){if(D=D||10,2>D||36<D)throw Error("radix out of range: "+D);if(b(this))return"0";if(N(this))return"-"+R(this).toString(D);for(var E=u(Math.pow(D,6)),S=this,T="";;){var M=Fe(S,E).g;S=G(S,M.j(E));var O=((0<S.g.length?S.g[0]:S.h)>>>0).toString(D);if(S=M,b(S))return O+T;for(;6>O.length;)O="0"+O;T=O+T}},n.i=function(D){return 0>D?0:D<this.g.length?this.g[D]:this.h};function b(D){if(D.h!=0)return!1;for(var E=0;E<D.g.length;E++)if(D.g[E]!=0)return!1;return!0}function N(D){return D.h==-1}n.l=function(D){return D=G(this,D),N(D)?-1:b(D)?0:1};function R(D){for(var E=D.g.length,S=[],T=0;T<E;T++)S[T]=~D.g[T];return new s(S,~D.h).add(v)}n.abs=function(){return N(this)?R(this):this},n.add=function(D){for(var E=Math.max(this.g.length,D.g.length),S=[],T=0,M=0;M<=E;M++){var O=T+(this.i(M)&65535)+(D.i(M)&65535),x=(O>>>16)+(this.i(M)>>>16)+(D.i(M)>>>16);T=x>>>16,O&=65535,x&=65535,S[M]=x<<16|O}return new s(S,S[S.length-1]&-2147483648?-1:0)};function G(D,E){return D.add(R(E))}n.j=function(D){if(b(this)||b(D))return f;if(N(this))return N(D)?R(this).j(R(D)):R(R(this).j(D));if(N(D))return R(this.j(R(D)));if(0>this.l(_)&&0>D.l(_))return u(this.m()*D.m());for(var E=this.g.length+D.g.length,S=[],T=0;T<2*E;T++)S[T]=0;for(T=0;T<this.g.length;T++)for(var M=0;M<D.g.length;M++){var O=this.i(T)>>>16,x=this.i(T)&65535,vi=D.i(M)>>>16,cl=D.i(M)&65535;S[2*T+2*M]+=x*cl,oe(S,2*T+2*M),S[2*T+2*M+1]+=O*cl,oe(S,2*T+2*M+1),S[2*T+2*M+1]+=x*vi,oe(S,2*T+2*M+1),S[2*T+2*M+2]+=O*vi,oe(S,2*T+2*M+2)}for(T=0;T<E;T++)S[T]=S[2*T+1]<<16|S[2*T];for(T=E;T<2*E;T++)S[T]=0;return new s(S,0)};function oe(D,E){for(;(D[E]&65535)!=D[E];)D[E+1]+=D[E]>>>16,D[E]&=65535,E++}function ce(D,E){this.g=D,this.h=E}function Fe(D,E){if(b(E))throw Error("division by zero");if(b(D))return new ce(f,f);if(N(D))return E=Fe(R(D),E),new ce(R(E.g),R(E.h));if(N(E))return E=Fe(D,R(E)),new ce(R(E.g),E.h);if(30<D.g.length){if(N(D)||N(E))throw Error("slowDivide_ only works with positive integers.");for(var S=v,T=E;0>=T.l(D);)S=Dt(S),T=Dt(T);var M=ze(S,1),O=ze(T,1);for(T=ze(T,2),S=ze(S,2);!b(T);){var x=O.add(T);0>=x.l(D)&&(M=M.add(S),O=x),T=ze(T,1),S=ze(S,1)}return E=G(D,M.j(E)),new ce(M,E)}for(M=f;0<=D.l(E);){for(S=Math.max(1,Math.floor(D.m()/E.m())),T=Math.ceil(Math.log(S)/Math.LN2),T=48>=T?1:Math.pow(2,T-48),O=u(S),x=O.j(E);N(x)||0<x.l(D);)S-=T,O=u(S),x=O.j(E);b(O)&&(O=v),M=M.add(O),D=G(D,x)}return new ce(M,D)}n.A=function(D){return Fe(this,D).h},n.and=function(D){for(var E=Math.max(this.g.length,D.g.length),S=[],T=0;T<E;T++)S[T]=this.i(T)&D.i(T);return new s(S,this.h&D.h)},n.or=function(D){for(var E=Math.max(this.g.length,D.g.length),S=[],T=0;T<E;T++)S[T]=this.i(T)|D.i(T);return new s(S,this.h|D.h)},n.xor=function(D){for(var E=Math.max(this.g.length,D.g.length),S=[],T=0;T<E;T++)S[T]=this.i(T)^D.i(T);return new s(S,this.h^D.h)};function Dt(D){for(var E=D.g.length+1,S=[],T=0;T<E;T++)S[T]=D.i(T)<<1|D.i(T-1)>>>31;return new s(S,D.h)}function ze(D,E){var S=E>>5;E%=32;for(var T=D.g.length-S,M=[],O=0;O<T;O++)M[O]=0<E?D.i(O+S)>>>E|D.i(O+S+1)<<32-E:D.i(O+S);return new s(M,D.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,IC=kO.Md5=r,s.prototype.add=s.prototype.add,s.prototype.multiply=s.prototype.j,s.prototype.modulo=s.prototype.A,s.prototype.compare=s.prototype.l,s.prototype.toNumber=s.prototype.m,s.prototype.toString=s.prototype.toString,s.prototype.getBits=s.prototype.i,s.fromNumber=u,s.fromString=d,ki=kO.Integer=s}).apply(typeof RO<"u"?RO:typeof self<"u"?self:typeof window<"u"?window:{});var ym=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Fi={};var EC,C9,gc,xC,nd,wm,SC,TC,DC;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(l,h,p){return l==Array.prototype||l==Object.prototype||(l[h]=p.value),l};function t(l){l=[typeof globalThis=="object"&&globalThis,l,typeof window=="object"&&window,typeof self=="object"&&self,typeof ym=="object"&&ym];for(var h=0;h<l.length;++h){var p=l[h];if(p&&p.Math==Math)return p}throw Error("Cannot find global object")}var r=t(this);function i(l,h){if(h)e:{var p=r;l=l.split(".");for(var C=0;C<l.length-1;C++){var P=l[C];if(!(P in p))break e;p=p[P]}l=l[l.length-1],C=p[l],h=h(C),h!=C&&h!=null&&e(p,l,{configurable:!0,writable:!0,value:h})}}function o(l,h){l instanceof String&&(l+="");var p=0,C=!1,P={next:function(){if(!C&&p<l.length){var k=p++;return{value:h(k,l[k]),done:!1}}return C=!0,{done:!0,value:void 0}}};return P[Symbol.iterator]=function(){return P},P}i("Array.prototype.values",function(l){return l||function(){return o(this,function(h,p){return p})}});var s=s||{},a=this||self;function c(l){var h=typeof l;return h=h!="object"?h:l?Array.isArray(l)?"array":h:"null",h=="array"||h=="object"&&typeof l.length=="number"}function u(l){var h=typeof l;return h=="object"&&l!=null||h=="function"}function d(l,h,p){return l.call.apply(l.bind,arguments)}function f(l,h,p){if(!l)throw Error();if(2<arguments.length){var C=Array.prototype.slice.call(arguments,2);return function(){var P=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(P,C),l.apply(h,P)}}return function(){return l.apply(h,arguments)}}function v(l,h,p){return v=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?d:f,v.apply(null,arguments)}function _(l,h){var p=Array.prototype.slice.call(arguments,1);return function(){var C=p.slice();return C.push.apply(C,arguments),l.apply(this,C)}}function b(l,h){function p(){}p.prototype=h.prototype,l.aa=h.prototype,l.prototype=new p,l.prototype.constructor=l,l.Qb=function(C,P,k){for(var W=Array(arguments.length-2),Ke=2;Ke<arguments.length;Ke++)W[Ke-2]=arguments[Ke];return h.prototype[P].apply(C,W)}}function N(l){let h=l.length;if(0<h){let p=Array(h);for(let C=0;C<h;C++)p[C]=l[C];return p}return[]}function R(l,h){for(let p=1;p<arguments.length;p++){let C=arguments[p];if(c(C)){let P=l.length||0,k=C.length||0;l.length=P+k;for(let W=0;W<k;W++)l[P+W]=C[W]}else l.push(C)}}class G{constructor(h,p){this.i=h,this.j=p,this.h=0,this.g=null}get(){let h;return 0<this.h?(this.h--,h=this.g,this.g=h.next,h.next=null):h=this.i(),h}}function oe(l){return/^[\s\xa0]*$/.test(l)}function ce(){var l=a.navigator;return l&&(l=l.userAgent)?l:""}function Fe(l){return Fe[" "](l),l}Fe[" "]=function(){};var Dt=ce().indexOf("Gecko")!=-1&&!(ce().toLowerCase().indexOf("webkit")!=-1&&ce().indexOf("Edge")==-1)&&!(ce().indexOf("Trident")!=-1||ce().indexOf("MSIE")!=-1)&&ce().indexOf("Edge")==-1;function ze(l,h,p){for(let C in l)h.call(p,l[C],C,l)}function D(l,h){for(let p in l)h.call(void 0,l[p],p,l)}function E(l){let h={};for(let p in l)h[p]=l[p];return h}let S="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function T(l,h){let p,C;for(let P=1;P<arguments.length;P++){C=arguments[P];for(p in C)l[p]=C[p];for(let k=0;k<S.length;k++)p=S[k],Object.prototype.hasOwnProperty.call(C,p)&&(l[p]=C[p])}}function M(l){var h=1;l=l.split(":");let p=[];for(;0<h&&l.length;)p.push(l.shift()),h--;return l.length&&p.push(l.join(":")),p}function O(l){a.setTimeout(()=>{throw l},0)}function x(){var l=fv;let h=null;return l.g&&(h=l.g,l.g=l.g.next,l.g||(l.h=null),h.next=null),h}class vi{constructor(){this.h=this.g=null}add(h,p){let C=cl.get();C.set(h,p),this.h?this.h.next=C:this.g=C,this.h=C}}var cl=new G(()=>new WF,l=>l.reset());class WF{constructor(){this.next=this.g=this.h=null}set(h,p){this.h=h,this.g=p,this.next=null}reset(){this.next=this.g=this.h=null}}let ll,ul=!1,fv=new vi,px=()=>{let l=a.Promise.resolve(void 0);ll=()=>{l.then(qF)}};var qF=()=>{for(var l;l=x();){try{l.h.call(l.g)}catch(p){O(p)}var h=cl;h.j(l),100>h.h&&(h.h++,l.next=h.g,h.g=l)}ul=!1};function Gi(){this.s=this.s,this.C=this.C}Gi.prototype.s=!1,Gi.prototype.ma=function(){this.s||(this.s=!0,this.N())},Gi.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function Qt(l,h){this.type=l,this.g=this.target=h,this.defaultPrevented=!1}Qt.prototype.h=function(){this.defaultPrevented=!0};var GF=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var l=!1,h=Object.defineProperty({},"passive",{get:function(){l=!0}});try{let p=()=>{};a.addEventListener("test",p,h),a.removeEventListener("test",p,h)}catch{}return l}();function dl(l,h){if(Qt.call(this,l?l.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,l){var p=this.type=l.type,C=l.changedTouches&&l.changedTouches.length?l.changedTouches[0]:null;if(this.target=l.target||l.srcElement,this.g=h,h=l.relatedTarget){if(Dt){e:{try{Fe(h.nodeName);var P=!0;break e}catch{}P=!1}P||(h=null)}}else p=="mouseover"?h=l.fromElement:p=="mouseout"&&(h=l.toElement);this.relatedTarget=h,C?(this.clientX=C.clientX!==void 0?C.clientX:C.pageX,this.clientY=C.clientY!==void 0?C.clientY:C.pageY,this.screenX=C.screenX||0,this.screenY=C.screenY||0):(this.clientX=l.clientX!==void 0?l.clientX:l.pageX,this.clientY=l.clientY!==void 0?l.clientY:l.pageY,this.screenX=l.screenX||0,this.screenY=l.screenY||0),this.button=l.button,this.key=l.key||"",this.ctrlKey=l.ctrlKey,this.altKey=l.altKey,this.shiftKey=l.shiftKey,this.metaKey=l.metaKey,this.pointerId=l.pointerId||0,this.pointerType=typeof l.pointerType=="string"?l.pointerType:KF[l.pointerType]||"",this.state=l.state,this.i=l,l.defaultPrevented&&dl.aa.h.call(this)}}b(dl,Qt);var KF={2:"touch",3:"pen",4:"mouse"};dl.prototype.h=function(){dl.aa.h.call(this);var l=this.i;l.preventDefault?l.preventDefault():l.returnValue=!1};var hl="closure_listenable_"+(1e6*Math.random()|0),YF=0;function QF(l,h,p,C,P){this.listener=l,this.proxy=null,this.src=h,this.type=p,this.capture=!!C,this.ha=P,this.key=++YF,this.da=this.fa=!1}function oh(l){l.da=!0,l.listener=null,l.proxy=null,l.src=null,l.ha=null}function sh(l){this.src=l,this.g={},this.h=0}sh.prototype.add=function(l,h,p,C,P){var k=l.toString();l=this.g[k],l||(l=this.g[k]=[],this.h++);var W=mv(l,h,C,P);return-1<W?(h=l[W],p||(h.fa=!1)):(h=new QF(h,this.src,k,!!C,P),h.fa=p,l.push(h)),h};function pv(l,h){var p=h.type;if(p in l.g){var C=l.g[p],P=Array.prototype.indexOf.call(C,h,void 0),k;(k=0<=P)&&Array.prototype.splice.call(C,P,1),k&&(oh(h),l.g[p].length==0&&(delete l.g[p],l.h--))}}function mv(l,h,p,C){for(var P=0;P<l.length;++P){var k=l[P];if(!k.da&&k.listener==h&&k.capture==!!p&&k.ha==C)return P}return-1}var gv="closure_lm_"+(1e6*Math.random()|0),vv={};function mx(l,h,p,C,P){if(C&&C.once)return vx(l,h,p,C,P);if(Array.isArray(h)){for(var k=0;k<h.length;k++)mx(l,h[k],p,C,P);return null}return p=Cv(p),l&&l[hl]?l.K(h,p,u(C)?!!C.capture:!!C,P):gx(l,h,p,!1,C,P)}function gx(l,h,p,C,P,k){if(!h)throw Error("Invalid event type");var W=u(P)?!!P.capture:!!P,Ke=yv(l);if(Ke||(l[gv]=Ke=new sh(l)),p=Ke.add(h,p,C,W,k),p.proxy)return p;if(C=ZF(),p.proxy=C,C.src=l,C.listener=p,l.addEventListener)GF||(P=W),P===void 0&&(P=!1),l.addEventListener(h.toString(),C,P);else if(l.attachEvent)l.attachEvent(yx(h.toString()),C);else if(l.addListener&&l.removeListener)l.addListener(C);else throw Error("addEventListener and attachEvent are unavailable.");return p}function ZF(){function l(p){return h.call(l.src,l.listener,p)}let h=JF;return l}function vx(l,h,p,C,P){if(Array.isArray(h)){for(var k=0;k<h.length;k++)vx(l,h[k],p,C,P);return null}return p=Cv(p),l&&l[hl]?l.L(h,p,u(C)?!!C.capture:!!C,P):gx(l,h,p,!0,C,P)}function _x(l,h,p,C,P){if(Array.isArray(h))for(var k=0;k<h.length;k++)_x(l,h[k],p,C,P);else C=u(C)?!!C.capture:!!C,p=Cv(p),l&&l[hl]?(l=l.i,h=String(h).toString(),h in l.g&&(k=l.g[h],p=mv(k,p,C,P),-1<p&&(oh(k[p]),Array.prototype.splice.call(k,p,1),k.length==0&&(delete l.g[h],l.h--)))):l&&(l=yv(l))&&(h=l.g[h.toString()],l=-1,h&&(l=mv(h,p,C,P)),(p=-1<l?h[l]:null)&&_v(p))}function _v(l){if(typeof l!="number"&&l&&!l.da){var h=l.src;if(h&&h[hl])pv(h.i,l);else{var p=l.type,C=l.proxy;h.removeEventListener?h.removeEventListener(p,C,l.capture):h.detachEvent?h.detachEvent(yx(p),C):h.addListener&&h.removeListener&&h.removeListener(C),(p=yv(h))?(pv(p,l),p.h==0&&(p.src=null,h[gv]=null)):oh(l)}}}function yx(l){return l in vv?vv[l]:vv[l]="on"+l}function JF(l,h){if(l.da)l=!0;else{h=new dl(h,this);var p=l.listener,C=l.ha||l.src;l.fa&&_v(l),l=p.call(C,h)}return l}function yv(l){return l=l[gv],l instanceof sh?l:null}var wv="__closure_events_fn_"+(1e9*Math.random()>>>0);function Cv(l){return typeof l=="function"?l:(l[wv]||(l[wv]=function(h){return l.handleEvent(h)}),l[wv])}function Zt(){Gi.call(this),this.i=new sh(this),this.M=this,this.F=null}b(Zt,Gi),Zt.prototype[hl]=!0,Zt.prototype.removeEventListener=function(l,h,p,C){_x(this,l,h,p,C)};function un(l,h){var p,C=l.F;if(C)for(p=[];C;C=C.F)p.push(C);if(l=l.M,C=h.type||h,typeof h=="string")h=new Qt(h,l);else if(h instanceof Qt)h.target=h.target||l;else{var P=h;h=new Qt(C,l),T(h,P)}if(P=!0,p)for(var k=p.length-1;0<=k;k--){var W=h.g=p[k];P=ah(W,C,!0,h)&&P}if(W=h.g=l,P=ah(W,C,!0,h)&&P,P=ah(W,C,!1,h)&&P,p)for(k=0;k<p.length;k++)W=h.g=p[k],P=ah(W,C,!1,h)&&P}Zt.prototype.N=function(){if(Zt.aa.N.call(this),this.i){var l=this.i,h;for(h in l.g){for(var p=l.g[h],C=0;C<p.length;C++)oh(p[C]);delete l.g[h],l.h--}}this.F=null},Zt.prototype.K=function(l,h,p,C){return this.i.add(String(l),h,!1,p,C)},Zt.prototype.L=function(l,h,p,C){return this.i.add(String(l),h,!0,p,C)};function ah(l,h,p,C){if(h=l.i.g[String(h)],!h)return!0;h=h.concat();for(var P=!0,k=0;k<h.length;++k){var W=h[k];if(W&&!W.da&&W.capture==p){var Ke=W.listener,jt=W.ha||W.src;W.fa&&pv(l.i,W),P=Ke.call(jt,C)!==!1&&P}}return P&&!C.defaultPrevented}function wx(l,h,p){if(typeof l=="function")p&&(l=v(l,p));else if(l&&typeof l.handleEvent=="function")l=v(l.handleEvent,l);else throw Error("Invalid listener argument");return 2147483647<Number(h)?-1:a.setTimeout(l,h||0)}function Cx(l){l.g=wx(()=>{l.g=null,l.i&&(l.i=!1,Cx(l))},l.l);let h=l.h;l.h=null,l.m.apply(null,h)}class XF extends Gi{constructor(h,p){super(),this.m=h,this.l=p,this.h=null,this.i=!1,this.g=null}j(h){this.h=arguments,this.g?this.i=!0:Cx(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function fl(l){Gi.call(this),this.h=l,this.g={}}b(fl,Gi);var bx=[];function Ix(l){ze(l.g,function(h,p){this.g.hasOwnProperty(p)&&_v(h)},l),l.g={}}fl.prototype.N=function(){fl.aa.N.call(this),Ix(this)},fl.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var bv=a.JSON.stringify,eL=a.JSON.parse,tL=class{stringify(l){return a.JSON.stringify(l,void 0)}parse(l){return a.JSON.parse(l,void 0)}};function Iv(){}Iv.prototype.h=null;function Ex(l){return l.h||(l.h=l.i())}function xx(){}var pl={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Ev(){Qt.call(this,"d")}b(Ev,Qt);function xv(){Qt.call(this,"c")}b(xv,Qt);var Wo={},Sx=null;function ch(){return Sx=Sx||new Zt}Wo.La="serverreachability";function Tx(l){Qt.call(this,Wo.La,l)}b(Tx,Qt);function ml(l){let h=ch();un(h,new Tx(h))}Wo.STAT_EVENT="statevent";function Dx(l,h){Qt.call(this,Wo.STAT_EVENT,l),this.stat=h}b(Dx,Qt);function dn(l){let h=ch();un(h,new Dx(h,l))}Wo.Ma="timingevent";function Mx(l,h){Qt.call(this,Wo.Ma,l),this.size=h}b(Mx,Qt);function gl(l,h){if(typeof l!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){l()},h)}function vl(){this.g=!0}vl.prototype.xa=function(){this.g=!1};function nL(l,h,p,C,P,k){l.info(function(){if(l.g)if(k)for(var W="",Ke=k.split("&"),jt=0;jt<Ke.length;jt++){var Le=Ke[jt].split("=");if(1<Le.length){var Jt=Le[0];Le=Le[1];var Xt=Jt.split("_");W=2<=Xt.length&&Xt[1]=="type"?W+(Jt+"="+Le+"&"):W+(Jt+"=redacted&")}}else W=null;else W=k;return"XMLHTTP REQ ("+C+") [attempt "+P+"]: "+h+`
`+p+`
`+W})}function rL(l,h,p,C,P,k,W){l.info(function(){return"XMLHTTP RESP ("+C+") [ attempt "+P+"]: "+h+`
`+p+`
`+k+" "+W})}function ca(l,h,p,C){l.info(function(){return"XMLHTTP TEXT ("+h+"): "+oL(l,p)+(C?" "+C:"")})}function iL(l,h){l.info(function(){return"TIMEOUT: "+h})}vl.prototype.info=function(){};function oL(l,h){if(!l.g)return h;if(!h)return null;try{var p=JSON.parse(h);if(p){for(l=0;l<p.length;l++)if(Array.isArray(p[l])){var C=p[l];if(!(2>C.length)){var P=C[1];if(Array.isArray(P)&&!(1>P.length)){var k=P[0];if(k!="noop"&&k!="stop"&&k!="close")for(var W=1;W<P.length;W++)P[W]=""}}}}return bv(p)}catch{return h}}var lh={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Px={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Sv;function uh(){}b(uh,Iv),uh.prototype.g=function(){return new XMLHttpRequest},uh.prototype.i=function(){return{}},Sv=new uh;function Ki(l,h,p,C){this.j=l,this.i=h,this.l=p,this.R=C||1,this.U=new fl(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Ax}function Ax(){this.i=null,this.g="",this.h=!1}var Ox={},Tv={};function Dv(l,h,p){l.L=1,l.v=ph(_i(h)),l.m=p,l.P=!0,Nx(l,null)}function Nx(l,h){l.F=Date.now(),dh(l),l.A=_i(l.v);var p=l.A,C=l.R;Array.isArray(C)||(C=[String(C)]),Gx(p.i,"t",C),l.C=0,p=l.j.J,l.h=new Ax,l.g=dS(l.j,p?h:null,!l.m),0<l.O&&(l.M=new XF(v(l.Y,l,l.g),l.O)),h=l.U,p=l.g,C=l.ca;var P="readystatechange";Array.isArray(P)||(P&&(bx[0]=P.toString()),P=bx);for(var k=0;k<P.length;k++){var W=mx(p,P[k],C||h.handleEvent,!1,h.h||h);if(!W)break;h.g[W.key]=W}h=l.H?E(l.H):{},l.m?(l.u||(l.u="POST"),h["Content-Type"]="application/x-www-form-urlencoded",l.g.ea(l.A,l.u,l.m,h)):(l.u="GET",l.g.ea(l.A,l.u,null,h)),ml(),nL(l.i,l.u,l.A,l.l,l.R,l.m)}Ki.prototype.ca=function(l){l=l.target;let h=this.M;h&&yi(l)==3?h.j():this.Y(l)},Ki.prototype.Y=function(l){try{if(l==this.g)e:{let Xt=yi(this.g);var h=this.g.Ba();let da=this.g.Z();if(!(3>Xt)&&(Xt!=3||this.g&&(this.h.h||this.g.oa()||eS(this.g)))){this.J||Xt!=4||h==7||(h==8||0>=da?ml(3):ml(2)),Mv(this);var p=this.g.Z();this.X=p;t:if(Rx(this)){var C=eS(this.g);l="";var P=C.length,k=yi(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){qo(this),_l(this);var W="";break t}this.h.i=new a.TextDecoder}for(h=0;h<P;h++)this.h.h=!0,l+=this.h.i.decode(C[h],{stream:!(k&&h==P-1)});C.length=0,this.h.g+=l,this.C=0,W=this.h.g}else W=this.g.oa();if(this.o=p==200,rL(this.i,this.u,this.A,this.l,this.R,Xt,p),this.o){if(this.T&&!this.K){t:{if(this.g){var Ke,jt=this.g;if((Ke=jt.g?jt.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!oe(Ke)){var Le=Ke;break t}}Le=null}if(p=Le)ca(this.i,this.l,p,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Pv(this,p);else{this.o=!1,this.s=3,dn(12),qo(this),_l(this);break e}}if(this.P){p=!0;let sr;for(;!this.J&&this.C<W.length;)if(sr=sL(this,W),sr==Tv){Xt==4&&(this.s=4,dn(14),p=!1),ca(this.i,this.l,null,"[Incomplete Response]");break}else if(sr==Ox){this.s=4,dn(15),ca(this.i,this.l,W,"[Invalid Chunk]"),p=!1;break}else ca(this.i,this.l,sr,null),Pv(this,sr);if(Rx(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Xt!=4||W.length!=0||this.h.h||(this.s=1,dn(16),p=!1),this.o=this.o&&p,!p)ca(this.i,this.l,W,"[Invalid Chunked Response]"),qo(this),_l(this);else if(0<W.length&&!this.W){this.W=!0;var Jt=this.j;Jt.g==this&&Jt.ba&&!Jt.M&&(Jt.j.info("Great, no buffering proxy detected. Bytes received: "+W.length),Fv(Jt),Jt.M=!0,dn(11))}}else ca(this.i,this.l,W,null),Pv(this,W);Xt==4&&qo(this),this.o&&!this.J&&(Xt==4?aS(this.j,this):(this.o=!1,dh(this)))}else IL(this.g),p==400&&0<W.indexOf("Unknown SID")?(this.s=3,dn(12)):(this.s=0,dn(13)),qo(this),_l(this)}}}catch{}finally{}};function Rx(l){return l.g?l.u=="GET"&&l.L!=2&&l.j.Ca:!1}function sL(l,h){var p=l.C,C=h.indexOf(`
`,p);return C==-1?Tv:(p=Number(h.substring(p,C)),isNaN(p)?Ox:(C+=1,C+p>h.length?Tv:(h=h.slice(C,C+p),l.C=C+p,h)))}Ki.prototype.cancel=function(){this.J=!0,qo(this)};function dh(l){l.S=Date.now()+l.I,kx(l,l.I)}function kx(l,h){if(l.B!=null)throw Error("WatchDog timer not null");l.B=gl(v(l.ba,l),h)}function Mv(l){l.B&&(a.clearTimeout(l.B),l.B=null)}Ki.prototype.ba=function(){this.B=null;let l=Date.now();0<=l-this.S?(iL(this.i,this.A),this.L!=2&&(ml(),dn(17)),qo(this),this.s=2,_l(this)):kx(this,this.S-l)};function _l(l){l.j.G==0||l.J||aS(l.j,l)}function qo(l){Mv(l);var h=l.M;h&&typeof h.ma=="function"&&h.ma(),l.M=null,Ix(l.U),l.g&&(h=l.g,l.g=null,h.abort(),h.ma())}function Pv(l,h){try{var p=l.j;if(p.G!=0&&(p.g==l||Av(p.h,l))){if(!l.K&&Av(p.h,l)&&p.G==3){try{var C=p.Da.g.parse(h)}catch{C=null}if(Array.isArray(C)&&C.length==3){var P=C;if(P[0]==0){e:if(!p.u){if(p.g)if(p.g.F+3e3<l.F)yh(p),vh(p);else break e;kv(p),dn(18)}}else p.za=P[1],0<p.za-p.T&&37500>P[2]&&p.F&&p.v==0&&!p.C&&(p.C=gl(v(p.Za,p),6e3));if(1>=Vx(p.h)&&p.ca){try{p.ca()}catch{}p.ca=void 0}}else Ko(p,11)}else if((l.K||p.g==l)&&yh(p),!oe(h))for(P=p.Da.g.parse(h),h=0;h<P.length;h++){let Le=P[h];if(p.T=Le[0],Le=Le[1],p.G==2)if(Le[0]=="c"){p.K=Le[1],p.ia=Le[2];let Jt=Le[3];Jt!=null&&(p.la=Jt,p.j.info("VER="+p.la));let Xt=Le[4];Xt!=null&&(p.Aa=Xt,p.j.info("SVER="+p.Aa));let da=Le[5];da!=null&&typeof da=="number"&&0<da&&(C=1.5*da,p.L=C,p.j.info("backChannelRequestTimeoutMs_="+C)),C=p;let sr=l.g;if(sr){let Ch=sr.g?sr.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Ch){var k=C.h;k.g||Ch.indexOf("spdy")==-1&&Ch.indexOf("quic")==-1&&Ch.indexOf("h2")==-1||(k.j=k.l,k.g=new Set,k.h&&(Ov(k,k.h),k.h=null))}if(C.D){let Lv=sr.g?sr.g.getResponseHeader("X-HTTP-Session-Id"):null;Lv&&(C.ya=Lv,tt(C.I,C.D,Lv))}}p.G=3,p.l&&p.l.ua(),p.ba&&(p.R=Date.now()-l.F,p.j.info("Handshake RTT: "+p.R+"ms")),C=p;var W=l;if(C.qa=uS(C,C.J?C.ia:null,C.W),W.K){jx(C.h,W);var Ke=W,jt=C.L;jt&&(Ke.I=jt),Ke.B&&(Mv(Ke),dh(Ke)),C.g=W}else oS(C);0<p.i.length&&_h(p)}else Le[0]!="stop"&&Le[0]!="close"||Ko(p,7);else p.G==3&&(Le[0]=="stop"||Le[0]=="close"?Le[0]=="stop"?Ko(p,7):Rv(p):Le[0]!="noop"&&p.l&&p.l.ta(Le),p.v=0)}}ml(4)}catch{}}var aL=class{constructor(l,h){this.g=l,this.map=h}};function Fx(l){this.l=l||10,a.PerformanceNavigationTiming?(l=a.performance.getEntriesByType("navigation"),l=0<l.length&&(l[0].nextHopProtocol=="hq"||l[0].nextHopProtocol=="h2")):l=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=l?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Lx(l){return l.h?!0:l.g?l.g.size>=l.j:!1}function Vx(l){return l.h?1:l.g?l.g.size:0}function Av(l,h){return l.h?l.h==h:l.g?l.g.has(h):!1}function Ov(l,h){l.g?l.g.add(h):l.h=h}function jx(l,h){l.h&&l.h==h?l.h=null:l.g&&l.g.has(h)&&l.g.delete(h)}Fx.prototype.cancel=function(){if(this.i=Bx(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(let l of this.g.values())l.cancel();this.g.clear()}};function Bx(l){if(l.h!=null)return l.i.concat(l.h.D);if(l.g!=null&&l.g.size!==0){let h=l.i;for(let p of l.g.values())h=h.concat(p.D);return h}return N(l.i)}function cL(l){if(l.V&&typeof l.V=="function")return l.V();if(typeof Map<"u"&&l instanceof Map||typeof Set<"u"&&l instanceof Set)return Array.from(l.values());if(typeof l=="string")return l.split("");if(c(l)){for(var h=[],p=l.length,C=0;C<p;C++)h.push(l[C]);return h}h=[],p=0;for(C in l)h[p++]=l[C];return h}function lL(l){if(l.na&&typeof l.na=="function")return l.na();if(!l.V||typeof l.V!="function"){if(typeof Map<"u"&&l instanceof Map)return Array.from(l.keys());if(!(typeof Set<"u"&&l instanceof Set)){if(c(l)||typeof l=="string"){var h=[];l=l.length;for(var p=0;p<l;p++)h.push(p);return h}h=[],p=0;for(let C in l)h[p++]=C;return h}}}function Ux(l,h){if(l.forEach&&typeof l.forEach=="function")l.forEach(h,void 0);else if(c(l)||typeof l=="string")Array.prototype.forEach.call(l,h,void 0);else for(var p=lL(l),C=cL(l),P=C.length,k=0;k<P;k++)h.call(void 0,C[k],p&&p[k],l)}var $x=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function uL(l,h){if(l){l=l.split("&");for(var p=0;p<l.length;p++){var C=l[p].indexOf("="),P=null;if(0<=C){var k=l[p].substring(0,C);P=l[p].substring(C+1)}else k=l[p];h(k,P?decodeURIComponent(P.replace(/\+/g," ")):"")}}}function Go(l){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,l instanceof Go){this.h=l.h,hh(this,l.j),this.o=l.o,this.g=l.g,fh(this,l.s),this.l=l.l;var h=l.i,p=new Cl;p.i=h.i,h.g&&(p.g=new Map(h.g),p.h=h.h),zx(this,p),this.m=l.m}else l&&(h=String(l).match($x))?(this.h=!1,hh(this,h[1]||"",!0),this.o=yl(h[2]||""),this.g=yl(h[3]||"",!0),fh(this,h[4]),this.l=yl(h[5]||"",!0),zx(this,h[6]||"",!0),this.m=yl(h[7]||"")):(this.h=!1,this.i=new Cl(null,this.h))}Go.prototype.toString=function(){var l=[],h=this.j;h&&l.push(wl(h,Hx,!0),":");var p=this.g;return(p||h=="file")&&(l.push("//"),(h=this.o)&&l.push(wl(h,Hx,!0),"@"),l.push(encodeURIComponent(String(p)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),p=this.s,p!=null&&l.push(":",String(p))),(p=this.l)&&(this.g&&p.charAt(0)!="/"&&l.push("/"),l.push(wl(p,p.charAt(0)=="/"?fL:hL,!0))),(p=this.i.toString())&&l.push("?",p),(p=this.m)&&l.push("#",wl(p,mL)),l.join("")};function _i(l){return new Go(l)}function hh(l,h,p){l.j=p?yl(h,!0):h,l.j&&(l.j=l.j.replace(/:$/,""))}function fh(l,h){if(h){if(h=Number(h),isNaN(h)||0>h)throw Error("Bad port number "+h);l.s=h}else l.s=null}function zx(l,h,p){h instanceof Cl?(l.i=h,gL(l.i,l.h)):(p||(h=wl(h,pL)),l.i=new Cl(h,l.h))}function tt(l,h,p){l.i.set(h,p)}function ph(l){return tt(l,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),l}function yl(l,h){return l?h?decodeURI(l.replace(/%25/g,"%2525")):decodeURIComponent(l):""}function wl(l,h,p){return typeof l=="string"?(l=encodeURI(l).replace(h,dL),p&&(l=l.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),l):null}function dL(l){return l=l.charCodeAt(0),"%"+(l>>4&15).toString(16)+(l&15).toString(16)}var Hx=/[#\/\?@]/g,hL=/[#\?:]/g,fL=/[#\?]/g,pL=/[#\?@]/g,mL=/#/g;function Cl(l,h){this.h=this.g=null,this.i=l||null,this.j=!!h}function Yi(l){l.g||(l.g=new Map,l.h=0,l.i&&uL(l.i,function(h,p){l.add(decodeURIComponent(h.replace(/\+/g," ")),p)}))}n=Cl.prototype,n.add=function(l,h){Yi(this),this.i=null,l=la(this,l);var p=this.g.get(l);return p||this.g.set(l,p=[]),p.push(h),this.h+=1,this};function Wx(l,h){Yi(l),h=la(l,h),l.g.has(h)&&(l.i=null,l.h-=l.g.get(h).length,l.g.delete(h))}function qx(l,h){return Yi(l),h=la(l,h),l.g.has(h)}n.forEach=function(l,h){Yi(this),this.g.forEach(function(p,C){p.forEach(function(P){l.call(h,P,C,this)},this)},this)},n.na=function(){Yi(this);let l=Array.from(this.g.values()),h=Array.from(this.g.keys()),p=[];for(let C=0;C<h.length;C++){let P=l[C];for(let k=0;k<P.length;k++)p.push(h[C])}return p},n.V=function(l){Yi(this);let h=[];if(typeof l=="string")qx(this,l)&&(h=h.concat(this.g.get(la(this,l))));else{l=Array.from(this.g.values());for(let p=0;p<l.length;p++)h=h.concat(l[p])}return h},n.set=function(l,h){return Yi(this),this.i=null,l=la(this,l),qx(this,l)&&(this.h-=this.g.get(l).length),this.g.set(l,[h]),this.h+=1,this},n.get=function(l,h){return l?(l=this.V(l),0<l.length?String(l[0]):h):h};function Gx(l,h,p){Wx(l,h),0<p.length&&(l.i=null,l.g.set(la(l,h),N(p)),l.h+=p.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";let l=[],h=Array.from(this.g.keys());for(var p=0;p<h.length;p++){var C=h[p];let k=encodeURIComponent(String(C)),W=this.V(C);for(C=0;C<W.length;C++){var P=k;W[C]!==""&&(P+="="+encodeURIComponent(String(W[C]))),l.push(P)}}return this.i=l.join("&")};function la(l,h){return h=String(h),l.j&&(h=h.toLowerCase()),h}function gL(l,h){h&&!l.j&&(Yi(l),l.i=null,l.g.forEach(function(p,C){var P=C.toLowerCase();C!=P&&(Wx(this,C),Gx(this,P,p))},l)),l.j=h}function vL(l,h){let p=new vl;if(a.Image){let C=new Image;C.onload=_(Qi,p,"TestLoadImage: loaded",!0,h,C),C.onerror=_(Qi,p,"TestLoadImage: error",!1,h,C),C.onabort=_(Qi,p,"TestLoadImage: abort",!1,h,C),C.ontimeout=_(Qi,p,"TestLoadImage: timeout",!1,h,C),a.setTimeout(function(){C.ontimeout&&C.ontimeout()},1e4),C.src=l}else h(!1)}function _L(l,h){let p=new vl,C=new AbortController,P=setTimeout(()=>{C.abort(),Qi(p,"TestPingServer: timeout",!1,h)},1e4);fetch(l,{signal:C.signal}).then(k=>{clearTimeout(P),k.ok?Qi(p,"TestPingServer: ok",!0,h):Qi(p,"TestPingServer: server error",!1,h)}).catch(()=>{clearTimeout(P),Qi(p,"TestPingServer: error",!1,h)})}function Qi(l,h,p,C,P){try{P&&(P.onload=null,P.onerror=null,P.onabort=null,P.ontimeout=null),C(p)}catch{}}function yL(){this.g=new tL}function wL(l,h,p){let C=p||"";try{Ux(l,function(P,k){let W=P;u(P)&&(W=bv(P)),h.push(C+k+"="+encodeURIComponent(W))})}catch(P){throw h.push(C+"type="+encodeURIComponent("_badmap")),P}}function bl(l){this.l=l.Ub||null,this.j=l.eb||!1}b(bl,Iv),bl.prototype.g=function(){return new mh(this.l,this.j)},bl.prototype.i=function(l){return function(){return l}}({});function mh(l,h){Zt.call(this),this.D=l,this.o=h,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}b(mh,Zt),n=mh.prototype,n.open=function(l,h){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=l,this.A=h,this.readyState=1,El(this)},n.send=function(l){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;let h={headers:this.u,method:this.B,credentials:this.m,cache:void 0};l&&(h.body=l),(this.D||a).fetch(new Request(this.A,h)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Il(this)),this.readyState=0},n.Sa=function(l){if(this.g&&(this.l=l,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=l.headers,this.readyState=2,El(this)),this.g&&(this.readyState=3,El(this),this.g)))if(this.responseType==="arraybuffer")l.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in l){if(this.j=l.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Kx(this)}else l.text().then(this.Ra.bind(this),this.ga.bind(this))};function Kx(l){l.j.read().then(l.Pa.bind(l)).catch(l.ga.bind(l))}n.Pa=function(l){if(this.g){if(this.o&&l.value)this.response.push(l.value);else if(!this.o){var h=l.value?l.value:new Uint8Array(0);(h=this.v.decode(h,{stream:!l.done}))&&(this.response=this.responseText+=h)}l.done?Il(this):El(this),this.readyState==3&&Kx(this)}},n.Ra=function(l){this.g&&(this.response=this.responseText=l,Il(this))},n.Qa=function(l){this.g&&(this.response=l,Il(this))},n.ga=function(){this.g&&Il(this)};function Il(l){l.readyState=4,l.l=null,l.j=null,l.v=null,El(l)}n.setRequestHeader=function(l,h){this.u.append(l,h)},n.getResponseHeader=function(l){return this.h&&this.h.get(l.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";let l=[],h=this.h.entries();for(var p=h.next();!p.done;)p=p.value,l.push(p[0]+": "+p[1]),p=h.next();return l.join(`\r
`)};function El(l){l.onreadystatechange&&l.onreadystatechange.call(l)}Object.defineProperty(mh.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(l){this.m=l?"include":"same-origin"}});function Yx(l){let h="";return ze(l,function(p,C){h+=C,h+=":",h+=p,h+=`\r
`}),h}function Nv(l,h,p){e:{for(C in p){var C=!1;break e}C=!0}C||(p=Yx(p),typeof l=="string"?p!=null&&encodeURIComponent(String(p)):tt(l,h,p))}function dt(l){Zt.call(this),this.headers=new Map,this.o=l||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}b(dt,Zt);var CL=/^https?$/i,bL=["POST","PUT"];n=dt.prototype,n.Ha=function(l){this.J=l},n.ea=function(l,h,p,C){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+l);h=h?h.toUpperCase():"GET",this.D=l,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Sv.g(),this.v=this.o?Ex(this.o):Ex(Sv),this.g.onreadystatechange=v(this.Ea,this);try{this.B=!0,this.g.open(h,String(l),!0),this.B=!1}catch(k){Qx(this,k);return}if(l=p||"",p=new Map(this.headers),C)if(Object.getPrototypeOf(C)===Object.prototype)for(var P in C)p.set(P,C[P]);else if(typeof C.keys=="function"&&typeof C.get=="function")for(let k of C.keys())p.set(k,C.get(k));else throw Error("Unknown input type for opt_headers: "+String(C));C=Array.from(p.keys()).find(k=>k.toLowerCase()=="content-type"),P=a.FormData&&l instanceof a.FormData,!(0<=Array.prototype.indexOf.call(bL,h,void 0))||C||P||p.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(let[k,W]of p)this.g.setRequestHeader(k,W);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Xx(this),this.u=!0,this.g.send(l),this.u=!1}catch(k){Qx(this,k)}};function Qx(l,h){l.h=!1,l.g&&(l.j=!0,l.g.abort(),l.j=!1),l.l=h,l.m=5,Zx(l),gh(l)}function Zx(l){l.A||(l.A=!0,un(l,"complete"),un(l,"error"))}n.abort=function(l){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=l||7,un(this,"complete"),un(this,"abort"),gh(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),gh(this,!0)),dt.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?Jx(this):this.bb())},n.bb=function(){Jx(this)};function Jx(l){if(l.h&&typeof s<"u"&&(!l.v[1]||yi(l)!=4||l.Z()!=2)){if(l.u&&yi(l)==4)wx(l.Ea,0,l);else if(un(l,"readystatechange"),yi(l)==4){l.h=!1;try{let W=l.Z();e:switch(W){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var h=!0;break e;default:h=!1}var p;if(!(p=h)){var C;if(C=W===0){var P=String(l.D).match($x)[1]||null;!P&&a.self&&a.self.location&&(P=a.self.location.protocol.slice(0,-1)),C=!CL.test(P?P.toLowerCase():"")}p=C}if(p)un(l,"complete"),un(l,"success");else{l.m=6;try{var k=2<yi(l)?l.g.statusText:""}catch{k=""}l.l=k+" ["+l.Z()+"]",Zx(l)}}finally{gh(l)}}}}function gh(l,h){if(l.g){Xx(l);let p=l.g,C=l.v[0]?()=>{}:null;l.g=null,l.v=null,h||un(l,"ready");try{p.onreadystatechange=C}catch{}}}function Xx(l){l.I&&(a.clearTimeout(l.I),l.I=null)}n.isActive=function(){return!!this.g};function yi(l){return l.g?l.g.readyState:0}n.Z=function(){try{return 2<yi(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(l){if(this.g){var h=this.g.responseText;return l&&h.indexOf(l)==0&&(h=h.substring(l.length)),eL(h)}};function eS(l){try{if(!l.g)return null;if("response"in l.g)return l.g.response;switch(l.H){case"":case"text":return l.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in l.g)return l.g.mozResponseArrayBuffer}return null}catch{return null}}function IL(l){let h={};l=(l.g&&2<=yi(l)&&l.g.getAllResponseHeaders()||"").split(`\r
`);for(let C=0;C<l.length;C++){if(oe(l[C]))continue;var p=M(l[C]);let P=p[0];if(p=p[1],typeof p!="string")continue;p=p.trim();let k=h[P]||[];h[P]=k,k.push(p)}D(h,function(C){return C.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function xl(l,h,p){return p&&p.internalChannelParams&&p.internalChannelParams[l]||h}function tS(l){this.Aa=0,this.i=[],this.j=new vl,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=xl("failFast",!1,l),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=xl("baseRetryDelayMs",5e3,l),this.cb=xl("retryDelaySeedMs",1e4,l),this.Wa=xl("forwardChannelMaxRetries",2,l),this.wa=xl("forwardChannelRequestTimeoutMs",2e4,l),this.pa=l&&l.xmlHttpFactory||void 0,this.Xa=l&&l.Tb||void 0,this.Ca=l&&l.useFetchStreams||!1,this.L=void 0,this.J=l&&l.supportsCrossDomainXhr||!1,this.K="",this.h=new Fx(l&&l.concurrentRequestLimit),this.Da=new yL,this.P=l&&l.fastHandshake||!1,this.O=l&&l.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=l&&l.Rb||!1,l&&l.xa&&this.j.xa(),l&&l.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&l&&l.detectBufferingProxy||!1,this.ja=void 0,l&&l.longPollingTimeout&&0<l.longPollingTimeout&&(this.ja=l.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=tS.prototype,n.la=8,n.G=1,n.connect=function(l,h,p,C){dn(0),this.W=l,this.H=h||{},p&&C!==void 0&&(this.H.OSID=p,this.H.OAID=C),this.F=this.X,this.I=uS(this,null,this.W),_h(this)};function Rv(l){if(nS(l),l.G==3){var h=l.U++,p=_i(l.I);if(tt(p,"SID",l.K),tt(p,"RID",h),tt(p,"TYPE","terminate"),Sl(l,p),h=new Ki(l,l.j,h),h.L=2,h.v=ph(_i(p)),p=!1,a.navigator&&a.navigator.sendBeacon)try{p=a.navigator.sendBeacon(h.v.toString(),"")}catch{}!p&&a.Image&&(new Image().src=h.v,p=!0),p||(h.g=dS(h.j,null),h.g.ea(h.v)),h.F=Date.now(),dh(h)}lS(l)}function vh(l){l.g&&(Fv(l),l.g.cancel(),l.g=null)}function nS(l){vh(l),l.u&&(a.clearTimeout(l.u),l.u=null),yh(l),l.h.cancel(),l.s&&(typeof l.s=="number"&&a.clearTimeout(l.s),l.s=null)}function _h(l){if(!Lx(l.h)&&!l.s){l.s=!0;var h=l.Ga;ll||px(),ul||(ll(),ul=!0),fv.add(h,l),l.B=0}}function EL(l,h){return Vx(l.h)>=l.h.j-(l.s?1:0)?!1:l.s?(l.i=h.D.concat(l.i),!0):l.G==1||l.G==2||l.B>=(l.Va?0:l.Wa)?!1:(l.s=gl(v(l.Ga,l,h),cS(l,l.B)),l.B++,!0)}n.Ga=function(l){if(this.s)if(this.s=null,this.G==1){if(!l){this.U=Math.floor(1e5*Math.random()),l=this.U++;let P=new Ki(this,this.j,l),k=this.o;if(this.S&&(k?(k=E(k),T(k,this.S)):k=this.S),this.m!==null||this.O||(P.H=k,k=null),this.P)e:{for(var h=0,p=0;p<this.i.length;p++){t:{var C=this.i[p];if("__data__"in C.map&&(C=C.map.__data__,typeof C=="string")){C=C.length;break t}C=void 0}if(C===void 0)break;if(h+=C,4096<h){h=p;break e}if(h===4096||p===this.i.length-1){h=p+1;break e}}h=1e3}else h=1e3;h=iS(this,P,h),p=_i(this.I),tt(p,"RID",l),tt(p,"CVER",22),this.D&&tt(p,"X-HTTP-Session-Id",this.D),Sl(this,p),k&&(this.O?h="headers="+encodeURIComponent(String(Yx(k)))+"&"+h:this.m&&Nv(p,this.m,k)),Ov(this.h,P),this.Ua&&tt(p,"TYPE","init"),this.P?(tt(p,"$req",h),tt(p,"SID","null"),P.T=!0,Dv(P,p,null)):Dv(P,p,h),this.G=2}}else this.G==3&&(l?rS(this,l):this.i.length==0||Lx(this.h)||rS(this))};function rS(l,h){var p;h?p=h.l:p=l.U++;let C=_i(l.I);tt(C,"SID",l.K),tt(C,"RID",p),tt(C,"AID",l.T),Sl(l,C),l.m&&l.o&&Nv(C,l.m,l.o),p=new Ki(l,l.j,p,l.B+1),l.m===null&&(p.H=l.o),h&&(l.i=h.D.concat(l.i)),h=iS(l,p,1e3),p.I=Math.round(.5*l.wa)+Math.round(.5*l.wa*Math.random()),Ov(l.h,p),Dv(p,C,h)}function Sl(l,h){l.H&&ze(l.H,function(p,C){tt(h,C,p)}),l.l&&Ux({},function(p,C){tt(h,C,p)})}function iS(l,h,p){p=Math.min(l.i.length,p);var C=l.l?v(l.l.Na,l.l,l):null;e:{var P=l.i;let k=-1;for(;;){let W=["count="+p];k==-1?0<p?(k=P[0].g,W.push("ofs="+k)):k=0:W.push("ofs="+k);let Ke=!0;for(let jt=0;jt<p;jt++){let Le=P[jt].g,Jt=P[jt].map;if(Le-=k,0>Le)k=Math.max(0,P[jt].g-100),Ke=!1;else try{wL(Jt,W,"req"+Le+"_")}catch{C&&C(Jt)}}if(Ke){C=W.join("&");break e}}}return l=l.i.splice(0,p),h.D=l,C}function oS(l){if(!l.g&&!l.u){l.Y=1;var h=l.Fa;ll||px(),ul||(ll(),ul=!0),fv.add(h,l),l.v=0}}function kv(l){return l.g||l.u||3<=l.v?!1:(l.Y++,l.u=gl(v(l.Fa,l),cS(l,l.v)),l.v++,!0)}n.Fa=function(){if(this.u=null,sS(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var l=2*this.R;this.j.info("BP detection timer enabled: "+l),this.A=gl(v(this.ab,this),l)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,dn(10),vh(this),sS(this))};function Fv(l){l.A!=null&&(a.clearTimeout(l.A),l.A=null)}function sS(l){l.g=new Ki(l,l.j,"rpc",l.Y),l.m===null&&(l.g.H=l.o),l.g.O=0;var h=_i(l.qa);tt(h,"RID","rpc"),tt(h,"SID",l.K),tt(h,"AID",l.T),tt(h,"CI",l.F?"0":"1"),!l.F&&l.ja&&tt(h,"TO",l.ja),tt(h,"TYPE","xmlhttp"),Sl(l,h),l.m&&l.o&&Nv(h,l.m,l.o),l.L&&(l.g.I=l.L);var p=l.g;l=l.ia,p.L=1,p.v=ph(_i(h)),p.m=null,p.P=!0,Nx(p,l)}n.Za=function(){this.C!=null&&(this.C=null,vh(this),kv(this),dn(19))};function yh(l){l.C!=null&&(a.clearTimeout(l.C),l.C=null)}function aS(l,h){var p=null;if(l.g==h){yh(l),Fv(l),l.g=null;var C=2}else if(Av(l.h,h))p=h.D,jx(l.h,h),C=1;else return;if(l.G!=0){if(h.o)if(C==1){p=h.m?h.m.length:0,h=Date.now()-h.F;var P=l.B;C=ch(),un(C,new Mx(C,p)),_h(l)}else oS(l);else if(P=h.s,P==3||P==0&&0<h.X||!(C==1&&EL(l,h)||C==2&&kv(l)))switch(p&&0<p.length&&(h=l.h,h.i=h.i.concat(p)),P){case 1:Ko(l,5);break;case 4:Ko(l,10);break;case 3:Ko(l,6);break;default:Ko(l,2)}}}function cS(l,h){let p=l.Ta+Math.floor(Math.random()*l.cb);return l.isActive()||(p*=2),p*h}function Ko(l,h){if(l.j.info("Error code "+h),h==2){var p=v(l.fb,l),C=l.Xa;let P=!C;C=new Go(C||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||hh(C,"https"),ph(C),P?vL(C.toString(),p):_L(C.toString(),p)}else dn(2);l.G=0,l.l&&l.l.sa(h),lS(l),nS(l)}n.fb=function(l){l?(this.j.info("Successfully pinged google.com"),dn(2)):(this.j.info("Failed to ping google.com"),dn(1))};function lS(l){if(l.G=0,l.ka=[],l.l){let h=Bx(l.h);(h.length!=0||l.i.length!=0)&&(R(l.ka,h),R(l.ka,l.i),l.h.i.length=0,N(l.i),l.i.length=0),l.l.ra()}}function uS(l,h,p){var C=p instanceof Go?_i(p):new Go(p);if(C.g!="")h&&(C.g=h+"."+C.g),fh(C,C.s);else{var P=a.location;C=P.protocol,h=h?h+"."+P.hostname:P.hostname,P=+P.port;var k=new Go(null);C&&hh(k,C),h&&(k.g=h),P&&fh(k,P),p&&(k.l=p),C=k}return p=l.D,h=l.ya,p&&h&&tt(C,p,h),tt(C,"VER",l.la),Sl(l,C),C}function dS(l,h,p){if(h&&!l.J)throw Error("Can't create secondary domain capable XhrIo object.");return h=l.Ca&&!l.pa?new dt(new bl({eb:p})):new dt(l.pa),h.Ha(l.J),h}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function hS(){}n=hS.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function wh(){}wh.prototype.g=function(l,h){return new An(l,h)};function An(l,h){Zt.call(this),this.g=new tS(h),this.l=l,this.h=h&&h.messageUrlParams||null,l=h&&h.messageHeaders||null,h&&h.clientProtocolHeaderRequired&&(l?l["X-Client-Protocol"]="webchannel":l={"X-Client-Protocol":"webchannel"}),this.g.o=l,l=h&&h.initMessageHeaders||null,h&&h.messageContentType&&(l?l["X-WebChannel-Content-Type"]=h.messageContentType:l={"X-WebChannel-Content-Type":h.messageContentType}),h&&h.va&&(l?l["X-WebChannel-Client-Profile"]=h.va:l={"X-WebChannel-Client-Profile":h.va}),this.g.S=l,(l=h&&h.Sb)&&!oe(l)&&(this.g.m=l),this.v=h&&h.supportsCrossDomainXhr||!1,this.u=h&&h.sendRawJson||!1,(h=h&&h.httpSessionIdParam)&&!oe(h)&&(this.g.D=h,l=this.h,l!==null&&h in l&&(l=this.h,h in l&&delete l[h])),this.j=new ua(this)}b(An,Zt),An.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},An.prototype.close=function(){Rv(this.g)},An.prototype.o=function(l){var h=this.g;if(typeof l=="string"){var p={};p.__data__=l,l=p}else this.u&&(p={},p.__data__=bv(l),l=p);h.i.push(new aL(h.Ya++,l)),h.G==3&&_h(h)},An.prototype.N=function(){this.g.l=null,delete this.j,Rv(this.g),delete this.g,An.aa.N.call(this)};function fS(l){Ev.call(this),l.__headers__&&(this.headers=l.__headers__,this.statusCode=l.__status__,delete l.__headers__,delete l.__status__);var h=l.__sm__;if(h){e:{for(let p in h){l=p;break e}l=void 0}(this.i=l)&&(l=this.i,h=h!==null&&l in h?h[l]:void 0),this.data=h}else this.data=l}b(fS,Ev);function pS(){xv.call(this),this.status=1}b(pS,xv);function ua(l){this.g=l}b(ua,hS),ua.prototype.ua=function(){un(this.g,"a")},ua.prototype.ta=function(l){un(this.g,new fS(l))},ua.prototype.sa=function(l){un(this.g,new pS)},ua.prototype.ra=function(){un(this.g,"b")},wh.prototype.createWebChannel=wh.prototype.g,An.prototype.send=An.prototype.o,An.prototype.open=An.prototype.m,An.prototype.close=An.prototype.close,DC=Fi.createWebChannelTransport=function(){return new wh},TC=Fi.getStatEventTarget=function(){return ch()},SC=Fi.Event=Wo,wm=Fi.Stat={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},lh.NO_ERROR=0,lh.TIMEOUT=8,lh.HTTP_ERROR=6,nd=Fi.ErrorCode=lh,Px.COMPLETE="complete",xC=Fi.EventType=Px,xx.EventType=pl,pl.OPEN="a",pl.CLOSE="b",pl.ERROR="c",pl.MESSAGE="d",Zt.prototype.listen=Zt.prototype.K,gc=Fi.WebChannel=xx,C9=Fi.FetchXmlHttpFactory=bl,dt.prototype.listenOnce=dt.prototype.L,dt.prototype.getLastError=dt.prototype.Ka,dt.prototype.getLastErrorCode=dt.prototype.Ba,dt.prototype.getStatus=dt.prototype.Z,dt.prototype.getResponseJson=dt.prototype.Oa,dt.prototype.getResponseText=dt.prototype.oa,dt.prototype.send=dt.prototype.ea,dt.prototype.setWithCredentials=dt.prototype.Ha,EC=Fi.XhrIo=dt}).apply(typeof ym<"u"?ym:typeof self<"u"?self:typeof window<"u"?window:{});var FO="@firebase/firestore",LO="4.8.0";var kt=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};kt.UNAUTHENTICATED=new kt(null),kt.GOOGLE_CREDENTIALS=new kt("google-credentials-uid"),kt.FIRST_PARTY=new kt("first-party-uid"),kt.MOCK_USER=new kt("mock-user");var Fc="11.10.0";var Hs=new Zn("@firebase/firestore");function vc(){return Hs.logLevel}function X(n,...e){if(Hs.logLevel<=Ee.DEBUG){let t=e.map(vI);Hs.debug(`Firestore (${Fc}): ${n}`,...t)}}function Li(n,...e){if(Hs.logLevel<=Ee.ERROR){let t=e.map(vI);Hs.error(`Firestore (${Fc}): ${n}`,...t)}}function Oo(n,...e){if(Hs.logLevel<=Ee.WARN){let t=e.map(vI);Hs.warn(`Firestore (${Fc}): ${n}`,...t)}}function vI(n){if(typeof n=="string")return n;try{return function(t){return JSON.stringify(t)}(n)}catch{return n}}function ue(n,e,t){let r="Unexpected state";typeof e=="string"?r=e:t=e,MN(n,r,t)}function MN(n,e,t){let r=`FIRESTORE (${Fc}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{r+=" CONTEXT: "+JSON.stringify(t)}catch{r+=" CONTEXT: "+t}throw Li(r),new Error(r)}function $e(n,e,t,r){let i="Unexpected state";typeof t=="string"?i=t:r=t,n||MN(e,i,r)}function ge(n,e){return n}var F={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Q=class extends jn{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var ii=class{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}};var Tm=class{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},NC=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(kt.UNAUTHENTICATED))}shutdown(){}},RC=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}},kC=class{constructor(e){this.t=e,this.currentUser=kt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){$e(this.o===void 0,42304);let r=this.i,i=c=>this.i!==r?(r=this.i,t(c)):Promise.resolve(),o=new ii;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new ii,e.enqueueRetryable(()=>i(this.currentUser))};let s=()=>{let c=o;e.enqueueRetryable(()=>w(this,null,function*(){yield c.promise,yield i(this.currentUser)}))},a=c=>{X("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.o&&(this.auth.addAuthTokenListener(this.o),s())};this.t.onInit(c=>a(c)),setTimeout(()=>{if(!this.auth){let c=this.t.getImmediate({optional:!0});c?a(c):(X("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new ii)}},0),s()}getToken(){let e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(X("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?($e(typeof r.accessToken=="string",31837,{l:r}),new Tm(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){let e=this.auth&&this.auth.getUid();return $e(e===null||typeof e=="string",2055,{h:e}),new kt(e)}},FC=class{constructor(e,t,r){this.P=e,this.T=t,this.I=r,this.type="FirstParty",this.user=kt.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);let e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}},LC=class{constructor(e,t,r){this.P=e,this.T=t,this.I=r}getToken(){return Promise.resolve(new FC(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable(()=>t(kt.FIRST_PARTY))}shutdown(){}invalidateToken(){}},Dm=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},VC=class{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,vn(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){$e(this.o===void 0,3512);let r=o=>{o.error!=null&&X("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${o.error.message}`);let s=o.token!==this.m;return this.m=o.token,X("FirebaseAppCheckTokenProvider",`Received ${s?"new":"existing"} token.`),s?t(o.token):Promise.resolve()};this.o=o=>{e.enqueueRetryable(()=>r(o))};let i=o=>{X("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=o,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(o=>i(o)),setTimeout(()=>{if(!this.appCheck){let o=this.V.getImmediate({optional:!0});o?i(o):X("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new Dm(this.p));let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?($e(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new Dm(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}};function b9(n){let e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}function PN(){return new TextEncoder}var cd=class{static newId(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516),r="";for(;r.length<20;){let i=b9(40);for(let o=0;o<i.length;++o)r.length<20&&i[o]<t&&(r+=e.charAt(i[o]%62))}return r}};function xe(n,e){return n<e?-1:n>e?1:0}function jC(n,e){let t=0;for(;t<n.length&&t<e.length;){let r=n.codePointAt(t),i=e.codePointAt(t);if(r!==i){if(r<128&&i<128)return xe(r,i);{let o=PN(),s=I9(o.encode(VO(n,t)),o.encode(VO(e,t)));return s!==0?s:xe(r,i)}}t+=r>65535?2:1}return xe(n.length,e.length)}function VO(n,e){return n.codePointAt(e)>65535?n.substring(e,e+2):n.substring(e,e+1)}function I9(n,e){for(let t=0;t<n.length&&t<e.length;++t)if(n[t]!==e[t])return xe(n[t],e[t]);return xe(n.length,e.length)}function Ec(n,e,t){return n.length===e.length&&n.every((r,i)=>t(r,e[i]))}var jO="__name__",Mm=class n{constructor(e,t,r){t===void 0?t=0:t>e.length&&ue(637,{offset:t,range:e.length}),r===void 0?r=e.length-t:r>e.length-t&&ue(1746,{length:r,range:e.length-t}),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return n.comparator(this,e)===0}child(e){let t=this.segments.slice(this.offset,this.limit());return e instanceof n?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){let r=Math.min(e.length,t.length);for(let i=0;i<r;i++){let o=n.compareSegments(e.get(i),t.get(i));if(o!==0)return o}return xe(e.length,t.length)}static compareSegments(e,t){let r=n.isNumericId(e),i=n.isNumericId(t);return r&&!i?-1:!r&&i?1:r&&i?n.extractNumericId(e).compare(n.extractNumericId(t)):jC(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return ki.fromString(e.substring(4,e.length-2))}},at=class n extends Mm{construct(e,t,r){return new n(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let t=[];for(let r of e){if(r.indexOf("//")>=0)throw new Q(F.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(i=>i.length>0))}return new n(t)}static emptyPath(){return new n([])}},E9=/^[_a-zA-Z][_a-zA-Z0-9]*$/,$n=class n extends Mm{construct(e,t,r){return new n(e,t,r)}static isValidIdentifier(e){return E9.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),n.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===jO}static keyField(){return new n([jO])}static fromServerFormat(e){let t=[],r="",i=0,o=()=>{if(r.length===0)throw new Q(F.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""},s=!1;for(;i<e.length;){let a=e[i];if(a==="\\"){if(i+1===e.length)throw new Q(F.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let c=e[i+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new Q(F.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=c,i+=2}else a==="`"?(s=!s,i++):a!=="."||s?(r+=a,i++):(o(),i++)}if(o(),s)throw new Q(F.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new n(t)}static emptyPath(){return new n([])}};var ae=class n{constructor(e){this.path=e}static fromPath(e){return new n(at.fromString(e))}static fromName(e){return new n(at.fromString(e).popFirst(5))}static empty(){return new n(at.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&at.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return at.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new n(new at(e.slice()))}};function AN(n,e,t){if(!t)throw new Q(F.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function x9(n,e,t,r){if(e===!0&&r===!0)throw new Q(F.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function BO(n){if(!ae.isDocumentKey(n))throw new Q(F.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function UO(n){if(ae.isDocumentKey(n))throw new Q(F.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function ON(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function cg(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{let e=function(r){return r.constructor?r.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":ue(12329,{type:typeof n})}function er(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new Q(F.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let t=cg(n);throw new Q(F.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function It(n,e){let t={typeString:n};return e&&(t.value=e),t}function Cd(n,e){if(!ON(n))throw new Q(F.INVALID_ARGUMENT,"JSON must be an object");let t;for(let r in e)if(e[r]){let i=e[r].typeString,o="value"in e[r]?{value:e[r].value}:void 0;if(!(r in n)){t=`JSON missing required field: '${r}'`;break}let s=n[r];if(i&&typeof s!==i){t=`JSON field '${r}' must be a ${i}.`;break}if(o!==void 0&&s!==o.value){t=`Expected '${r}' field to equal '${o.value}'`;break}}if(t)throw new Q(F.INVALID_ARGUMENT,t);return!0}var $O=-62135596800,zO=1e6,Et=class n{static now(){return n.fromMillis(Date.now())}static fromDate(e){return n.fromMillis(e.getTime())}static fromMillis(e){let t=Math.floor(e/1e3),r=Math.floor((e-1e3*t)*zO);return new n(t,r)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Q(F.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Q(F.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<$O)throw new Q(F.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Q(F.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/zO}_compareTo(e){return this.seconds===e.seconds?xe(this.nanoseconds,e.nanoseconds):xe(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:n._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Cd(e,n._jsonSchema))return new n(e.seconds,e.nanoseconds)}valueOf(){let e=this.seconds-$O;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}};Et._jsonSchemaVersion="firestore/timestamp/1.0",Et._jsonSchema={type:It("string",Et._jsonSchemaVersion),seconds:It("number"),nanoseconds:It("number")};var we=class n{static fromTimestamp(e){return new n(e)}static min(){return new n(new Et(0,0))}static max(){return new n(new Et(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};var ld=-1,BC=class{constructor(e,t,r,i){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=i}};BC.UNKNOWN_ID=-1;function S9(n,e){let t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=we.fromTimestamp(r===1e9?new Et(t+1,0):new Et(t,r));return new Ws(i,ae.empty(),e)}function T9(n){return new Ws(n.readTime,n.key,ld)}var Ws=class n{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new n(we.min(),ae.empty(),ld)}static max(){return new n(we.max(),ae.empty(),ld)}};function D9(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=ae.comparator(n.documentKey,e.documentKey),t!==0?t:xe(n.largestBatchId,e.largestBatchId))}var M9="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",UC=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}};function Lc(n){return w(this,null,function*(){if(n.code!==F.FAILED_PRECONDITION||n.message!==M9)throw n;X("LocalStore","Unexpectedly lost primary lease")})}var $=class n{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&ue(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new n((r,i)=>{this.nextCallback=o=>{this.wrapSuccess(e,o).next(r,i)},this.catchCallback=o=>{this.wrapFailure(t,o).next(r,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{let t=e();return t instanceof n?t:n.resolve(t)}catch(t){return n.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):n.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):n.reject(t)}static resolve(e){return new n((t,r)=>{t(e)})}static reject(e){return new n((t,r)=>{r(e)})}static waitFor(e){return new n((t,r)=>{let i=0,o=0,s=!1;e.forEach(a=>{++i,a.next(()=>{++o,s&&o===i&&t()},c=>r(c))}),s=!0,o===i&&t()})}static or(e){let t=n.resolve(!1);for(let r of e)t=t.next(i=>i?n.resolve(i):r());return t}static forEach(e,t){let r=[];return e.forEach((i,o)=>{r.push(t.call(this,i,o))}),this.waitFor(r)}static mapArray(e,t){return new n((r,i)=>{let o=e.length,s=new Array(o),a=0;for(let c=0;c<o;c++){let u=c;t(e[u]).next(d=>{s[u]=d,++a,a===o&&r(s)},d=>i(d))}})}static doWhile(e,t){return new n((r,i)=>{let o=()=>{e()===!0?t().next(()=>{o()},i):r()};o()})}};function P9(n){let e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function Vc(n){return n.name==="IndexedDbTransactionError"}var _I=(()=>{class n{constructor(t,r){this.previousValue=t,r&&(r.sequenceNumberHandler=i=>this._e(i),this.ae=i=>r.writeSequenceNumber(i))}_e(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){let t=++this.previousValue;return this.ae&&this.ae(t),t}}n.ue=-1;return n})(),yI=-1;function lg(n){return n==null}function ud(n){return n===0&&1/n==-1/0}function A9(n){return typeof n=="number"&&Number.isInteger(n)&&!ud(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}var NN="";function O9(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=HO(e)),e=N9(n.get(t),e);return HO(e)}function N9(n,e){let t=e,r=n.length;for(let i=0;i<r;i++){let o=n.charAt(i);switch(o){case"\0":t+="";break;case NN:t+="";break;default:t+=o}}return t}function HO(n){return n+NN+""}var R9="remoteDocuments",RN="owner";var kN="mutationQueues";var FN="mutations";var LN="documentMutations",k9="remoteDocumentsV14";var VN="remoteDocumentGlobal";var jN="targets";var BN="targetDocuments";var UN="targetGlobal",$N="collectionParents";var zN="clientMetadata";var HN="bundles";var WN="namedQueries";var F9="indexConfiguration";var L9="indexState";var V9="indexEntries";var qN="documentOverlays";var j9="globals";var B9=[kN,FN,LN,R9,jN,RN,UN,BN,zN,VN,$N,HN,WN],Bce=[...B9,qN],U9=[kN,FN,LN,k9,jN,RN,UN,BN,zN,VN,$N,HN,WN,qN],$9=U9,z9=[...$9,F9,L9,V9];var Uce=[...z9,j9];function WO(n){let e=0;for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Vo(n,e){for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function GN(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}var pt=class n{constructor(e,t){this.comparator=e,this.root=t||oi.EMPTY}insert(e,t){return new n(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,oi.BLACK,null,null))}remove(e){return new n(this.comparator,this.root.remove(e,this.comparator).copy(null,null,oi.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){let r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){let i=this.comparator(e,r.key);if(i===0)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){let e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Cc(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Cc(this.root,e,this.comparator,!1)}getReverseIterator(){return new Cc(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Cc(this.root,e,this.comparator,!0)}},Cc=class{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let o=1;for(;!e.isEmpty();)if(o=t?r(e.key,t):1,t&&i&&(o*=-1),o<0)e=this.isReverse?e.left:e.right;else{if(o===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},oi=class n{constructor(e,t,r,i,o){this.key=e,this.value=t,this.color=r??n.RED,this.left=i??n.EMPTY,this.right=o??n.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,o){return new n(e??this.key,t??this.value,r??this.color,i??this.left,o??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this,o=r(e,i.key);return i=o<0?i.copy(null,null,null,i.left.insert(e,t,r),null):o===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return n.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return n.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){let e=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){let e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw ue(43730,{key:this.key,value:this.value});if(this.right.isRed())throw ue(14113,{key:this.key,value:this.value});let e=this.left.check();if(e!==this.right.check())throw ue(27949);return e+(this.isRed()?0:1)}};oi.EMPTY=null,oi.RED=!0,oi.BLACK=!1;oi.EMPTY=new class{constructor(){this.size=0}get key(){throw ue(57766)}get value(){throw ue(16141)}get color(){throw ue(16727)}get left(){throw ue(29726)}get right(){throw ue(36894)}copy(e,t,r,i,o){return this}insert(e,t,r){return new oi(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};var Ft=class n{constructor(e){this.comparator=e,this.data=new pt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){let r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){let i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){let t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Pm(this.data.getIterator())}getIteratorFrom(e){return new Pm(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){let i=t.getNext().key,o=r.getNext().key;if(this.comparator(i,o)!==0)return!1}return!0}toArray(){let e=[];return this.forEach(t=>{e.push(t)}),e}toString(){let e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){let t=new n(this.comparator);return t.data=e,t}},Pm=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};var Xn=class n{constructor(e){this.fields=e,e.sort($n.comparator)}static empty(){return new n([])}unionWith(e){let t=new Ft($n.comparator);for(let r of this.fields)t=t.add(r);for(let r of e)t=t.add(r);return new n(t.toArray())}covers(e){for(let t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Ec(this.fields,e.fields,(t,r)=>t.isEqual(r))}};var Am=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};var on=class n{constructor(e){this.binaryString=e}static fromBase64String(e){let t=function(i){try{return atob(i)}catch(o){throw typeof DOMException<"u"&&o instanceof DOMException?new Am("Invalid base64 string: "+o):o}}(e);return new n(t)}static fromUint8Array(e){let t=function(i){let o="";for(let s=0;s<i.length;++s)o+=String.fromCharCode(i[s]);return o}(e);return new n(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){let r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return xe(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};on.EMPTY_BYTE_STRING=new on("");var H9=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Vi(n){if($e(!!n,39018),typeof n=="string"){let e=0,t=H9.exec(n);if($e(!!t,46558,{timestamp:n}),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}let r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:st(n.seconds),nanos:st(n.nanos)}}function st(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function ji(n){return typeof n=="string"?on.fromBase64String(n):on.fromUint8Array(n)}var KN="server_timestamp",YN="__type__",QN="__previous_value__",ZN="__local_write_time__";function wI(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{})[YN])===null||t===void 0?void 0:t.stringValue)===KN}function ug(n){let e=n.mapValue.fields[QN];return wI(e)?ug(e):e}function dd(n){let e=Vi(n.mapValue.fields[ZN].timestampValue);return new Et(e.seconds,e.nanos)}var $C=class{constructor(e,t,r,i,o,s,a,c,u,d){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=o,this.forceLongPolling=s,this.autoDetectLongPolling=a,this.longPollingOptions=c,this.useFetchStreams=u,this.isUsingEmulator=d}},Om="(default)",Nm=class n{constructor(e,t){this.projectId=e,this.database=t||Om}static empty(){return new n("","")}get isDefaultDatabase(){return this.database===Om}isEqual(e){return e instanceof n&&e.projectId===this.projectId&&e.database===this.database}};var CI="__type__",JN="__max__",Cm={mapValue:{fields:{__type__:{stringValue:JN}}}},bI="__vector__",xc="value";function No(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?wI(n)?4:eR(n)?9007199254740991:XN(n)?10:11:ue(28295,{value:n})}function li(n,e){if(n===e)return!0;let t=No(n);if(t!==No(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return dd(n).isEqual(dd(e));case 3:return function(i,o){if(typeof i.timestampValue=="string"&&typeof o.timestampValue=="string"&&i.timestampValue.length===o.timestampValue.length)return i.timestampValue===o.timestampValue;let s=Vi(i.timestampValue),a=Vi(o.timestampValue);return s.seconds===a.seconds&&s.nanos===a.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return function(i,o){return ji(i.bytesValue).isEqual(ji(o.bytesValue))}(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return function(i,o){return st(i.geoPointValue.latitude)===st(o.geoPointValue.latitude)&&st(i.geoPointValue.longitude)===st(o.geoPointValue.longitude)}(n,e);case 2:return function(i,o){if("integerValue"in i&&"integerValue"in o)return st(i.integerValue)===st(o.integerValue);if("doubleValue"in i&&"doubleValue"in o){let s=st(i.doubleValue),a=st(o.doubleValue);return s===a?ud(s)===ud(a):isNaN(s)&&isNaN(a)}return!1}(n,e);case 9:return Ec(n.arrayValue.values||[],e.arrayValue.values||[],li);case 10:case 11:return function(i,o){let s=i.mapValue.fields||{},a=o.mapValue.fields||{};if(WO(s)!==WO(a))return!1;for(let c in s)if(s.hasOwnProperty(c)&&(a[c]===void 0||!li(s[c],a[c])))return!1;return!0}(n,e);default:return ue(52216,{left:n})}}function hd(n,e){return(n.values||[]).find(t=>li(t,e))!==void 0}function Sc(n,e){if(n===e)return 0;let t=No(n),r=No(e);if(t!==r)return xe(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return xe(n.booleanValue,e.booleanValue);case 2:return function(o,s){let a=st(o.integerValue||o.doubleValue),c=st(s.integerValue||s.doubleValue);return a<c?-1:a>c?1:a===c?0:isNaN(a)?isNaN(c)?0:-1:1}(n,e);case 3:return qO(n.timestampValue,e.timestampValue);case 4:return qO(dd(n),dd(e));case 5:return jC(n.stringValue,e.stringValue);case 6:return function(o,s){let a=ji(o),c=ji(s);return a.compareTo(c)}(n.bytesValue,e.bytesValue);case 7:return function(o,s){let a=o.split("/"),c=s.split("/");for(let u=0;u<a.length&&u<c.length;u++){let d=xe(a[u],c[u]);if(d!==0)return d}return xe(a.length,c.length)}(n.referenceValue,e.referenceValue);case 8:return function(o,s){let a=xe(st(o.latitude),st(s.latitude));return a!==0?a:xe(st(o.longitude),st(s.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return GO(n.arrayValue,e.arrayValue);case 10:return function(o,s){var a,c,u,d;let f=o.fields||{},v=s.fields||{},_=(a=f[xc])===null||a===void 0?void 0:a.arrayValue,b=(c=v[xc])===null||c===void 0?void 0:c.arrayValue,N=xe(((u=_?.values)===null||u===void 0?void 0:u.length)||0,((d=b?.values)===null||d===void 0?void 0:d.length)||0);return N!==0?N:GO(_,b)}(n.mapValue,e.mapValue);case 11:return function(o,s){if(o===Cm.mapValue&&s===Cm.mapValue)return 0;if(o===Cm.mapValue)return 1;if(s===Cm.mapValue)return-1;let a=o.fields||{},c=Object.keys(a),u=s.fields||{},d=Object.keys(u);c.sort(),d.sort();for(let f=0;f<c.length&&f<d.length;++f){let v=jC(c[f],d[f]);if(v!==0)return v;let _=Sc(a[c[f]],u[d[f]]);if(_!==0)return _}return xe(c.length,d.length)}(n.mapValue,e.mapValue);default:throw ue(23264,{le:t})}}function qO(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return xe(n,e);let t=Vi(n),r=Vi(e),i=xe(t.seconds,r.seconds);return i!==0?i:xe(t.nanos,r.nanos)}function GO(n,e){let t=n.values||[],r=e.values||[];for(let i=0;i<t.length&&i<r.length;++i){let o=Sc(t[i],r[i]);if(o)return o}return xe(t.length,r.length)}function Tc(n){return zC(n)}function zC(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){let r=Vi(t);return`time(${r.seconds},${r.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(t){return ji(t).toBase64()}(n.bytesValue):"referenceValue"in n?function(t){return ae.fromName(t).toString()}(n.referenceValue):"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let r="[",i=!0;for(let o of t.values||[])i?i=!1:r+=",",r+=zC(o);return r+"]"}(n.arrayValue):"mapValue"in n?function(t){let r=Object.keys(t.fields||{}).sort(),i="{",o=!0;for(let s of r)o?o=!1:i+=",",i+=`${s}:${zC(t.fields[s])}`;return i+"}"}(n.mapValue):ue(61005,{value:n})}function Em(n){switch(No(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:let e=ug(n);return e?16+Em(e):16;case 5:return 2*n.stringValue.length;case 6:return ji(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return function(r){return(r.values||[]).reduce((i,o)=>i+Em(o),0)}(n.arrayValue);case 10:case 11:return function(r){let i=0;return Vo(r.fields,(o,s)=>{i+=o.length+Em(s)}),i}(n.mapValue);default:throw ue(13486,{value:n})}}function KO(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function HC(n){return!!n&&"integerValue"in n}function II(n){return!!n&&"arrayValue"in n}function YO(n){return!!n&&"nullValue"in n}function QO(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function xm(n){return!!n&&"mapValue"in n}function XN(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{})[CI])===null||t===void 0?void 0:t.stringValue)===bI}function id(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){let e={mapValue:{fields:{}}};return Vo(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=id(r)),e}if(n.arrayValue){let e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=id(n.arrayValue.values[t]);return e}return Object.assign({},n)}function eR(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===JN}var zce={mapValue:{fields:{[CI]:{stringValue:bI},[xc]:{arrayValue:{}}}}};var Un=class n{constructor(e){this.value=e}static empty(){return new n({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!xm(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=id(t)}setAll(e){let t=$n.emptyPath(),r={},i=[];e.forEach((s,a)=>{if(!t.isImmediateParentOf(a)){let c=this.getFieldsMap(t);this.applyChanges(c,r,i),r={},i=[],t=a.popLast()}s?r[a.lastSegment()]=id(s):i.push(a.lastSegment())});let o=this.getFieldsMap(t);this.applyChanges(o,r,i)}delete(e){let t=this.field(e.popLast());xm(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return li(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];xm(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){Vo(t,(i,o)=>e[i]=o);for(let i of r)delete e[i]}clone(){return new n(id(this.value))}};function tR(n){let e=[];return Vo(n.fields,(t,r)=>{let i=new $n([t]);if(xm(r)){let o=tR(r.mapValue).fields;if(o.length===0)e.push(i);else for(let s of o)e.push(i.child(s))}else e.push(i)}),new Xn(e)}var br=class n{constructor(e,t,r,i,o,s,a){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=o,this.data=s,this.documentState=a}static newInvalidDocument(e){return new n(e,0,we.min(),we.min(),we.min(),Un.empty(),0)}static newFoundDocument(e,t,r,i){return new n(e,1,t,we.min(),r,i,0)}static newNoDocument(e,t){return new n(e,2,t,we.min(),we.min(),Un.empty(),0)}static newUnknownDocument(e,t){return new n(e,3,t,we.min(),we.min(),Un.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(we.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Un.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Un.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=we.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof n&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new n(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};var Dc=class{constructor(e,t){this.position=e,this.inclusive=t}};function ZO(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){let o=e[i],s=n.position[i];if(o.field.isKeyField()?r=ae.comparator(ae.fromName(s.referenceValue),t.key):r=Sc(s,t.data.field(o.field)),o.dir==="desc"&&(r*=-1),r!==0)break}return r}function JO(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!li(n.position[t],e.position[t]))return!1;return!0}var qs=class{constructor(e,t="asc"){this.field=e,this.dir=t}};function W9(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}var Rm=class{},bt=class n extends Rm{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new qC(e,t,r):t==="array-contains"?new YC(e,r):t==="in"?new QC(e,r):t==="not-in"?new ZC(e,r):t==="array-contains-any"?new JC(e,r):new n(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new GC(e,r):new KC(e,r)}matches(e){let t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(Sc(t,this.value)):t!==null&&No(this.value)===No(t)&&this.matchesComparison(Sc(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return ue(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}},Ir=class n extends Rm{constructor(e,t){super(),this.filters=e,this.op=t,this.he=null}static create(e,t){return new n(e,t)}matches(e){return nR(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.he!==null||(this.he=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.he}getFilters(){return Object.assign([],this.filters)}};function nR(n){return n.op==="and"}function rR(n){return q9(n)&&nR(n)}function q9(n){for(let e of n.filters)if(e instanceof Ir)return!1;return!0}function WC(n){if(n instanceof bt)return n.field.canonicalString()+n.op.toString()+Tc(n.value);if(rR(n))return n.filters.map(e=>WC(e)).join(",");{let e=n.filters.map(t=>WC(t)).join(",");return`${n.op}(${e})`}}function iR(n,e){return n instanceof bt?function(r,i){return i instanceof bt&&r.op===i.op&&r.field.isEqual(i.field)&&li(r.value,i.value)}(n,e):n instanceof Ir?function(r,i){return i instanceof Ir&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((o,s,a)=>o&&iR(s,i.filters[a]),!0):!1}(n,e):void ue(19439)}function oR(n){return n instanceof bt?function(t){return`${t.field.canonicalString()} ${t.op} ${Tc(t.value)}`}(n):n instanceof Ir?function(t){return t.op.toString()+" {"+t.getFilters().map(oR).join(" ,")+"}"}(n):"Filter"}var qC=class extends bt{constructor(e,t,r){super(e,t,r),this.key=ae.fromName(r.referenceValue)}matches(e){let t=ae.comparator(e.key,this.key);return this.matchesComparison(t)}},GC=class extends bt{constructor(e,t){super(e,"in",t),this.keys=sR("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}},KC=class extends bt{constructor(e,t){super(e,"not-in",t),this.keys=sR("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}};function sR(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(r=>ae.fromName(r.referenceValue))}var YC=class extends bt{constructor(e,t){super(e,"array-contains",t)}matches(e){let t=e.data.field(this.field);return II(t)&&hd(t.arrayValue,this.value)}},QC=class extends bt{constructor(e,t){super(e,"in",t)}matches(e){let t=e.data.field(this.field);return t!==null&&hd(this.value.arrayValue,t)}},ZC=class extends bt{constructor(e,t){super(e,"not-in",t)}matches(e){if(hd(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!hd(this.value.arrayValue,t)}},JC=class extends bt{constructor(e,t){super(e,"array-contains-any",t)}matches(e){let t=e.data.field(this.field);return!(!II(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>hd(this.value.arrayValue,r))}};var XC=class{constructor(e,t=null,r=[],i=[],o=null,s=null,a=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=o,this.startAt=s,this.endAt=a,this.Pe=null}};function XO(n,e=null,t=[],r=[],i=null,o=null,s=null){return new XC(n,e,t,r,i,o,s)}function EI(n){let e=ge(n);if(e.Pe===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>WC(r)).join(","),t+="|ob:",t+=e.orderBy.map(r=>function(o){return o.field.canonicalString()+o.dir}(r)).join(","),lg(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>Tc(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>Tc(r)).join(",")),e.Pe=t}return e.Pe}function xI(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!W9(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!iR(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!JO(n.startAt,e.startAt)&&JO(n.endAt,e.endAt)}function eb(n){return ae.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}var Ro=class{constructor(e,t=null,r=[],i=[],o=null,s="F",a=null,c=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=o,this.limitType=s,this.startAt=a,this.endAt=c,this.Te=null,this.Ie=null,this.de=null,this.startAt,this.endAt}};function G9(n,e,t,r,i,o,s,a){return new Ro(n,e,t,r,i,o,s,a)}function SI(n){return new Ro(n)}function eN(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function aR(n){return n.collectionGroup!==null}function od(n){let e=ge(n);if(e.Te===null){e.Te=[];let t=new Set;for(let o of e.explicitOrderBy)e.Te.push(o),t.add(o.field.canonicalString());let r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(s){let a=new Ft($n.comparator);return s.filters.forEach(c=>{c.getFlattenedFilters().forEach(u=>{u.isInequality()&&(a=a.add(u.field))})}),a})(e).forEach(o=>{t.has(o.canonicalString())||o.isKeyField()||e.Te.push(new qs(o,r))}),t.has($n.keyField().canonicalString())||e.Te.push(new qs($n.keyField(),r))}return e.Te}function si(n){let e=ge(n);return e.Ie||(e.Ie=K9(e,od(n))),e.Ie}function K9(n,e){if(n.limitType==="F")return XO(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(i=>{let o=i.dir==="desc"?"asc":"desc";return new qs(i.field,o)});let t=n.endAt?new Dc(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new Dc(n.startAt.position,n.startAt.inclusive):null;return XO(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function tb(n,e){let t=n.filters.concat([e]);return new Ro(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function nb(n,e,t){return new Ro(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function dg(n,e){return xI(si(n),si(e))&&n.limitType===e.limitType}function cR(n){return`${EI(si(n))}|lt:${n.limitType}`}function _c(n){return`Query(target=${function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map(i=>oR(i)).join(", ")}]`),lg(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map(i=>function(s){return`${s.field.canonicalString()} (${s.dir})`}(i)).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(i=>Tc(i)).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(i=>Tc(i)).join(",")),`Target(${r})`}(si(n))}; limitType=${n.limitType})`}function hg(n,e){return e.isFoundDocument()&&function(r,i){let o=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(o):ae.isDocumentKey(r.path)?r.path.isEqual(o):r.path.isImmediateParentOf(o)}(n,e)&&function(r,i){for(let o of od(r))if(!o.field.isKeyField()&&i.data.field(o.field)===null)return!1;return!0}(n,e)&&function(r,i){for(let o of r.filters)if(!o.matches(i))return!1;return!0}(n,e)&&function(r,i){return!(r.startAt&&!function(s,a,c){let u=ZO(s,a,c);return s.inclusive?u<=0:u<0}(r.startAt,od(r),i)||r.endAt&&!function(s,a,c){let u=ZO(s,a,c);return s.inclusive?u>=0:u>0}(r.endAt,od(r),i))}(n,e)}function Y9(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function lR(n){return(e,t)=>{let r=!1;for(let i of od(n)){let o=Q9(i,e,t);if(o!==0)return o;r=r||i.field.isKeyField()}return 0}}function Q9(n,e,t){let r=n.field.isKeyField()?ae.comparator(e.key,t.key):function(o,s,a){let c=s.data.field(o),u=a.data.field(o);return c!==null&&u!==null?Sc(c,u):ue(42886)}(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return ue(19790,{direction:n.dir})}}var Bi=class{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(let[i,o]of r)if(this.equalsFn(i,e))return o}}has(e){return this.get(e)!==void 0}set(e,t){let r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let o=0;o<i.length;o++)if(this.equalsFn(i[o][0],e))return void(i[o]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Vo(this.inner,(t,r)=>{for(let[i,o]of r)e(i,o)})}isEmpty(){return GN(this.inner)}size(){return this.innerSize}};var Z9=new pt(ae.comparator);function Ui(){return Z9}var uR=new pt(ae.comparator);function rd(...n){let e=uR;for(let t of n)e=e.insert(t.key,t);return e}function dR(n){let e=uR;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function js(){return sd()}function hR(){return sd()}function sd(){return new Bi(n=>n.toString(),(n,e)=>n.isEqual(e))}var J9=new pt(ae.comparator),X9=new Ft(ae.comparator);function De(...n){let e=X9;for(let t of n)e=e.add(t);return e}var eW=new Ft(xe);function tW(){return eW}function TI(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ud(e)?"-0":e}}function fR(n){return{integerValue:""+n}}function nW(n,e){return A9(e)?fR(e):TI(n,e)}var Mc=class{constructor(){this._=void 0}};function rW(n,e,t){return n instanceof Pc?function(i,o){let s={fields:{[YN]:{stringValue:KN},[ZN]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return o&&wI(o)&&(o=ug(o)),o&&(s.fields[QN]=o),{mapValue:s}}(t,e):n instanceof Gs?mR(n,e):n instanceof Ks?gR(n,e):function(i,o){let s=pR(i,o),a=tN(s)+tN(i.Ee);return HC(s)&&HC(i.Ee)?fR(a):TI(i.serializer,a)}(n,e)}function iW(n,e,t){return n instanceof Gs?mR(n,e):n instanceof Ks?gR(n,e):t}function pR(n,e){return n instanceof Ac?function(r){return HC(r)||function(o){return!!o&&"doubleValue"in o}(r)}(e)?e:{integerValue:0}:null}var Pc=class extends Mc{},Gs=class extends Mc{constructor(e){super(),this.elements=e}};function mR(n,e){let t=vR(e);for(let r of n.elements)t.some(i=>li(i,r))||t.push(r);return{arrayValue:{values:t}}}var Ks=class extends Mc{constructor(e){super(),this.elements=e}};function gR(n,e){let t=vR(e);for(let r of n.elements)t=t.filter(i=>!li(i,r));return{arrayValue:{values:t}}}var Ac=class extends Mc{constructor(e,t){super(),this.serializer=e,this.Ee=t}};function tN(n){return st(n.integerValue||n.doubleValue)}function vR(n){return II(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}function oW(n,e){return n.field.isEqual(e.field)&&function(r,i){return r instanceof Gs&&i instanceof Gs||r instanceof Ks&&i instanceof Ks?Ec(r.elements,i.elements,li):r instanceof Ac&&i instanceof Ac?li(r.Ee,i.Ee):r instanceof Pc&&i instanceof Pc}(n.transform,e.transform)}var rb=class{constructor(e,t){this.version=e,this.transformResults=t}},ai=class n{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new n}static exists(e){return new n(void 0,e)}static updateTime(e){return new n(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function Sm(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}var Oc=class{};function _R(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new fd(n.key,ai.none()):new Ys(n.key,n.data,ai.none());{let t=n.data,r=Un.empty(),i=new Ft($n.comparator);for(let o of e.fields)if(!i.has(o)){let s=t.field(o);s===null&&o.length>1&&(o=o.popLast(),s=t.field(o)),s===null?r.delete(o):r.set(o,s),i=i.add(o)}return new ui(n.key,r,new Xn(i.toArray()),ai.none())}}function sW(n,e,t){n instanceof Ys?function(i,o,s){let a=i.value.clone(),c=rN(i.fieldTransforms,o,s.transformResults);a.setAll(c),o.convertToFoundDocument(s.version,a).setHasCommittedMutations()}(n,e,t):n instanceof ui?function(i,o,s){if(!Sm(i.precondition,o))return void o.convertToUnknownDocument(s.version);let a=rN(i.fieldTransforms,o,s.transformResults),c=o.data;c.setAll(yR(i)),c.setAll(a),o.convertToFoundDocument(s.version,c).setHasCommittedMutations()}(n,e,t):function(i,o,s){o.convertToNoDocument(s.version).setHasCommittedMutations()}(0,e,t)}function ad(n,e,t,r){return n instanceof Ys?function(o,s,a,c){if(!Sm(o.precondition,s))return a;let u=o.value.clone(),d=iN(o.fieldTransforms,c,s);return u.setAll(d),s.convertToFoundDocument(s.version,u).setHasLocalMutations(),null}(n,e,t,r):n instanceof ui?function(o,s,a,c){if(!Sm(o.precondition,s))return a;let u=iN(o.fieldTransforms,c,s),d=s.data;return d.setAll(yR(o)),d.setAll(u),s.convertToFoundDocument(s.version,d).setHasLocalMutations(),a===null?null:a.unionWith(o.fieldMask.fields).unionWith(o.fieldTransforms.map(f=>f.field))}(n,e,t,r):function(o,s,a){return Sm(o.precondition,s)?(s.convertToNoDocument(s.version).setHasLocalMutations(),null):a}(n,e,t)}function aW(n,e){let t=null;for(let r of n.fieldTransforms){let i=e.data.field(r.field),o=pR(r.transform,i||null);o!=null&&(t===null&&(t=Un.empty()),t.set(r.field,o))}return t||null}function nN(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&Ec(r,i,(o,s)=>oW(o,s))}(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}var Ys=class extends Oc{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}},ui=class extends Oc{constructor(e,t,r,i,o=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=o,this.type=1}getFieldMask(){return this.fieldMask}};function yR(n){let e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){let r=n.data.field(t);e.set(t,r)}}),e}function rN(n,e,t){let r=new Map;$e(n.length===t.length,32656,{Ae:t.length,Re:n.length});for(let i=0;i<t.length;i++){let o=n[i],s=o.transform,a=e.data.field(o.field);r.set(o.field,iW(s,a,t[i]))}return r}function iN(n,e,t){let r=new Map;for(let i of n){let o=i.transform,s=t.data.field(i.field);r.set(i.field,rW(o,s,e))}return r}var fd=class extends Oc{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}},ib=class extends Oc{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}};var ob=class{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){let r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){let o=this.mutations[i];o.key.isEqual(e.key)&&sW(o,e,r[i])}}applyToLocalView(e,t){for(let r of this.baseMutations)r.key.isEqual(e.key)&&(t=ad(r,e,t,this.localWriteTime));for(let r of this.mutations)r.key.isEqual(e.key)&&(t=ad(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){let r=hR();return this.mutations.forEach(i=>{let o=e.get(i.key),s=o.overlayedDocument,a=this.applyToLocalView(s,o.mutatedFields);a=t.has(i.key)?null:a;let c=_R(s,a);c!==null&&r.set(i.key,c),s.isValidDocument()||s.convertToNoDocument(we.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),De())}isEqual(e){return this.batchId===e.batchId&&Ec(this.mutations,e.mutations,(t,r)=>nN(t,r))&&Ec(this.baseMutations,e.baseMutations,(t,r)=>nN(t,r))}},sb=class n{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){$e(e.mutations.length===r.length,58842,{Ve:e.mutations.length,me:r.length});let i=function(){return J9}(),o=e.mutations;for(let s=0;s<o.length;s++)i=i.insert(o[s].key,r[s].version);return new n(e,t,r,i)}};var ab=class{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};var cb=class{constructor(e,t){this.count=e,this.unchangedNames=t}};var wt,Ne;function cW(n){switch(n){case F.OK:return ue(64938);case F.CANCELLED:case F.UNKNOWN:case F.DEADLINE_EXCEEDED:case F.RESOURCE_EXHAUSTED:case F.INTERNAL:case F.UNAVAILABLE:case F.UNAUTHENTICATED:return!1;case F.INVALID_ARGUMENT:case F.NOT_FOUND:case F.ALREADY_EXISTS:case F.PERMISSION_DENIED:case F.FAILED_PRECONDITION:case F.ABORTED:case F.OUT_OF_RANGE:case F.UNIMPLEMENTED:case F.DATA_LOSS:return!0;default:return ue(15467,{code:n})}}function wR(n){if(n===void 0)return Li("GRPC error has no .code"),F.UNKNOWN;switch(n){case wt.OK:return F.OK;case wt.CANCELLED:return F.CANCELLED;case wt.UNKNOWN:return F.UNKNOWN;case wt.DEADLINE_EXCEEDED:return F.DEADLINE_EXCEEDED;case wt.RESOURCE_EXHAUSTED:return F.RESOURCE_EXHAUSTED;case wt.INTERNAL:return F.INTERNAL;case wt.UNAVAILABLE:return F.UNAVAILABLE;case wt.UNAUTHENTICATED:return F.UNAUTHENTICATED;case wt.INVALID_ARGUMENT:return F.INVALID_ARGUMENT;case wt.NOT_FOUND:return F.NOT_FOUND;case wt.ALREADY_EXISTS:return F.ALREADY_EXISTS;case wt.PERMISSION_DENIED:return F.PERMISSION_DENIED;case wt.FAILED_PRECONDITION:return F.FAILED_PRECONDITION;case wt.ABORTED:return F.ABORTED;case wt.OUT_OF_RANGE:return F.OUT_OF_RANGE;case wt.UNIMPLEMENTED:return F.UNIMPLEMENTED;case wt.DATA_LOSS:return F.DATA_LOSS;default:return ue(39323,{code:n})}}(Ne=wt||(wt={}))[Ne.OK=0]="OK",Ne[Ne.CANCELLED=1]="CANCELLED",Ne[Ne.UNKNOWN=2]="UNKNOWN",Ne[Ne.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ne[Ne.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ne[Ne.NOT_FOUND=5]="NOT_FOUND",Ne[Ne.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ne[Ne.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ne[Ne.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ne[Ne.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ne[Ne.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ne[Ne.ABORTED=10]="ABORTED",Ne[Ne.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ne[Ne.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ne[Ne.INTERNAL=13]="INTERNAL",Ne[Ne.UNAVAILABLE=14]="UNAVAILABLE",Ne[Ne.DATA_LOSS=15]="DATA_LOSS";var oN=null;var lW=new ki([4294967295,4294967295],0);function sN(n){let e=PN().encode(n),t=new IC;return t.update(e),new Uint8Array(t.digest())}function aN(n){let e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),o=e.getUint32(12,!0);return[new ki([t,r],0),new ki([i,o],0)]}var lb=class n{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new Bs(`Invalid padding: ${t}`);if(r<0)throw new Bs(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Bs(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new Bs(`Invalid padding when bitmap length is 0: ${t}`);this.fe=8*e.length-t,this.ge=ki.fromNumber(this.fe)}pe(e,t,r){let i=e.add(t.multiply(ki.fromNumber(r)));return i.compare(lW)===1&&(i=new ki([i.getBits(0),i.getBits(1)],0)),i.modulo(this.ge).toNumber()}ye(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.fe===0)return!1;let t=sN(e),[r,i]=aN(t);for(let o=0;o<this.hashCount;o++){let s=this.pe(r,i,o);if(!this.ye(s))return!1}return!0}static create(e,t,r){let i=e%8==0?0:8-e%8,o=new Uint8Array(Math.ceil(e/8)),s=new n(o,i,t);return r.forEach(a=>s.insert(a)),s}insert(e){if(this.fe===0)return;let t=sN(e),[r,i]=aN(t);for(let o=0;o<this.hashCount;o++){let s=this.pe(r,i,o);this.we(s)}}we(e){let t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}},Bs=class extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}};var km=class n{constructor(e,t,r,i,o){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=o}static createSynthesizedRemoteEventForCurrentChange(e,t,r){let i=new Map;return i.set(e,pd.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new n(we.min(),i,new pt(xe),Ui(),De())}},pd=class n{constructor(e,t,r,i,o){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=o}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new n(r,t,De(),De(),De())}};var bc=class{constructor(e,t,r,i){this.Se=e,this.removedTargetIds=t,this.key=r,this.be=i}},Fm=class{constructor(e,t){this.targetId=e,this.De=t}},Lm=class{constructor(e,t,r=on.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}},Vm=class{constructor(){this.ve=0,this.Ce=cN(),this.Fe=on.EMPTY_BYTE_STRING,this.Me=!1,this.xe=!0}get current(){return this.Me}get resumeToken(){return this.Fe}get Oe(){return this.ve!==0}get Ne(){return this.xe}Be(e){e.approximateByteSize()>0&&(this.xe=!0,this.Fe=e)}Le(){let e=De(),t=De(),r=De();return this.Ce.forEach((i,o)=>{switch(o){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:ue(38017,{changeType:o})}}),new pd(this.Fe,this.Me,e,t,r)}ke(){this.xe=!1,this.Ce=cN()}qe(e,t){this.xe=!0,this.Ce=this.Ce.insert(e,t)}Qe(e){this.xe=!0,this.Ce=this.Ce.remove(e)}$e(){this.ve+=1}Ue(){this.ve-=1,$e(this.ve>=0,3241,{ve:this.ve})}Ke(){this.xe=!0,this.Me=!0}},ub=class{constructor(e){this.We=e,this.Ge=new Map,this.ze=Ui(),this.je=bm(),this.Je=bm(),this.He=new pt(xe)}Ye(e){for(let t of e.Se)e.be&&e.be.isFoundDocument()?this.Ze(t,e.be):this.Xe(t,e.key,e.be);for(let t of e.removedTargetIds)this.Xe(t,e.key,e.be)}et(e){this.forEachTarget(e,t=>{let r=this.tt(t);switch(e.state){case 0:this.nt(t)&&r.Be(e.resumeToken);break;case 1:r.Ue(),r.Oe||r.ke(),r.Be(e.resumeToken);break;case 2:r.Ue(),r.Oe||this.removeTarget(t);break;case 3:this.nt(t)&&(r.Ke(),r.Be(e.resumeToken));break;case 4:this.nt(t)&&(this.rt(t),r.Be(e.resumeToken));break;default:ue(56790,{state:e.state})}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Ge.forEach((r,i)=>{this.nt(i)&&t(i)})}it(e){let t=e.targetId,r=e.De.count,i=this.st(t);if(i){let o=i.target;if(eb(o))if(r===0){let s=new ae(o.path);this.Xe(t,s,br.newNoDocument(s,we.min()))}else $e(r===1,20013,{expectedCount:r});else{let s=this.ot(t);if(s!==r){let a=this._t(e),c=a?this.ut(a,e,s):1;if(c!==0){this.rt(t);let u=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.He=this.He.insert(t,u)}oN?.ct(function(d,f,v,_,b){var N,R,G,oe,ce,Fe;let Dt={localCacheCount:d,existenceFilterCount:f.count,databaseId:v.database,projectId:v.projectId},ze=f.unchangedNames;return ze&&(Dt.bloomFilter={applied:b===0,hashCount:(N=ze?.hashCount)!==null&&N!==void 0?N:0,bitmapLength:(oe=(G=(R=ze?.bits)===null||R===void 0?void 0:R.bitmap)===null||G===void 0?void 0:G.length)!==null&&oe!==void 0?oe:0,padding:(Fe=(ce=ze?.bits)===null||ce===void 0?void 0:ce.padding)!==null&&Fe!==void 0?Fe:0,mightContain:D=>{var E;return(E=_?.mightContain(D))!==null&&E!==void 0&&E}}),Dt}(s,e.De,this.We.lt(),a,c))}}}}_t(e){let t=e.De.unchangedNames;if(!t||!t.bits)return null;let{bits:{bitmap:r="",padding:i=0},hashCount:o=0}=t,s,a;try{s=ji(r).toUint8Array()}catch(c){if(c instanceof Am)return Oo("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{a=new lb(s,i,o)}catch(c){return Oo(c instanceof Bs?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return a.fe===0?null:a}ut(e,t,r){return t.De.count===r-this.ht(e,t.targetId)?0:2}ht(e,t){let r=this.We.getRemoteKeysForTarget(t),i=0;return r.forEach(o=>{let s=this.We.lt(),a=`projects/${s.projectId}/databases/${s.database}/documents/${o.path.canonicalString()}`;e.mightContain(a)||(this.Xe(t,o,null),i++)}),i}Pt(e){let t=new Map;this.Ge.forEach((o,s)=>{let a=this.st(s);if(a){if(o.current&&eb(a.target)){let c=new ae(a.target.path);this.Tt(c).has(s)||this.It(s,c)||this.Xe(s,c,br.newNoDocument(c,e))}o.Ne&&(t.set(s,o.Le()),o.ke())}});let r=De();this.Je.forEach((o,s)=>{let a=!0;s.forEachWhile(c=>{let u=this.st(c);return!u||u.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(o))}),this.ze.forEach((o,s)=>s.setReadTime(e));let i=new km(e,t,this.He,this.ze,r);return this.ze=Ui(),this.je=bm(),this.Je=bm(),this.He=new pt(xe),i}Ze(e,t){if(!this.nt(e))return;let r=this.It(e,t.key)?2:0;this.tt(e).qe(t.key,r),this.ze=this.ze.insert(t.key,t),this.je=this.je.insert(t.key,this.Tt(t.key).add(e)),this.Je=this.Je.insert(t.key,this.dt(t.key).add(e))}Xe(e,t,r){if(!this.nt(e))return;let i=this.tt(e);this.It(e,t)?i.qe(t,1):i.Qe(t),this.Je=this.Je.insert(t,this.dt(t).delete(e)),this.Je=this.Je.insert(t,this.dt(t).add(e)),r&&(this.ze=this.ze.insert(t,r))}removeTarget(e){this.Ge.delete(e)}ot(e){let t=this.tt(e).Le();return this.We.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}$e(e){this.tt(e).$e()}tt(e){let t=this.Ge.get(e);return t||(t=new Vm,this.Ge.set(e,t)),t}dt(e){let t=this.Je.get(e);return t||(t=new Ft(xe),this.Je=this.Je.insert(e,t)),t}Tt(e){let t=this.je.get(e);return t||(t=new Ft(xe),this.je=this.je.insert(e,t)),t}nt(e){let t=this.st(e)!==null;return t||X("WatchChangeAggregator","Detected inactive target",e),t}st(e){let t=this.Ge.get(e);return t&&t.Oe?null:this.We.Et(e)}rt(e){this.Ge.set(e,new Vm),this.We.getRemoteKeysForTarget(e).forEach(t=>{this.Xe(e,t,null)})}It(e,t){return this.We.getRemoteKeysForTarget(e).has(t)}};function bm(){return new pt(ae.comparator)}function cN(){return new pt(ae.comparator)}var uW={asc:"ASCENDING",desc:"DESCENDING"},dW={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},hW={and:"AND",or:"OR"},db=class{constructor(e,t){this.databaseId=e,this.useProto3Json=t}};function hb(n,e){return n.useProto3Json||lg(e)?e:{value:e}}function jm(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function CR(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function fW(n,e){return jm(n,e.toTimestamp())}function ci(n){return $e(!!n,49232),we.fromTimestamp(function(t){let r=Vi(t);return new Et(r.seconds,r.nanos)}(n))}function DI(n,e){return fb(n,e).canonicalString()}function fb(n,e){let t=function(i){return new at(["projects",i.projectId,"databases",i.database])}(n).child("documents");return e===void 0?t:t.child(e)}function bR(n){let e=at.fromString(n);return $e(TR(e),10190,{key:e.toString()}),e}function pb(n,e){return DI(n.databaseId,e.path)}function MC(n,e){let t=bR(e);if(t.get(1)!==n.databaseId.projectId)throw new Q(F.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new Q(F.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new ae(ER(t))}function IR(n,e){return DI(n.databaseId,e)}function pW(n){let e=bR(n);return e.length===4?at.emptyPath():ER(e)}function mb(n){return new at(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function ER(n){return $e(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function lN(n,e,t){return{name:pb(n,e),fields:t.value.mapValue.fields}}function mW(n,e){let t;if("targetChange"in e){e.targetChange;let r=function(u){return u==="NO_CHANGE"?0:u==="ADD"?1:u==="REMOVE"?2:u==="CURRENT"?3:u==="RESET"?4:ue(39313,{state:u})}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],o=function(u,d){return u.useProto3Json?($e(d===void 0||typeof d=="string",58123),on.fromBase64String(d||"")):($e(d===void 0||d instanceof Buffer||d instanceof Uint8Array,16193),on.fromUint8Array(d||new Uint8Array))}(n,e.targetChange.resumeToken),s=e.targetChange.cause,a=s&&function(u){let d=u.code===void 0?F.UNKNOWN:wR(u.code);return new Q(d,u.message||"")}(s);t=new Lm(r,i,o,a||null)}else if("documentChange"in e){e.documentChange;let r=e.documentChange;r.document,r.document.name,r.document.updateTime;let i=MC(n,r.document.name),o=ci(r.document.updateTime),s=r.document.createTime?ci(r.document.createTime):we.min(),a=new Un({mapValue:{fields:r.document.fields}}),c=br.newFoundDocument(i,o,s,a),u=r.targetIds||[],d=r.removedTargetIds||[];t=new bc(u,d,c.key,c)}else if("documentDelete"in e){e.documentDelete;let r=e.documentDelete;r.document;let i=MC(n,r.document),o=r.readTime?ci(r.readTime):we.min(),s=br.newNoDocument(i,o),a=r.removedTargetIds||[];t=new bc([],a,s.key,s)}else if("documentRemove"in e){e.documentRemove;let r=e.documentRemove;r.document;let i=MC(n,r.document),o=r.removedTargetIds||[];t=new bc([],o,i,null)}else{if(!("filter"in e))return ue(11601,{At:e});{e.filter;let r=e.filter;r.targetId;let{count:i=0,unchangedNames:o}=r,s=new cb(i,o),a=r.targetId;t=new Fm(a,s)}}return t}function gW(n,e){let t;if(e instanceof Ys)t={update:lN(n,e.key,e.value)};else if(e instanceof fd)t={delete:pb(n,e.key)};else if(e instanceof ui)t={update:lN(n,e.key,e.data),updateMask:xW(e.fieldMask)};else{if(!(e instanceof ib))return ue(16599,{Rt:e.type});t={verify:pb(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>function(o,s){let a=s.transform;if(a instanceof Pc)return{fieldPath:s.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof Gs)return{fieldPath:s.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof Ks)return{fieldPath:s.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof Ac)return{fieldPath:s.field.canonicalString(),increment:a.Ee};throw ue(20930,{transform:s.transform})}(0,r))),e.precondition.isNone||(t.currentDocument=function(i,o){return o.updateTime!==void 0?{updateTime:fW(i,o.updateTime)}:o.exists!==void 0?{exists:o.exists}:ue(27497)}(n,e.precondition)),t}function vW(n,e){return n&&n.length>0?($e(e!==void 0,14353),n.map(t=>function(i,o){let s=i.updateTime?ci(i.updateTime):ci(o);return s.isEqual(we.min())&&(s=ci(o)),new rb(s,i.transformResults||[])}(t,e))):[]}function _W(n,e){return{documents:[IR(n,e.path)]}}function yW(n,e){let t={structuredQuery:{}},r=e.path,i;e.collectionGroup!==null?(i=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=IR(n,i);let o=function(u){if(u.length!==0)return SR(Ir.create(u,"and"))}(e.filters);o&&(t.structuredQuery.where=o);let s=function(u){if(u.length!==0)return u.map(d=>function(v){return{field:yc(v.field),direction:bW(v.dir)}}(d))}(e.orderBy);s&&(t.structuredQuery.orderBy=s);let a=hb(n,e.limit);return a!==null&&(t.structuredQuery.limit=a),e.startAt&&(t.structuredQuery.startAt=function(u){return{before:u.inclusive,values:u.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(u){return{before:!u.inclusive,values:u.position}}(e.endAt)),{Vt:t,parent:i}}function wW(n){let e=pW(n.parent),t=n.structuredQuery,r=t.from?t.from.length:0,i=null;if(r>0){$e(r===1,65062);let d=t.from[0];d.allDescendants?i=d.collectionId:e=e.child(d.collectionId)}let o=[];t.where&&(o=function(f){let v=xR(f);return v instanceof Ir&&rR(v)?v.getFilters():[v]}(t.where));let s=[];t.orderBy&&(s=function(f){return f.map(v=>function(b){return new qs(wc(b.field),function(R){switch(R){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(b.direction))}(v))}(t.orderBy));let a=null;t.limit&&(a=function(f){let v;return v=typeof f=="object"?f.value:f,lg(v)?null:v}(t.limit));let c=null;t.startAt&&(c=function(f){let v=!!f.before,_=f.values||[];return new Dc(_,v)}(t.startAt));let u=null;return t.endAt&&(u=function(f){let v=!f.before,_=f.values||[];return new Dc(_,v)}(t.endAt)),G9(e,i,s,o,a,"F",c,u)}function CW(n,e){let t=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return ue(28987,{purpose:i})}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function xR(n){return n.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":let r=wc(t.unaryFilter.field);return bt.create(r,"==",{doubleValue:NaN});case"IS_NULL":let i=wc(t.unaryFilter.field);return bt.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let o=wc(t.unaryFilter.field);return bt.create(o,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let s=wc(t.unaryFilter.field);return bt.create(s,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return ue(61313);default:return ue(60726)}}(n):n.fieldFilter!==void 0?function(t){return bt.create(wc(t.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return ue(58110);default:return ue(50506)}}(t.fieldFilter.op),t.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(t){return Ir.create(t.compositeFilter.filters.map(r=>xR(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return ue(1026)}}(t.compositeFilter.op))}(n):ue(30097,{filter:n})}function bW(n){return uW[n]}function IW(n){return dW[n]}function EW(n){return hW[n]}function yc(n){return{fieldPath:n.canonicalString()}}function wc(n){return $n.fromServerFormat(n.fieldPath)}function SR(n){return n instanceof bt?function(t){if(t.op==="=="){if(QO(t.value))return{unaryFilter:{field:yc(t.field),op:"IS_NAN"}};if(YO(t.value))return{unaryFilter:{field:yc(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(QO(t.value))return{unaryFilter:{field:yc(t.field),op:"IS_NOT_NAN"}};if(YO(t.value))return{unaryFilter:{field:yc(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:yc(t.field),op:IW(t.op),value:t.value}}}(n):n instanceof Ir?function(t){let r=t.getFilters().map(i=>SR(i));return r.length===1?r[0]:{compositeFilter:{op:EW(t.op),filters:r}}}(n):ue(54877,{filter:n})}function xW(n){let e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function TR(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}var md=class n{constructor(e,t,r,i,o=we.min(),s=we.min(),a=on.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=o,this.lastLimboFreeSnapshotVersion=s,this.resumeToken=a,this.expectedCount=c}withSequenceNumber(e){return new n(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}};var gb=class{constructor(e){this.gt=e}};function SW(n){let e=wW({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?nb(e,e.limit,"L"):e}var Bm=class{constructor(){}bt(e,t){this.Dt(e,t),t.vt()}Dt(e,t){if("nullValue"in e)this.Ct(t,5);else if("booleanValue"in e)this.Ct(t,10),t.Ft(e.booleanValue?1:0);else if("integerValue"in e)this.Ct(t,15),t.Ft(st(e.integerValue));else if("doubleValue"in e){let r=st(e.doubleValue);isNaN(r)?this.Ct(t,13):(this.Ct(t,15),ud(r)?t.Ft(0):t.Ft(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Ct(t,20),typeof r=="string"&&(r=Vi(r)),t.Mt(`${r.seconds||""}`),t.Ft(r.nanos||0)}else if("stringValue"in e)this.xt(e.stringValue,t),this.Ot(t);else if("bytesValue"in e)this.Ct(t,30),t.Nt(ji(e.bytesValue)),this.Ot(t);else if("referenceValue"in e)this.Bt(e.referenceValue,t);else if("geoPointValue"in e){let r=e.geoPointValue;this.Ct(t,45),t.Ft(r.latitude||0),t.Ft(r.longitude||0)}else"mapValue"in e?eR(e)?this.Ct(t,Number.MAX_SAFE_INTEGER):XN(e)?this.Lt(e.mapValue,t):(this.kt(e.mapValue,t),this.Ot(t)):"arrayValue"in e?(this.qt(e.arrayValue,t),this.Ot(t)):ue(19022,{Qt:e})}xt(e,t){this.Ct(t,25),this.$t(e,t)}$t(e,t){t.Mt(e)}kt(e,t){let r=e.fields||{};this.Ct(t,55);for(let i of Object.keys(r))this.xt(i,t),this.Dt(r[i],t)}Lt(e,t){var r,i;let o=e.fields||{};this.Ct(t,53);let s=xc,a=((i=(r=o[s].arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.length)||0;this.Ct(t,15),t.Ft(st(a)),this.xt(s,t),this.Dt(o[s],t)}qt(e,t){let r=e.values||[];this.Ct(t,50);for(let i of r)this.Dt(i,t)}Bt(e,t){this.Ct(t,37),ae.fromName(e).path.forEach(r=>{this.Ct(t,60),this.$t(r,t)})}Ct(e,t){e.Ft(t)}Ot(e){e.Ft(2)}};Bm.Ut=new Bm;var vb=class{constructor(){this.Dn=new _b}addToCollectionParentIndex(e,t){return this.Dn.add(t),$.resolve()}getCollectionParents(e,t){return $.resolve(this.Dn.getEntries(t))}addFieldIndex(e,t){return $.resolve()}deleteFieldIndex(e,t){return $.resolve()}deleteAllFieldIndexes(e){return $.resolve()}createTargetIndexes(e,t){return $.resolve()}getDocumentsMatchingTarget(e,t){return $.resolve(null)}getIndexType(e,t){return $.resolve(0)}getFieldIndexes(e,t){return $.resolve([])}getNextCollectionGroupToUpdate(e){return $.resolve(null)}getMinOffset(e,t){return $.resolve(Ws.min())}getMinOffsetFromCollectionGroup(e,t){return $.resolve(Ws.min())}updateCollectionGroup(e,t,r){return $.resolve()}updateIndexEntries(e,t){return $.resolve()}},_b=class{constructor(){this.index={}}add(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new Ft(at.comparator),o=!i.has(r);return this.index[t]=i.add(r),o}has(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Ft(at.comparator)).toArray()}};var Hce=new Uint8Array(0);var uN={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},DR=41943040,Jn=class n{static withCacheSize(e){return new n(e,n.DEFAULT_COLLECTION_PERCENTILE,n.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}};Jn.DEFAULT_COLLECTION_PERCENTILE=10,Jn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Jn.DEFAULT=new Jn(DR,Jn.DEFAULT_COLLECTION_PERCENTILE,Jn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Jn.DISABLED=new Jn(-1,0,0);var gd=class n{constructor(e){this._r=e}next(){return this._r+=2,this._r}static ar(){return new n(0)}static ur(){return new n(-1)}};var dN="LruGarbageCollector",TW=1048576;function hN([n,e],[t,r]){let i=xe(n,t);return i===0?xe(e,r):i}var yb=class{constructor(e){this.Tr=e,this.buffer=new Ft(hN),this.Ir=0}dr(){return++this.Ir}Er(e){let t=[e,this.dr()];if(this.buffer.size<this.Tr)this.buffer=this.buffer.add(t);else{let r=this.buffer.last();hN(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}},wb=class{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Ar=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Rr(6e4)}stop(){this.Ar&&(this.Ar.cancel(),this.Ar=null)}get started(){return this.Ar!==null}Rr(e){X(dN,`Garbage collection scheduled in ${e}ms`),this.Ar=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,()=>w(this,null,function*(){this.Ar=null;try{yield this.localStore.collectGarbage(this.garbageCollector)}catch(t){Vc(t)?X(dN,"Ignoring IndexedDB error during garbage collection: ",t):yield Lc(t)}yield this.Rr(3e5)}))}},Cb=class{constructor(e,t){this.Vr=e,this.params=t}calculateTargetCount(e,t){return this.Vr.mr(e).next(r=>Math.floor(t/100*r))}nthSequenceNumber(e,t){if(t===0)return $.resolve(_I.ue);let r=new yb(t);return this.Vr.forEachTarget(e,i=>r.Er(i.sequenceNumber)).next(()=>this.Vr.gr(e,i=>r.Er(i))).next(()=>r.maxValue)}removeTargets(e,t,r){return this.Vr.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.Vr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(X("LruGarbageCollector","Garbage collection skipped; disabled"),$.resolve(uN)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(X("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),uN):this.pr(e,t))}getCacheSize(e){return this.Vr.getCacheSize(e)}pr(e,t){let r,i,o,s,a,c,u,d=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(f=>(f>this.params.maximumSequenceNumbersToCollect?(X("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${f}`),i=this.params.maximumSequenceNumbersToCollect):i=f,s=Date.now(),this.nthSequenceNumber(e,i))).next(f=>(r=f,a=Date.now(),this.removeTargets(e,r,t))).next(f=>(o=f,c=Date.now(),this.removeOrphanedDocuments(e,r))).next(f=>(u=Date.now(),vc()<=Ee.DEBUG&&X("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${s-d}ms
	Determined least recently used ${i} in `+(a-s)+`ms
	Removed ${o} targets in `+(c-a)+`ms
	Removed ${f} documents in `+(u-c)+`ms
Total Duration: ${u-d}ms`),$.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:o,documentsRemoved:f})))}};function DW(n,e){return new Cb(n,e)}var bb=class{constructor(){this.changes=new Bi(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,br.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();let r=this.changes.get(t);return r!==void 0?$.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}};var Ib=class{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}};var Eb=class{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,t))).next(i=>(r!==null&&ad(r.mutation,i,Xn.empty(),Et.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,De()).next(()=>r))}getLocalViewOfDocuments(e,t,r=De()){let i=js();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,r).next(o=>{let s=rd();return o.forEach((a,c)=>{s=s.insert(a,c.overlayedDocument)}),s}))}getOverlayedDocuments(e,t){let r=js();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,De()))}populateOverlays(e,t,r){let i=[];return r.forEach(o=>{t.has(o)||i.push(o)}),this.documentOverlayCache.getOverlays(e,i).next(o=>{o.forEach((s,a)=>{t.set(s,a)})})}computeViews(e,t,r,i){let o=Ui(),s=sd(),a=function(){return sd()}();return t.forEach((c,u)=>{let d=r.get(u.key);i.has(u.key)&&(d===void 0||d.mutation instanceof ui)?o=o.insert(u.key,u):d!==void 0?(s.set(u.key,d.mutation.getFieldMask()),ad(d.mutation,u,d.mutation.getFieldMask(),Et.now())):s.set(u.key,Xn.empty())}),this.recalculateAndSaveOverlays(e,o).next(c=>(c.forEach((u,d)=>s.set(u,d)),t.forEach((u,d)=>{var f;return a.set(u,new Ib(d,(f=s.get(u))!==null&&f!==void 0?f:null))}),a))}recalculateAndSaveOverlays(e,t){let r=sd(),i=new pt((s,a)=>s-a),o=De();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(s=>{for(let a of s)a.keys().forEach(c=>{let u=t.get(c);if(u===null)return;let d=r.get(c)||Xn.empty();d=a.applyToLocalView(u,d),r.set(c,d);let f=(i.get(a.batchId)||De()).add(c);i=i.insert(a.batchId,f)})}).next(()=>{let s=[],a=i.getReverseIterator();for(;a.hasNext();){let c=a.getNext(),u=c.key,d=c.value,f=hR();d.forEach(v=>{if(!o.has(v)){let _=_R(t.get(v),r.get(v));_!==null&&f.set(v,_),o=o.add(v)}}),s.push(this.documentOverlayCache.saveOverlays(e,u,f))}return $.waitFor(s)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r,i){return function(s){return ae.isDocumentKey(s.path)&&s.collectionGroup===null&&s.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):aR(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,i):this.getDocumentsMatchingCollectionQuery(e,t,r,i)}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next(o=>{let s=i-o.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-o.size):$.resolve(js()),a=ld,c=o;return s.next(u=>$.forEach(u,(d,f)=>(a<f.largestBatchId&&(a=f.largestBatchId),o.get(d)?$.resolve():this.remoteDocumentCache.getEntry(e,d).next(v=>{c=c.insert(d,v)}))).next(()=>this.populateOverlays(e,u,o)).next(()=>this.computeViews(e,c,u,De())).next(d=>({batchId:a,changes:dR(d)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new ae(t)).next(r=>{let i=rd();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,r,i){let o=t.collectionGroup,s=rd();return this.indexManager.getCollectionParents(e,o).next(a=>$.forEach(a,c=>{let u=function(f,v){return new Ro(v,null,f.explicitOrderBy.slice(),f.filters.slice(),f.limit,f.limitType,f.startAt,f.endAt)}(t,c.child(o));return this.getDocumentsMatchingCollectionQuery(e,u,r,i).next(d=>{d.forEach((f,v)=>{s=s.insert(f,v)})})}).next(()=>s))}getDocumentsMatchingCollectionQuery(e,t,r,i){let o;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(s=>(o=s,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,o,i))).next(s=>{o.forEach((c,u)=>{let d=u.getKey();s.get(d)===null&&(s=s.insert(d,br.newInvalidDocument(d)))});let a=rd();return s.forEach((c,u)=>{let d=o.get(c);d!==void 0&&ad(d.mutation,u,Xn.empty(),Et.now()),hg(t,u)&&(a=a.insert(c,u))}),a})}};var xb=class{constructor(e){this.serializer=e,this.Br=new Map,this.Lr=new Map}getBundleMetadata(e,t){return $.resolve(this.Br.get(t))}saveBundleMetadata(e,t){return this.Br.set(t.id,function(i){return{id:i.id,version:i.version,createTime:ci(i.createTime)}}(t)),$.resolve()}getNamedQuery(e,t){return $.resolve(this.Lr.get(t))}saveNamedQuery(e,t){return this.Lr.set(t.name,function(i){return{name:i.name,query:SW(i.bundledQuery),readTime:ci(i.readTime)}}(t)),$.resolve()}};var Sb=class{constructor(){this.overlays=new pt(ae.comparator),this.kr=new Map}getOverlay(e,t){return $.resolve(this.overlays.get(t))}getOverlays(e,t){let r=js();return $.forEach(t,i=>this.getOverlay(e,i).next(o=>{o!==null&&r.set(i,o)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((i,o)=>{this.wt(e,t,o)}),$.resolve()}removeOverlaysForBatchId(e,t,r){let i=this.kr.get(r);return i!==void 0&&(i.forEach(o=>this.overlays=this.overlays.remove(o)),this.kr.delete(r)),$.resolve()}getOverlaysForCollection(e,t,r){let i=js(),o=t.length+1,s=new ae(t.child("")),a=this.overlays.getIteratorFrom(s);for(;a.hasNext();){let c=a.getNext().value,u=c.getKey();if(!t.isPrefixOf(u.path))break;u.path.length===o&&c.largestBatchId>r&&i.set(c.getKey(),c)}return $.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let o=new pt((u,d)=>u-d),s=this.overlays.getIterator();for(;s.hasNext();){let u=s.getNext().value;if(u.getKey().getCollectionGroup()===t&&u.largestBatchId>r){let d=o.get(u.largestBatchId);d===null&&(d=js(),o=o.insert(u.largestBatchId,d)),d.set(u.getKey(),u)}}let a=js(),c=o.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((u,d)=>a.set(u,d)),!(a.size()>=i)););return $.resolve(a)}wt(e,t,r){let i=this.overlays.get(r.key);if(i!==null){let s=this.kr.get(i.largestBatchId).delete(r.key);this.kr.set(i.largestBatchId,s)}this.overlays=this.overlays.insert(r.key,new ab(t,r));let o=this.kr.get(t);o===void 0&&(o=De(),this.kr.set(t,o)),this.kr.set(t,o.add(r.key))}};var Tb=class{constructor(){this.sessionToken=on.EMPTY_BYTE_STRING}getSessionToken(e){return $.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,$.resolve()}};var vd=class{constructor(){this.qr=new Ft(Ct.Qr),this.$r=new Ft(Ct.Ur)}isEmpty(){return this.qr.isEmpty()}addReference(e,t){let r=new Ct(e,t);this.qr=this.qr.add(r),this.$r=this.$r.add(r)}Kr(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.Wr(new Ct(e,t))}Gr(e,t){e.forEach(r=>this.removeReference(r,t))}zr(e){let t=new ae(new at([])),r=new Ct(t,e),i=new Ct(t,e+1),o=[];return this.$r.forEachInRange([r,i],s=>{this.Wr(s),o.push(s.key)}),o}jr(){this.qr.forEach(e=>this.Wr(e))}Wr(e){this.qr=this.qr.delete(e),this.$r=this.$r.delete(e)}Jr(e){let t=new ae(new at([])),r=new Ct(t,e),i=new Ct(t,e+1),o=De();return this.$r.forEachInRange([r,i],s=>{o=o.add(s.key)}),o}containsKey(e){let t=new Ct(e,0),r=this.qr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}},Ct=class{constructor(e,t){this.key=e,this.Hr=t}static Qr(e,t){return ae.comparator(e.key,t.key)||xe(e.Hr,t.Hr)}static Ur(e,t){return xe(e.Hr,t.Hr)||ae.comparator(e.key,t.key)}};var Db=class{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.er=1,this.Yr=new Ft(Ct.Qr)}checkEmpty(e){return $.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,i){let o=this.er;this.er++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let s=new ob(o,t,r,i);this.mutationQueue.push(s);for(let a of i)this.Yr=this.Yr.add(new Ct(a.key,o)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return $.resolve(s)}lookupMutationBatch(e,t){return $.resolve(this.Zr(t))}getNextMutationBatchAfterBatchId(e,t){let r=t+1,i=this.Xr(r),o=i<0?0:i;return $.resolve(this.mutationQueue.length>o?this.mutationQueue[o]:null)}getHighestUnacknowledgedBatchId(){return $.resolve(this.mutationQueue.length===0?yI:this.er-1)}getAllMutationBatches(e){return $.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){let r=new Ct(t,0),i=new Ct(t,Number.POSITIVE_INFINITY),o=[];return this.Yr.forEachInRange([r,i],s=>{let a=this.Zr(s.Hr);o.push(a)}),$.resolve(o)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Ft(xe);return t.forEach(i=>{let o=new Ct(i,0),s=new Ct(i,Number.POSITIVE_INFINITY);this.Yr.forEachInRange([o,s],a=>{r=r.add(a.Hr)})}),$.resolve(this.ei(r))}getAllMutationBatchesAffectingQuery(e,t){let r=t.path,i=r.length+1,o=r;ae.isDocumentKey(o)||(o=o.child(""));let s=new Ct(new ae(o),0),a=new Ft(xe);return this.Yr.forEachWhile(c=>{let u=c.key.path;return!!r.isPrefixOf(u)&&(u.length===i&&(a=a.add(c.Hr)),!0)},s),$.resolve(this.ei(a))}ei(e){let t=[];return e.forEach(r=>{let i=this.Zr(r);i!==null&&t.push(i)}),t}removeMutationBatch(e,t){$e(this.ti(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Yr;return $.forEach(t.mutations,i=>{let o=new Ct(i.key,t.batchId);return r=r.delete(o),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.Yr=r})}rr(e){}containsKey(e,t){let r=new Ct(t,0),i=this.Yr.firstAfterOrEqual(r);return $.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,$.resolve()}ti(e,t){return this.Xr(e)}Xr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Zr(e){let t=this.Xr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}};var Mb=class{constructor(e){this.ni=e,this.docs=function(){return new pt(ae.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){let r=t.key,i=this.docs.get(r),o=i?i.size:0,s=this.ni(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:s}),this.size+=s-o,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){let t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){let r=this.docs.get(t);return $.resolve(r?r.document.mutableCopy():br.newInvalidDocument(t))}getEntries(e,t){let r=Ui();return t.forEach(i=>{let o=this.docs.get(i);r=r.insert(i,o?o.document.mutableCopy():br.newInvalidDocument(i))}),$.resolve(r)}getDocumentsMatchingQuery(e,t,r,i){let o=Ui(),s=t.path,a=new ae(s.child("__id-9223372036854775808__")),c=this.docs.getIteratorFrom(a);for(;c.hasNext();){let{key:u,value:{document:d}}=c.getNext();if(!s.isPrefixOf(u.path))break;u.path.length>s.length+1||D9(T9(d),r)<=0||(i.has(d.key)||hg(t,d))&&(o=o.insert(d.key,d.mutableCopy()))}return $.resolve(o)}getAllFromCollectionGroup(e,t,r,i){ue(9500)}ri(e,t){return $.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new Pb(this)}getSize(e){return $.resolve(this.size)}},Pb=class extends bb{constructor(e){super(),this.Or=e}applyChanges(e){let t=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?t.push(this.Or.addEntry(e,i)):this.Or.removeEntry(r)}),$.waitFor(t)}getFromCache(e,t){return this.Or.getEntry(e,t)}getAllFromCache(e,t){return this.Or.getEntries(e,t)}};var Ab=class{constructor(e){this.persistence=e,this.ii=new Bi(t=>EI(t),xI),this.lastRemoteSnapshotVersion=we.min(),this.highestTargetId=0,this.si=0,this.oi=new vd,this.targetCount=0,this._i=gd.ar()}forEachTarget(e,t){return this.ii.forEach((r,i)=>t(i)),$.resolve()}getLastRemoteSnapshotVersion(e){return $.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return $.resolve(this.si)}allocateTargetId(e){return this.highestTargetId=this._i.next(),$.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.si&&(this.si=t),$.resolve()}hr(e){this.ii.set(e.target,e);let t=e.targetId;t>this.highestTargetId&&(this._i=new gd(t),this.highestTargetId=t),e.sequenceNumber>this.si&&(this.si=e.sequenceNumber)}addTargetData(e,t){return this.hr(t),this.targetCount+=1,$.resolve()}updateTargetData(e,t){return this.hr(t),$.resolve()}removeTargetData(e,t){return this.ii.delete(t.target),this.oi.zr(t.targetId),this.targetCount-=1,$.resolve()}removeTargets(e,t,r){let i=0,o=[];return this.ii.forEach((s,a)=>{a.sequenceNumber<=t&&r.get(a.targetId)===null&&(this.ii.delete(s),o.push(this.removeMatchingKeysForTargetId(e,a.targetId)),i++)}),$.waitFor(o).next(()=>i)}getTargetCount(e){return $.resolve(this.targetCount)}getTargetData(e,t){let r=this.ii.get(t)||null;return $.resolve(r)}addMatchingKeys(e,t,r){return this.oi.Kr(t,r),$.resolve()}removeMatchingKeys(e,t,r){this.oi.Gr(t,r);let i=this.persistence.referenceDelegate,o=[];return i&&t.forEach(s=>{o.push(i.markPotentiallyOrphaned(e,s))}),$.waitFor(o)}removeMatchingKeysForTargetId(e,t){return this.oi.zr(t),$.resolve()}getMatchingKeysForTargetId(e,t){let r=this.oi.Jr(t);return $.resolve(r)}containsKey(e,t){return $.resolve(this.oi.containsKey(t))}};var Um=class{constructor(e,t){this.ai={},this.overlays={},this.ui=new _I(0),this.ci=!1,this.ci=!0,this.li=new Tb,this.referenceDelegate=e(this),this.hi=new Ab(this),this.indexManager=new vb,this.remoteDocumentCache=function(i){return new Mb(i)}(r=>this.referenceDelegate.Pi(r)),this.serializer=new gb(t),this.Ti=new xb(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ci=!1,Promise.resolve()}get started(){return this.ci}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new Sb,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.ai[e.toKey()];return r||(r=new Db(t,this.referenceDelegate),this.ai[e.toKey()]=r),r}getGlobalsCache(){return this.li}getTargetCache(){return this.hi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ti}runTransaction(e,t,r){X("MemoryPersistence","Starting transaction:",e);let i=new Ob(this.ui.next());return this.referenceDelegate.Ii(),r(i).next(o=>this.referenceDelegate.di(i).next(()=>o)).toPromise().then(o=>(i.raiseOnCommittedEvent(),o))}Ei(e,t){return $.or(Object.values(this.ai).map(r=>()=>r.containsKey(e,t)))}},Ob=class extends UC{constructor(e){super(),this.currentSequenceNumber=e}},Nb=class n{constructor(e){this.persistence=e,this.Ai=new vd,this.Ri=null}static Vi(e){return new n(e)}get mi(){if(this.Ri)return this.Ri;throw ue(60996)}addReference(e,t,r){return this.Ai.addReference(r,t),this.mi.delete(r.toString()),$.resolve()}removeReference(e,t,r){return this.Ai.removeReference(r,t),this.mi.add(r.toString()),$.resolve()}markPotentiallyOrphaned(e,t){return this.mi.add(t.toString()),$.resolve()}removeTarget(e,t){this.Ai.zr(t.targetId).forEach(i=>this.mi.add(i.toString()));let r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(o=>this.mi.add(o.toString()))}).next(()=>r.removeTargetData(e,t))}Ii(){this.Ri=new Set}di(e){let t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return $.forEach(this.mi,r=>{let i=ae.fromPath(r);return this.fi(e,i).next(o=>{o||t.removeEntry(i,we.min())})}).next(()=>(this.Ri=null,t.apply(e)))}updateLimboDocument(e,t){return this.fi(e,t).next(r=>{r?this.mi.delete(t.toString()):this.mi.add(t.toString())})}Pi(e){return 0}fi(e,t){return $.or([()=>$.resolve(this.Ai.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ei(e,t)])}},$m=class n{constructor(e,t){this.persistence=e,this.gi=new Bi(r=>O9(r.path),(r,i)=>r.isEqual(i)),this.garbageCollector=DW(this,t)}static Vi(e,t){return new n(e,t)}Ii(){}di(e){return $.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}mr(e){let t=this.yr(e);return this.persistence.getTargetCache().getTargetCount(e).next(r=>t.next(i=>r+i))}yr(e){let t=0;return this.gr(e,r=>{t++}).next(()=>t)}gr(e,t){return $.forEach(this.gi,(r,i)=>this.Sr(e,r,i).next(o=>o?$.resolve():t(i)))}removeTargets(e,t,r){return this.persistence.getTargetCache().removeTargets(e,t,r)}removeOrphanedDocuments(e,t){let r=0,i=this.persistence.getRemoteDocumentCache(),o=i.newChangeBuffer();return i.ri(e,s=>this.Sr(e,s,t).next(a=>{a||(r++,o.removeEntry(s,we.min()))})).next(()=>o.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,t){return this.gi.set(t,e.currentSequenceNumber),$.resolve()}removeTarget(e,t){let r=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,t,r){return this.gi.set(r,e.currentSequenceNumber),$.resolve()}removeReference(e,t,r){return this.gi.set(r,e.currentSequenceNumber),$.resolve()}updateLimboDocument(e,t){return this.gi.set(t,e.currentSequenceNumber),$.resolve()}Pi(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=Em(e.data.value)),t}Sr(e,t,r){return $.or([()=>this.persistence.Ei(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{let i=this.gi.get(t);return $.resolve(i!==void 0&&i>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}};var Rb=class n{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.Is=r,this.ds=i}static Es(e,t){let r=De(),i=De();for(let o of t.docChanges)switch(o.type){case 0:r=r.add(o.doc.key);break;case 1:i=i.add(o.doc.key)}return new n(e,t.fromCache,r,i)}};var kb=class{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}};var Fb=class{constructor(){this.As=!1,this.Rs=!1,this.Vs=100,this.fs=function(){return tA()?8:P9(Nt())>0?6:4}()}initialize(e,t){this.gs=e,this.indexManager=t,this.As=!0}getDocumentsMatchingQuery(e,t,r,i){let o={result:null};return this.ps(e,t).next(s=>{o.result=s}).next(()=>{if(!o.result)return this.ys(e,t,i,r).next(s=>{o.result=s})}).next(()=>{if(o.result)return;let s=new kb;return this.ws(e,t,s).next(a=>{if(o.result=a,this.Rs)return this.Ss(e,t,s,a.size)})}).next(()=>o.result)}Ss(e,t,r,i){return r.documentReadCount<this.Vs?(vc()<=Ee.DEBUG&&X("QueryEngine","SDK will not create cache indexes for query:",_c(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),$.resolve()):(vc()<=Ee.DEBUG&&X("QueryEngine","Query:",_c(t),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.fs*i?(vc()<=Ee.DEBUG&&X("QueryEngine","The SDK decides to create cache indexes for query:",_c(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,si(t))):$.resolve())}ps(e,t){if(eN(t))return $.resolve(null);let r=si(t);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(t.limit!==null&&i===1&&(t=nb(t,null,"F"),r=si(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(o=>{let s=De(...o);return this.gs.getDocuments(e,s).next(a=>this.indexManager.getMinOffset(e,r).next(c=>{let u=this.bs(t,a);return this.Ds(t,u,s,c.readTime)?this.ps(e,nb(t,null,"F")):this.vs(e,u,t,c)}))})))}ys(e,t,r,i){return eN(t)||i.isEqual(we.min())?$.resolve(null):this.gs.getDocuments(e,r).next(o=>{let s=this.bs(t,o);return this.Ds(t,s,r,i)?$.resolve(null):(vc()<=Ee.DEBUG&&X("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),_c(t)),this.vs(e,s,t,S9(i,ld)).next(a=>a))})}bs(e,t){let r=new Ft(lR(e));return t.forEach((i,o)=>{hg(e,o)&&(r=r.add(o))}),r}Ds(e,t,r,i){if(e.limit===null)return!1;if(r.size!==t.size)return!0;let o=e.limitType==="F"?t.last():t.first();return!!o&&(o.hasPendingWrites||o.version.compareTo(i)>0)}ws(e,t,r){return vc()<=Ee.DEBUG&&X("QueryEngine","Using full collection scan to execute query:",_c(t)),this.gs.getDocumentsMatchingQuery(e,t,Ws.min(),r)}vs(e,t,r,i){return this.gs.getDocumentsMatchingQuery(e,r,i).next(o=>(t.forEach(s=>{o=o.insert(s.key,s)}),o))}};var MI="LocalStore",MW=3e8,Lb=class{constructor(e,t,r,i){this.persistence=e,this.Cs=t,this.serializer=i,this.Fs=new pt(xe),this.Ms=new Bi(o=>EI(o),xI),this.xs=new Map,this.Os=e.getRemoteDocumentCache(),this.hi=e.getTargetCache(),this.Ti=e.getBundleCache(),this.Ns(r)}Ns(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Eb(this.Os,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Os.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.Fs))}};function PW(n,e,t,r){return new Lb(n,e,t,r)}function MR(n,e){return w(this,null,function*(){let t=ge(n);return yield t.persistence.runTransaction("Handle user change","readonly",r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next(o=>(i=o,t.Ns(e),t.mutationQueue.getAllMutationBatches(r))).next(o=>{let s=[],a=[],c=De();for(let u of i){s.push(u.batchId);for(let d of u.mutations)c=c.add(d.key)}for(let u of o){a.push(u.batchId);for(let d of u.mutations)c=c.add(d.key)}return t.localDocuments.getDocuments(r,c).next(u=>({Bs:u,removedBatchIds:s,addedBatchIds:a}))})})})}function AW(n,e){let t=ge(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{let i=e.batch.keys(),o=t.Os.newChangeBuffer({trackRemovals:!0});return function(a,c,u,d){let f=u.batch,v=f.keys(),_=$.resolve();return v.forEach(b=>{_=_.next(()=>d.getEntry(c,b)).next(N=>{let R=u.docVersions.get(b);$e(R!==null,48541),N.version.compareTo(R)<0&&(f.applyToRemoteDocument(N,u),N.isValidDocument()&&(N.setReadTime(u.commitVersion),d.addEntry(N)))})}),_.next(()=>a.mutationQueue.removeMutationBatch(c,f))}(t,r,e,o).next(()=>o.apply(r)).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let c=De();for(let u=0;u<a.mutationResults.length;++u)a.mutationResults[u].transformResults.length>0&&(c=c.add(a.batch.mutations[u].key));return c}(e))).next(()=>t.localDocuments.getDocuments(r,i))})}function PR(n){let e=ge(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.hi.getLastRemoteSnapshotVersion(t))}function OW(n,e){let t=ge(n),r=e.snapshotVersion,i=t.Fs;return t.persistence.runTransaction("Apply remote event","readwrite-primary",o=>{let s=t.Os.newChangeBuffer({trackRemovals:!0});i=t.Fs;let a=[];e.targetChanges.forEach((d,f)=>{let v=i.get(f);if(!v)return;a.push(t.hi.removeMatchingKeys(o,d.removedDocuments,f).next(()=>t.hi.addMatchingKeys(o,d.addedDocuments,f)));let _=v.withSequenceNumber(o.currentSequenceNumber);e.targetMismatches.get(f)!==null?_=_.withResumeToken(on.EMPTY_BYTE_STRING,we.min()).withLastLimboFreeSnapshotVersion(we.min()):d.resumeToken.approximateByteSize()>0&&(_=_.withResumeToken(d.resumeToken,r)),i=i.insert(f,_),function(N,R,G){return N.resumeToken.approximateByteSize()===0||R.snapshotVersion.toMicroseconds()-N.snapshotVersion.toMicroseconds()>=MW?!0:G.addedDocuments.size+G.modifiedDocuments.size+G.removedDocuments.size>0}(v,_,d)&&a.push(t.hi.updateTargetData(o,_))});let c=Ui(),u=De();if(e.documentUpdates.forEach(d=>{e.resolvedLimboDocuments.has(d)&&a.push(t.persistence.referenceDelegate.updateLimboDocument(o,d))}),a.push(NW(o,s,e.documentUpdates).next(d=>{c=d.Ls,u=d.ks})),!r.isEqual(we.min())){let d=t.hi.getLastRemoteSnapshotVersion(o).next(f=>t.hi.setTargetsMetadata(o,o.currentSequenceNumber,r));a.push(d)}return $.waitFor(a).next(()=>s.apply(o)).next(()=>t.localDocuments.getLocalViewOfDocuments(o,c,u)).next(()=>c)}).then(o=>(t.Fs=i,o))}function NW(n,e,t){let r=De(),i=De();return t.forEach(o=>r=r.add(o)),e.getEntries(n,r).next(o=>{let s=Ui();return t.forEach((a,c)=>{let u=o.get(a);c.isFoundDocument()!==u.isFoundDocument()&&(i=i.add(a)),c.isNoDocument()&&c.version.isEqual(we.min())?(e.removeEntry(a,c.readTime),s=s.insert(a,c)):!u.isValidDocument()||c.version.compareTo(u.version)>0||c.version.compareTo(u.version)===0&&u.hasPendingWrites?(e.addEntry(c),s=s.insert(a,c)):X(MI,"Ignoring outdated watch update for ",a,". Current version:",u.version," Watch version:",c.version)}),{Ls:s,ks:i}})}function RW(n,e){let t=ge(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=yI),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function kW(n,e){let t=ge(n);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return t.hi.getTargetData(r,e).next(o=>o?(i=o,$.resolve(i)):t.hi.allocateTargetId(r).next(s=>(i=new md(e,s,"TargetPurposeListen",r.currentSequenceNumber),t.hi.addTargetData(r,i).next(()=>i))))}).then(r=>{let i=t.Fs.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.Fs=t.Fs.insert(r.targetId,r),t.Ms.set(e,r.targetId)),r})}function Vb(n,e,t){return w(this,null,function*(){let r=ge(n),i=r.Fs.get(e),o=t?"readwrite":"readwrite-primary";try{t||(yield r.persistence.runTransaction("Release target",o,s=>r.persistence.referenceDelegate.removeTarget(s,i)))}catch(s){if(!Vc(s))throw s;X(MI,`Failed to update sequence numbers for target ${e}: ${s}`)}r.Fs=r.Fs.remove(e),r.Ms.delete(i.target)})}function fN(n,e,t){let r=ge(n),i=we.min(),o=De();return r.persistence.runTransaction("Execute query","readwrite",s=>function(c,u,d){let f=ge(c),v=f.Ms.get(d);return v!==void 0?$.resolve(f.Fs.get(v)):f.hi.getTargetData(u,d)}(r,s,si(e)).next(a=>{if(a)return i=a.lastLimboFreeSnapshotVersion,r.hi.getMatchingKeysForTargetId(s,a.targetId).next(c=>{o=c})}).next(()=>r.Cs.getDocumentsMatchingQuery(s,e,t?i:we.min(),t?o:De())).next(a=>(FW(r,Y9(e),a),{documents:a,qs:o})))}function FW(n,e,t){let r=n.xs.get(e)||we.min();t.forEach((i,o)=>{o.readTime.compareTo(r)>0&&(r=o.readTime)}),n.xs.set(e,r)}var zm=class{constructor(){this.activeTargetIds=tW()}Gs(e){this.activeTargetIds=this.activeTargetIds.add(e)}zs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}};var jb=class{constructor(){this.Fo=new zm,this.Mo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.Fo.Gs(e),this.Mo[e]||"not-current"}updateQueryState(e,t,r){this.Mo[e]=t}removeLocalQueryTarget(e){this.Fo.zs(e)}isLocalQueryTarget(e){return this.Fo.activeTargetIds.has(e)}clearQueryState(e){delete this.Mo[e]}getAllActiveQueryTargets(){return this.Fo.activeTargetIds}isActiveQueryTarget(e){return this.Fo.activeTargetIds.has(e)}start(){return this.Fo=new zm,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}};var Bb=class{xo(e){}shutdown(){}};var pN="ConnectivityMonitor",Hm=class{constructor(){this.Oo=()=>this.No(),this.Bo=()=>this.Lo(),this.ko=[],this.qo()}xo(e){this.ko.push(e)}shutdown(){window.removeEventListener("online",this.Oo),window.removeEventListener("offline",this.Bo)}qo(){window.addEventListener("online",this.Oo),window.addEventListener("offline",this.Bo)}No(){X(pN,"Network connectivity changed: AVAILABLE");for(let e of this.ko)e(0)}Lo(){X(pN,"Network connectivity changed: UNAVAILABLE");for(let e of this.ko)e(1)}static C(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}};var Im=null;function Ub(){return Im===null?Im=function(){return 268435456+Math.round(2147483648*Math.random())}():Im++,"0x"+Im.toString(16)}var PC="RestConnection",LW={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"},$b=class{get Qo(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;let t=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.$o=t+"://"+e.host,this.Uo=`projects/${r}/databases/${i}`,this.Ko=this.databaseId.database===Om?`project_id=${r}`:`project_id=${r}&database_id=${i}`}Wo(e,t,r,i,o){let s=Ub(),a=this.Go(e,t.toUriEncodedString());X(PC,`Sending RPC '${e}' ${s}:`,a,r);let c={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.Ko};this.zo(c,i,o);let{host:u}=new URL(a),d=yr(u);return this.jo(e,a,c,r,d).then(f=>(X(PC,`Received RPC '${e}' ${s}: `,f),f),f=>{throw Oo(PC,`RPC '${e}' ${s} failed with error: `,f,"url: ",a,"request:",r),f})}Jo(e,t,r,i,o,s){return this.Wo(e,t,r,i,o)}zo(e,t,r){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Fc}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((i,o)=>e[o]=i),r&&r.headers.forEach((i,o)=>e[o]=i)}Go(e,t){let r=LW[e];return`${this.$o}/v1/${t}:${r}`}terminate(){}};var zb=class{constructor(e){this.Ho=e.Ho,this.Yo=e.Yo}Zo(e){this.Xo=e}e_(e){this.t_=e}n_(e){this.r_=e}onMessage(e){this.i_=e}close(){this.Yo()}send(e){this.Ho(e)}s_(){this.Xo()}o_(){this.t_()}__(e){this.r_(e)}a_(e){this.i_(e)}};var rn="WebChannelConnection",Hb=class extends $b{constructor(e){super(e),this.u_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}jo(e,t,r,i,o){let s=Ub();return new Promise((a,c)=>{let u=new EC;u.setWithCredentials(!0),u.listenOnce(xC.COMPLETE,()=>{try{switch(u.getLastErrorCode()){case nd.NO_ERROR:let f=u.getResponseJson();X(rn,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(f)),a(f);break;case nd.TIMEOUT:X(rn,`RPC '${e}' ${s} timed out`),c(new Q(F.DEADLINE_EXCEEDED,"Request time out"));break;case nd.HTTP_ERROR:let v=u.getStatus();if(X(rn,`RPC '${e}' ${s} failed with status:`,v,"response text:",u.getResponseText()),v>0){let _=u.getResponseJson();Array.isArray(_)&&(_=_[0]);let b=_?.error;if(b&&b.status&&b.message){let N=function(G){let oe=G.toLowerCase().replace(/_/g,"-");return Object.values(F).indexOf(oe)>=0?oe:F.UNKNOWN}(b.status);c(new Q(N,b.message))}else c(new Q(F.UNKNOWN,"Server responded with status "+u.getStatus()))}else c(new Q(F.UNAVAILABLE,"Connection failed."));break;default:ue(9055,{c_:e,streamId:s,l_:u.getLastErrorCode(),h_:u.getLastError()})}}finally{X(rn,`RPC '${e}' ${s} completed.`)}});let d=JSON.stringify(i);X(rn,`RPC '${e}' ${s} sending request:`,i),u.send(t,"POST",d,r,15)})}P_(e,t,r){let i=Ub(),o=[this.$o,"/","google.firestore.v1.Firestore","/",e,"/channel"],s=DC(),a=TC(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;u!==void 0&&(c.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(c.useFetchStreams=!0),this.zo(c.initMessageHeaders,t,r),c.encodeInitMessageHeaders=!0;let d=o.join("");X(rn,`Creating RPC '${e}' stream ${i}: ${d}`,c);let f=s.createWebChannel(d,c);this.T_(f);let v=!1,_=!1,b=new zb({Ho:R=>{_?X(rn,`Not sending because RPC '${e}' stream ${i} is closed:`,R):(v||(X(rn,`Opening RPC '${e}' stream ${i} transport.`),f.open(),v=!0),X(rn,`RPC '${e}' stream ${i} sending:`,R),f.send(R))},Yo:()=>f.close()}),N=(R,G,oe)=>{R.listen(G,ce=>{try{oe(ce)}catch(Fe){setTimeout(()=>{throw Fe},0)}})};return N(f,gc.EventType.OPEN,()=>{_||(X(rn,`RPC '${e}' stream ${i} transport opened.`),b.s_())}),N(f,gc.EventType.CLOSE,()=>{_||(_=!0,X(rn,`RPC '${e}' stream ${i} transport closed`),b.__(),this.I_(f))}),N(f,gc.EventType.ERROR,R=>{_||(_=!0,Oo(rn,`RPC '${e}' stream ${i} transport errored. Name:`,R.name,"Message:",R.message),b.__(new Q(F.UNAVAILABLE,"The operation could not be completed")))}),N(f,gc.EventType.MESSAGE,R=>{var G;if(!_){let oe=R.data[0];$e(!!oe,16349);let ce=oe,Fe=ce?.error||((G=ce[0])===null||G===void 0?void 0:G.error);if(Fe){X(rn,`RPC '${e}' stream ${i} received error:`,Fe);let Dt=Fe.status,ze=function(S){let T=wt[S];if(T!==void 0)return wR(T)}(Dt),D=Fe.message;ze===void 0&&(ze=F.INTERNAL,D="Unknown error status: "+Dt+" with message "+Fe.message),_=!0,b.__(new Q(ze,D)),f.close()}else X(rn,`RPC '${e}' stream ${i} received:`,oe),b.a_(oe)}}),N(a,SC.STAT_EVENT,R=>{R.stat===wm.PROXY?X(rn,`RPC '${e}' stream ${i} detected buffering proxy`):R.stat===wm.NOPROXY&&X(rn,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{b.o_()},0),b}terminate(){this.u_.forEach(e=>e.close()),this.u_=[]}T_(e){this.u_.push(e)}I_(e){this.u_=this.u_.filter(t=>t===e)}};function AC(){return typeof document<"u"?document:null}function fg(n){return new db(n,!0)}var Wm=class{constructor(e,t,r=1e3,i=1.5,o=6e4){this.Fi=e,this.timerId=t,this.d_=r,this.E_=i,this.A_=o,this.R_=0,this.V_=null,this.m_=Date.now(),this.reset()}reset(){this.R_=0}f_(){this.R_=this.A_}g_(e){this.cancel();let t=Math.floor(this.R_+this.p_()),r=Math.max(0,Date.now()-this.m_),i=Math.max(0,t-r);i>0&&X("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.R_} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.V_=this.Fi.enqueueAfterDelay(this.timerId,i,()=>(this.m_=Date.now(),e())),this.R_*=this.E_,this.R_<this.d_&&(this.R_=this.d_),this.R_>this.A_&&(this.R_=this.A_)}y_(){this.V_!==null&&(this.V_.skipDelay(),this.V_=null)}cancel(){this.V_!==null&&(this.V_.cancel(),this.V_=null)}p_(){return(Math.random()-.5)*this.R_}};var mN="PersistentStream",qm=class{constructor(e,t,r,i,o,s,a,c){this.Fi=e,this.w_=r,this.S_=i,this.connection=o,this.authCredentialsProvider=s,this.appCheckCredentialsProvider=a,this.listener=c,this.state=0,this.b_=0,this.D_=null,this.v_=null,this.stream=null,this.C_=0,this.F_=new Wm(e,t)}M_(){return this.state===1||this.state===5||this.x_()}x_(){return this.state===2||this.state===3}start(){this.C_=0,this.state!==4?this.auth():this.O_()}stop(){return w(this,null,function*(){this.M_()&&(yield this.close(0))})}N_(){this.state=0,this.F_.reset()}B_(){this.x_()&&this.D_===null&&(this.D_=this.Fi.enqueueAfterDelay(this.w_,6e4,()=>this.L_()))}k_(e){this.q_(),this.stream.send(e)}L_(){return w(this,null,function*(){if(this.x_())return this.close(0)})}q_(){this.D_&&(this.D_.cancel(),this.D_=null)}Q_(){this.v_&&(this.v_.cancel(),this.v_=null)}close(e,t){return w(this,null,function*(){this.q_(),this.Q_(),this.F_.cancel(),this.b_++,e!==4?this.F_.reset():t&&t.code===F.RESOURCE_EXHAUSTED?(Li(t.toString()),Li("Using maximum backoff delay to prevent overloading the backend."),this.F_.f_()):t&&t.code===F.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.U_(),this.stream.close(),this.stream=null),this.state=e,yield this.listener.n_(t)})}U_(){}auth(){this.state=1;let e=this.K_(this.b_),t=this.b_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.b_===t&&this.W_(r,i)},r=>{e(()=>{let i=new Q(F.UNKNOWN,"Fetching auth token failed: "+r.message);return this.G_(i)})})}W_(e,t){let r=this.K_(this.b_);this.stream=this.z_(e,t),this.stream.Zo(()=>{r(()=>this.listener.Zo())}),this.stream.e_(()=>{r(()=>(this.state=2,this.v_=this.Fi.enqueueAfterDelay(this.S_,1e4,()=>(this.x_()&&(this.state=3),Promise.resolve())),this.listener.e_()))}),this.stream.n_(i=>{r(()=>this.G_(i))}),this.stream.onMessage(i=>{r(()=>++this.C_==1?this.j_(i):this.onNext(i))})}O_(){this.state=5,this.F_.g_(()=>w(this,null,function*(){this.state=0,this.start()}))}G_(e){return X(mN,`close with error: ${e}`),this.stream=null,this.close(4,e)}K_(e){return t=>{this.Fi.enqueueAndForget(()=>this.b_===e?t():(X(mN,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}},Wb=class extends qm{constructor(e,t,r,i,o,s){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,s),this.serializer=o}z_(e,t){return this.connection.P_("Listen",e,t)}j_(e){return this.onNext(e)}onNext(e){this.F_.reset();let t=mW(this.serializer,e),r=function(o){if(!("targetChange"in o))return we.min();let s=o.targetChange;return s.targetIds&&s.targetIds.length?we.min():s.readTime?ci(s.readTime):we.min()}(e);return this.listener.J_(t,r)}H_(e){let t={};t.database=mb(this.serializer),t.addTarget=function(o,s){let a,c=s.target;if(a=eb(c)?{documents:_W(o,c)}:{query:yW(o,c).Vt},a.targetId=s.targetId,s.resumeToken.approximateByteSize()>0){a.resumeToken=CR(o,s.resumeToken);let u=hb(o,s.expectedCount);u!==null&&(a.expectedCount=u)}else if(s.snapshotVersion.compareTo(we.min())>0){a.readTime=jm(o,s.snapshotVersion.toTimestamp());let u=hb(o,s.expectedCount);u!==null&&(a.expectedCount=u)}return a}(this.serializer,e);let r=CW(this.serializer,e);r&&(t.labels=r),this.k_(t)}Y_(e){let t={};t.database=mb(this.serializer),t.removeTarget=e,this.k_(t)}},qb=class extends qm{constructor(e,t,r,i,o,s){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,i,s),this.serializer=o}get Z_(){return this.C_>0}start(){this.lastStreamToken=void 0,super.start()}U_(){this.Z_&&this.X_([])}z_(e,t){return this.connection.P_("Write",e,t)}j_(e){return $e(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,$e(!e.writeResults||e.writeResults.length===0,55816),this.listener.ea()}onNext(e){$e(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.F_.reset();let t=vW(e.writeResults,e.commitTime),r=ci(e.commitTime);return this.listener.ta(r,t)}na(){let e={};e.database=mb(this.serializer),this.k_(e)}X_(e){let t={streamToken:this.lastStreamToken,writes:e.map(r=>gW(this.serializer,r))};this.k_(t)}};var Gb=class{},Kb=class extends Gb{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=i,this.ra=!1}ia(){if(this.ra)throw new Q(F.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,t,r,i){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,s])=>this.connection.Wo(e,fb(t,r),i,o,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===F.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new Q(F.UNKNOWN,o.toString())})}Jo(e,t,r,i,o){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,a])=>this.connection.Jo(e,fb(t,r),i,s,a,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===F.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new Q(F.UNKNOWN,s.toString())})}terminate(){this.ra=!0,this.connection.terminate()}},Yb=class{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.sa=0,this.oa=null,this._a=!0}aa(){this.sa===0&&(this.ua("Unknown"),this.oa=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.oa=null,this.ca("Backend didn't respond within 10 seconds."),this.ua("Offline"),Promise.resolve())))}la(e){this.state==="Online"?this.ua("Unknown"):(this.sa++,this.sa>=1&&(this.ha(),this.ca(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ua("Offline")))}set(e){this.ha(),this.sa=0,e==="Online"&&(this._a=!1),this.ua(e)}ua(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}ca(e){let t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this._a?(Li(t),this._a=!1):X("OnlineStateTracker",t)}ha(){this.oa!==null&&(this.oa.cancel(),this.oa=null)}};var Qs="RemoteStore",Qb=class{constructor(e,t,r,i,o){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.Pa=[],this.Ta=new Map,this.Ia=new Set,this.da=[],this.Ea=o,this.Ea.xo(s=>{r.enqueueAndForget(()=>w(this,null,function*(){Zs(this)&&(X(Qs,"Restarting streams for network reachability change."),yield function(c){return w(this,null,function*(){let u=ge(c);u.Ia.add(4),yield bd(u),u.Aa.set("Unknown"),u.Ia.delete(4),yield pg(u)})}(this))}))}),this.Aa=new Yb(r,i)}};function pg(n){return w(this,null,function*(){if(Zs(n))for(let e of n.da)yield e(!0)})}function bd(n){return w(this,null,function*(){for(let e of n.da)yield e(!1)})}function AR(n,e){let t=ge(n);t.Ta.has(e.targetId)||(t.Ta.set(e.targetId,e),NI(t)?OI(t):jc(t).x_()&&AI(t,e))}function PI(n,e){let t=ge(n),r=jc(t);t.Ta.delete(e),r.x_()&&OR(t,e),t.Ta.size===0&&(r.x_()?r.B_():Zs(t)&&t.Aa.set("Unknown"))}function AI(n,e){if(n.Ra.$e(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(we.min())>0){let t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}jc(n).H_(e)}function OR(n,e){n.Ra.$e(e),jc(n).Y_(e)}function OI(n){n.Ra=new ub({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),Et:e=>n.Ta.get(e)||null,lt:()=>n.datastore.serializer.databaseId}),jc(n).start(),n.Aa.aa()}function NI(n){return Zs(n)&&!jc(n).M_()&&n.Ta.size>0}function Zs(n){return ge(n).Ia.size===0}function NR(n){n.Ra=void 0}function VW(n){return w(this,null,function*(){n.Aa.set("Online")})}function jW(n){return w(this,null,function*(){n.Ta.forEach((e,t)=>{AI(n,e)})})}function BW(n,e){return w(this,null,function*(){NR(n),NI(n)?(n.Aa.la(e),OI(n)):n.Aa.set("Unknown")})}function UW(n,e,t){return w(this,null,function*(){if(n.Aa.set("Online"),e instanceof Lm&&e.state===2&&e.cause)try{yield function(i,o){return w(this,null,function*(){let s=o.cause;for(let a of o.targetIds)i.Ta.has(a)&&(yield i.remoteSyncer.rejectListen(a,s),i.Ta.delete(a),i.Ra.removeTarget(a))})}(n,e)}catch(r){X(Qs,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),yield Gm(n,r)}else if(e instanceof bc?n.Ra.Ye(e):e instanceof Fm?n.Ra.it(e):n.Ra.et(e),!t.isEqual(we.min()))try{let r=yield PR(n.localStore);t.compareTo(r)>=0&&(yield function(o,s){let a=o.Ra.Pt(s);return a.targetChanges.forEach((c,u)=>{if(c.resumeToken.approximateByteSize()>0){let d=o.Ta.get(u);d&&o.Ta.set(u,d.withResumeToken(c.resumeToken,s))}}),a.targetMismatches.forEach((c,u)=>{let d=o.Ta.get(c);if(!d)return;o.Ta.set(c,d.withResumeToken(on.EMPTY_BYTE_STRING,d.snapshotVersion)),OR(o,c);let f=new md(d.target,c,u,d.sequenceNumber);AI(o,f)}),o.remoteSyncer.applyRemoteEvent(a)}(n,t))}catch(r){X(Qs,"Failed to raise snapshot:",r),yield Gm(n,r)}})}function Gm(n,e,t){return w(this,null,function*(){if(!Vc(e))throw e;n.Ia.add(1),yield bd(n),n.Aa.set("Offline"),t||(t=()=>PR(n.localStore)),n.asyncQueue.enqueueRetryable(()=>w(null,null,function*(){X(Qs,"Retrying IndexedDB access"),yield t(),n.Ia.delete(1),yield pg(n)}))})}function RR(n,e){return e().catch(t=>Gm(n,t,e))}function mg(n){return w(this,null,function*(){let e=ge(n),t=ko(e),r=e.Pa.length>0?e.Pa[e.Pa.length-1].batchId:yI;for(;$W(e);)try{let i=yield RW(e.localStore,r);if(i===null){e.Pa.length===0&&t.B_();break}r=i.batchId,zW(e,i)}catch(i){yield Gm(e,i)}kR(e)&&FR(e)})}function $W(n){return Zs(n)&&n.Pa.length<10}function zW(n,e){n.Pa.push(e);let t=ko(n);t.x_()&&t.Z_&&t.X_(e.mutations)}function kR(n){return Zs(n)&&!ko(n).M_()&&n.Pa.length>0}function FR(n){ko(n).start()}function HW(n){return w(this,null,function*(){ko(n).na()})}function WW(n){return w(this,null,function*(){let e=ko(n);for(let t of n.Pa)e.X_(t.mutations)})}function qW(n,e,t){return w(this,null,function*(){let r=n.Pa.shift(),i=sb.from(r,e,t);yield RR(n,()=>n.remoteSyncer.applySuccessfulWrite(i)),yield mg(n)})}function GW(n,e){return w(this,null,function*(){e&&ko(n).Z_&&(yield function(r,i){return w(this,null,function*(){if(function(s){return cW(s)&&s!==F.ABORTED}(i.code)){let o=r.Pa.shift();ko(r).N_(),yield RR(r,()=>r.remoteSyncer.rejectFailedWrite(o.batchId,i)),yield mg(r)}})}(n,e)),kR(n)&&FR(n)})}function gN(n,e){return w(this,null,function*(){let t=ge(n);t.asyncQueue.verifyOperationInProgress(),X(Qs,"RemoteStore received new credentials");let r=Zs(t);t.Ia.add(3),yield bd(t),r&&t.Aa.set("Unknown"),yield t.remoteSyncer.handleCredentialChange(e),t.Ia.delete(3),yield pg(t)})}function KW(n,e){return w(this,null,function*(){let t=ge(n);e?(t.Ia.delete(2),yield pg(t)):e||(t.Ia.add(2),yield bd(t),t.Aa.set("Unknown"))})}function jc(n){return n.Va||(n.Va=function(t,r,i){let o=ge(t);return o.ia(),new Wb(r,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,i)}(n.datastore,n.asyncQueue,{Zo:VW.bind(null,n),e_:jW.bind(null,n),n_:BW.bind(null,n),J_:UW.bind(null,n)}),n.da.push(e=>w(null,null,function*(){e?(n.Va.N_(),NI(n)?OI(n):n.Aa.set("Unknown")):(yield n.Va.stop(),NR(n))}))),n.Va}function ko(n){return n.ma||(n.ma=function(t,r,i){let o=ge(t);return o.ia(),new qb(r,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,i)}(n.datastore,n.asyncQueue,{Zo:()=>Promise.resolve(),e_:HW.bind(null,n),n_:GW.bind(null,n),ea:WW.bind(null,n),ta:qW.bind(null,n)}),n.da.push(e=>w(null,null,function*(){e?(n.ma.N_(),yield mg(n)):(yield n.ma.stop(),n.Pa.length>0&&(X(Qs,`Stopping write stream with ${n.Pa.length} pending writes`),n.Pa=[]))}))),n.ma}var Zb=class n{constructor(e,t,r,i,o){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=o,this.deferred=new ii,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(s=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,i,o){let s=Date.now()+r,a=new n(e,t,s,i,o);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Q(F.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function RI(n,e){if(Li("AsyncQueue",`${e}: ${n}`),Vc(n))return new Q(F.UNAVAILABLE,`${e}: ${n}`);throw n}var Km=class n{static emptySet(e){return new n(e.comparator)}constructor(e){this.comparator=e?(t,r)=>e(t,r)||ae.comparator(t.key,r.key):(t,r)=>ae.comparator(t.key,r.key),this.keyedMap=rd(),this.sortedSet=new pt(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){let t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){let t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){let t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){let i=t.getNext().key,o=r.getNext().key;if(!i.isEqual(o))return!1}return!0}toString(){let e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){let r=new n;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}};var Ym=class{constructor(){this.fa=new pt(ae.comparator)}track(e){let t=e.doc.key,r=this.fa.get(t);r?e.type!==0&&r.type===3?this.fa=this.fa.insert(t,e):e.type===3&&r.type!==1?this.fa=this.fa.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.fa=this.fa.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.fa=this.fa.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.fa=this.fa.remove(t):e.type===1&&r.type===2?this.fa=this.fa.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.fa=this.fa.insert(t,{type:2,doc:e.doc}):ue(63341,{At:e,ga:r}):this.fa=this.fa.insert(t,e)}pa(){let e=[];return this.fa.inorderTraversal((t,r)=>{e.push(r)}),e}},Nc=class n{constructor(e,t,r,i,o,s,a,c,u){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=o,this.fromCache=s,this.syncStateChanged=a,this.excludesMetadataChanges=c,this.hasCachedResults=u}static fromInitialDocuments(e,t,r,i,o){let s=[];return t.forEach(a=>{s.push({type:0,doc:a})}),new n(e,t,Km.emptySet(t),s,r,i,!0,!1,o)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&dg(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;let t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}};var Jb=class{constructor(){this.ya=void 0,this.wa=[]}Sa(){return this.wa.some(e=>e.ba())}},Xb=class{constructor(){this.queries=vN(),this.onlineState="Unknown",this.Da=new Set}terminate(){(function(t,r){let i=ge(t),o=i.queries;i.queries=vN(),o.forEach((s,a)=>{for(let c of a.wa)c.onError(r)})})(this,new Q(F.ABORTED,"Firestore shutting down"))}};function vN(){return new Bi(n=>cR(n),dg)}function LR(n,e){return w(this,null,function*(){let t=ge(n),r=3,i=e.query,o=t.queries.get(i);o?!o.Sa()&&e.ba()&&(r=2):(o=new Jb,r=e.ba()?0:1);try{switch(r){case 0:o.ya=yield t.onListen(i,!0);break;case 1:o.ya=yield t.onListen(i,!1);break;case 2:yield t.onFirstRemoteStoreListen(i)}}catch(s){let a=RI(s,`Initialization of query '${_c(e.query)}' failed`);return void e.onError(a)}t.queries.set(i,o),o.wa.push(e),e.va(t.onlineState),o.ya&&e.Ca(o.ya)&&kI(t)})}function VR(n,e){return w(this,null,function*(){let t=ge(n),r=e.query,i=3,o=t.queries.get(r);if(o){let s=o.wa.indexOf(e);s>=0&&(o.wa.splice(s,1),o.wa.length===0?i=e.ba()?0:1:!o.Sa()&&e.ba()&&(i=2))}switch(i){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}})}function YW(n,e){let t=ge(n),r=!1;for(let i of e){let o=i.query,s=t.queries.get(o);if(s){for(let a of s.wa)a.Ca(i)&&(r=!0);s.ya=i}}r&&kI(t)}function QW(n,e,t){let r=ge(n),i=r.queries.get(e);if(i)for(let o of i.wa)o.onError(t);r.queries.delete(e)}function kI(n){n.Da.forEach(e=>{e.next()})}var eI,_N;(_N=eI||(eI={})).Fa="default",_N.Cache="cache";var Qm=class{constructor(e,t,r){this.query=e,this.Ma=t,this.xa=!1,this.Oa=null,this.onlineState="Unknown",this.options=r||{}}Ca(e){if(!this.options.includeMetadataChanges){let r=[];for(let i of e.docChanges)i.type!==3&&r.push(i);e=new Nc(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.xa?this.Na(e)&&(this.Ma.next(e),t=!0):this.Ba(e,this.onlineState)&&(this.La(e),t=!0),this.Oa=e,t}onError(e){this.Ma.error(e)}va(e){this.onlineState=e;let t=!1;return this.Oa&&!this.xa&&this.Ba(this.Oa,e)&&(this.La(this.Oa),t=!0),t}Ba(e,t){if(!e.fromCache||!this.ba())return!0;let r=t!=="Offline";return(!this.options.ka||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Na(e){if(e.docChanges.length>0)return!0;let t=this.Oa&&this.Oa.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}La(e){e=Nc.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.xa=!0,this.Ma.next(e)}ba(){return this.options.source!==eI.Cache}};var Zm=class{constructor(e){this.key=e}},Jm=class{constructor(e){this.key=e}},tI=class{constructor(e,t){this.query=e,this.Ha=t,this.Ya=null,this.hasCachedResults=!1,this.current=!1,this.Za=De(),this.mutatedKeys=De(),this.Xa=lR(e),this.eu=new Km(this.Xa)}get tu(){return this.Ha}nu(e,t){let r=t?t.ru:new Ym,i=t?t.eu:this.eu,o=t?t.mutatedKeys:this.mutatedKeys,s=i,a=!1,c=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,u=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((d,f)=>{let v=i.get(d),_=hg(this.query,f)?f:null,b=!!v&&this.mutatedKeys.has(v.key),N=!!_&&(_.hasLocalMutations||this.mutatedKeys.has(_.key)&&_.hasCommittedMutations),R=!1;v&&_?v.data.isEqual(_.data)?b!==N&&(r.track({type:3,doc:_}),R=!0):this.iu(v,_)||(r.track({type:2,doc:_}),R=!0,(c&&this.Xa(_,c)>0||u&&this.Xa(_,u)<0)&&(a=!0)):!v&&_?(r.track({type:0,doc:_}),R=!0):v&&!_&&(r.track({type:1,doc:v}),R=!0,(c||u)&&(a=!0)),R&&(_?(s=s.add(_),o=N?o.add(d):o.delete(d)):(s=s.delete(d),o=o.delete(d)))}),this.query.limit!==null)for(;s.size>this.query.limit;){let d=this.query.limitType==="F"?s.last():s.first();s=s.delete(d.key),o=o.delete(d.key),r.track({type:1,doc:d})}return{eu:s,ru:r,Ds:a,mutatedKeys:o}}iu(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,i){let o=this.eu;this.eu=e.eu,this.mutatedKeys=e.mutatedKeys;let s=e.ru.pa();s.sort((d,f)=>function(_,b){let N=R=>{switch(R){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ue(20277,{At:R})}};return N(_)-N(b)}(d.type,f.type)||this.Xa(d.doc,f.doc)),this.su(r),i=i!=null&&i;let a=t&&!i?this.ou():[],c=this.Za.size===0&&this.current&&!i?1:0,u=c!==this.Ya;return this.Ya=c,s.length!==0||u?{snapshot:new Nc(this.query,e.eu,o,s,e.mutatedKeys,c===0,u,!1,!!r&&r.resumeToken.approximateByteSize()>0),_u:a}:{_u:a}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({eu:this.eu,ru:new Ym,mutatedKeys:this.mutatedKeys,Ds:!1},!1)):{_u:[]}}au(e){return!this.Ha.has(e)&&!!this.eu.has(e)&&!this.eu.get(e).hasLocalMutations}su(e){e&&(e.addedDocuments.forEach(t=>this.Ha=this.Ha.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Ha=this.Ha.delete(t)),this.current=e.current)}ou(){if(!this.current)return[];let e=this.Za;this.Za=De(),this.eu.forEach(r=>{this.au(r.key)&&(this.Za=this.Za.add(r.key))});let t=[];return e.forEach(r=>{this.Za.has(r)||t.push(new Jm(r))}),this.Za.forEach(r=>{e.has(r)||t.push(new Zm(r))}),t}uu(e){this.Ha=e.qs,this.Za=De();let t=this.nu(e.documents);return this.applyChanges(t,!0)}cu(){return Nc.fromInitialDocuments(this.query,this.eu,this.mutatedKeys,this.Ya===0,this.hasCachedResults)}},FI="SyncEngine",nI=class{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}},rI=class{constructor(e){this.key=e,this.lu=!1}},iI=class{constructor(e,t,r,i,o,s){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=o,this.maxConcurrentLimboResolutions=s,this.hu={},this.Pu=new Bi(a=>cR(a),dg),this.Tu=new Map,this.Iu=new Set,this.du=new pt(ae.comparator),this.Eu=new Map,this.Au=new vd,this.Ru={},this.Vu=new Map,this.mu=gd.ur(),this.onlineState="Unknown",this.fu=void 0}get isPrimaryClient(){return this.fu===!0}};function ZW(n,e,t=!0){return w(this,null,function*(){let r=HR(n),i,o=r.Pu.get(e);return o?(r.sharedClientState.addLocalQueryTarget(o.targetId),i=o.view.cu()):i=yield jR(r,e,t,!0),i})}function JW(n,e){return w(this,null,function*(){let t=HR(n);yield jR(t,e,!0,!1)})}function jR(n,e,t,r){return w(this,null,function*(){let i=yield kW(n.localStore,si(e)),o=i.targetId,s=n.sharedClientState.addLocalQueryTarget(o,t),a;return r&&(a=yield XW(n,e,o,s==="current",i.resumeToken)),n.isPrimaryClient&&t&&AR(n.remoteStore,i),a})}function XW(n,e,t,r,i){return w(this,null,function*(){n.gu=(f,v,_)=>function(N,R,G,oe){return w(this,null,function*(){let ce=R.view.nu(G);ce.Ds&&(ce=yield fN(N.localStore,R.query,!1).then(({documents:D})=>R.view.nu(D,ce)));let Fe=oe&&oe.targetChanges.get(R.targetId),Dt=oe&&oe.targetMismatches.get(R.targetId)!=null,ze=R.view.applyChanges(ce,N.isPrimaryClient,Fe,Dt);return wN(N,R.targetId,ze._u),ze.snapshot})}(n,f,v,_);let o=yield fN(n.localStore,e,!0),s=new tI(e,o.qs),a=s.nu(o.documents),c=pd.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",i),u=s.applyChanges(a,n.isPrimaryClient,c);wN(n,t,u._u);let d=new nI(e,t,s);return n.Pu.set(e,d),n.Tu.has(t)?n.Tu.get(t).push(e):n.Tu.set(t,[e]),u.snapshot})}function e7(n,e,t){return w(this,null,function*(){let r=ge(n),i=r.Pu.get(e),o=r.Tu.get(i.targetId);if(o.length>1)return r.Tu.set(i.targetId,o.filter(s=>!dg(s,e))),void r.Pu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||(yield Vb(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),t&&PI(r.remoteStore,i.targetId),oI(r,i.targetId)}).catch(Lc))):(oI(r,i.targetId),yield Vb(r.localStore,i.targetId,!0))})}function t7(n,e){return w(this,null,function*(){let t=ge(n),r=t.Pu.get(e),i=t.Tu.get(r.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),PI(t.remoteStore,r.targetId))})}function n7(n,e,t){return w(this,null,function*(){let r=l7(n);try{let i=yield function(s,a){let c=ge(s),u=Et.now(),d=a.reduce((_,b)=>_.add(b.key),De()),f,v;return c.persistence.runTransaction("Locally write mutations","readwrite",_=>{let b=Ui(),N=De();return c.Os.getEntries(_,d).next(R=>{b=R,b.forEach((G,oe)=>{oe.isValidDocument()||(N=N.add(G))})}).next(()=>c.localDocuments.getOverlayedDocuments(_,b)).next(R=>{f=R;let G=[];for(let oe of a){let ce=aW(oe,f.get(oe.key).overlayedDocument);ce!=null&&G.push(new ui(oe.key,ce,tR(ce.value.mapValue),ai.exists(!0)))}return c.mutationQueue.addMutationBatch(_,u,G,a)}).next(R=>{v=R;let G=R.applyToLocalDocumentSet(f,N);return c.documentOverlayCache.saveOverlays(_,R.batchId,G)})}).then(()=>({batchId:v.batchId,changes:dR(f)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(s,a,c){let u=s.Ru[s.currentUser.toKey()];u||(u=new pt(xe)),u=u.insert(a,c),s.Ru[s.currentUser.toKey()]=u}(r,i.batchId,t),yield Id(r,i.changes),yield mg(r.remoteStore)}catch(i){let o=RI(i,"Failed to persist write");t.reject(o)}})}function BR(n,e){return w(this,null,function*(){let t=ge(n);try{let r=yield OW(t.localStore,e);e.targetChanges.forEach((i,o)=>{let s=t.Eu.get(o);s&&($e(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?s.lu=!0:i.modifiedDocuments.size>0?$e(s.lu,14607):i.removedDocuments.size>0&&($e(s.lu,42227),s.lu=!1))}),yield Id(t,r,e)}catch(r){yield Lc(r)}})}function yN(n,e,t){let r=ge(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){let i=[];r.Pu.forEach((o,s)=>{let a=s.view.va(e);a.snapshot&&i.push(a.snapshot)}),function(s,a){let c=ge(s);c.onlineState=a;let u=!1;c.queries.forEach((d,f)=>{for(let v of f.wa)v.va(a)&&(u=!0)}),u&&kI(c)}(r.eventManager,e),i.length&&r.hu.J_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function r7(n,e,t){return w(this,null,function*(){let r=ge(n);r.sharedClientState.updateQueryState(e,"rejected",t);let i=r.Eu.get(e),o=i&&i.key;if(o){let s=new pt(ae.comparator);s=s.insert(o,br.newNoDocument(o,we.min()));let a=De().add(o),c=new km(we.min(),new Map,new pt(xe),s,a);yield BR(r,c),r.du=r.du.remove(o),r.Eu.delete(e),LI(r)}else yield Vb(r.localStore,e,!1).then(()=>oI(r,e,t)).catch(Lc)})}function i7(n,e){return w(this,null,function*(){let t=ge(n),r=e.batch.batchId;try{let i=yield AW(t.localStore,e);$R(t,r,null),UR(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),yield Id(t,i)}catch(i){yield Lc(i)}})}function o7(n,e,t){return w(this,null,function*(){let r=ge(n);try{let i=yield function(s,a){let c=ge(s);return c.persistence.runTransaction("Reject batch","readwrite-primary",u=>{let d;return c.mutationQueue.lookupMutationBatch(u,a).next(f=>($e(f!==null,37113),d=f.keys(),c.mutationQueue.removeMutationBatch(u,f))).next(()=>c.mutationQueue.performConsistencyCheck(u)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(u,d,a)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(u,d)).next(()=>c.localDocuments.getDocuments(u,d))})}(r.localStore,e);$R(r,e,t),UR(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),yield Id(r,i)}catch(i){yield Lc(i)}})}function UR(n,e){(n.Vu.get(e)||[]).forEach(t=>{t.resolve()}),n.Vu.delete(e)}function $R(n,e,t){let r=ge(n),i=r.Ru[r.currentUser.toKey()];if(i){let o=i.get(e);o&&(t?o.reject(t):o.resolve(),i=i.remove(e)),r.Ru[r.currentUser.toKey()]=i}}function oI(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(let r of n.Tu.get(e))n.Pu.delete(r),t&&n.hu.pu(r,t);n.Tu.delete(e),n.isPrimaryClient&&n.Au.zr(e).forEach(r=>{n.Au.containsKey(r)||zR(n,r)})}function zR(n,e){n.Iu.delete(e.path.canonicalString());let t=n.du.get(e);t!==null&&(PI(n.remoteStore,t),n.du=n.du.remove(e),n.Eu.delete(t),LI(n))}function wN(n,e,t){for(let r of t)r instanceof Zm?(n.Au.addReference(r.key,e),s7(n,r)):r instanceof Jm?(X(FI,"Document no longer in limbo: "+r.key),n.Au.removeReference(r.key,e),n.Au.containsKey(r.key)||zR(n,r.key)):ue(19791,{yu:r})}function s7(n,e){let t=e.key,r=t.path.canonicalString();n.du.get(t)||n.Iu.has(r)||(X(FI,"New document in limbo: "+t),n.Iu.add(r),LI(n))}function LI(n){for(;n.Iu.size>0&&n.du.size<n.maxConcurrentLimboResolutions;){let e=n.Iu.values().next().value;n.Iu.delete(e);let t=new ae(at.fromString(e)),r=n.mu.next();n.Eu.set(r,new rI(t)),n.du=n.du.insert(t,r),AR(n.remoteStore,new md(si(SI(t.path)),r,"TargetPurposeLimboResolution",_I.ue))}}function Id(n,e,t){return w(this,null,function*(){let r=ge(n),i=[],o=[],s=[];r.Pu.isEmpty()||(r.Pu.forEach((a,c)=>{s.push(r.gu(c,e,t).then(u=>{var d;if((u||t)&&r.isPrimaryClient){let f=u?!u.fromCache:(d=t?.targetChanges.get(c.targetId))===null||d===void 0?void 0:d.current;r.sharedClientState.updateQueryState(c.targetId,f?"current":"not-current")}if(u){i.push(u);let f=Rb.Es(c.targetId,u);o.push(f)}}))}),yield Promise.all(s),r.hu.J_(i),yield function(c,u){return w(this,null,function*(){let d=ge(c);try{yield d.persistence.runTransaction("notifyLocalViewChanges","readwrite",f=>$.forEach(u,v=>$.forEach(v.Is,_=>d.persistence.referenceDelegate.addReference(f,v.targetId,_)).next(()=>$.forEach(v.ds,_=>d.persistence.referenceDelegate.removeReference(f,v.targetId,_)))))}catch(f){if(!Vc(f))throw f;X(MI,"Failed to update sequence numbers: "+f)}for(let f of u){let v=f.targetId;if(!f.fromCache){let _=d.Fs.get(v),b=_.snapshotVersion,N=_.withLastLimboFreeSnapshotVersion(b);d.Fs=d.Fs.insert(v,N)}}})}(r.localStore,o))})}function a7(n,e){return w(this,null,function*(){let t=ge(n);if(!t.currentUser.isEqual(e)){X(FI,"User change. New user:",e.toKey());let r=yield MR(t.localStore,e);t.currentUser=e,function(o,s){o.Vu.forEach(a=>{a.forEach(c=>{c.reject(new Q(F.CANCELLED,s))})}),o.Vu.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),yield Id(t,r.Bs)}})}function c7(n,e){let t=ge(n),r=t.Eu.get(e);if(r&&r.lu)return De().add(r.key);{let i=De(),o=t.Tu.get(e);if(!o)return i;for(let s of o){let a=t.Pu.get(s);i=i.unionWith(a.view.tu)}return i}}function HR(n){let e=ge(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=BR.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=c7.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=r7.bind(null,e),e.hu.J_=YW.bind(null,e.eventManager),e.hu.pu=QW.bind(null,e.eventManager),e}function l7(n){let e=ge(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=i7.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=o7.bind(null,e),e}var WR=(()=>{class n{constructor(){this.kind="memory",this.synchronizeTabs=!1}initialize(t){return w(this,null,function*(){this.serializer=fg(t.databaseInfo.databaseId),this.sharedClientState=this.bu(t),this.persistence=this.Du(t),yield this.persistence.start(),this.localStore=this.vu(t),this.gcScheduler=this.Cu(t,this.localStore),this.indexBackfillerScheduler=this.Fu(t,this.localStore)})}Cu(t,r){return null}Fu(t,r){return null}vu(t){return PW(this.persistence,new Fb,t.initialUser,this.serializer)}Du(t){return new Um(Nb.Vi,this.serializer)}bu(t){return new jb}terminate(){return w(this,null,function*(){var t,r;(t=this.gcScheduler)===null||t===void 0||t.stop(),(r=this.indexBackfillerScheduler)===null||r===void 0||r.stop(),this.sharedClientState.shutdown(),yield this.persistence.shutdown()})}}return n.provider={build:()=>new n},n})(),sI=class extends WR{constructor(e){super(),this.cacheSizeBytes=e}Cu(e,t){$e(this.persistence.referenceDelegate instanceof $m,46915);let r=this.persistence.referenceDelegate.garbageCollector;return new wb(r,e.asyncQueue,t)}Du(e){let t=this.cacheSizeBytes!==void 0?Jn.withCacheSize(this.cacheSizeBytes):Jn.DEFAULT;return new Um(r=>$m.Vi(r,t),this.serializer)}};var u7=(()=>{class n{initialize(t,r){return w(this,null,function*(){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>yN(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=a7.bind(null,this.syncEngine),yield KW(this.remoteStore,this.syncEngine.isPrimaryClient))})}createEventManager(t){return function(){return new Xb}()}createDatastore(t){let r=fg(t.databaseInfo.databaseId),i=function(s){return new Hb(s)}(t.databaseInfo);return function(s,a,c,u){return new Kb(s,a,c,u)}(t.authCredentials,t.appCheckCredentials,i,r)}createRemoteStore(t){return function(i,o,s,a,c){return new Qb(i,o,s,a,c)}(this.localStore,this.datastore,t.asyncQueue,r=>yN(this.syncEngine,r,0),function(){return Hm.C()?new Hm:new Bb}())}createSyncEngine(t,r){return function(o,s,a,c,u,d,f){let v=new iI(o,s,a,c,u,d);return f&&(v.fu=!0),v}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,r)}terminate(){return w(this,null,function*(){var t,r;yield function(o){return w(this,null,function*(){let s=ge(o);X(Qs,"RemoteStore shutting down."),s.Ia.add(5),yield bd(s),s.Ea.shutdown(),s.Aa.set("Unknown")})}(this.remoteStore),(t=this.datastore)===null||t===void 0||t.terminate(),(r=this.eventManager)===null||r===void 0||r.terminate()})}}return n.provider={build:()=>new n},n})();var Xm=class{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.xu(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.xu(this.observer.error,e):Li("Uncaught Error in snapshot listener:",e.toString()))}Ou(){this.muted=!0}xu(e,t){setTimeout(()=>{this.muted||e(t)},0)}};var Fo="FirestoreClient",aI=class{constructor(e,t,r,i,o){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=i,this.user=kt.UNAUTHENTICATED,this.clientId=cd.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=o,this.authCredentials.start(r,s=>w(this,null,function*(){X(Fo,"Received user=",s.uid),yield this.authCredentialListener(s),this.user=s})),this.appCheckCredentials.start(r,s=>(X(Fo,"Received new app check token=",s),this.appCheckCredentialListener(s,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();let e=new ii;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(()=>w(this,null,function*(){try{this._onlineComponents&&(yield this._onlineComponents.terminate()),this._offlineComponents&&(yield this._offlineComponents.terminate()),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){let r=RI(t,"Failed to shutdown persistence");e.reject(r)}})),e.promise}};function OC(n,e){return w(this,null,function*(){n.asyncQueue.verifyOperationInProgress(),X(Fo,"Initializing OfflineComponentProvider");let t=n.configuration;yield e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(i=>w(null,null,function*(){r.isEqual(i)||(yield MR(e.localStore,i),r=i)})),e.persistence.setDatabaseDeletedListener(()=>{Oo("Terminating Firestore due to IndexedDb database deletion"),n.terminate().then(()=>{X("Terminating Firestore due to IndexedDb database deletion completed successfully")}).catch(i=>{Oo("Terminating Firestore due to IndexedDb database deletion failed",i)})}),n._offlineComponents=e})}function CN(n,e){return w(this,null,function*(){n.asyncQueue.verifyOperationInProgress();let t=yield d7(n);X(Fo,"Initializing OnlineComponentProvider"),yield e.initialize(t,n.configuration),n.setCredentialChangeListener(r=>gN(e.remoteStore,r)),n.setAppCheckTokenChangeListener((r,i)=>gN(e.remoteStore,i)),n._onlineComponents=e})}function d7(n){return w(this,null,function*(){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){X(Fo,"Using user provided OfflineComponentProvider");try{yield OC(n,n._uninitializedComponentsProvider._offline)}catch(e){let t=e;if(!function(i){return i.name==="FirebaseError"?i.code===F.FAILED_PRECONDITION||i.code===F.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(t))throw t;Oo("Error using user provided cache. Falling back to memory cache: "+t),yield OC(n,new WR)}}else X(Fo,"Using default OfflineComponentProvider"),yield OC(n,new sI(void 0));return n._offlineComponents})}function qR(n){return w(this,null,function*(){return n._onlineComponents||(n._uninitializedComponentsProvider?(X(Fo,"Using user provided OnlineComponentProvider"),yield CN(n,n._uninitializedComponentsProvider._online)):(X(Fo,"Using default OnlineComponentProvider"),yield CN(n,new u7))),n._onlineComponents})}function h7(n){return qR(n).then(e=>e.syncEngine)}function cI(n){return w(this,null,function*(){let e=yield qR(n),t=e.eventManager;return t.onListen=ZW.bind(null,e.syncEngine),t.onUnlisten=e7.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=JW.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=t7.bind(null,e.syncEngine),t})}function f7(n,e,t={}){let r=new ii;return n.asyncQueue.enqueueAndForget(()=>w(null,null,function*(){return function(o,s,a,c,u){let d=new Xm({next:v=>{d.Ou(),s.enqueueAndForget(()=>VR(o,f)),v.fromCache&&c.source==="server"?u.reject(new Q(F.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):u.resolve(v)},error:v=>u.reject(v)}),f=new Qm(a,d,{includeMetadataChanges:!0,ka:!0});return LR(o,f)}(yield cI(n),n.asyncQueue,e,t,r)})),r.promise}function GR(n){let e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}var bN=new Map;var KR="firestore.googleapis.com",IN=!0,eg=class{constructor(e){var t,r;if(e.host===void 0){if(e.ssl!==void 0)throw new Q(F.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=KR,this.ssl=IN}else this.host=e.host,this.ssl=(t=e.ssl)!==null&&t!==void 0?t:IN;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=DR;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<TW)throw new Q(F.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}x9("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=GR((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(o){if(o.timeoutSeconds!==void 0){if(isNaN(o.timeoutSeconds))throw new Q(F.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (must not be NaN)`);if(o.timeoutSeconds<5)throw new Q(F.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (minimum allowed value is 5)`);if(o.timeoutSeconds>30)throw new Q(F.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}},Rc=class{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new eg({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Q(F.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Q(F.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new eg(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new NC;switch(r.type){case"firstParty":return new LC(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new Q(F.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}_restart(){return w(this,null,function*(){this._terminateTask==="notTerminated"?yield this._terminate():this._terminateTask="notTerminated"})}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){let r=bN.get(t);r&&(X("ComponentProvider","Removing Datastore"),bN.delete(t),r.terminate())}(this),Promise.resolve()}};function YR(n,e,t,r={}){var i;n=er(n,Rc);let o=yr(e),s=n._getSettings(),a=Object.assign(Object.assign({},s),{emulatorOptions:n._getEmulatorOptions()}),c=`${e}:${t}`;o&&(uc(`https://${c}`),dc("Firestore",!0)),s.host!==KR&&s.host!==c&&Oo("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");let u=Object.assign(Object.assign({},s),{host:c,ssl:o,emulatorOptions:r});if(!Qn(u,a)&&(n._setSettings(u),r.mockUserToken)){let d,f;if(typeof r.mockUserToken=="string")d=r.mockUserToken,f=kt.MOCK_USER;else{d=qp(r.mockUserToken,(i=n._app)===null||i===void 0?void 0:i.options.projectId);let v=r.mockUserToken.sub||r.mockUserToken.user_id;if(!v)throw new Q(F.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");f=new kt(v)}n._authCredentials=new RC(new Tm(d,f))}}var Lo=class n{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new n(this.firestore,e,this._query)}},Lt=class n{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Do(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new n(this.firestore,e,this._key)}toJSON(){return{type:n._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,r){if(Cd(t,n._jsonSchema))return new n(e,r||null,new ae(at.fromString(t.referencePath)))}};Lt._jsonSchemaVersion="firestore/documentReference/1.0",Lt._jsonSchema={type:It("string",Lt._jsonSchemaVersion),referencePath:It("string")};var Do=class n extends Lo{constructor(e,t,r){super(e,t,SI(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new Lt(this.firestore,null,new ae(e))}withConverter(e){return new n(this.firestore,e,this._path)}};function QR(n,e,...t){if(n=lt(n),AN("collection","path",e),n instanceof Rc){let r=at.fromString(e,...t);return UO(r),new Do(n,null,r)}{if(!(n instanceof Lt||n instanceof Do))throw new Q(F.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(at.fromString(e,...t));return UO(r),new Do(n.firestore,null,r)}}function VI(n,e,...t){if(n=lt(n),arguments.length===1&&(e=cd.newId()),AN("doc","path",e),n instanceof Rc){let r=at.fromString(e,...t);return BO(r),new Lt(n,null,new ae(r))}{if(!(n instanceof Lt||n instanceof Do))throw new Q(F.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(at.fromString(e,...t));return BO(r),new Lt(n.firestore,n instanceof Do?n.converter:null,new ae(r))}}var EN="AsyncQueue",tg=class{constructor(e=Promise.resolve()){this.Zu=[],this.Xu=!1,this.ec=[],this.tc=null,this.nc=!1,this.rc=!1,this.sc=[],this.F_=new Wm(this,"async_queue_retry"),this.oc=()=>{let r=AC();r&&X(EN,"Visibility state changed to "+r.visibilityState),this.F_.y_()},this._c=e;let t=AC();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.oc)}get isShuttingDown(){return this.Xu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.ac(),this.uc(e)}enterRestrictedMode(e){if(!this.Xu){this.Xu=!0,this.rc=e||!1;let t=AC();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.oc)}}enqueue(e){if(this.ac(),this.Xu)return new Promise(()=>{});let t=new ii;return this.uc(()=>this.Xu&&this.rc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Zu.push(e),this.cc()))}cc(){return w(this,null,function*(){if(this.Zu.length!==0){try{yield this.Zu[0](),this.Zu.shift(),this.F_.reset()}catch(e){if(!Vc(e))throw e;X(EN,"Operation failed with retryable error: "+e)}this.Zu.length>0&&this.F_.g_(()=>this.cc())}})}uc(e){let t=this._c.then(()=>(this.nc=!0,e().catch(r=>{throw this.tc=r,this.nc=!1,Li("INTERNAL UNHANDLED ERROR: ",xN(r)),r}).then(r=>(this.nc=!1,r))));return this._c=t,t}enqueueAfterDelay(e,t,r){this.ac(),this.sc.indexOf(e)>-1&&(t=0);let i=Zb.createAndSchedule(this,e,t,r,o=>this.lc(o));return this.ec.push(i),i}ac(){this.tc&&ue(47125,{hc:xN(this.tc)})}verifyOperationInProgress(){}Pc(){return w(this,null,function*(){let e;do e=this._c,yield e;while(e!==this._c)})}Tc(e){for(let t of this.ec)if(t.timerId===e)return!0;return!1}Ic(e){return this.Pc().then(()=>{this.ec.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(let t of this.ec)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Pc()})}dc(e){this.sc.push(e)}lc(e){let t=this.ec.indexOf(e);this.ec.splice(t,1)}};function xN(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}function SN(n){return function(t,r){if(typeof t!="object"||t===null)return!1;let i=t;for(let o of r)if(o in i&&typeof i[o]=="function")return!0;return!1}(n,["next","error","complete"])}var di=class extends Rc{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=new tg,this._persistenceKey=i?.name||"[DEFAULT]"}_terminate(){return w(this,null,function*(){if(this._firestoreClient){let e=this._firestoreClient.terminate();this._queue=new tg(e),this._firestoreClient=void 0,yield e}})}};function ZR(n,e){let t=typeof n=="object"?n:Ai(),r=typeof n=="string"?n:e||Om,i=yo(t,"firestore").getImmediate({identifier:r});if(!i._initialized){let o=Wp("firestore");o&&YR(i,...o)}return i}function jI(n){if(n._terminated)throw new Q(F.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||p7(n),n._firestoreClient}function p7(n){var e,t,r;let i=n._freezeSettings(),o=function(a,c,u,d){return new $C(a,c,u,d.host,d.ssl,d.experimentalForceLongPolling,d.experimentalAutoDetectLongPolling,GR(d.experimentalLongPollingOptions),d.useFetchStreams,d.isUsingEmulator)}(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,i);n._componentsProvider||!((t=i.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(n._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),n._firestoreClient=new aI(n._authCredentials,n._appCheckCredentials,n._queue,o,n._componentsProvider&&function(a){let c=a?._online.build();return{_offline:a?._offline.build(c),_online:c}}(n._componentsProvider))}var Mo=class n{constructor(e){this._byteString=e}static fromBase64String(e){try{return new n(on.fromBase64String(e))}catch(t){throw new Q(F.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new n(on.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:n._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Cd(e,n._jsonSchema))return n.fromBase64String(e.bytes)}};Mo._jsonSchemaVersion="firestore/bytes/1.0",Mo._jsonSchema={type:It("string",Mo._jsonSchemaVersion),bytes:It("string")};var kc=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new Q(F.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new $n(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};var _d=class{constructor(e){this._methodName=e}};var Po=class n{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Q(F.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Q(F.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return xe(this._lat,e._lat)||xe(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:n._jsonSchemaVersion}}static fromJSON(e){if(Cd(e,n._jsonSchema))return new n(e.latitude,e.longitude)}};Po._jsonSchemaVersion="firestore/geoPoint/1.0",Po._jsonSchema={type:It("string",Po._jsonSchemaVersion),latitude:It("number"),longitude:It("number")};var Ao=class n{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,i){if(r.length!==i.length)return!1;for(let o=0;o<r.length;++o)if(r[o]!==i[o])return!1;return!0}(this._values,e._values)}toJSON(){return{type:n._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Cd(e,n._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(t=>typeof t=="number"))return new n(e.vectorValues);throw new Q(F.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}};Ao._jsonSchemaVersion="firestore/vectorValue/1.0",Ao._jsonSchema={type:It("string",Ao._jsonSchemaVersion),vectorValues:It("object")};var m7=/^__.*__$/,lI=class{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new ui(e,this.data,this.fieldMask,t,this.fieldTransforms):new Ys(e,this.data,t,this.fieldTransforms)}},ng=class{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new ui(e,this.data,this.fieldMask,t,this.fieldTransforms)}};function JR(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ue(40011,{Ec:n})}}var uI=class n{constructor(e,t,r,i,o,s){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=i,o===void 0&&this.Ac(),this.fieldTransforms=o||[],this.fieldMask=s||[]}get path(){return this.settings.path}get Ec(){return this.settings.Ec}Rc(e){return new n(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Vc(e){var t;let r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.Rc({path:r,mc:!1});return i.fc(e),i}gc(e){var t;let r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.Rc({path:r,mc:!1});return i.Ac(),i}yc(e){return this.Rc({path:void 0,mc:!0})}wc(e){return ig(e,this.settings.methodName,this.settings.Sc||!1,this.path,this.settings.bc)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}Ac(){if(this.path)for(let e=0;e<this.path.length;e++)this.fc(this.path.get(e))}fc(e){if(e.length===0)throw this.wc("Document fields must not be empty");if(JR(this.Ec)&&m7.test(e))throw this.wc('Document fields cannot begin and end with "__"')}},dI=class{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||fg(e)}Dc(e,t,r,i=!1){return new uI({Ec:e,methodName:t,bc:r,path:$n.emptyPath(),mc:!1,Sc:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}};function gg(n){let e=n._freezeSettings(),t=fg(n._databaseId);return new dI(n._databaseId,!!e.ignoreUndefinedProperties,t)}function XR(n,e,t,r,i,o={}){let s=n.Dc(o.merge||o.mergeFields?2:0,e,t,i);BI("Data must be an object, but it was:",s,r);let a=ek(r,s),c,u;if(o.merge)c=new Xn(s.fieldMask),u=s.fieldTransforms;else if(o.mergeFields){let d=[];for(let f of o.mergeFields){let v=hI(e,f,t);if(!s.contains(v))throw new Q(F.INVALID_ARGUMENT,`Field '${v}' is specified in your field mask but missing from your input data.`);nk(d,v)||d.push(v)}c=new Xn(d),u=s.fieldTransforms.filter(f=>c.covers(f.field))}else c=null,u=s.fieldTransforms;return new lI(new Un(a),c,u)}var rg=class n extends _d{_toFieldTransform(e){if(e.Ec!==2)throw e.Ec===1?e.wc(`${this._methodName}() can only appear at the top level of your update data`):e.wc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof n}};function g7(n,e,t,r){let i=n.Dc(1,e,t);BI("Data must be an object, but it was:",i,r);let o=[],s=Un.empty();Vo(r,(c,u)=>{let d=UI(e,c,t);u=lt(u);let f=i.gc(d);if(u instanceof rg)o.push(d);else{let v=Ed(u,f);v!=null&&(o.push(d),s.set(d,v))}});let a=new Xn(o);return new ng(s,a,i.fieldTransforms)}function v7(n,e,t,r,i,o){let s=n.Dc(1,e,t),a=[hI(e,r,t)],c=[i];if(o.length%2!=0)throw new Q(F.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let v=0;v<o.length;v+=2)a.push(hI(e,o[v])),c.push(o[v+1]);let u=[],d=Un.empty();for(let v=a.length-1;v>=0;--v)if(!nk(u,a[v])){let _=a[v],b=c[v];b=lt(b);let N=s.gc(_);if(b instanceof rg)u.push(_);else{let R=Ed(b,N);R!=null&&(u.push(_),d.set(_,R))}}let f=new Xn(u);return new ng(d,f,s.fieldTransforms)}function _7(n,e,t,r=!1){return Ed(t,n.Dc(r?4:3,e))}function Ed(n,e){if(tk(n=lt(n)))return BI("Unsupported field value:",e,n),ek(n,e);if(n instanceof _d)return function(r,i){if(!JR(i.Ec))throw i.wc(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.wc(`${r._methodName}() is not currently supported inside arrays`);let o=r._toFieldTransform(i);o&&i.fieldTransforms.push(o)}(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.mc&&e.Ec!==4)throw e.wc("Nested arrays are not supported");return function(r,i){let o=[],s=0;for(let a of r){let c=Ed(a,i.yc(s));c==null&&(c={nullValue:"NULL_VALUE"}),o.push(c),s++}return{arrayValue:{values:o}}}(n,e)}return function(r,i){if((r=lt(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return nW(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){let o=Et.fromDate(r);return{timestampValue:jm(i.serializer,o)}}if(r instanceof Et){let o=new Et(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:jm(i.serializer,o)}}if(r instanceof Po)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Mo)return{bytesValue:CR(i.serializer,r._byteString)};if(r instanceof Lt){let o=i.databaseId,s=r.firestore._databaseId;if(!s.isEqual(o))throw i.wc(`Document reference is for database ${s.projectId}/${s.database} but should be for database ${o.projectId}/${o.database}`);return{referenceValue:DI(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof Ao)return function(s,a){return{mapValue:{fields:{[CI]:{stringValue:bI},[xc]:{arrayValue:{values:s.toArray().map(u=>{if(typeof u!="number")throw a.wc("VectorValues must only contain numeric values.");return TI(a.serializer,u)})}}}}}}(r,i);throw i.wc(`Unsupported field value: ${cg(r)}`)}(n,e)}function ek(n,e){let t={};return GN(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Vo(n,(r,i)=>{let o=Ed(i,e.Vc(r));o!=null&&(t[r]=o)}),{mapValue:{fields:t}}}function tk(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof Et||n instanceof Po||n instanceof Mo||n instanceof Lt||n instanceof _d||n instanceof Ao)}function BI(n,e,t){if(!tk(t)||!ON(t)){let r=cg(t);throw r==="an object"?e.wc(n+" a custom object"):e.wc(n+" "+r)}}function hI(n,e,t){if((e=lt(e))instanceof kc)return e._internalPath;if(typeof e=="string")return UI(n,e);throw ig("Field path arguments must be of type string or ",n,!1,void 0,t)}var y7=new RegExp("[~\\*/\\[\\]]");function UI(n,e,t){if(e.search(y7)>=0)throw ig(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new kc(...e.split("."))._internalPath}catch{throw ig(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function ig(n,e,t,r,i){let o=r&&!r.isEmpty(),s=i!==void 0,a=`Function ${e}() called with invalid data`;t&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(o||s)&&(c+=" (found",o&&(c+=` in field ${r}`),s&&(c+=` in document ${i}`),c+=")"),new Q(F.INVALID_ARGUMENT,a+n+c)}function nk(n,e){return n.some(t=>t.isEqual(e))}var og=class{constructor(e,t,r,i,o){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=o}get id(){return this._key.path.lastSegment()}get ref(){return new Lt(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){let e=new fI(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){let t=this._document.data.field(vg("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}},fI=class extends og{data(){return super.data()}};function vg(n,e){return typeof e=="string"?UI(n,e):e instanceof kc?e._internalPath:e._delegate._internalPath}function rk(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new Q(F.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var yd=class{},sg=class extends yd{};function ik(n,e,...t){let r=[];e instanceof yd&&r.push(e),r=r.concat(t),function(o){let s=o.filter(c=>c instanceof pI).length,a=o.filter(c=>c instanceof ag).length;if(s>1||s>0&&a>0)throw new Q(F.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(let i of r)n=i._apply(n);return n}var ag=class n extends sg{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new n(e,t,r)}_apply(e){let t=this._parse(e);return ak(e._query,t),new Lo(e.firestore,e.converter,tb(e._query,t))}_parse(e){let t=gg(e.firestore);return function(o,s,a,c,u,d,f){let v;if(u.isKeyField()){if(d==="array-contains"||d==="array-contains-any")throw new Q(F.INVALID_ARGUMENT,`Invalid Query. You can't perform '${d}' queries on documentId().`);if(d==="in"||d==="not-in"){DN(f,d);let b=[];for(let N of f)b.push(TN(c,o,N));v={arrayValue:{values:b}}}else v=TN(c,o,f)}else d!=="in"&&d!=="not-in"&&d!=="array-contains-any"||DN(f,d),v=_7(a,s,f,d==="in"||d==="not-in");return bt.create(u,d,v)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}};function ok(n,e,t){let r=e,i=vg("where",n);return ag._create(i,r,t)}var pI=class n extends yd{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new n(e,t)}_parse(e){let t=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return t.length===1?t[0]:Ir.create(t,this._getOperator())}_apply(e){let t=this._parse(e);return t.getFilters().length===0?e:(function(i,o){let s=i,a=o.getFlattenedFilters();for(let c of a)ak(s,c),s=tb(s,c)}(e._query,t),new Lo(e.firestore,e.converter,tb(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}};var mI=class n extends sg{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new n(e,t)}_apply(e){let t=function(i,o,s){if(i.startAt!==null)throw new Q(F.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new Q(F.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new qs(o,s)}(e._query,this._field,this._direction);return new Lo(e.firestore,e.converter,function(i,o){let s=i.explicitOrderBy.concat([o]);return new Ro(i.path,i.collectionGroup,s,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,t))}};function sk(n,e="asc"){let t=e,r=vg("orderBy",n);return mI._create(r,t)}function TN(n,e,t){if(typeof(t=lt(t))=="string"){if(t==="")throw new Q(F.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!aR(e)&&t.indexOf("/")!==-1)throw new Q(F.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);let r=e.path.child(at.fromString(t));if(!ae.isDocumentKey(r))throw new Q(F.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return KO(n,new ae(r))}if(t instanceof Lt)return KO(n,t._key);throw new Q(F.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${cg(t)}.`)}function DN(n,e){if(!Array.isArray(n)||n.length===0)throw new Q(F.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function ak(n,e){let t=function(i,o){for(let s of i)for(let a of s.getFlattenedFilters())if(o.indexOf(a.op)>=0)return a.op;return null}(n.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new Q(F.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new Q(F.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}var gI=class{convertValue(e,t="none"){switch(No(e)){case 0:return null;case 1:return e.booleanValue;case 2:return st(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(ji(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw ue(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){let r={};return Vo(e,(i,o)=>{r[i]=this.convertValue(o,t)}),r}convertVectorValue(e){var t,r,i;let o=(i=(r=(t=e.fields)===null||t===void 0?void 0:t[xc].arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.map(s=>st(s.doubleValue));return new Ao(o)}convertGeoPoint(e){return new Po(st(e.latitude),st(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":let r=ug(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(dd(e));default:return null}}convertTimestamp(e){let t=Vi(e);return new Et(t.seconds,t.nanos)}convertDocumentKey(e,t){let r=at.fromString(e);$e(TR(r),9688,{name:e});let i=new Nm(r.get(1),r.get(3)),o=new ae(r.popFirst(5));return i.isEqual(t)||Li(`Document ${o} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),o}};function ck(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}var Us=class{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}},$s=class n extends og{constructor(e,t,r,i,o,s){super(e,t,r,i,s),this._firestore=e,this._firestoreImpl=e,this.metadata=o}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){let t=new Ic(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){let r=this._document.data.field(vg("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Q(F.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");let e=this._document,t={};return t.type=n._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}};$s._jsonSchemaVersion="firestore/documentSnapshot/1.0",$s._jsonSchema={type:It("string",$s._jsonSchemaVersion),bundleSource:It("string","DocumentSnapshot"),bundleName:It("string"),bundle:It("string")};var Ic=class extends $s{data(e={}){return super.data(e)}},zs=class n{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new Us(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){let e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new Ic(this._firestore,this._userDataWriter,r.key,r,new Us(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){let t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Q(F.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(i,o){if(i._snapshot.oldDocs.isEmpty()){let s=0;return i._snapshot.docChanges.map(a=>{let c=new Ic(i._firestore,i._userDataWriter,a.doc.key,a.doc,new Us(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);return a.doc,{type:"added",doc:c,oldIndex:-1,newIndex:s++}})}{let s=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(a=>o||a.type!==3).map(a=>{let c=new Ic(i._firestore,i._userDataWriter,a.doc.key,a.doc,new Us(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter),u=-1,d=-1;return a.type!==0&&(u=s.indexOf(a.doc.key),s=s.delete(a.doc.key)),a.type!==1&&(s=s.add(a.doc),d=s.indexOf(a.doc.key)),{type:w7(a.type),doc:c,oldIndex:u,newIndex:d}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Q(F.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");let e={};e.type=n._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=cd.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;let t=[],r=[],i=[];return this.docs.forEach(o=>{o._document!==null&&(t.push(o._document),r.push(this._userDataWriter.convertObjectMap(o._document.data.value.mapValue.fields,"previous")),i.push(o.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}};function w7(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ue(61501,{type:n})}}zs._jsonSchemaVersion="firestore/querySnapshot/1.0",zs._jsonSchema={type:It("string",zs._jsonSchemaVersion),bundleSource:It("string","QuerySnapshot"),bundleName:It("string"),bundle:It("string")};var wd=class extends gI{constructor(e){super(),this.firestore=e}convertBytes(e){return new Mo(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new Lt(this.firestore,null,t)}};function lk(n){n=er(n,Lo);let e=er(n.firestore,di),t=jI(e),r=new wd(e);return rk(n._query),f7(t,n._query).then(i=>new zs(e,r,n,i))}function uk(n,e,t){n=er(n,Lt);let r=er(n.firestore,di),i=ck(n.converter,e,t);return _g(r,[XR(gg(r),"setDoc",n._key,i,n.converter!==null,t).toMutation(n._key,ai.none())])}function dk(n,e,t,...r){n=er(n,Lt);let i=er(n.firestore,di),o=gg(i),s;return s=typeof(e=lt(e))=="string"||e instanceof kc?v7(o,"updateDoc",n._key,e,t,r):g7(o,"updateDoc",n._key,e),_g(i,[s.toMutation(n._key,ai.exists(!0))])}function hk(n){return _g(er(n.firestore,di),[new fd(n._key,ai.none())])}function fk(n,e){let t=er(n.firestore,di),r=VI(n),i=ck(n.converter,e);return _g(t,[XR(gg(n.firestore),"addDoc",r._key,i,n.converter!==null,{}).toMutation(r._key,ai.exists(!1))]).then(()=>r)}function $I(n,...e){var t,r,i;n=lt(n);let o={includeMetadataChanges:!1,source:"default"},s=0;typeof e[s]!="object"||SN(e[s])||(o=e[s++]);let a={includeMetadataChanges:o.includeMetadataChanges,source:o.source};if(SN(e[s])){let f=e[s];e[s]=(t=f.next)===null||t===void 0?void 0:t.bind(f),e[s+1]=(r=f.error)===null||r===void 0?void 0:r.bind(f),e[s+2]=(i=f.complete)===null||i===void 0?void 0:i.bind(f)}let c,u,d;if(n instanceof Lt)u=er(n.firestore,di),d=SI(n._key.path),c={next:f=>{e[s]&&e[s](C7(u,n,f))},error:e[s+1],complete:e[s+2]};else{let f=er(n,Lo);u=er(f.firestore,di),d=f._query;let v=new wd(u);c={next:_=>{e[s]&&e[s](new zs(u,v,f,_))},error:e[s+1],complete:e[s+2]},rk(n._query)}return function(v,_,b,N){let R=new Xm(N),G=new Qm(_,R,b);return v.asyncQueue.enqueueAndForget(()=>w(null,null,function*(){return LR(yield cI(v),G)})),()=>{R.Ou(),v.asyncQueue.enqueueAndForget(()=>w(null,null,function*(){return VR(yield cI(v),G)}))}}(jI(u),d,a,c)}function _g(n,e){return function(r,i){let o=new ii;return r.asyncQueue.enqueueAndForget(()=>w(null,null,function*(){return n7(yield h7(r),i,o)})),o.promise}(jI(n),e)}function C7(n,e,t){let r=t.docs.get(e._key),i=new wd(n);return new $s(n,i,e._key,r,new Us(t.hasPendingWrites,t.fromCache),e.converter)}(function(e,t=!0){(function(i){Fc=i})(Xr),Bn(new Gt("firestore",(r,{instanceIdentifier:i,options:o})=>{let s=r.getProvider("app").getImmediate(),a=new di(new kC(r.getProvider("auth-internal")),new VC(s,r.getProvider("app-check-internal")),function(u,d){if(!Object.prototype.hasOwnProperty.apply(u.options,["projectId"]))throw new Q(F.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Nm(u.options.projectId,d)}(s,i),s);return o=Object.assign({useFetchStreams:t},o),a._setSettings(o),a},"PUBLIC").setMultipleInstances(!0)),Je(FO,LO,e),Je(FO,LO,"esm2017")})();var yg=function(){return yg=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},yg.apply(this,arguments)};var E7={includeMetadataChanges:!1};function pk(n,e){return e===void 0&&(e=E7),new me(function(t){var r=$I(n,e,{next:t.next.bind(t),error:t.error.bind(t),complete:t.complete.bind(t)});return{unsubscribe:r}})}function mk(n,e){var t;e===void 0&&(e={});var r=n.data(e);return!n.exists()||typeof r!="object"||r===null||!e.idField?r:yg(yg({},r),(t={},t[e.idField]=n.id,t))}function gk(n){return pk(n,{includeMetadataChanges:!0}).pipe(_e(function(e){return e.docs}))}function vk(n,e){return e===void 0&&(e={}),gk(n).pipe(_e(function(t){return t.map(function(r){return mk(r,e)})}))}var Kt=class{constructor(e){return e}},_k="firestore",zI=class{constructor(){return wo(_k)}};var HI=new J("angularfire2.firestore-instances");function x7(n,e){let t=Os(_k,n,e);return t&&new Kt(t)}function S7(n){return(e,t)=>{let r=e.runOutsideAngular(()=>n(t));return new Kt(r)}}var T7={provide:zI,deps:[[new Mt,HI]]},D7={provide:Kt,useFactory:x7,deps:[[new Mt,HI],wr]};function yk(n,...e){return Je("angularfire",ei.full,"fst"),En([D7,T7,{provide:HI,useFactory:S7(n),multi:!0,deps:[Pe,rt,ti,Oi,[new Mt,Vs],[new Mt,bo],...e]}])}var Js=gt(vk,!0);var Er=gt(fk,!0,2);var sn=gt(QR,!0,2);var hi=gt(hk,!0,2);var Yt=gt(VI,!0,2);var xr=gt(lk,!0);var wk=gt(ZR,!0);var $i=gt(sk,!0,2),Sr=gt(ik,!0,2);var Ck=gt(uk,!0,2);var fi=gt(dk,!0,2);var xd=gt(ok,!0,2);var Cg=class n{constructor(e){this.firestore=e}get customersCollection(){return sn(this.firestore,"customers")}getCustomers(){let e=Sr(this.customersCollection,$i("createdAt","desc"));return Js(e,{idField:"id"})}addCustomer(e){return w(this,null,function*(){let t=le(L({},e),{createdAt:new Date,updatedAt:new Date});return(yield Er(this.customersCollection,t)).id})}updateCustomer(e,t){return w(this,null,function*(){let r=Yt(this.firestore,"customers",e),i=le(L({},t),{updatedAt:new Date});yield fi(r,i)})}deleteCustomer(e){return w(this,null,function*(){let t=Yt(this.firestore,"customers",e);yield hi(t)})}getCustomerByMobile(e){let t=Sr(this.customersCollection,xd("mobile","==",e));return Js(t,{idField:"id"})}static \u0275fac=function(t){return new(t||n)(ee(Kt))};static \u0275prov=H({token:n,factory:n.\u0275fac,providedIn:"root"})};var bg=class n{constructor(e){this.firestore=e}get invoicesCollection(){return sn(this.firestore,"invoices")}getInvoices(){let e=Sr(this.invoicesCollection,$i("createdAt","desc"));return Js(e,{idField:"id"})}addInvoice(e){return w(this,null,function*(){let t=le(L({},e),{createdAt:new Date,updatedAt:new Date});return(yield Er(this.invoicesCollection,t)).id})}updateInvoice(e,t){return w(this,null,function*(){let r=Yt(this.firestore,"invoices",e),i=le(L({},t),{updatedAt:new Date});yield fi(r,i)})}deleteInvoice(e){return w(this,null,function*(){let t=Yt(this.firestore,"invoices",e);yield hi(t)})}getInvoicesByCustomer(e){let t=Sr(this.invoicesCollection,xd("customer.mobile","==",e),$i("createdAt","desc"));return Js(t,{idField:"id"})}getInvoiceByNumber(e){let t=Sr(this.invoicesCollection,xd("invoiceNumber","==",e));return Js(t,{idField:"id"})}generateInvoiceNumber(){return w(this,null,function*(){let e=yield new Promise(r=>{this.getInvoices().subscribe(i=>r(i))}),t=e.length>0?Math.max(...e.map(r=>parseInt(r.invoiceNumber.replace("INV-","")))):0;return`INV-${String(t+1).padStart(4,"0")}`})}static \u0275fac=function(t){return new(t||n)(ee(Kt))};static \u0275prov=H({token:n,factory:n.\u0275fac,providedIn:"root"})};var Ig=class n{storageKey="globalfinserv_customers";constructor(){}addCustomer(e){return w(this,null,function*(){try{let t=this.getCustomersFromStorage(),r=Date.now().toString(),i=L({id:r},e);return t.push(i),localStorage.setItem(this.storageKey,JSON.stringify(t)),r}catch(t){throw console.error("Error adding customer:",t),t}})}getCustomers(){return w(this,null,function*(){try{return this.getCustomersFromStorage()}catch(e){throw console.error("Error getting customers:",e),e}})}updateCustomer(e,t){return w(this,null,function*(){try{let r=this.getCustomersFromStorage(),i=r.findIndex(o=>o.id===e);i!==-1&&(r[i]=L(L({},r[i]),t),localStorage.setItem(this.storageKey,JSON.stringify(r)))}catch(r){throw console.error("Error updating customer:",r),r}})}deleteCustomer(e){return w(this,null,function*(){try{let r=this.getCustomersFromStorage().filter(i=>i.id!==e);localStorage.setItem(this.storageKey,JSON.stringify(r))}catch(t){throw console.error("Error deleting customer:",t),t}})}searchCustomers(e){return w(this,null,function*(){try{return this.getCustomersFromStorage().filter(r=>r.name.toLowerCase().includes(e.toLowerCase())||r.mobile.includes(e)||r.email.toLowerCase().includes(e.toLowerCase()))}catch(t){throw console.error("Error searching customers:",t),t}})}getCustomersFromStorage(){let e=localStorage.getItem(this.storageKey);return e?JSON.parse(e):[]}static \u0275fac=function(t){return new(t||n)};static \u0275prov=H({token:n,factory:n.\u0275fac,providedIn:"root"})};var Eg=class n{storageKey="globalfinserv_invoices";constructor(){}addInvoice(e){return w(this,null,function*(){try{let t=this.getInvoicesFromStorage(),r=Date.now().toString(),i=L({id:r},e);return t.unshift(i),localStorage.setItem(this.storageKey,JSON.stringify(t)),r}catch(t){throw console.error("Error adding invoice:",t),t}})}getInvoices(){return w(this,null,function*(){try{return this.getInvoicesFromStorage()}catch(e){throw console.error("Error getting invoices:",e),e}})}getInvoiceById(e){return w(this,null,function*(){try{return this.getInvoicesFromStorage().find(r=>r.id===e)||null}catch(t){throw console.error("Error getting invoice by ID:",t),t}})}updateInvoice(e,t){return w(this,null,function*(){try{let r=this.getInvoicesFromStorage(),i=r.findIndex(o=>o.id===e);i!==-1&&(r[i]=L(L({},r[i]),t),localStorage.setItem(this.storageKey,JSON.stringify(r)))}catch(r){throw console.error("Error updating invoice:",r),r}})}deleteInvoice(e){return w(this,null,function*(){try{let r=this.getInvoicesFromStorage().filter(i=>i.id!==e);localStorage.setItem(this.storageKey,JSON.stringify(r))}catch(t){throw console.error("Error deleting invoice:",t),t}})}searchInvoices(e){return w(this,null,function*(){try{return this.getInvoicesFromStorage().filter(r=>r.invoiceNumber.toLowerCase().includes(e.toLowerCase())||r.customer.name.toLowerCase().includes(e.toLowerCase())||r.customer.mobile.includes(e))}catch(t){throw console.error("Error searching invoices:",t),t}})}getInvoicesByStatus(e){return w(this,null,function*(){try{return this.getInvoicesFromStorage().filter(r=>r.status===e)}catch(t){throw console.error("Error getting invoices by status:",t),t}})}getTotalRevenue(){return w(this,null,function*(){try{return this.getInvoicesFromStorage().reduce((t,r)=>t+r.totalAmount,0)}catch(e){return console.error("Error getting total revenue:",e),0}})}getPendingAmount(){return w(this,null,function*(){try{return this.getInvoicesFromStorage().filter(t=>t.status==="PENDING"||t.status==="PARTIAL").reduce((t,r)=>t+r.balancePayable,0)}catch(e){return console.error("Error getting pending amount:",e),0}})}generateNextInvoiceNumber(e){return w(this,null,function*(){try{let t=this.getInvoicesFromStorage(),r=e?new Date(e):new Date,i=r.getFullYear(),o=String(r.getMonth()+1).padStart(2,"0"),a=`INV-${`${i}${o}`}-`,c=t.filter(v=>v.invoiceNumber.startsWith(a)),u=0;c.forEach(v=>{let _=v.invoiceNumber.split("-")[2];if(_){let b=parseInt(_,10);!isNaN(b)&&b>u&&(u=b)}});let d=u+1,f=String(d).padStart(4,"0");return`${a}${f}`}catch(t){console.error("Error generating invoice number:",t);let r=e?new Date(e):new Date,i=r.getFullYear(),o=String(r.getMonth()+1).padStart(2,"0");return`INV-${i}${o}-0001`}})}getInvoicesFromStorage(){let e=localStorage.getItem(this.storageKey);return e?JSON.parse(e):[]}static \u0275fac=function(t){return new(t||n)};static \u0275prov=H({token:n,factory:n.\u0275fac,providedIn:"root"})};var xg=class n{constructor(e,t,r,i){this.firestoreCustomerService=e;this.firestoreInvoiceService=t;this.localCustomerService=r;this.localInvoiceService=i}migrateCustomersToFirestore(){return w(this,null,function*(){try{console.log("Starting customer migration...");let t=yield this.localCustomerService.getCustomers();if(t.length===0){console.log("No customers found in localStorage to migrate.");return}for(let r of t){let e=r,{id:i}=e,o=Vv(e,["id"]);yield this.firestoreCustomerService.addCustomer(o),console.log(`Migrated customer: ${r.name}`)}console.log(`Successfully migrated ${t.length} customers to Firestore.`)}catch(t){throw console.error("Error migrating customers:",t),t}})}migrateInvoicesToFirestore(){return w(this,null,function*(){try{console.log("Starting invoice migration...");let t=yield this.localInvoiceService.getInvoices();if(t.length===0){console.log("No invoices found in localStorage to migrate.");return}for(let r of t){let e=r,{id:i}=e,o=Vv(e,["id"]);yield this.firestoreInvoiceService.addInvoice(o),console.log(`Migrated invoice: ${r.invoiceNumber}`)}console.log(`Successfully migrated ${t.length} invoices to Firestore.`)}catch(t){throw console.error("Error migrating invoices:",t),t}})}migrateAllData(){return w(this,null,function*(){console.log("Starting complete data migration from localStorage to Firestore...");try{yield this.migrateCustomersToFirestore(),yield this.migrateInvoicesToFirestore(),console.log("\u2705 Complete migration successful!"),console.log("You can now switch to using Firestore services in production.")}catch(e){throw console.error("\u274C Migration failed:",e),e}})}static \u0275fac=function(t){return new(t||n)(ee(Cg),ee(bg),ee(Ig),ee(Eg))};static \u0275prov=H({token:n,factory:n.\u0275fac,providedIn:"root"})};var Sg=class n{firestore=j(Kt);initializeCollections(){return w(this,null,function*(){try{console.log("\u{1F525} Initializing Firestore collections..."),console.log("\u2705 Firestore collections initialized successfully")}catch(e){console.error("\u274C Error initializing Firestore collections:",e)}})}createSampleCustomerIfNeeded(){return w(this,null,function*(){try{let e=sn(this.firestore,"customers");(yield xr(e)).empty?(console.log("\u{1F4DD} Creating sample customer..."),yield Er(e,{name:"John Doe",mobile:"+91 9876543210",email:"john.doe@example.com",address:"123 Main Street, Mumbai, Maharashtra, 400001",gst:"27ABCDE1234F1Z5",dueAmount:0,createdAt:new Date,updatedAt:new Date}),console.log("\u2705 Sample customer created")):console.log("\u2705 Customers collection already has data")}catch(e){console.error("\u274C Error creating sample customer:",e)}})}createSampleInvoiceIfNeeded(){return w(this,null,function*(){try{let e=sn(this.firestore,"invoices");if((yield xr(e)).empty){console.log("\u{1F4DD} Creating sample invoice...");let r=sn(this.firestore,"customers"),i=yield xr(r),o="sample-customer-id",s={name:"John Doe",mobile:"+91 9876543210",email:"john.doe@example.com",address:"123 Main Street, Mumbai, Maharashtra, 400001",gst:"27ABCDE1234F1Z5"};if(!i.empty){let c=i.docs[0];o=c.id,s=c.data()}let a={invoiceNumber:"INV-202507-0001",invoiceDate:"2025-07-19",customer:{id:o,name:s.name,mobile:s.mobile,email:s.email,address:s.address,gst:s.gst},serviceDetails:[{description:"Web Development Service",quantity:1,rate:5e4,amount:5e4},{description:"SEO Optimization",quantity:1,rate:15e3,amount:15e3}],totalAmount:65e3,advanceReceived:2e4,balancePayable:45e3,selectedBank:"HDFC Bank",status:"PENDING",createdAt:new Date,updatedAt:new Date};yield Er(e,a),console.log("\u2705 Sample invoice created")}else console.log("\u2705 Invoices collection already has data")}catch(e){console.error("\u274C Error creating sample invoice:",e)}})}testFirestoreConnection(){return w(this,null,function*(){try{console.log("\u{1F50D} Testing Firestore connection...");let e=sn(this.firestore,"test"),t=Yt(e,"connection-test");return yield Ck(t,{timestamp:new Date,message:"Connection test successful"}),console.log("\u2705 Firestore connection successful"),!0}catch(e){return console.error("\u274C Firestore connection failed:",e),!1}})}static \u0275fac=function(t){return new(t||n)};static \u0275prov=H({token:n,factory:n.\u0275fac,providedIn:"root"})};var Tg=class n{firestore=j(Kt);cleanupDuplicateInvoiceNumbers(){return w(this,null,function*(){try{if(!this.firestore){console.warn("\u26A0\uFE0F Firestore not available yet, skipping cleanup");return}console.log("\u{1F9F9} Starting invoice number cleanup...");let e=sn(this.firestore,"invoices"),t=yield xr(e);if(t.empty){console.log("\u{1F4CB} No invoices found to clean up");return}let r=t.docs.map(s=>L({id:s.id},s.data()));console.log(`\u{1F4CA} Found ${r.length} invoices`);let i={};r.forEach(s=>{let a=s.invoiceNumber;i[a]||(i[a]=[]),i[a].push(s)});let o=Object.entries(i).filter(([s,a])=>a.length>1);if(o.length===0){console.log("\u2705 No duplicate invoice numbers found");return}console.log(`\u26A0\uFE0F Found ${o.length} duplicate invoice numbers:`);for(let[s,a]of o){console.log(`\u{1F50D} Invoice ${s} has ${a.length} duplicates`),a.sort((c,u)=>{let d=c.createdAt?.toDate?.()||new Date(c.createdAt),f=u.createdAt?.toDate?.()||new Date(u.createdAt);return d.getTime()-f.getTime()});for(let c=1;c<a.length;c++){let u=a[c],d=yield this.generateUniqueInvoiceNumber(u.invoiceDate,r);console.log(`\u{1F504} Renumbering duplicate invoice from ${s} to ${d}`);let f=Yt(this.firestore,"invoices",u.id);yield fi(f,{invoiceNumber:d,updatedAt:new Date}),u.invoiceNumber=d}}console.log("\u2705 Duplicate invoice number cleanup completed")}catch(e){console.error("\u274C Error during cleanup:",e)}})}generateUniqueInvoiceNumber(e,t){return w(this,null,function*(){let r=new Date(e),i=r.getFullYear(),o=String(r.getMonth()+1).padStart(2,"0"),s=`${i}${o}`,a=t.filter(d=>d.invoiceNumber.startsWith(`INV-${s}`)).map(d=>d.invoiceNumber),c=1,u=`INV-${s}-${String(c).padStart(4,"0")}`;for(;a.includes(u);)c++,u=`INV-${s}-${String(c).padStart(4,"0")}`;return u})}removeTestData(){return w(this,null,function*(){try{console.log("\u{1F5D1}\uFE0F Removing test/sample data...");let e=sn(this.firestore,"invoices"),r=(yield xr(e)).docs.filter(i=>{let o=i.data();return o.customer?.name==="John Doe"||o.customer?.email==="john.doe@example.com"||o.invoiceNumber==="INV-202507-0001"});if(r.length>0){console.log(`\u{1F5D1}\uFE0F Found ${r.length} test invoices to remove`);for(let i of r){yield hi(Yt(this.firestore,"invoices",i.id));let o=i.data();console.log(`\u{1F5D1}\uFE0F Removed test invoice: ${o.invoiceNumber}`)}}else console.log("\u{1F4CB} No test invoices found to remove");console.log("\u2705 Test data cleanup completed")}catch(e){console.error("\u274C Error removing test data:",e)}})}static \u0275fac=function(t){return new(t||n)};static \u0275prov=H({token:n,factory:n.\u0275fac,providedIn:"root"})};function F7(n,e){if(n&1){let t=de();m(0,"button",13),z("click",function(){B(t);let i=A(2);return U(i.navigateToHome())}),K(1,"i",14),m(2,"span"),y(3,"Back to Dashboard"),g()()}}function L7(n,e){if(n&1){let t=de();m(0,"button",15),z("click",function(){B(t);let i=A(2);return U(i.logout())}),K(1,"i",16),m(2,"span"),y(3,"Logout"),g()()}}function V7(n,e){if(n&1&&(m(0,"header",3)(1,"div",4)(2,"div",5),K(3,"img",6),m(4,"div",7)(5,"h1",8),y(6,"Global Financial Services"),g(),m(7,"div",9),y(8,"ACCOUNTING & FINANCIAL SERVICES"),g()()(),m(9,"div",10),ie(10,F7,4,0,"button",11)(11,L7,4,0,"button",12),g()()()),n&2){let t=A();I(10),V("ngIf",t.showDashboardButton()),I(),V("ngIf",t.isDashboardPage())}}var Dg=class n{constructor(e,t,r,i){this.router=e;this.migrationService=t;this.firestoreSetup=r;this.dataCleanup=i}ngOnInit(){this.clearLegacyData(),this.initializeFirestore()}clearLegacyData(){try{localStorage.removeItem("customers"),localStorage.removeItem("invoices"),localStorage.removeItem("invoiceCounter"),localStorage.removeItem("lastInvoiceNumber"),console.log("\u2705 Legacy local storage data cleared - now using Firestore")}catch(e){console.warn("Warning: Could not clear local storage:",e)}}initializeFirestore(){return w(this,null,function*(){try{(yield this.firestoreSetup.testFirestoreConnection())?(yield this.dataCleanup.cleanupDuplicateInvoiceNumbers(),yield this.firestoreSetup.initializeCollections()):console.warn("\u26A0\uFE0F Firestore connection failed - app may not work properly")}catch(e){console.error("\u274C Error initializing Firestore:",e)}})}navigateToHome(){this.router.navigate(["/dashboard"])}logout(){localStorage.clear(),sessionStorage.clear(),this.router.navigate(["/login"])}showDashboardButton(){let e=this.router.url;return e!=="/login"&&e!=="/dashboard"&&e!=="/"&&e!==""}showHomeButton(){let e=this.router.url;return e!=="/login"&&e!=="/dashboard"&&e!=="/"&&e!==""}isLoginPage(){let e=this.router.url;return e==="/login"||e==="/"||e===""}isDashboardPage(){return this.router.url==="/dashboard"}static \u0275fac=function(t){return new(t||n)(q(it),q(xg),q(Sg),q(Tg))};static \u0275cmp=Pt({type:n,selectors:[["app-root"]],decls:4,vars:1,consts:[[1,"app-container"],["class","global-header",4,"ngIf"],[1,"main-content"],[1,"global-header"],[1,"header-content"],[1,"logo-title-section"],["src","logo.jpg","alt","CA India Logo",1,"company-logo"],[1,"title-section"],[1,"app-title"],[1,"header-subtitle"],[1,"header-actions"],["class","header-btn dashboard-btn",3,"click",4,"ngIf"],["class","header-btn logout-btn",3,"click",4,"ngIf"],[1,"header-btn","dashboard-btn",3,"click"],[1,"fas","fa-tachometer-alt"],[1,"header-btn","logout-btn",3,"click"],[1,"fas","fa-sign-out-alt"]],template:function(t,r){t&1&&(m(0,"div",0),ie(1,V7,12,2,"header",1),m(2,"main",2),K(3,"router-outlet"),g()()),t&2&&(I(),V("ngIf",!r.isLoginPage()))},dependencies:[Pu,Ot,Wt],styles:["*[_ngcontent-%COMP%]{margin:0;padding:0;box-sizing:border-box}.app-container[_ngcontent-%COMP%]{min-height:100vh;display:flex;flex-direction:column}.global-header[_ngcontent-%COMP%]{background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;padding:20px 0;box-shadow:0 4px 15px #0000001a;position:relative;z-index:1000}.header-content[_ngcontent-%COMP%]{max-width:1200px;margin:0 auto;padding:0 20px;display:flex;justify-content:space-between;align-items:center}.logo-title-section[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;gap:20px}.header-actions[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px}.header-btn[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;padding:10px 16px;background:#fff3;color:#fff;border:1px solid rgba(255,255,255,.3);border-radius:6px;cursor:pointer;font-size:14px;font-weight:600;transition:all .3s ease;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px)}.header-btn[_ngcontent-%COMP%]:hover{background:#ffffff4d;border-color:#ffffff80;transform:translateY(-1px)}.header-btn[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:16px}.dashboard-btn[_ngcontent-%COMP%]:hover{background:#667eea4d}.logout-btn[_ngcontent-%COMP%]{background:#dc3545!important;border-color:#dc354580!important}.logout-btn[_ngcontent-%COMP%]:hover{background:#c82333!important;border-color:#c82333b3!important;transform:translateY(-1px)}.home-btn[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;padding:10px 16px;background:#fff3;color:#fff;border:1px solid rgba(255,255,255,.3);border-radius:6px;cursor:pointer;font-size:14px;font-weight:600;transition:all .3s ease;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px)}.home-btn[_ngcontent-%COMP%]:hover{background:#ffffff4d;border-color:#ffffff80;transform:translateY(-1px)}.home-btn[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:16px}.company-logo[_ngcontent-%COMP%]{width:60px;height:60px;border-radius:8px;object-fit:cover;filter:drop-shadow(0 2px 4px rgba(0,0,0,.1))}.title-section[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:flex-start}.app-title[_ngcontent-%COMP%]{font-size:2.5rem;font-weight:700;margin:0;letter-spacing:-.5px;text-shadow:0 2px 4px rgba(0,0,0,.1)}.header-subtitle[_ngcontent-%COMP%]{font-size:1.1rem;margin-top:8px;opacity:.9;font-weight:400;letter-spacing:.5px}.main-content[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:column}@media (max-width: 768px){.app-title[_ngcontent-%COMP%]{font-size:2rem}.header-subtitle[_ngcontent-%COMP%]{font-size:1rem}.header-content[_ngcontent-%COMP%]{padding:0 15px;flex-direction:column;gap:15px}.global-header[_ngcontent-%COMP%]{padding:15px 0}.logo-title-section[_ngcontent-%COMP%]{gap:15px}.company-logo[_ngcontent-%COMP%]{width:50px;height:50px}.home-btn[_ngcontent-%COMP%]{padding:8px 12px;font-size:13px}}@media (max-width: 480px){.app-title[_ngcontent-%COMP%]{font-size:1.7rem}.header-subtitle[_ngcontent-%COMP%]{font-size:.9rem}.header-content[_ngcontent-%COMP%]{flex-direction:column;gap:12px}.logo-title-section[_ngcontent-%COMP%]{flex-direction:column;gap:10px}.title-section[_ngcontent-%COMP%]{align-items:center}.company-logo[_ngcontent-%COMP%]{width:45px;height:45px}.home-btn[_ngcontent-%COMP%]{padding:6px 10px;font-size:12px}}"]})};var Pk=(()=>{class n{_renderer;_elementRef;onChange=t=>{};onTouched=()=>{};constructor(t,r){this._renderer=t,this._elementRef=r}setProperty(t,r){this._renderer.setProperty(this._elementRef.nativeElement,t,r)}registerOnTouched(t){this.onTouched=t}registerOnChange(t){this.onChange=t}setDisabledState(t){this.setProperty("disabled",t)}static \u0275fac=function(r){return new(r||n)(q(Ti),q(Ur))};static \u0275dir=Qe({type:n})}return n})(),Ad=(()=>{class n extends Pk{static \u0275fac=(()=>{let t;return function(i){return(t||(t=Rn(n)))(i||n)}})();static \u0275dir=Qe({type:n,features:[Ht]})}return n})(),Hc=new J("");var j7={provide:Hc,useExisting:mn(()=>tr),multi:!0};function B7(){let n=Kn()?Kn().getUserAgent():"";return/android (\d+)/.test(n.toLowerCase())}var U7=new J(""),tr=(()=>{class n extends Pk{_compositionMode;_composing=!1;constructor(t,r,i){super(t,r),this._compositionMode=i,this._compositionMode==null&&(this._compositionMode=!B7())}writeValue(t){let r=t??"";this.setProperty("value",r)}_handleInput(t){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(t)}_compositionStart(){this._composing=!0}_compositionEnd(t){this._composing=!1,this._compositionMode&&this.onChange(t)}static \u0275fac=function(r){return new(r||n)(q(Ti),q(Ur),q(U7,8))};static \u0275dir=Qe({type:n,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(r,i){r&1&&z("input",function(s){return i._handleInput(s.target.value)})("blur",function(){return i.onTouched()})("compositionstart",function(){return i._compositionStart()})("compositionend",function(s){return i._compositionEnd(s.target.value)})},standalone:!1,features:[Fn([j7]),Ht]})}return n})();function Ak(n){return n==null||Ok(n)===0}function Ok(n){return n==null?null:Array.isArray(n)||typeof n=="string"?n.length:n instanceof Set?n.size:null}var ea=new J(""),Nk=new J("");function $7(n){return e=>{if(e.value==null||n==null)return null;let t=parseFloat(e.value);return!isNaN(t)&&t<n?{min:{min:n,actual:e.value}}:null}}function z7(n){return e=>{if(e.value==null||n==null)return null;let t=parseFloat(e.value);return!isNaN(t)&&t>n?{max:{max:n,actual:e.value}}:null}}function H7(n){return Ak(n.value)?{required:!0}:null}function W7(n){return e=>{let t=e.value?.length??Ok(e.value);return t!==null&&t>n?{maxlength:{requiredLength:n,actualLength:t}}:null}}function q7(n){if(!n)return WI;let e,t;return typeof n=="string"?(t="",n.charAt(0)!=="^"&&(t+="^"),t+=n,n.charAt(n.length-1)!=="$"&&(t+="$"),e=new RegExp(t)):(t=n.toString(),e=n),r=>{if(Ak(r.value))return null;let i=r.value;return e.test(i)?null:{pattern:{requiredPattern:t,actualValue:i}}}}function WI(n){return null}function Rk(n){return n!=null}function kk(n){return gs(n)?nt(n):n}function Fk(n){let e={};return n.forEach(t=>{e=t!=null?L(L({},e),t):e}),Object.keys(e).length===0?null:e}function Lk(n,e){return e.map(t=>t(n))}function G7(n){return!n.validate}function Vk(n){return n.map(e=>G7(e)?e:t=>e.validate(t))}function K7(n){if(!n)return null;let e=n.filter(Rk);return e.length==0?null:function(t){return Fk(Lk(t,e))}}function YI(n){return n!=null?K7(Vk(n)):null}function Y7(n){if(!n)return null;let e=n.filter(Rk);return e.length==0?null:function(t){let r=Lk(t,e).map(kk);return y_(r).pipe(_e(Fk))}}function QI(n){return n!=null?Y7(Vk(n)):null}function bk(n,e){return n===null?[e]:Array.isArray(n)?[...n,e]:[n,e]}function Q7(n){return n._rawValidators}function Z7(n){return n._rawAsyncValidators}function qI(n){return n?Array.isArray(n)?n:[n]:[]}function Pg(n,e){return Array.isArray(n)?n.includes(e):n===e}function Ik(n,e){let t=qI(e);return qI(n).forEach(i=>{Pg(t,i)||t.push(i)}),t}function Ek(n,e){return qI(e).filter(t=>!Pg(n,t))}var Ag=class{get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_composedValidatorFn;_composedAsyncValidatorFn;_rawValidators=[];_rawAsyncValidators=[];_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=YI(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=QI(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_onDestroyCallbacks=[];_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e=void 0){this.control&&this.control.reset(e)}hasError(e,t){return this.control?this.control.hasError(e,t):!1}getError(e,t){return this.control?this.control.getError(e,t):null}},$c=class extends Ag{name;get formDirective(){return null}get path(){return null}},zc=class extends Ag{_parent=null;name=null;valueAccessor=null},Og=class{_cd;constructor(e){this._cd=e}get isTouched(){return this._cd?.control?._touched?.(),!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return this._cd?.control?._pristine?.(),!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return this._cd?.control?._status?.(),!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return this._cd?._submitted?.(),!!this._cd?.submitted}},J7={"[class.ng-untouched]":"isUntouched","[class.ng-touched]":"isTouched","[class.ng-pristine]":"isPristine","[class.ng-dirty]":"isDirty","[class.ng-valid]":"isValid","[class.ng-invalid]":"isInvalid","[class.ng-pending]":"isPending"},Hue=le(L({},J7),{"[class.ng-submitted]":"isSubmitted"}),pi=(()=>{class n extends Og{constructor(t){super(t)}static \u0275fac=function(r){return new(r||n)(q(zc,2))};static \u0275dir=Qe({type:n,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(r,i){r&2&&Ze("ng-untouched",i.isUntouched)("ng-touched",i.isTouched)("ng-pristine",i.isPristine)("ng-dirty",i.isDirty)("ng-valid",i.isValid)("ng-invalid",i.isInvalid)("ng-pending",i.isPending)},standalone:!1,features:[Ht]})}return n})(),Bo=(()=>{class n extends Og{constructor(t){super(t)}static \u0275fac=function(r){return new(r||n)(q($c,10))};static \u0275dir=Qe({type:n,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(r,i){r&2&&Ze("ng-untouched",i.isUntouched)("ng-touched",i.isTouched)("ng-pristine",i.isPristine)("ng-dirty",i.isDirty)("ng-valid",i.isValid)("ng-invalid",i.isInvalid)("ng-pending",i.isPending)("ng-submitted",i.isSubmitted)},standalone:!1,features:[Ht]})}return n})();var Sd="VALID",Mg="INVALID",Bc="PENDING",Td="DISABLED",jo=class{},Ng=class extends jo{value;source;constructor(e,t){super(),this.value=e,this.source=t}},Md=class extends jo{pristine;source;constructor(e,t){super(),this.pristine=e,this.source=t}},Pd=class extends jo{touched;source;constructor(e,t){super(),this.touched=e,this.source=t}},Uc=class extends jo{status;source;constructor(e,t){super(),this.status=e,this.source=t}},GI=class extends jo{source;constructor(e){super(),this.source=e}},KI=class extends jo{source;constructor(e){super(),this.source=e}};function jk(n){return(Fg(n)?n.validators:n)||null}function X7(n){return Array.isArray(n)?YI(n):n||null}function Bk(n,e){return(Fg(e)?e.asyncValidators:n)||null}function eq(n){return Array.isArray(n)?QI(n):n||null}function Fg(n){return n!=null&&!Array.isArray(n)&&typeof n=="object"}function tq(n,e,t){let r=n.controls;if(!(e?Object.keys(r):r).length)throw new Z(1e3,"");if(!r[t])throw new Z(1001,"")}function nq(n,e,t){n._forEachChild((r,i)=>{if(t[i]===void 0)throw new Z(1002,"")})}var Rg=class{_pendingDirty=!1;_hasOwnPendingAsyncValidator=null;_pendingTouched=!1;_onCollectionChange=()=>{};_updateOn;_parent=null;_asyncValidationSubscription;_composedValidatorFn;_composedAsyncValidatorFn;_rawValidators;_rawAsyncValidators;value;constructor(e,t){this._assignValidators(e),this._assignAsyncValidators(t)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get status(){return zr(this.statusReactive)}set status(e){zr(()=>this.statusReactive.set(e))}_status=Ka(()=>this.statusReactive());statusReactive=Ha(void 0);get valid(){return this.status===Sd}get invalid(){return this.status===Mg}get pending(){return this.status==Bc}get disabled(){return this.status===Td}get enabled(){return this.status!==Td}errors;get pristine(){return zr(this.pristineReactive)}set pristine(e){zr(()=>this.pristineReactive.set(e))}_pristine=Ka(()=>this.pristineReactive());pristineReactive=Ha(!0);get dirty(){return!this.pristine}get touched(){return zr(this.touchedReactive)}set touched(e){zr(()=>this.touchedReactive.set(e))}_touched=Ka(()=>this.touchedReactive());touchedReactive=Ha(!1);get untouched(){return!this.touched}_events=new ct;events=this._events.asObservable();valueChanges;statusChanges;get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._assignValidators(e)}setAsyncValidators(e){this._assignAsyncValidators(e)}addValidators(e){this.setValidators(Ik(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators(Ik(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(Ek(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(Ek(e,this._rawAsyncValidators))}hasValidator(e){return Pg(this._rawValidators,e)}hasAsyncValidator(e){return Pg(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){let t=this.touched===!1;this.touched=!0;let r=e.sourceControl??this;this._parent&&!e.onlySelf&&this._parent.markAsTouched(le(L({},e),{sourceControl:r})),t&&e.emitEvent!==!1&&this._events.next(new Pd(!0,r))}markAllAsTouched(e={}){this.markAsTouched({onlySelf:!0,emitEvent:e.emitEvent,sourceControl:this}),this._forEachChild(t=>t.markAllAsTouched(e))}markAsUntouched(e={}){let t=this.touched===!0;this.touched=!1,this._pendingTouched=!1;let r=e.sourceControl??this;this._forEachChild(i=>{i.markAsUntouched({onlySelf:!0,emitEvent:e.emitEvent,sourceControl:r})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e,r),t&&e.emitEvent!==!1&&this._events.next(new Pd(!1,r))}markAsDirty(e={}){let t=this.pristine===!0;this.pristine=!1;let r=e.sourceControl??this;this._parent&&!e.onlySelf&&this._parent.markAsDirty(le(L({},e),{sourceControl:r})),t&&e.emitEvent!==!1&&this._events.next(new Md(!1,r))}markAsPristine(e={}){let t=this.pristine===!1;this.pristine=!0,this._pendingDirty=!1;let r=e.sourceControl??this;this._forEachChild(i=>{i.markAsPristine({onlySelf:!0,emitEvent:e.emitEvent})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e,r),t&&e.emitEvent!==!1&&this._events.next(new Md(!0,r))}markAsPending(e={}){this.status=Bc;let t=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new Uc(this.status,t)),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.markAsPending(le(L({},e),{sourceControl:t}))}disable(e={}){let t=this._parentMarkedDirty(e.onlySelf);this.status=Td,this.errors=null,this._forEachChild(i=>{i.disable(le(L({},e),{onlySelf:!0}))}),this._updateValue();let r=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new Ng(this.value,r)),this._events.next(new Uc(this.status,r)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(le(L({},e),{skipPristineCheck:t}),this),this._onDisabledChange.forEach(i=>i(!0))}enable(e={}){let t=this._parentMarkedDirty(e.onlySelf);this.status=Sd,this._forEachChild(r=>{r.enable(le(L({},e),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors(le(L({},e),{skipPristineCheck:t}),this),this._onDisabledChange.forEach(r=>r(!1))}_updateAncestors(e,t){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine({},t),this._parent._updateTouched({},t))}setParent(e){this._parent=e}getRawValue(){return this.value}updateValueAndValidity(e={}){if(this._setInitialStatus(),this._updateValue(),this.enabled){let r=this._cancelExistingSubscription();this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===Sd||this.status===Bc)&&this._runAsyncValidator(r,e.emitEvent)}let t=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new Ng(this.value,t)),this._events.next(new Uc(this.status,t)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(le(L({},e),{sourceControl:t}))}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(t=>t._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?Td:Sd}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e,t){if(this.asyncValidator){this.status=Bc,this._hasOwnPendingAsyncValidator={emitEvent:t!==!1};let r=kk(this.asyncValidator(this));this._asyncValidationSubscription=r.subscribe(i=>{this._hasOwnPendingAsyncValidator=null,this.setErrors(i,{emitEvent:t,shouldHaveEmitted:e})})}}_cancelExistingSubscription(){if(this._asyncValidationSubscription){this._asyncValidationSubscription.unsubscribe();let e=this._hasOwnPendingAsyncValidator?.emitEvent??!1;return this._hasOwnPendingAsyncValidator=null,e}return!1}setErrors(e,t={}){this.errors=e,this._updateControlsErrors(t.emitEvent!==!1,this,t.shouldHaveEmitted)}get(e){let t=e;return t==null||(Array.isArray(t)||(t=t.split(".")),t.length===0)?null:t.reduce((r,i)=>r&&r._find(i),this)}getError(e,t){let r=t?this.get(t):this;return r&&r.errors?r.errors[e]:null}hasError(e,t){return!!this.getError(e,t)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e,t,r){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),(e||r)&&this._events.next(new Uc(this.status,t)),this._parent&&this._parent._updateControlsErrors(e,t,r)}_initObservables(){this.valueChanges=new St,this.statusChanges=new St}_calculateStatus(){return this._allControlsDisabled()?Td:this.errors?Mg:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(Bc)?Bc:this._anyControlsHaveStatus(Mg)?Mg:Sd}_anyControlsHaveStatus(e){return this._anyControls(t=>t.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e,t){let r=!this._anyControlsDirty(),i=this.pristine!==r;this.pristine=r,this._parent&&!e.onlySelf&&this._parent._updatePristine(e,t),i&&this._events.next(new Md(this.pristine,t))}_updateTouched(e={},t){this.touched=this._anyControlsTouched(),this._events.next(new Pd(this.touched,t)),this._parent&&!e.onlySelf&&this._parent._updateTouched(e,t)}_onDisabledChange=[];_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){Fg(e)&&e.updateOn!=null&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){let t=this._parent&&this._parent.dirty;return!e&&!!t&&!this._parent._anyControlsDirty()}_find(e){return null}_assignValidators(e){this._rawValidators=Array.isArray(e)?e.slice():e,this._composedValidatorFn=X7(this._rawValidators)}_assignAsyncValidators(e){this._rawAsyncValidators=Array.isArray(e)?e.slice():e,this._composedAsyncValidatorFn=eq(this._rawAsyncValidators)}},kg=class extends Rg{constructor(e,t,r){super(jk(t),Bk(r,t)),this.controls=e,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}controls;registerControl(e,t){return this.controls[e]?this.controls[e]:(this.controls[e]=t,t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange),t)}addControl(e,t,r={}){this.registerControl(e,t),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}removeControl(e,t={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}setControl(e,t,r={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],t&&this.registerControl(e,t),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}contains(e){return this.controls.hasOwnProperty(e)&&this.controls[e].enabled}setValue(e,t={}){nq(this,!0,e),Object.keys(e).forEach(r=>{tq(this,!0,r),this.controls[r].setValue(e[r],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(e,t={}){e!=null&&(Object.keys(e).forEach(r=>{let i=this.controls[r];i&&i.patchValue(e[r],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t))}reset(e={},t={}){this._forEachChild((r,i)=>{r.reset(e?e[i]:null,{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t,this),this._updateTouched(t,this),this.updateValueAndValidity(t)}getRawValue(){return this._reduceChildren({},(e,t,r)=>(e[r]=t.getRawValue(),e))}_syncPendingControls(){let e=this._reduceChildren(!1,(t,r)=>r._syncPendingControls()?!0:t);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){Object.keys(this.controls).forEach(t=>{let r=this.controls[t];r&&e(r,t)})}_setUpControls(){this._forEachChild(e=>{e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(e){for(let[t,r]of Object.entries(this.controls))if(this.contains(t)&&e(r))return!0;return!1}_reduceValue(){let e={};return this._reduceChildren(e,(t,r,i)=>((r.enabled||this.disabled)&&(t[i]=r.value),t))}_reduceChildren(e,t){let r=e;return this._forEachChild((i,o)=>{r=t(r,i,o)}),r}_allControlsDisabled(){for(let e of Object.keys(this.controls))if(this.controls[e].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(e){return this.controls.hasOwnProperty(e)?this.controls[e]:null}};var Lg=new J("",{providedIn:"root",factory:()=>Vg}),Vg="always";function rq(n,e){return[...e.path,n]}function Uk(n,e,t=Vg){$k(n,e),e.valueAccessor.writeValue(n.value),(n.disabled||t==="always")&&e.valueAccessor.setDisabledState?.(n.disabled),oq(n,e),aq(n,e),sq(n,e),iq(n,e)}function xk(n,e){n.forEach(t=>{t.registerOnValidatorChange&&t.registerOnValidatorChange(e)})}function iq(n,e){if(e.valueAccessor.setDisabledState){let t=r=>{e.valueAccessor.setDisabledState(r)};n.registerOnDisabledChange(t),e._registerOnDestroy(()=>{n._unregisterOnDisabledChange(t)})}}function $k(n,e){let t=Q7(n);e.validator!==null?n.setValidators(bk(t,e.validator)):typeof t=="function"&&n.setValidators([t]);let r=Z7(n);e.asyncValidator!==null?n.setAsyncValidators(bk(r,e.asyncValidator)):typeof r=="function"&&n.setAsyncValidators([r]);let i=()=>n.updateValueAndValidity();xk(e._rawValidators,i),xk(e._rawAsyncValidators,i)}function oq(n,e){e.valueAccessor.registerOnChange(t=>{n._pendingValue=t,n._pendingChange=!0,n._pendingDirty=!0,n.updateOn==="change"&&zk(n,e)})}function sq(n,e){e.valueAccessor.registerOnTouched(()=>{n._pendingTouched=!0,n.updateOn==="blur"&&n._pendingChange&&zk(n,e),n.updateOn!=="submit"&&n.markAsTouched()})}function zk(n,e){n._pendingDirty&&n.markAsDirty(),n.setValue(n._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(n._pendingValue),n._pendingChange=!1}function aq(n,e){let t=(r,i)=>{e.valueAccessor.writeValue(r),i&&e.viewToModelUpdate(r)};n.registerOnChange(t),e._registerOnDestroy(()=>{n._unregisterOnChange(t)})}function cq(n,e){n==null,$k(n,e)}function lq(n,e){if(!n.hasOwnProperty("model"))return!1;let t=n.model;return t.isFirstChange()?!0:!Object.is(e,t.currentValue)}function uq(n){return Object.getPrototypeOf(n.constructor)===Ad}function dq(n,e){n._syncPendingControls(),e.forEach(t=>{let r=t.control;r.updateOn==="submit"&&r._pendingChange&&(t.viewToModelUpdate(r._pendingValue),r._pendingChange=!1)})}function hq(n,e){if(!e)return null;Array.isArray(e);let t,r,i;return e.forEach(o=>{o.constructor===tr?t=o:uq(o)?r=o:i=o}),i||r||t||null}var fq={provide:$c,useExisting:mn(()=>zi)},Dd=Promise.resolve(),zi=(()=>{class n extends $c{callSetDisabledState;get submitted(){return zr(this.submittedReactive)}_submitted=Ka(()=>this.submittedReactive());submittedReactive=Ha(!1);_directives=new Set;form;ngSubmit=new St;options;constructor(t,r,i){super(),this.callSetDisabledState=i,this.form=new kg({},YI(t),QI(r))}ngAfterViewInit(){this._setUpdateStrategy()}get formDirective(){return this}get control(){return this.form}get path(){return[]}get controls(){return this.form.controls}addControl(t){Dd.then(()=>{let r=this._findContainer(t.path);t.control=r.registerControl(t.name,t.control),Uk(t.control,t,this.callSetDisabledState),t.control.updateValueAndValidity({emitEvent:!1}),this._directives.add(t)})}getControl(t){return this.form.get(t.path)}removeControl(t){Dd.then(()=>{let r=this._findContainer(t.path);r&&r.removeControl(t.name),this._directives.delete(t)})}addFormGroup(t){Dd.then(()=>{let r=this._findContainer(t.path),i=new kg({});cq(i,t),r.registerControl(t.name,i),i.updateValueAndValidity({emitEvent:!1})})}removeFormGroup(t){Dd.then(()=>{let r=this._findContainer(t.path);r&&r.removeControl(t.name)})}getFormGroup(t){return this.form.get(t.path)}updateModel(t,r){Dd.then(()=>{this.form.get(t.path).setValue(r)})}setValue(t){this.control.setValue(t)}onSubmit(t){return this.submittedReactive.set(!0),dq(this.form,this._directives),this.ngSubmit.emit(t),this.form._events.next(new GI(this.control)),t?.target?.method==="dialog"}onReset(){this.resetForm()}resetForm(t=void 0){this.form.reset(t),this.submittedReactive.set(!1),this.form._events.next(new KI(this.form))}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.form._updateOn=this.options.updateOn)}_findContainer(t){return t.pop(),t.length?this.form.get(t):this.form}static \u0275fac=function(r){return new(r||n)(q(ea,10),q(Nk,10),q(Lg,8))};static \u0275dir=Qe({type:n,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(r,i){r&1&&z("submit",function(s){return i.onSubmit(s)})("reset",function(){return i.onReset()})},inputs:{options:[0,"ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],standalone:!1,features:[Fn([fq]),Ht]})}return n})();function Sk(n,e){let t=n.indexOf(e);t>-1&&n.splice(t,1)}function Tk(n){return typeof n=="object"&&n!==null&&Object.keys(n).length===2&&"value"in n&&"disabled"in n}var pq=class extends Rg{defaultValue=null;_onChange=[];_pendingValue;_pendingChange=!1;constructor(e=null,t,r){super(jk(t),Bk(r,t)),this._applyFormState(e),this._setUpdateStrategy(t),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),Fg(t)&&(t.nonNullable||t.initialValueIsDefault)&&(Tk(e)?this.defaultValue=e.value:this.defaultValue=e)}setValue(e,t={}){this.value=this._pendingValue=e,this._onChange.length&&t.emitModelToViewChange!==!1&&this._onChange.forEach(r=>r(this.value,t.emitViewToModelChange!==!1)),this.updateValueAndValidity(t)}patchValue(e,t={}){this.setValue(e,t)}reset(e=this.defaultValue,t={}){this._applyFormState(e),this.markAsPristine(t),this.markAsUntouched(t),this.setValue(this.value,t),this._pendingChange=!1}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){Sk(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){Sk(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return this.updateOn==="submit"&&(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),this._pendingChange)?(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),!0):!1}_applyFormState(e){Tk(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}};var mq={provide:zc,useExisting:mn(()=>Tr)},Dk=Promise.resolve(),Tr=(()=>{class n extends zc{_changeDetectorRef;callSetDisabledState;control=new pq;static ngAcceptInputType_isDisabled;_registered=!1;viewModel;name="";isDisabled;model;options;update=new St;constructor(t,r,i,o,s,a){super(),this._changeDetectorRef=s,this.callSetDisabledState=a,this._parent=t,this._setValidators(r),this._setAsyncValidators(i),this.valueAccessor=hq(this,o)}ngOnChanges(t){if(this._checkForErrors(),!this._registered||"name"in t){if(this._registered&&(this._checkName(),this.formDirective)){let r=t.name.previousValue;this.formDirective.removeControl({name:r,path:this._getPath(r)})}this._setUpControl()}"isDisabled"in t&&this._updateDisabled(t),lq(t,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(t){this.viewModel=t,this.update.emit(t)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!!(this.options&&this.options.standalone)}_setUpStandalone(){Uk(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._checkName()}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),!this._isStandalone()&&this.name}_updateValue(t){Dk.then(()=>{this.control.setValue(t,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(t){let r=t.isDisabled.currentValue,i=r!==0&&ru(r);Dk.then(()=>{i&&!this.control.disabled?this.control.disable():!i&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(t){return this._parent?rq(t,this._parent):[t]}static \u0275fac=function(r){return new(r||n)(q($c,9),q(ea,10),q(Nk,10),q(Hc,10),q(_s,8),q(Lg,8))};static \u0275dir=Qe({type:n,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:[0,"disabled","isDisabled"],model:[0,"ngModel","model"],options:[0,"ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],standalone:!1,features:[Fn([mq]),Ht,ps]})}return n})();var Uo=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275dir=Qe({type:n,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""],standalone:!1})}return n})(),gq={provide:Hc,useExisting:mn(()=>Od),multi:!0},Od=(()=>{class n extends Ad{writeValue(t){let r=t??"";this.setProperty("value",r)}registerOnChange(t){this.onChange=r=>{t(r==""?null:parseFloat(r))}}static \u0275fac=(()=>{let t;return function(i){return(t||(t=Rn(n)))(i||n)}})();static \u0275dir=Qe({type:n,selectors:[["input","type","number","formControlName",""],["input","type","number","formControl",""],["input","type","number","ngModel",""]],hostBindings:function(r,i){r&1&&z("input",function(s){return i.onChange(s.target.value)})("blur",function(){return i.onTouched()})},standalone:!1,features:[Fn([gq]),Ht]})}return n})(),vq={provide:Hc,useExisting:mn(()=>Nd),multi:!0};var _q=(()=>{class n{_accessors=[];add(t,r){this._accessors.push([t,r])}remove(t){for(let r=this._accessors.length-1;r>=0;--r)if(this._accessors[r][1]===t){this._accessors.splice(r,1);return}}select(t){this._accessors.forEach(r=>{this._isSameGroup(r,t)&&r[1]!==t&&r[1].fireUncheck(t.value)})}_isSameGroup(t,r){return t[0].control?t[0]._parent===r._control._parent&&t[1].name===r.name:!1}static \u0275fac=function(r){return new(r||n)};static \u0275prov=H({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),Nd=(()=>{class n extends Ad{_registry;_injector;_state;_control;_fn;setDisabledStateFired=!1;onChange=()=>{};name;formControlName;value;callSetDisabledState=j(Lg,{optional:!0})??Vg;constructor(t,r,i,o){super(t,r),this._registry=i,this._injector=o}ngOnInit(){this._control=this._injector.get(zc),this._checkName(),this._registry.add(this._control,this)}ngOnDestroy(){this._registry.remove(this)}writeValue(t){this._state=t===this.value,this.setProperty("checked",this._state)}registerOnChange(t){this._fn=t,this.onChange=()=>{t(this.value),this._registry.select(this)}}setDisabledState(t){(this.setDisabledStateFired||t||this.callSetDisabledState==="whenDisabledForLegacyCode")&&this.setProperty("disabled",t),this.setDisabledStateFired=!0}fireUncheck(t){this.writeValue(t)}_checkName(){this.name&&this.formControlName&&(this.name,this.formControlName),!this.name&&this.formControlName&&(this.name=this.formControlName)}static \u0275fac=function(r){return new(r||n)(q(Ti),q(Ur),q(_q),q(rt))};static \u0275dir=Qe({type:n,selectors:[["input","type","radio","formControlName",""],["input","type","radio","formControl",""],["input","type","radio","ngModel",""]],hostBindings:function(r,i){r&1&&z("change",function(){return i.onChange()})("blur",function(){return i.onTouched()})},inputs:{name:"name",formControlName:"formControlName",value:"value"},standalone:!1,features:[Fn([vq]),Ht]})}return n})();var yq={provide:Hc,useExisting:mn(()=>$o),multi:!0};function Hk(n,e){return n==null?`${e}`:(e&&typeof e=="object"&&(e="Object"),`${n}: ${e}`.slice(0,50))}function wq(n){return n.split(":")[0]}var $o=(()=>{class n extends Ad{value;_optionMap=new Map;_idCounter=0;set compareWith(t){this._compareWith=t}_compareWith=Object.is;writeValue(t){this.value=t;let r=this._getOptionId(t),i=Hk(r,t);this.setProperty("value",i)}registerOnChange(t){this.onChange=r=>{this.value=this._getOptionValue(r),t(this.value)}}_registerOption(){return(this._idCounter++).toString()}_getOptionId(t){for(let r of this._optionMap.keys())if(this._compareWith(this._optionMap.get(r),t))return r;return null}_getOptionValue(t){let r=wq(t);return this._optionMap.has(r)?this._optionMap.get(r):t}static \u0275fac=(()=>{let t;return function(i){return(t||(t=Rn(n)))(i||n)}})();static \u0275dir=Qe({type:n,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(r,i){r&1&&z("change",function(s){return i.onChange(s.target.value)})("blur",function(){return i.onTouched()})},inputs:{compareWith:"compareWith"},standalone:!1,features:[Fn([yq]),Ht]})}return n})(),Wc=(()=>{class n{_element;_renderer;_select;id;constructor(t,r,i){this._element=t,this._renderer=r,this._select=i,this._select&&(this.id=this._select._registerOption())}set ngValue(t){this._select!=null&&(this._select._optionMap.set(this.id,t),this._setElementValue(Hk(this.id,t)),this._select.writeValue(this._select.value))}set value(t){this._setElementValue(t),this._select&&this._select.writeValue(this._select.value)}_setElementValue(t){this._renderer.setProperty(this._element.nativeElement,"value",t)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}static \u0275fac=function(r){return new(r||n)(q(Ur),q(Ti),q($o,9))};static \u0275dir=Qe({type:n,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"},standalone:!1})}return n})(),Cq={provide:Hc,useExisting:mn(()=>Wk),multi:!0};function Mk(n,e){return n==null?`${e}`:(typeof e=="string"&&(e=`'${e}'`),e&&typeof e=="object"&&(e="Object"),`${n}: ${e}`.slice(0,50))}function bq(n){return n.split(":")[0]}var Wk=(()=>{class n extends Ad{value;_optionMap=new Map;_idCounter=0;set compareWith(t){this._compareWith=t}_compareWith=Object.is;writeValue(t){this.value=t;let r;if(Array.isArray(t)){let i=t.map(o=>this._getOptionId(o));r=(o,s)=>{o._setSelected(i.indexOf(s.toString())>-1)}}else r=(i,o)=>{i._setSelected(!1)};this._optionMap.forEach(r)}registerOnChange(t){this.onChange=r=>{let i=[],o=r.selectedOptions;if(o!==void 0){let s=o;for(let a=0;a<s.length;a++){let c=s[a],u=this._getOptionValue(c.value);i.push(u)}}else{let s=r.options;for(let a=0;a<s.length;a++){let c=s[a];if(c.selected){let u=this._getOptionValue(c.value);i.push(u)}}}this.value=i,t(i)}}_registerOption(t){let r=(this._idCounter++).toString();return this._optionMap.set(r,t),r}_getOptionId(t){for(let r of this._optionMap.keys())if(this._compareWith(this._optionMap.get(r)._value,t))return r;return null}_getOptionValue(t){let r=bq(t);return this._optionMap.has(r)?this._optionMap.get(r)._value:t}static \u0275fac=(()=>{let t;return function(i){return(t||(t=Rn(n)))(i||n)}})();static \u0275dir=Qe({type:n,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(r,i){r&1&&z("change",function(s){return i.onChange(s.target)})("blur",function(){return i.onTouched()})},inputs:{compareWith:"compareWith"},standalone:!1,features:[Fn([Cq]),Ht]})}return n})(),qc=(()=>{class n{_element;_renderer;_select;id;_value;constructor(t,r,i){this._element=t,this._renderer=r,this._select=i,this._select&&(this.id=this._select._registerOption(this))}set ngValue(t){this._select!=null&&(this._value=t,this._setElementValue(Mk(this.id,t)),this._select.writeValue(this._select.value))}set value(t){this._select?(this._value=t,this._setElementValue(Mk(this.id,t)),this._select.writeValue(this._select.value)):this._setElementValue(t)}_setElementValue(t){this._renderer.setProperty(this._element.nativeElement,"value",t)}_setSelected(t){this._renderer.setProperty(this._element.nativeElement,"selected",t)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}static \u0275fac=function(r){return new(r||n)(q(Ur),q(Ti),q(Wk,9))};static \u0275dir=Qe({type:n,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"},standalone:!1})}return n})();function Iq(n){return typeof n=="number"?n:parseInt(n,10)}function qk(n){return typeof n=="number"?n:parseFloat(n)}var Rd=(()=>{class n{_validator=WI;_onChange;_enabled;ngOnChanges(t){if(this.inputName in t){let r=this.normalizeInput(t[this.inputName].currentValue);this._enabled=this.enabled(r),this._validator=this._enabled?this.createValidator(r):WI,this._onChange&&this._onChange()}}validate(t){return this._validator(t)}registerOnValidatorChange(t){this._onChange=t}enabled(t){return t!=null}static \u0275fac=function(r){return new(r||n)};static \u0275dir=Qe({type:n,features:[ps]})}return n})(),Eq={provide:ea,useExisting:mn(()=>ZI),multi:!0},ZI=(()=>{class n extends Rd{max;inputName="max";normalizeInput=t=>qk(t);createValidator=t=>z7(t);static \u0275fac=(()=>{let t;return function(i){return(t||(t=Rn(n)))(i||n)}})();static \u0275dir=Qe({type:n,selectors:[["input","type","number","max","","formControlName",""],["input","type","number","max","","formControl",""],["input","type","number","max","","ngModel",""]],hostVars:1,hostBindings:function(r,i){r&2&&lo("max",i._enabled?i.max:null)},inputs:{max:"max"},standalone:!1,features:[Fn([Eq]),Ht]})}return n})(),xq={provide:ea,useExisting:mn(()=>kd),multi:!0},kd=(()=>{class n extends Rd{min;inputName="min";normalizeInput=t=>qk(t);createValidator=t=>$7(t);static \u0275fac=(()=>{let t;return function(i){return(t||(t=Rn(n)))(i||n)}})();static \u0275dir=Qe({type:n,selectors:[["input","type","number","min","","formControlName",""],["input","type","number","min","","formControl",""],["input","type","number","min","","ngModel",""]],hostVars:1,hostBindings:function(r,i){r&2&&lo("min",i._enabled?i.min:null)},inputs:{min:"min"},standalone:!1,features:[Fn([xq]),Ht]})}return n})(),Sq={provide:ea,useExisting:mn(()=>Hi),multi:!0};var Hi=(()=>{class n extends Rd{required;inputName="required";normalizeInput=ru;createValidator=t=>H7;enabled(t){return t}static \u0275fac=(()=>{let t;return function(i){return(t||(t=Rn(n)))(i||n)}})();static \u0275dir=Qe({type:n,selectors:[["","required","","formControlName","",3,"type","checkbox"],["","required","","formControl","",3,"type","checkbox"],["","required","","ngModel","",3,"type","checkbox"]],hostVars:1,hostBindings:function(r,i){r&2&&lo("required",i._enabled?"":null)},inputs:{required:"required"},standalone:!1,features:[Fn([Sq]),Ht]})}return n})();var Tq={provide:ea,useExisting:mn(()=>JI),multi:!0},JI=(()=>{class n extends Rd{maxlength;inputName="maxlength";normalizeInput=t=>Iq(t);createValidator=t=>W7(t);static \u0275fac=(()=>{let t;return function(i){return(t||(t=Rn(n)))(i||n)}})();static \u0275dir=Qe({type:n,selectors:[["","maxlength","","formControlName",""],["","maxlength","","formControl",""],["","maxlength","","ngModel",""]],hostVars:1,hostBindings:function(r,i){r&2&&lo("maxlength",i._enabled?i.maxlength:null)},inputs:{maxlength:"maxlength"},standalone:!1,features:[Fn([Tq]),Ht]})}return n})(),Dq={provide:ea,useExisting:mn(()=>Fd),multi:!0},Fd=(()=>{class n extends Rd{pattern;inputName="pattern";normalizeInput=t=>t;createValidator=t=>q7(t);static \u0275fac=(()=>{let t;return function(i){return(t||(t=Rn(n)))(i||n)}})();static \u0275dir=Qe({type:n,selectors:[["","pattern","","formControlName",""],["","pattern","","formControl",""],["","pattern","","ngModel",""]],hostVars:1,hostBindings:function(r,i){r&2&&lo("pattern",i._enabled?i.pattern:null)},inputs:{pattern:"pattern"},standalone:!1,features:[Fn([Dq]),Ht]})}return n})();var Mq=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275mod=$r({type:n});static \u0275inj=jr({})}return n})();var Mn=(()=>{class n{static withConfig(t){return{ngModule:n,providers:[{provide:Lg,useValue:t.callSetDisabledState??Vg}]}}static \u0275fac=function(r){return new(r||n)};static \u0275mod=$r({type:n});static \u0275inj=jr({imports:[Mq]})}return n})();function Pq(n,e){if(n&1){let t=de();m(0,"div",15)(1,"button",16),z("click",function(){B(t);let i=A();return U(i.installApp())}),K(2,"i",17),y(3," Install App "),g()()}}function Aq(n,e){if(n&1&&(m(0,"p",18),y(1),g()),n&2){let t=A();I(),se(t.errorMessage)}}var jg=class n{constructor(e,t){this.auth=e;this.router=t}email="";password="";errorMessage="";deferredPrompt=null;showInstallButton=!1;ngOnInit(){window.addEventListener("beforeinstallprompt",e=>{e.preventDefault(),this.deferredPrompt=e,this.showInstallButton=!0}),window.addEventListener("appinstalled",()=>{this.showInstallButton=!1,this.deferredPrompt=null})}installApp(){return w(this,null,function*(){if(this.deferredPrompt){this.deferredPrompt.prompt();let{outcome:e}=yield this.deferredPrompt.userChoice;console.log(e==="accepted"?"\u2705 PWA installed successfully":"\u274C PWA installation dismissed"),this.deferredPrompt=null,this.showInstallButton=!1}})}login(){return w(this,null,function*(){this.errorMessage="";try{let e=yield NO(this.auth,this.email,this.password);console.log("\u2705 Logged in:",e.user);let t=e.user,r={username:t.displayName||t.email?.split("@")[0]||"User",email:t.email,uid:t.uid};localStorage.setItem("currentUser",JSON.stringify(r)),localStorage.setItem("username",r.username),this.errorMessage="login successful",this.router.navigate(["/dashboard"])}catch(e){console.error("\u274C Login error:",e.message),this.errorMessage="Invalid email or password"}})}static \u0275fac=function(t){return new(t||n)(q(Ls),q(it))};static \u0275cmp=Pt({type:n,selectors:[["app-login"]],decls:23,vars:4,consts:[[1,"login-container"],["class","install-prompt",4,"ngIf"],[3,"ngSubmit"],[1,"logo-section"],["src","logo.jpg","alt","CA India Logo",1,"app-logo"],[1,"app-title"],[1,"form-group"],["for","email"],["id","email","type","email","name","email","placeholder","Type your username","required","",3,"ngModelChange","ngModel"],["for","password"],["id","password","type","password","name","password","placeholder","Type your password","required","",3,"ngModelChange","ngModel"],[1,"forgot-password"],["href","#"],["type","submit"],["class","error",4,"ngIf"],[1,"install-prompt"],["type","button",1,"install-btn",3,"click"],[1,"fas","fa-download"],[1,"error"]],template:function(t,r){t&1&&(m(0,"div",0),ie(1,Pq,4,0,"div",1),m(2,"form",2),z("ngSubmit",function(){return r.login()}),m(3,"div",3),K(4,"img",4),m(5,"h1",5),y(6,"Global Financial Services"),g()(),m(7,"h2"),y(8,"Login"),g(),m(9,"div",6)(10,"label",7),y(11,"Username"),g(),m(12,"input",8),ne("ngModelChange",function(o){return re(r.email,o)||(r.email=o),o}),g()(),m(13,"div",6)(14,"label",9),y(15,"Password"),g(),m(16,"input",10),ne("ngModelChange",function(o){return re(r.password,o)||(r.password=o),o}),g(),m(17,"div",11)(18,"a",12),y(19,"Forgot password?"),g()()(),m(20,"button",13),y(21,"LOGIN"),g()(),ie(22,Aq,2,1,"p",14),g()),t&2&&(I(),V("ngIf",r.showInstallButton),I(11),te("ngModel",r.email),I(4),te("ngModel",r.password),I(6),V("ngIf",r.errorMessage))},dependencies:[Ot,Wt,Mn,Uo,tr,pi,Bo,Hi,Tr,zi],styles:["[_nghost-%COMP%]{display:flex;justify-content:center;align-items:center;min-height:100vh;padding:60px 20px;background:#f8f9fa;font-family:Roboto,sans-serif}.login-container[_ngcontent-%COMP%]{width:100%;max-width:400px;padding:40px;border-radius:15px;background-color:#fff;box-shadow:0 10px 30px #0000001a;text-align:center}h2[_ngcontent-%COMP%]{color:#333;margin-bottom:30px;font-size:28px;font-weight:600}.form-group[_ngcontent-%COMP%]{margin-bottom:20px;text-align:center}label[_ngcontent-%COMP%]{display:block;margin-bottom:8px;color:#555;font-size:14px;font-weight:500;text-align:left}input[_ngcontent-%COMP%]{width:100%;padding:15px 20px;border:1px solid #e0e0e0;border-radius:8px;font-size:14px;box-sizing:border-box;outline:none;transition:all .3s ease;background:#f8f9fa}input[_ngcontent-%COMP%]:focus{border-color:#28a745;box-shadow:0 0 10px #28a7454d;background:#fff}input[_ngcontent-%COMP%]::placeholder{color:#aaa}button[_ngcontent-%COMP%]{width:100%;padding:15px;background:#28a745;color:#fff;border:none;border-radius:8px;cursor:pointer;font-size:16px;font-weight:600;margin-top:20px;transition:all .3s ease;text-transform:uppercase;letter-spacing:1px}button[_ngcontent-%COMP%]:hover{background:#218838;transform:translateY(-2px);box-shadow:0 10px 20px #28a7454d}.error[_ngcontent-%COMP%]{color:#e74c3c;margin-top:15px;font-size:14px;text-align:center}.forgot-password[_ngcontent-%COMP%]{text-align:center;margin-top:10px}.forgot-password[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#28a745;text-decoration:none;font-size:12px}.forgot-password[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{text-decoration:underline}.logo-section[_ngcontent-%COMP%]{margin-bottom:30px;text-align:center}.app-logo[_ngcontent-%COMP%]{width:80px;height:80px;border-radius:12px;margin-bottom:15px;box-shadow:0 4px 12px #0000001a;object-fit:cover}.app-title[_ngcontent-%COMP%]{color:#2c3e50;font-size:24px;font-weight:700;margin:0 0 10px;background:linear-gradient(135deg,#667eea,#764ba2);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text}.install-prompt[_ngcontent-%COMP%]{margin-bottom:20px;padding:10px;background:linear-gradient(135deg,#667eea,#764ba2);border-radius:10px;animation:_ngcontent-%COMP%_pulse 2s infinite}.install-btn[_ngcontent-%COMP%]{background:transparent;border:2px solid #ffffff;color:#fff;padding:12px 24px;border-radius:8px;font-size:14px;font-weight:600;cursor:pointer;transition:all .3s ease;width:100%;display:flex;align-items:center;justify-content:center;gap:8px}.install-btn[_ngcontent-%COMP%]:hover{background:#fff;color:#667eea;transform:translateY(-2px)}.install-btn[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:16px}@keyframes _ngcontent-%COMP%_pulse{0%{box-shadow:0 0 #667eeab3}70%{box-shadow:0 0 0 10px #667eea00}to{box-shadow:0 0 #667eea00}}"]})};var mi=class n{constructor(){}generateInvoicePDF(e){let t=new jv,r=8,i=e.serviceDetails.length>r;this.generateFirstPage(t,e,i),i&&this.generateSecondPage(t,e,r);let o=(e.customer?.name||"Customer").replace(/[^a-zA-Z0-9]/g,"_");t.save(`${o}_${e.invoiceNumber}.pdf`)}generateFirstPage(e,t,r){this.addPageBorder(e),this.addCompanyHeader(e),this.addCustomerDetails(e,t);let i=this.addServicesTable(e,t,r,0);if(r)e.setFontSize(10),e.setFont("helvetica","italic"),e.text("Continued on next page...",105,260,{align:"center"});else{let o=this.addTotalSection(e,t,i),s=this.addPaymentSection(e,t,o);this.addBankDetailsSection(e,t,s)}}generateSecondPage(e,t,r){e.addPage(),e.setFontSize(16),e.setFont("helvetica","bold"),e.setTextColor(52,152,219),e.text("GLOBAL FINANCIAL SERVICES",105,20,{align:"center"}),e.setFontSize(12),e.text("INVOICE (Continued)",105,30,{align:"center"}),e.setFontSize(10),e.setTextColor(0,0,0),e.setFont("helvetica","normal"),e.text(`Invoice No: ${t.invoiceNumber}`,105,40,{align:"center"});let i=this.addServicesTable(e,t,!1,r,50),o=this.addTotalSection(e,t,i),s=this.addPaymentSection(e,t,o);this.addBankDetailsSection(e,t,s)}addPageBorder(e){e.setLineWidth(.5),e.setDrawColor(200,200,200),e.rect(10,10,190,277)}addCompanyHeader(e){e.setFont("helvetica"),e.setFontSize(20),e.setTextColor(52,152,219),e.text("GLOBAL FINANCIAL SERVICES",105,25,{align:"center"}),e.setFontSize(14),e.setTextColor(40,167,69),e.text("ACCOUNTING & FINANCIAL SERVICES",105,35,{align:"center"}),e.setFontSize(10),e.setTextColor(0,0,0),e.text("Flat No. 602, Ashirvad Symphani, Meera Datar Road, Near K K Wagh College,",105,45,{align:"center"}),e.text("Panchavati, Nashik - 422003.",105,52,{align:"center"}),e.setFontSize(9),e.text("Cell : 9623736781    |    Cell : 9604722533",105,60,{align:"center"}),e.setFillColor(0,0,0),e.rect(15,70,180,10,"F"),e.setTextColor(255,255,255),e.setFontSize(14),e.setFont("helvetica","bold"),e.text("INVOICE",105,78,{align:"center"})}addCustomerDetails(e,t){if(e.setFont("helvetica","normal"),e.setTextColor(0,0,0),e.setFontSize(10),e.setLineWidth(.3),e.setDrawColor(150,150,150),e.rect(15,85,120,30),e.rect(135,85,60,30),e.setFont("helvetica","bold"),e.text("TO,",18,93),e.setFont("helvetica","normal"),t.customer){let r=this.formatCustomerAddress(t.customer),i=100;r.forEach(o=>{e.splitTextToSize(o,114).forEach(c=>{i<112&&(e.text(c,18,i),i+=4)})})}e.setFont("helvetica","bold"),e.text("Invoice No.",138,93),e.text("Date",138,100),e.setFont("helvetica","normal"),e.text(": "+t.invoiceNumber,163,93),e.text(": "+this.formatDate(t.invoiceDate),163,100)}addServicesTable(e,t,r,i=0,o=120){let s=o;e.setLineWidth(.3),e.setDrawColor(150,150,150),e.rect(15,s,180,10),e.setFillColor(248,249,250),e.rect(15,s,180,10,"F"),e.setFontSize(10),e.setFont("helvetica","bold"),o===120?e.text("Fees for Professional services rendered as under :",18,s+7):e.text("Services (Continued) :",18,s+7),s+=10,e.setLineWidth(.3),e.setDrawColor(150,150,150),e.rect(15,s,180,8),e.rect(15,s,20,8),e.rect(35,s,110,8),e.rect(145,s,50,8),e.setFont("helvetica","bold"),e.text("No.",23,s+5),e.text("Particulars",85,s+5),e.text("Amount",165,s+5),s+=8,e.setFont("helvetica","normal");let a;if(r?a=t.serviceDetails.slice(0,Math.min(8,t.serviceDetails.length)):a=t.serviceDetails.slice(i),a.forEach((c,u)=>{let d=r?u:i+u,f=12;e.setLineWidth(.2),e.setDrawColor(180,180,180),e.rect(15,s,180,f),e.rect(15,s,20,f),e.rect(35,s,110,f),e.rect(145,s,50,f),e.text((d+1).toString(),25,s+8);let v=c.description;c.description==="custom"&&c.customDescription&&(v=c.customDescription),v=v+(c.notes?` (${c.notes})`:"");let b=e.splitTextToSize(v,105);b.length===1?e.text(b[0],38,s+8):(e.text(b[0],38,s+5),b[1]&&b[1].trim()&&e.text(b[1],38,s+10));let N=this.formatAmount(c.amount),R=e.getTextWidth(N);e.text(N,190-R,s+8),s+=f}),!r||t.serviceDetails.length<=8){let u=a.length;for(let d=u;d<6;d++)e.setLineWidth(.2),e.setDrawColor(180,180,180),e.rect(15,s,180,12),e.rect(15,s,20,12),e.rect(35,s,110,12),e.rect(145,s,50,12),s+=12}return s}addTotalSection(e,t,r){let i=r,o=12;e.setLineWidth(.3),e.setDrawColor(150,150,150),e.rect(15,i,180,o),e.rect(15,i,125,o),e.rect(140,i,55,o),e.setFont("helvetica","bold"),e.text("TOTAL",142,i+8);let s=this.formatAmount(t.totalAmount),a=e.getTextWidth(s);return e.text(s,190-a,i+8),i+o}addPaymentSection(e,t,r){let i=r,o=18;e.setLineWidth(.3),e.setDrawColor(150,150,150),e.rect(15,i,120,o),e.rect(135,i,60,o),e.rect(135,i,30,6),e.rect(165,i,30,6),e.rect(135,i+6,30,6),e.rect(165,i+6,30,6),e.rect(135,i+12,30,6),e.rect(165,i+12,30,6),e.setFont("helvetica","normal");let a="Amount in words : "+this.convertAmountToWords(t.totalAmount),u=e.splitTextToSize(a,115),d=i+6;u.forEach(N=>{d<i+16&&(e.text(N,18,d),d+=3.5)}),e.setFont("helvetica","bold"),e.text("Advance Rec.",137,i+4),e.text("Bill Amt.",137,i+10),e.text("Net Bal.",137,i+16),e.setFont("helvetica","normal");let f=190,v=this.formatAmount(t.advanceReceived),_=this.formatAmount(t.totalAmount),b=this.formatAmount(t.balancePayable);return e.text(v,f-e.getTextWidth(v),i+4),e.text(_,f-e.getTextWidth(_),i+10),e.setFont("helvetica","bold"),e.text(b,f-e.getTextWidth(b),i+16),i+o}addBankDetailsSection(e,t,r){let i=r+5,o=30;i+o>280&&(i=240),e.setLineWidth(.3),e.setDrawColor(150,150,150),e.rect(15,i,120,o),e.rect(135,i,60,o),e.setFont("helvetica","bold"),e.text("Bank Details :",18,i+7),e.setFont("helvetica","normal");let s=this.extractBankDetails(t.selectedBank);e.text("Bank Name : "+s.name,18,i+12),e.text("A/c Holder Name : Global Financial Services",18,i+17),e.text("A/c No. : "+s.accountNumber,18,i+22),e.text("IFSC Code : "+s.ifscCode,18,i+27),e.setTextColor(52,152,219),e.setFont("helvetica","bold"),e.text("for GLOBAL FINANCIAL",140,i+8),e.text("SERVICES",155,i+14),e.setTextColor(0,0,0),e.setFont("helvetica","normal"),e.text("Authorised Signatory",145,i+27);let a=i+o+5;return a<285&&(e.setFontSize(8),e.setTextColor(100,100,100),e.text("Thank you for your business!",105,a,{align:"center"})),a}formatCustomerAddress(e){let t=[];return t.push(e.name),e.mobile&&t.push("Mobile: "+e.mobile),e.email&&t.push("Email: "+e.email),e.address&&t.push("Address: "+e.address),e.gst&&t.push("GST: "+e.gst),t}formatDate(e){return new Date(e).toLocaleDateString("en-IN")}formatAmount(e){return e.toLocaleString("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2})}convertAmountToWords(e){let t=["","One","Two","Three","Four","Five","Six","Seven","Eight","Nine"],r=["Ten","Eleven","Twelve","Thirteen","Fourteen","Fifteen","Sixteen","Seventeen","Eighteen","Nineteen"],i=["","","Twenty","Thirty","Forty","Fifty","Sixty","Seventy","Eighty","Ninety"];if(e===0)return"Zero Rupees Only";let o=Math.floor(e),s=Math.round((e-o)*100),a=this.convertIntegerToWords(o,t,r,i);return a+=" Rupees",s>0&&(a+=" and "+this.convertIntegerToWords(s,t,r,i)+" Paise"),a+=" Only",a}convertIntegerToWords(e,t,r,i){if(e===0)return"";let o="";return e>=1e7&&(o+=this.convertIntegerToWords(Math.floor(e/1e7),t,r,i)+" Crore ",e%=1e7),e>=1e5&&(o+=this.convertIntegerToWords(Math.floor(e/1e5),t,r,i)+" Lakh ",e%=1e5),e>=1e3&&(o+=this.convertIntegerToWords(Math.floor(e/1e3),t,r,i)+" Thousand ",e%=1e3),e>=100&&(o+=t[Math.floor(e/100)]+" Hundred ",e%=100),e>=20?(o+=i[Math.floor(e/10)]+" ",e%=10):e>=10&&(o+=r[e-10]+" ",e=0),e>0&&(o+=t[e]+" "),o.trim()}extractBankDetails(e){let t={"HDFC Bank":{name:"HDFC Bank",accountNumber:"12345678901234",ifscCode:"HDFC0001234"},"SBI Bank":{name:"State Bank of India",accountNumber:"98765432109876",ifscCode:"SBIN0001234"},"ICICI Bank":{name:"ICICI Bank",accountNumber:"11223344556677",ifscCode:"ICIC0001234"},"PNB Bank":{name:"Punjab National Bank",accountNumber:"55667788990011",ifscCode:"PUNB0001234"}};return t[e]||t["HDFC Bank"]}shareOnWhatsApp(e){let r=`${(e.customer?.name||"Customer").replace(/[^a-zA-Z0-9]/g,"_")}_${e.invoiceNumber}.pdf`,i=`Invoice Details:
Invoice No: ${e.invoiceNumber}
Customer: ${e.customer.name}
Amount: \u20B9${e.totalAmount.toLocaleString("en-IN")}
Balance: \u20B9${e.balancePayable.toLocaleString("en-IN")}`,o=new jv;this.generateInvoicePDF(e);let s=o.output("blob");if(navigator.share&&navigator.canShare&&navigator.canShare({files:[new File([s],r,{type:"application/pdf"})]}))navigator.share({title:"Invoice",text:i,files:[new File([s],r,{type:"application/pdf"})]}).catch(()=>{alert("Sharing cancelled or not supported.")});else{let c=`https://wa.me/?text=${encodeURIComponent(i)}`;window.open(c,"_blank"),/iphone|ipad|ipod/i.test(navigator.userAgent)&&alert("On iPhone, you must use the share sheet to send the PDF via WhatsApp. Direct sharing is not supported by iOS PWAs.")}}static \u0275fac=function(t){return new(t||n)};static \u0275prov=H({token:n,factory:n.\u0275fac,providedIn:"root"})};var gi=class n{constructor(e){this.firestore=e;this.customersCollection=sn(this.firestore,"customers")}customersCollection;PAGE_SIZE=10;addCustomer(e){return w(this,null,function*(){try{let t=le(L({},e),{createdAt:new Date,updatedAt:new Date});return(yield Er(this.customersCollection,t)).id}catch(t){throw console.error("Error adding customer:",t),t}})}getCustomers(){return w(this,null,function*(){try{let e=Sr(this.customersCollection,$i("createdAt","asc"));return(yield xr(e)).docs.map(r=>L({id:r.id},r.data()))}catch(e){throw console.error("Error getting customers:",e),e}})}updateCustomer(e,t){return w(this,null,function*(){try{let r=Yt(this.firestore,"customers",e);yield fi(r,le(L({},t),{updatedAt:new Date}))}catch(r){throw console.error("Error updating customer:",r),r}})}deleteCustomer(e){return w(this,null,function*(){try{let t=Yt(this.firestore,"customers",e);yield hi(t)}catch(t){throw console.error("Error deleting customer:",t),t}})}getCustomerById(e){return w(this,null,function*(){try{return(yield this.getCustomers()).find(r=>r.id===e)||null}catch(t){throw console.error("Error getting customer by ID:",t),t}})}searchCustomers(e){return w(this,null,function*(){try{return(yield this.getCustomers()).filter(r=>r.name.toLowerCase().includes(e.toLowerCase())||r.mobile.includes(e)||r.email.toLowerCase().includes(e.toLowerCase()))}catch(t){throw console.error("Error searching customers:",t),t}})}static \u0275fac=function(t){return new(t||n)(ee(Kt))};static \u0275prov=H({token:n,factory:n.\u0275fac,providedIn:"root"})};var nr=class n{constructor(e){this.firestore=e;this.invoicesCollection=sn(this.firestore,"invoices")}invoicesCollection;PAGE_SIZE=10;addInvoice(e){return w(this,null,function*(){try{let t=le(L({},e),{createdAt:new Date,updatedAt:new Date});return(yield Er(this.invoicesCollection,t)).id}catch(t){throw console.error("Error adding invoice:",t),t}})}getInvoices(){return w(this,null,function*(){try{let e=Sr(this.invoicesCollection,$i("createdAt","desc"));return(yield xr(e)).docs.map(r=>L({id:r.id},r.data()))}catch(e){throw console.error("Error getting invoices:",e),e}})}getInvoiceById(e){return w(this,null,function*(){try{return(yield this.getInvoices()).find(r=>r.id===e)||null}catch(t){throw console.error("Error getting invoice by ID:",t),t}})}updateInvoice(e,t){return w(this,null,function*(){try{let r=Yt(this.firestore,"invoices",e);yield fi(r,le(L({},t),{updatedAt:new Date}))}catch(r){throw console.error("Error updating invoice:",r),r}})}deleteInvoice(e){return w(this,null,function*(){try{let t=Yt(this.firestore,"invoices",e);yield hi(t)}catch(t){throw console.error("Error deleting invoice:",t),t}})}searchInvoices(e){return w(this,null,function*(){try{return(yield this.getInvoices()).filter(r=>r.invoiceNumber.toLowerCase().includes(e.toLowerCase())||r.customer.name.toLowerCase().includes(e.toLowerCase())||r.customer.mobile.includes(e))}catch(t){throw console.error("Error searching invoices:",t),t}})}getInvoicesByStatus(e){return w(this,null,function*(){try{return(yield this.getInvoices()).filter(r=>r.status===e)}catch(t){throw console.error("Error getting invoices by status:",t),t}})}getTotalRevenue(){return w(this,null,function*(){try{return(yield this.getInvoices()).reduce((t,r)=>t+r.totalAmount,0)}catch(e){return console.error("Error getting total revenue:",e),0}})}getPendingAmount(){return w(this,null,function*(){try{return(yield this.getInvoices()).filter(t=>t.status==="PENDING"||t.status==="PARTIAL").reduce((t,r)=>t+r.balancePayable,0)}catch(e){return console.error("Error getting pending amount:",e),0}})}generateNextInvoiceNumber(e){return w(this,null,function*(){try{console.log("\u{1F522} Generating invoice number for date:",e);let t=yield this.getInvoices(),r=new Date(e),i=r.getFullYear(),o=String(r.getMonth()+1).padStart(2,"0"),s=`${i}${o}`;console.log("\u{1F4C5} Year-Month:",s),console.log("\u{1F4CB} Total invoices found:",t.length);let a=t.filter(v=>{let _=v.invoiceDate.split("-"),b=_[0],N=_[1];return`${b}${N}`===s});console.log("\u{1F4C5} Current month invoices:",a.length);let c=0;a.forEach(v=>{console.log("\u{1F50D} Checking invoice number:",v.invoiceNumber);let _=v.invoiceNumber.match(/INV-\d{6}-(\d{4})/);if(_){let b=parseInt(_[1],10);console.log("\u{1F4CA} Found sequence:",b),c=Math.max(c,b)}});let u=c+1,d=String(u).padStart(4,"0"),f=`INV-${s}-${d}`;return console.log("\u{1F3AF} Max sequence found:",c),console.log("\u2728 Generated invoice number:",f),f}catch(t){console.error("\u274C Error generating invoice number:",t);let r=new Date(e),i=r.getFullYear(),o=String(r.getMonth()+1).padStart(2,"0"),s=Date.now().toString().slice(-4),a=`INV-${i}${o}-${s}`;return console.log("\u{1F504} Fallback invoice number:",a),a}})}static \u0275fac=function(t){return new(t||n)(ee(Kt))};static \u0275prov=H({token:n,factory:n.\u0275fac,providedIn:"root"})};function Oq(n,e){if(n&1&&(m(0,"div",36)(1,"h3"),y(2,"Monthly Revenue Overview"),g(),m(3,"div",37)(4,"div",38)(5,"h4"),y(6,"This Month"),g(),m(7,"div",39),y(8),Ve(9,"number"),g(),m(10,"div",40),y(11,"Current period"),g()(),m(12,"div",38)(13,"h4"),y(14,"Outstanding"),g(),m(15,"div",39),y(16),Ve(17,"number"),g(),m(18,"div",41),y(19,"Pending collection"),g()(),m(20,"div",38)(21,"h4"),y(22,"Collection Rate"),g(),m(23,"div",39),y(24),Ve(25,"number"),g(),m(26,"div",41),y(27,"Efficiency rate"),g()()(),m(28,"div",42)(29,"h4"),y(30,"Monthly Revenue Trend"),g(),m(31,"div",43)(32,"p"),y(33,"\u{1F4CA} Chart will display monthly revenue trends"),g(),m(34,"small"),y(35,"Integration with charting library can be added here"),g()()()()),n&2){let t=A();I(8),pe("\u20B9",je(9,3,t.totalRevenue,"1.2-2"),""),I(8),pe("\u20B9",je(17,6,t.outstandingAmount,"1.2-2"),""),I(8),pe("",je(25,9,t.collectionRate,"1.1-1"),"%")}}function Nq(n,e){if(n&1&&(m(0,"div",47)(1,"span",48),y(2),g(),m(3,"span",39),y(4,"\u20B90.00"),g(),m(5,"span",49),y(6,"0"),g(),m(7,"span",50),y(8,"\u20B90.00"),g()()),n&2){let t=e.$implicit;I(2),se(t.name)}}function Rq(n,e){if(n&1&&(m(0,"div",36)(1,"h3"),y(2,"Customer Revenue Analysis"),g(),m(3,"div",44)(4,"div",45)(5,"span"),y(6,"Customer"),g(),m(7,"span"),y(8,"Total Revenue"),g(),m(9,"span"),y(10,"Invoices"),g(),m(11,"span"),y(12,"Outstanding"),g()(),ie(13,Nq,9,1,"div",46),g()()),n&2){let t=A();I(13),V("ngForOf",t.customers)}}function kq(n,e){n&1&&(m(0,"div",36)(1,"h3"),y(2,"Revenue Reports & Analytics"),g(),m(3,"div",51)(4,"div",52)(5,"h4"),y(6,"\u{1F4CA} Income Statement"),g(),m(7,"p"),y(8,"Detailed breakdown of revenue, expenses, and profit"),g(),m(9,"button",53),y(10,"Generate Report"),g()(),m(11,"div",52)(12,"h4"),y(13,"\u{1F4C8} Revenue Growth"),g(),m(14,"p"),y(15,"Year-over-year and month-over-month growth analysis"),g(),m(16,"button",53),y(17,"Generate Report"),g()(),m(18,"div",52)(19,"h4"),y(20,"\u{1F4B0} Payment Analytics"),g(),m(21,"p"),y(22,"Payment patterns, collection efficiency, and aging analysis"),g(),m(23,"button",53),y(24,"Generate Report"),g()(),m(25,"div",52)(26,"h4"),y(27,"\u{1F4CB} Tax Summary"),g(),m(28,"p"),y(29,"GST and tax summaries for compliance reporting"),g(),m(30,"button",53),y(31,"Generate Report"),g()()()())}function Fq(n,e){n&1&&(m(0,"li"),K(1,"i",16),y(2," Interactive monthly revenue charts "),g())}function Lq(n,e){n&1&&(m(0,"li"),K(1,"i",17),y(2," Year-over-year comparisons "),g())}function Vq(n,e){n&1&&(m(0,"li"),K(1,"i",6),y(2," Customer-wise revenue breakdown "),g())}function jq(n,e){n&1&&(m(0,"li"),K(1,"i",69),y(2," Top customer analytics "),g())}function Bq(n,e){n&1&&(m(0,"li"),K(1,"i",70),y(2," Downloadable PDF reports "),g())}function Uq(n,e){n&1&&(m(0,"li"),K(1,"i",71),y(2," Advanced filtering options "),g())}function $q(n,e){if(n&1){let t=de();m(0,"div",54),z("click",function(){B(t);let i=A();return U(i.closeComingSoonPopup())}),m(1,"div",55),z("click",function(i){return B(t),U(i.stopPropagation())}),m(2,"div",56)(3,"div",57),K(4,"i",58),g(),m(5,"button",59),z("click",function(){B(t);let i=A();return U(i.closeComingSoonPopup())}),K(6,"i",60),g()(),m(7,"div",61)(8,"h2"),y(9,"Coming Soon!"),g(),m(10,"h3"),y(11),g(),m(12,"p"),y(13,"We're working hard to bring you this exciting feature. It will include:"),g(),m(14,"ul",62),ie(15,Fq,3,0,"li",63)(16,Lq,3,0,"li",63)(17,Vq,3,0,"li",63)(18,jq,3,0,"li",63)(19,Bq,3,0,"li",63)(20,Uq,3,0,"li",63),m(21,"li"),K(22,"i",64),y(23," Mobile-optimized interface"),g(),m(24,"li"),K(25,"i",29),y(26," Real-time data updates"),g()(),m(27,"div",65)(28,"p",66),y(29,"Expected release: "),m(30,"strong"),y(31,"Next Update"),g()(),m(32,"button",67),z("click",function(){B(t);let i=A();return U(i.closeComingSoonPopup())}),K(33,"i",68),y(34," Got it! "),g()()()()()}if(n&2){let t=A();I(11),se(t.comingSoonFeature),I(4),V("ngIf",t.comingSoonFeature.includes("Monthly")),I(),V("ngIf",t.comingSoonFeature.includes("Monthly")),I(),V("ngIf",t.comingSoonFeature.includes("Customer")),I(),V("ngIf",t.comingSoonFeature.includes("Customer")),I(),V("ngIf",t.comingSoonFeature.includes("Reports")),I(),V("ngIf",t.comingSoonFeature.includes("Reports"))}}var $g=class n{constructor(e,t,r,i,o){this.router=e;this.route=t;this.pdfService=r;this.customerService=i;this.invoiceService=o;this.initializeInvoices()}activeCategory=null;activeSection=null;isRevenueMode=!1;showComingSoonPopup=!1;comingSoonFeature="";totalRevenue=0;outstandingAmount=0;collectionRate=0;totalCustomers=0;totalInvoices=0;newCustomer={customerType:"individual",prefix:"Mr.",firstName:"",middleName:"",lastName:"",companyName:"",companyType:"",mobile:"",countryCode:"+91",gst:"",email:"",flatNumber:"",buildingName:"",streetName:"",village:"",taluka:"",district:"",pincode:""};customers=[];invoices=[];invoiceSearchTerm="";filteredInvoices=[];selectedInvoiceStatus="ALL";invoice={invoiceNumber:"",invoiceDate:this.getCurrentDate(),customer:null,customerType:"existing",searchTerm:"",serviceDetails:[{description:"",amount:0,notes:""}],totalAmount:0,advanceReceived:0,balancePayable:0,selectedBank:""};searchResults=[];showAddCustomerForm=!1;showCustomerSearch=!1;newInvoiceCustomer={id:"",customerType:"individual",prefix:"Mr.",firstName:"",middleName:"",lastName:"",companyName:"",companyType:"",mobile:"",countryCode:"+91",gst:"",email:"",flatNumber:"",buildingName:"",streetName:"",village:"",taluka:"",district:"",pincode:""};bankAccounts=["HDFC Bank - Current Account (****1234)","ICICI Bank - Savings Account (****5678)","SBI Bank - Current Account (****9012)","Axis Bank - Current Account (****3456)"];companyTypes=["Private Limited Company (Pvt Ltd)","Farmer Producer Company Limited (FPCL)","Limited Liability Partnership (LLP)","Partnership Firm","Sole Proprietorship","Public Limited Company","One Person Company (OPC)","Section 8 Company (NGO)","Producer Company","Trust","Society","Hindu Undivided Family (HUF)"];serviceOptions=["Incorporation of Producer Company","ITR Filing","GST Filing","Company Registration","GST Registration","Income Tax Return","Audit Services","Compliance Services","Other Services"];ngOnInit(){return w(this,null,function*(){this.route.queryParams.subscribe(e=>{e.category&&(this.activeCategory=e.category)}),yield this.loadCustomers(),yield this.loadInvoices(),this.calculateStats(),this.invoice.invoiceNumber=yield this.invoiceService.generateNextInvoiceNumber(this.invoice.invoiceDate)})}loadCustomers(){return w(this,null,function*(){try{this.customers=yield this.customerService.getCustomers()}catch(e){console.error("Error loading customers:",e)}})}loadInvoices(){return w(this,null,function*(){try{this.invoices=yield this.invoiceService.getInvoices()}catch(e){console.error("Error loading invoices:",e)}})}setActiveCategory(e){this.activeCategory=e,this.activeSection=null}toggleCategory(e){this.activeCategory===e?this.activeCategory=null:this.activeCategory=e,this.activeSection=null}setActiveSection(e){let t={monthlyRevenue:"Monthly Revenue Analytics",customerRevenue:"Customer Revenue Analysis",revenueReports:"Revenue Reports & Analytics"};e&&t[e]&&(this.comingSoonFeature=t[e],this.showComingSoonPopup=!0)}closeComingSoonPopup(){this.showComingSoonPopup=!1,this.comingSoonFeature=""}get totalDueAmount(){return this.customers.reduce((e,t)=>e+t.dueAmount,0)}addCustomer(){return w(this,null,function*(){let e=!1,t="";if(this.newCustomer.customerType==="individual"?(e=!!(this.newCustomer.firstName&&this.newCustomer.lastName&&this.newCustomer.mobile&&this.newCustomer.village&&this.newCustomer.district),t=`${this.newCustomer.prefix} ${this.newCustomer.firstName} ${this.newCustomer.middleName?this.newCustomer.middleName+" ":""}${this.newCustomer.lastName}`.trim()):(e=!!(this.newCustomer.companyName&&this.newCustomer.companyType&&this.newCustomer.mobile&&this.newCustomer.village&&this.newCustomer.district),t=`${this.newCustomer.companyName} (${this.newCustomer.companyType})`),e){let r=`${this.newCustomer.flatNumber?this.newCustomer.flatNumber+", ":""}${this.newCustomer.buildingName?this.newCustomer.buildingName+", ":""}${this.newCustomer.streetName?this.newCustomer.streetName+", ":""}${this.newCustomer.village}, ${this.newCustomer.taluka?this.newCustomer.taluka+", ":""}${this.newCustomer.district}${this.newCustomer.pincode?", "+this.newCustomer.pincode:""}`,i={name:t,mobile:`${this.newCustomer.countryCode} ${this.newCustomer.mobile}`,gst:this.newCustomer.gst,email:this.newCustomer.email,address:r,dueAmount:0};try{yield this.customerService.addCustomer(i),this.newCustomer={customerType:"individual",prefix:"Mr.",firstName:"",middleName:"",lastName:"",companyName:"",companyType:"",mobile:"",countryCode:"+91",gst:"",email:"",flatNumber:"",buildingName:"",streetName:"",village:"",taluka:"",district:"",pincode:""},this.loadCustomers(),this.activeSection=null}catch(o){console.error("Error adding customer:",o),alert("Failed to add customer. Please try again.")}}})}editCustomer(e){}deleteCustomer(e){return w(this,null,function*(){if(confirm("Are you sure you want to delete this customer?"))try{yield this.customerService.deleteCustomer(e),this.loadCustomers()}catch(t){console.error("Error deleting customer:",t),alert("Failed to delete customer. Please try again.")}})}generateInvoiceNumber(){return w(this,null,function*(){return yield this.invoiceService.generateNextInvoiceNumber(this.invoice.invoiceDate)})}getCurrentDate(){return new Date().toISOString().split("T")[0]}onCustomerTypeChange(){this.invoice.customer=null,this.searchResults=[],this.showAddCustomerForm=!1,this.showCustomerSearch=this.invoice.customerType==="existing"}searchCustomer(){if(!this.invoice.searchTerm.trim()){this.searchResults=[],this.invoice.customer=null,this.showAddCustomerForm=!1;return}let e=this.invoice.searchTerm.toLowerCase();this.searchResults=this.customers.filter(t=>t.mobile.includes(e)||t.name.toLowerCase().includes(e)||t.email.toLowerCase().includes(e)),this.invoice.customer&&!this.invoice.searchTerm.includes(this.invoice.customer.name)&&(this.invoice.customer=null)}selectCustomer(e){this.invoice.customer=e,this.searchResults=[],this.invoice.searchTerm=`${e.name} (${e.mobile})`,this.showAddCustomerForm=!1,this.invoice.customerType="existing"}showAddNewCustomer(){this.showAddCustomerForm=!0,this.invoice.customerType="new",this.invoice.customer=null}addNewInvoiceCustomer(){let e=!1,t="";if(this.newInvoiceCustomer.customerType==="individual"?(e=!!(this.newInvoiceCustomer.firstName&&this.newInvoiceCustomer.lastName&&this.newInvoiceCustomer.mobile&&this.newInvoiceCustomer.village&&this.newInvoiceCustomer.district),t=`${this.newInvoiceCustomer.prefix} ${this.newInvoiceCustomer.firstName} ${this.newInvoiceCustomer.middleName?this.newInvoiceCustomer.middleName+" ":""}${this.newInvoiceCustomer.lastName}`.trim()):(e=!!(this.newInvoiceCustomer.companyName&&this.newInvoiceCustomer.companyType&&this.newInvoiceCustomer.mobile&&this.newInvoiceCustomer.village&&this.newInvoiceCustomer.district),t=`${this.newInvoiceCustomer.companyName} (${this.newInvoiceCustomer.companyType})`),e){let r=`${this.newInvoiceCustomer.flatNumber?this.newInvoiceCustomer.flatNumber+", ":""}${this.newInvoiceCustomer.buildingName?this.newInvoiceCustomer.buildingName+", ":""}${this.newInvoiceCustomer.streetName?this.newInvoiceCustomer.streetName+", ":""}${this.newInvoiceCustomer.village}, ${this.newInvoiceCustomer.taluka?this.newInvoiceCustomer.taluka+", ":""}${this.newInvoiceCustomer.district}${this.newInvoiceCustomer.pincode?", "+this.newInvoiceCustomer.pincode:""}`,i={id:Date.now().toString(),name:t,mobile:`${this.newInvoiceCustomer.countryCode} ${this.newInvoiceCustomer.mobile}`,email:this.newInvoiceCustomer.email,address:r,gst:this.newInvoiceCustomer.gst,dueAmount:0};this.customers.push(i),this.invoice.customer=i,this.showAddCustomerForm=!1,this.invoice.searchTerm=`${i.name} (${i.mobile})`,this.newInvoiceCustomer={id:"",customerType:"individual",prefix:"Mr.",firstName:"",middleName:"",lastName:"",companyName:"",companyType:"",mobile:"",countryCode:"+91",gst:"",email:"",flatNumber:"",buildingName:"",streetName:"",village:"",taluka:"",district:"",pincode:""}}}addServiceDetail(){this.invoice.serviceDetails.push({description:"",amount:0,notes:""})}removeServiceDetail(e){this.invoice.serviceDetails.length>1&&(this.invoice.serviceDetails.splice(e,1),this.calculateTotals())}calculateTotals(){this.invoice.totalAmount=this.invoice.serviceDetails.reduce((e,t)=>e+(t.amount||0),0),this.invoice.balancePayable=this.invoice.totalAmount-(this.invoice.advanceReceived||0)}onAmountChange(){this.calculateTotals()}onAdvanceChange(){this.calculateTotals()}saveInvoice(){return w(this,null,function*(){if(this.validateInvoice())try{let e=this.invoice.customer;if(this.invoice.customerType==="new"||this.showAddCustomerForm){let o="";this.newInvoiceCustomer.customerType==="individual"?o=`${this.newInvoiceCustomer.prefix} ${this.newInvoiceCustomer.firstName} ${this.newInvoiceCustomer.middleName?this.newInvoiceCustomer.middleName+" ":""}${this.newInvoiceCustomer.lastName}`.trim():o=`${this.newInvoiceCustomer.companyName} (${this.newInvoiceCustomer.companyType})`;let s=`${this.newInvoiceCustomer.flatNumber?this.newInvoiceCustomer.flatNumber+", ":""}${this.newInvoiceCustomer.buildingName?this.newInvoiceCustomer.buildingName+", ":""}${this.newInvoiceCustomer.streetName?this.newInvoiceCustomer.streetName+", ":""}${this.newInvoiceCustomer.village}, ${this.newInvoiceCustomer.taluka?this.newInvoiceCustomer.taluka+", ":""}${this.newInvoiceCustomer.district}${this.newInvoiceCustomer.pincode?", "+this.newInvoiceCustomer.pincode:""}`,a={name:o,mobile:`${this.newInvoiceCustomer.countryCode} ${this.newInvoiceCustomer.mobile}`,email:this.newInvoiceCustomer.email,address:s,gst:this.newInvoiceCustomer.gst||"",dueAmount:0};e={id:yield this.customerService.addCustomer(a),name:o,mobile:`${this.newInvoiceCustomer.countryCode} ${this.newInvoiceCustomer.mobile}`,email:this.newInvoiceCustomer.email,address:s,gst:this.newInvoiceCustomer.gst||""},yield this.loadCustomers()}let t=this.invoice.serviceDetails.map(o=>({description:o.description,quantity:1,rate:o.amount,amount:o.amount})),r={invoiceNumber:this.invoice.invoiceNumber,invoiceDate:this.invoice.invoiceDate,customer:{id:e?.id,name:e?.name||"",mobile:e?.mobile||"",email:e?.email||"",address:e?.address||"",gst:e?.gst||""},serviceDetails:t,totalAmount:this.invoice.totalAmount,advanceReceived:this.invoice.advanceReceived,balancePayable:this.invoice.balancePayable,selectedBank:this.invoice.selectedBank,createdAt:new Date,status:this.invoice.balancePayable>0?"PARTIAL":"PAID"},i=yield this.invoiceService.addInvoice(r);yield this.loadInvoices(),this.filterInvoices(),alert("Invoice created successfully!"),yield this.resetInvoiceForm()}catch(e){console.error("Error saving invoice:",e),alert("Failed to save invoice. Please try again.")}})}resetInvoiceForm(){return w(this,null,function*(){this.invoice={invoiceNumber:yield this.generateInvoiceNumber(),invoiceDate:this.getCurrentDate(),customer:null,customerType:"existing",searchTerm:"",serviceDetails:[{description:"",amount:0,notes:""}],totalAmount:0,advanceReceived:0,balancePayable:0,selectedBank:""},this.newInvoiceCustomer={id:"",customerType:"individual",prefix:"Mr.",firstName:"",middleName:"",lastName:"",companyName:"",companyType:"",mobile:"",countryCode:"+91",gst:"",email:"",flatNumber:"",buildingName:"",streetName:"",village:"",taluka:"",district:"",pincode:""},this.showAddCustomerForm=!1,this.searchResults=[],this.activeSection=null})}validateInvoice(){return!this.invoice.customer&&this.invoice.customerType==="existing"&&!this.showAddCustomerForm?(alert("Please select a customer or add a new customer"),!1):(this.invoice.customerType==="new"||this.showAddCustomerForm)&&(!this.newInvoiceCustomer.firstName||!this.newInvoiceCustomer.lastName||!this.newInvoiceCustomer.mobile)?(alert("Please fill all required customer details (First Name, Last Name, Mobile)"),!1):this.invoice.serviceDetails.some(e=>!e.description||e.amount<=0)?(alert("Please fill all service details with valid amounts"),!1):this.invoice.selectedBank?!0:(alert("Please select a bank account"),!1)}initializeInvoices(){this.filterInvoices()}filterInvoices(){let e=[...this.invoices];if(this.invoiceSearchTerm.trim()){let t=this.invoiceSearchTerm.toLowerCase();e=e.filter(r=>r.invoiceNumber.toLowerCase().includes(t)||r.customer.name.toLowerCase().includes(t)||r.customer.mobile.includes(t)||r.customer.email.toLowerCase().includes(t))}this.selectedInvoiceStatus!=="ALL"&&(e=e.filter(t=>t.status===this.selectedInvoiceStatus)),e.sort((t,r)=>new Date(r.createdAt).getTime()-new Date(t.createdAt).getTime()),this.filteredInvoices=e}onInvoiceSearch(){this.filterInvoices()}onStatusFilterChange(){this.filterInvoices()}updateInvoiceStatus(e,t){return w(this,null,function*(){try{yield this.invoiceService.updateInvoice(e,{status:t}),yield this.loadInvoices(),this.filterInvoices()}catch(r){console.error("Error updating invoice status:",r),alert("Failed to update invoice status. Please try again.")}})}deleteInvoice(e){return w(this,null,function*(){if(confirm("Are you sure you want to delete this invoice?"))try{yield this.invoiceService.deleteInvoice(e),yield this.loadInvoices(),this.filterInvoices()}catch(t){console.error("Error deleting invoice:",t),alert("Failed to delete invoice. Please try again.")}})}printInvoice(e){let t=this.invoices.find(r=>r.id===e);t?this.pdfService.generateInvoicePDF(t):alert("Invoice not found!")}shareOnWhatsApp(e){let t=this.invoices.find(r=>r.id===e);t?this.pdfService.shareOnWhatsApp(t):alert("Invoice not found!")}editInvoice(e){alert("Edit functionality will be implemented soon!")}get totalInvoiceAmount(){let e=this.invoices.reduce((t,r)=>{let i=Number(r.totalAmount)||0;return t+i},0);return Math.round(e*100)/100}get totalPendingAmount(){let e=this.invoices.reduce((t,r)=>{let i=Number(r.balancePayable)||0;return t+i},0);return Math.round(e*100)/100}get paidInvoicesCount(){return this.invoices.filter(e=>e.status==="PAID").length}get pendingInvoicesCount(){return this.invoices.filter(e=>e.status==="PENDING").length}getCurrentMonthRevenue(){let e=new Date().getMonth(),t=new Date().getFullYear();return this.invoices.filter(r=>{let i=new Date(r.invoiceDate);return i.getMonth()===e&&i.getFullYear()===t}).reduce((r,i)=>r+i.totalAmount,0)}getLastMonthRevenue(){let e=new Date().getMonth()-1,t=e<0?new Date().getFullYear()-1:new Date().getFullYear(),r=e<0?11:e;return this.invoices.filter(i=>{let o=new Date(i.invoiceDate);return o.getMonth()===r&&o.getFullYear()===t}).reduce((i,o)=>i+o.totalAmount,0)}getAverageMonthlyRevenue(){let e=new Date;return e.setMonth(e.getMonth()-6),this.invoices.filter(i=>new Date(i.invoiceDate)>=e).reduce((i,o)=>i+o.totalAmount,0)/6}getCustomerRevenueData(){let e=new Map;return this.invoices.forEach(t=>{let r=t.customer?.id||0,i=t.customer?.name||"Unknown Customer";e.has(r)||e.set(r,{name:i,totalRevenue:0,invoiceCount:0,outstanding:0});let o=e.get(r);o.totalRevenue+=t.totalAmount,o.invoiceCount+=1,o.outstanding+=t.balancePayable}),Array.from(e.values()).sort((t,r)=>r.totalRevenue-t.totalRevenue)}getYearToDateRevenue(){let e=new Date().getFullYear();return this.invoices.filter(t=>new Date(t.invoiceDate).getFullYear()===e).reduce((t,r)=>t+r.totalAmount,0)}getTotalOutstanding(){return this.invoices.reduce((e,t)=>e+t.balancePayable,0)}getCollectionRate(){let e=this.invoices.reduce((r,i)=>r+i.totalAmount,0),t=this.invoices.reduce((r,i)=>r+(i.totalAmount-i.balancePayable),0);return e>0?Math.round(t/e*100):0}getActiveCustomersCount(){let e=new Set;return this.invoices.forEach(t=>{t.customer?.id&&e.add(t.customer.id)}),e.size}generateIncomeStatement(){alert("Income Statement report generation will be implemented. This will include detailed revenue, expenses, and profit analysis.")}generateGrowthReport(){alert("Growth Report generation will be implemented. This will show year-over-year and month-over-month growth trends.")}generatePaymentReport(){alert("Payment Analytics report generation will be implemented. This will show payment patterns and collection efficiency.")}generateTaxReport(){alert("Tax Summary report generation will be implemented. This will include GST and other tax summaries for compliance.")}logout(){localStorage.removeItem("authToken"),localStorage.removeItem("userSession"),localStorage.removeItem("currentUser"),localStorage.removeItem("username"),sessionStorage.clear(),alert("You have been logged out successfully!"),this.router.navigate(["/login"])}navigateToAddCustomer(){this.router.navigate(["/add-customer"])}navigateToViewCustomers(){this.router.navigate(["/view-customer"])}navigateToCreateInvoice(){this.router.navigate(["/create-invoice"])}navigateToViewInvoices(){this.router.navigate(["/view-invoices"])}navigateToCustomers(){this.router.navigate(["/view-customer"])}navigateToInvoices(){this.router.navigate(["/view-invoices"])}toggleRevenueMode(){this.isRevenueMode=!this.isRevenueMode}calculateStats(){this.totalCustomers=this.customers.length,this.totalInvoices=this.invoices.length,this.totalRevenue=this.invoices.reduce((t,r)=>{let i=Number(r.totalAmount)||0;return t+i},0),this.outstandingAmount=this.invoices.reduce((t,r)=>{let i=Number(r.balancePayable)||0;return t+i},0);let e=this.totalRevenue-this.outstandingAmount;this.collectionRate=this.totalRevenue>0?e/this.totalRevenue*100:0,this.totalRevenue=Math.round(this.totalRevenue*100)/100,this.outstandingAmount=Math.round(this.outstandingAmount*100)/100,this.collectionRate=Math.round(this.collectionRate*100)/100}static \u0275fac=function(t){return new(t||n)(q(it),q(qt),q(mi),q(gi),q(nr))};static \u0275cmp=Pt({type:n,selectors:[["app-dashboard"]],decls:113,vars:42,consts:[[1,"dashboard"],[1,"dashboard-header"],[1,"accordion-navigation"],[1,"accordion-item"],[1,"accordion-header",3,"click"],[1,"header-content"],[1,"fas","fa-users"],[1,"fas","fa-chevron-down","accordion-icon"],[1,"accordion-content"],[1,"sub-functions"],[1,"actions"],[3,"click"],[1,"fas","fa-user-plus"],[1,"fas","fa-file-invoice"],[1,"fas","fa-plus-circle"],[1,"fas","fa-file-invoice-dollar"],[1,"fas","fa-chart-line"],[1,"fas","fa-calendar-alt"],[1,"fas","fa-user-chart"],[1,"fas","fa-chart-bar"],[1,"quick-stats"],[1,"stats-title"],[1,"stats-grid"],[1,"stat-card","total-revenue"],[1,"stat-icon"],[1,"fas","fa-rupee-sign"],[1,"stat-content"],[1,"stat-value"],[1,"stat-card","outstanding-amount"],[1,"fas","fa-clock"],[1,"stat-card","collection-rate"],[1,"fas","fa-percentage"],[1,"stat-card","total-customers",3,"click"],[1,"stat-card","total-invoices",3,"click"],["class","section-container",4,"ngIf"],["class","coming-soon-overlay",3,"click",4,"ngIf"],[1,"section-container"],[1,"revenue-cards"],[1,"revenue-card"],[1,"revenue-amount"],[1,"revenue-trend","positive"],[1,"revenue-trend"],[1,"chart-container"],[1,"chart-placeholder"],[1,"customer-revenue-list"],[1,"customer-revenue-header"],["class","customer-revenue-row",4,"ngFor","ngForOf"],[1,"customer-revenue-row"],[1,"customer-name"],[1,"invoice-count"],[1,"outstanding","paid"],[1,"report-options"],[1,"report-card"],[1,"report-btn"],[1,"coming-soon-overlay",3,"click"],[1,"coming-soon-modal",3,"click"],[1,"coming-soon-header"],[1,"coming-soon-icon"],[1,"fas","fa-rocket"],[1,"close-btn",3,"click"],[1,"fas","fa-times"],[1,"coming-soon-content"],[1,"feature-list"],[4,"ngIf"],[1,"fas","fa-mobile-alt"],[1,"coming-soon-footer"],[1,"timeline"],[1,"notify-btn",3,"click"],[1,"fas","fa-bell"],[1,"fas","fa-crown"],[1,"fas","fa-file-download"],[1,"fas","fa-filter"]],template:function(t,r){t&1&&(m(0,"div",0)(1,"div",1)(2,"h2"),y(3,"Dashboard"),g()(),m(4,"div",2)(5,"div",3)(6,"button",4),z("click",function(){return r.toggleCategory("customers")}),m(7,"div",5),K(8,"i",6),m(9,"span"),y(10,"Customers"),g()(),K(11,"i",7),g(),m(12,"div",8)(13,"div",9)(14,"h3"),y(15,"Customer Management"),g(),m(16,"div",10)(17,"button",11),z("click",function(){return r.navigateToAddCustomer()}),K(18,"i",12),y(19," Add Customer "),g(),m(20,"button",11),z("click",function(){return r.navigateToViewCustomers()}),K(21,"i",6),y(22," View Customers "),g()()()()(),m(23,"div",3)(24,"button",4),z("click",function(){return r.toggleCategory("invoices")}),m(25,"div",5),K(26,"i",13),m(27,"span"),y(28,"Invoices"),g()(),K(29,"i",7),g(),m(30,"div",8)(31,"div",9)(32,"h3"),y(33,"Invoice Management"),g(),m(34,"div",10)(35,"button",11),z("click",function(){return r.navigateToCreateInvoice()}),K(36,"i",14),y(37," Create Invoice "),g(),m(38,"button",11),z("click",function(){return r.navigateToViewInvoices()}),K(39,"i",15),y(40," View Invoices "),g()()()()(),m(41,"div",3)(42,"button",4),z("click",function(){return r.toggleCategory("revenue")}),m(43,"div",5),K(44,"i",16),m(45,"span"),y(46,"Revenue Dashboard"),g()(),K(47,"i",7),g(),m(48,"div",8)(49,"div",9)(50,"h3"),y(51,"Revenue Analytics"),g(),m(52,"div",10)(53,"button",11),z("click",function(){return r.setActiveSection("monthlyRevenue")}),K(54,"i",17),y(55," Monthly Revenue "),g(),m(56,"button",11),z("click",function(){return r.setActiveSection("customerRevenue")}),K(57,"i",18),y(58," Customer Revenue "),g(),m(59,"button",11),z("click",function(){return r.setActiveSection("revenueReports")}),K(60,"i",19),y(61," Revenue Reports "),g()()()()()(),m(62,"div",20)(63,"h3",21),y(64,"Quick Stats"),g(),m(65,"div",22)(66,"div",23)(67,"div",24),K(68,"i",25),g(),m(69,"div",26)(70,"h4"),y(71,"Total Revenue"),g(),m(72,"p",27),y(73),Ve(74,"number"),g()()(),m(75,"div",28)(76,"div",24),K(77,"i",29),g(),m(78,"div",26)(79,"h4"),y(80,"Outstanding Amount"),g(),m(81,"p",27),y(82),Ve(83,"number"),g()()(),m(84,"div",30)(85,"div",24),K(86,"i",31),g(),m(87,"div",26)(88,"h4"),y(89,"Collection Rate"),g(),m(90,"p",27),y(91),Ve(92,"number"),g()()(),m(93,"div",32),z("click",function(){return r.navigateToViewCustomers()}),m(94,"div",24),K(95,"i",6),g(),m(96,"div",26)(97,"h4"),y(98,"Total Customers"),g(),m(99,"p",27),y(100),g()()(),m(101,"div",33),z("click",function(){return r.navigateToViewInvoices()}),m(102,"div",24),K(103,"i",15),g(),m(104,"div",26)(105,"h4"),y(106,"Total Invoices"),g(),m(107,"p",27),y(108),g()()()()(),ie(109,Oq,36,12,"div",34)(110,Rq,14,1,"div",34)(111,kq,32,0,"div",34),g(),ie(112,$q,35,7,"div",35)),t&2&&(I(6),Ze("active",r.activeCategory==="customers"),I(5),Ze("rotated",r.activeCategory==="customers"),I(),Ze("expanded",r.activeCategory==="customers"),I(12),Ze("active",r.activeCategory==="invoices"),I(5),Ze("rotated",r.activeCategory==="invoices"),I(),Ze("expanded",r.activeCategory==="invoices"),I(12),Ze("active",r.activeCategory==="revenue"),I(5),Ze("rotated",r.activeCategory==="revenue"),I(),Ze("expanded",r.activeCategory==="revenue"),I(5),Ze("active",r.activeSection==="monthlyRevenue"),I(3),Ze("active",r.activeSection==="customerRevenue"),I(3),Ze("active",r.activeSection==="revenueReports"),I(14),pe("\u20B9",je(74,33,r.totalRevenue,"1.2-2"),""),I(9),pe("\u20B9",je(83,36,r.outstandingAmount,"1.2-2"),""),I(9),pe("",je(92,39,r.collectionRate,"1.1-1"),"%"),I(9),se(r.totalCustomers),I(8),se(r.totalInvoices),I(),V("ngIf",r.activeCategory==="revenue"&&r.activeSection==="monthlyRevenue"),I(),V("ngIf",r.activeCategory==="revenue"&&r.activeSection==="customerRevenue"),I(),V("ngIf",r.activeCategory==="revenue"&&r.activeSection==="revenueReports"),I(),V("ngIf",r.showComingSoonPopup))},dependencies:[Ot,Tn,Wt,mr,Mn,Ss],styles:["[_nghost-%COMP%]{display:block;background:#f8f9fa;min-height:calc(100vh - 120px)}.dashboard[_ngcontent-%COMP%]{padding:40px 20px;max-width:1200px;margin:0 auto}.dashboard-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:30px;padding:0 10px}.dashboard-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{color:#2c3e50;font-size:28px;margin:0;font-weight:600}.logout-btn[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;padding:12px 20px;background:#dc3545;color:#fff;border:none;border-radius:8px;cursor:pointer;font-size:14px;font-weight:600;transition:all .3s ease;box-shadow:0 2px 8px #dc35454d}.logout-btn[_ngcontent-%COMP%]:hover{background:#c82333;transform:translateY(-1px);box-shadow:0 4px 12px #dc354566}.logout-btn[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:16px}.actions[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:20px;margin-bottom:30px}.actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:15px 25px;background:#fffffff2;color:#333;border:none;border-radius:15px;cursor:pointer;font-size:16px;font-weight:600;transition:all .3s ease;box-shadow:0 5px 15px #0000001a;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px)}.actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{transform:translateY(-3px);box-shadow:0 10px 25px #0003;background:#fff}.actions[_ngcontent-%COMP%]   button.active[_ngcontent-%COMP%]{background:#28a745;color:#fff;transform:translateY(-2px);box-shadow:0 8px 20px #28a7454d}.section-container[_ngcontent-%COMP%]{background:#fffffff2;border-radius:20px;padding:30px;box-shadow:0 20px 40px #0000001a;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);margin-top:20px}.section-container[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{color:#333;margin-bottom:20px;font-size:24px;font-weight:600}.form-group[_ngcontent-%COMP%]{margin-bottom:20px}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:8px;color:#555;font-size:14px;font-weight:500}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;padding:12px 15px;border:1px solid #e0e0e0;border-radius:10px;font-size:14px;box-sizing:border-box;outline:none;transition:all .3s ease}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{border-color:#667eea;box-shadow:0 0 10px #667eea4d}.submit-btn[_ngcontent-%COMP%]{background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;border:none;border-radius:10px;padding:12px 30px;font-size:16px;font-weight:600;cursor:pointer;transition:all .3s ease}.submit-btn[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 10px 20px #667eea4d}.table-container[_ngcontent-%COMP%]{overflow-x:auto;border-radius:10px;box-shadow:0 5px 15px #0000001a}table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;background:#fff;border-radius:10px;overflow:hidden}th[_ngcontent-%COMP%]{background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;padding:15px;text-align:left;font-weight:600}td[_ngcontent-%COMP%]{padding:15px;border-bottom:1px solid #f0f0f0}tr[_ngcontent-%COMP%]:hover{background-color:#f9f9f9}.form-row[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:15px}.customer-form[_ngcontent-%COMP%]{max-width:none}.form-section[_ngcontent-%COMP%]{margin-bottom:30px;padding:20px;background:#f8f9facc;border-radius:12px;border-left:4px solid #667eea}.form-section[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 20px;color:#333;font-size:18px;font-weight:600}.form-group.small[_ngcontent-%COMP%]{flex:0 0 120px}.form-actions[_ngcontent-%COMP%]{display:flex;gap:15px;justify-content:flex-end;margin-top:30px}.cancel-btn[_ngcontent-%COMP%]{background:#6c757d;color:#fff;border:none;border-radius:8px;padding:12px 25px;cursor:pointer;font-size:14px;font-weight:500;transition:all .3s ease}.cancel-btn[_ngcontent-%COMP%]:hover{background:#5a6268;transform:translateY(-1px)}.customer-stats[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:20px;margin-bottom:30px}.stat-card[_ngcontent-%COMP%]{background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;padding:20px;border-radius:15px;text-align:center;box-shadow:0 10px 20px #667eea4d}.stat-card.total-customers[_ngcontent-%COMP%], .stat-card.total-invoices[_ngcontent-%COMP%]{cursor:pointer;transition:all .3s ease}.stat-card.total-customers[_ngcontent-%COMP%]:hover, .stat-card.total-invoices[_ngcontent-%COMP%]:hover{transform:translateY(-3px);box-shadow:0 15px 30px #667eea66}.stat-card.total-customers[_ngcontent-%COMP%]:active, .stat-card.total-invoices[_ngcontent-%COMP%]:active{transform:translateY(-1px)}.stat-card[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 10px;font-size:16px;font-weight:500}.stat-number[_ngcontent-%COMP%]{font-size:28px;font-weight:700;margin:0}.customer-list[_ngcontent-%COMP%]{display:grid;gap:20px}.customer-card[_ngcontent-%COMP%]{background:#fff;border-radius:15px;padding:25px;box-shadow:0 5px 15px #0000001a;transition:transform .3s ease,box-shadow .3s ease}.customer-card[_ngcontent-%COMP%]:hover{transform:translateY(-3px);box-shadow:0 10px 25px #00000026}.customer-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px;padding-bottom:15px;border-bottom:2px solid #f0f0f0}.customer-header[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0;color:#333;font-size:20px;font-weight:600}.customer-actions[_ngcontent-%COMP%]{display:flex;gap:10px}.edit-btn[_ngcontent-%COMP%], .delete-btn[_ngcontent-%COMP%]{padding:8px 15px;border:none;border-radius:8px;cursor:pointer;font-size:14px;font-weight:500;transition:all .3s ease}.edit-btn[_ngcontent-%COMP%]{background:#28a745;color:#fff}.edit-btn[_ngcontent-%COMP%]:hover{background:#218838;transform:translateY(-1px)}.customer-details[_ngcontent-%COMP%]{display:grid;gap:15px}.detail-row[_ngcontent-%COMP%]{display:flex;align-items:flex-start;gap:15px}.label[_ngcontent-%COMP%]{font-weight:600;color:#555;min-width:120px;font-size:14px}.value[_ngcontent-%COMP%]{color:#333;flex:1;font-size:14px;line-height:1.5}.due-row[_ngcontent-%COMP%]{margin-top:10px;padding-top:15px;border-top:1px solid #f0f0f0}.due-amount[_ngcontent-%COMP%]{font-weight:700;color:#dc3545}.due-amount.no-due[_ngcontent-%COMP%]{color:#28a745}.paid-badge[_ngcontent-%COMP%]{background:#28a745;color:#fff;padding:2px 8px;border-radius:12px;font-size:12px;margin-left:10px}.no-customers[_ngcontent-%COMP%]{text-align:center;padding:40px;color:#666;background:#fff;border-radius:15px;box-shadow:0 5px 15px #0000001a}.main-categories[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:25px;margin-bottom:40px}.main-categories[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:25px 20px;background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;border:none;border-radius:20px;cursor:pointer;font-size:18px;font-weight:600;transition:all .3s ease;box-shadow:0 8px 25px #667eea4d;display:flex;flex-direction:column;align-items:center;gap:10px;min-height:120px}.main-categories[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{transform:translateY(-5px);box-shadow:0 15px 35px #667eea66}.main-categories[_ngcontent-%COMP%]   button.active[_ngcontent-%COMP%]{background:linear-gradient(135deg,#28a745,#20c997);box-shadow:0 8px 25px #28a74566}.main-categories[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:32px;margin-bottom:5px}.sub-functions[_ngcontent-%COMP%]{margin-bottom:30px;padding:20px;background:#fffffff2;border-radius:15px;box-shadow:0 5px 15px #0000001a}.sub-functions[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{color:#2c3e50;text-align:center;margin-bottom:20px;font-size:24px;font-weight:600}.revenue-cards[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:20px;margin-bottom:30px}.revenue-card[_ngcontent-%COMP%]{background:linear-gradient(135deg,#f8f9fa,#e9ecef);padding:25px;border-radius:15px;text-align:center;box-shadow:0 5px 15px #0000001a;transition:transform .3s ease}.revenue-card[_ngcontent-%COMP%]:hover{transform:translateY(-3px)}.revenue-card[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{color:#6c757d;font-size:14px;font-weight:600;margin-bottom:10px;text-transform:uppercase;letter-spacing:1px}.revenue-amount[_ngcontent-%COMP%]{font-size:28px;font-weight:700;color:#28a745;margin-bottom:8px}.revenue-trend[_ngcontent-%COMP%]{font-size:12px;color:#6c757d}.revenue-trend.positive[_ngcontent-%COMP%]{color:#28a745}.chart-container[_ngcontent-%COMP%]{background:#fff;padding:30px;border-radius:15px;box-shadow:0 5px 15px #0000001a;margin-bottom:30px}.chart-container[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{color:#2c3e50;margin-bottom:20px;font-size:18px;font-weight:600}.chart-placeholder[_ngcontent-%COMP%]{text-align:center;padding:60px 20px;background:#f8f9fa;border-radius:10px;color:#6c757d}.chart-placeholder[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:18px;margin-bottom:10px}.chart-placeholder[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]{font-size:14px;color:#adb5bd}.customer-revenue-list[_ngcontent-%COMP%]{background:#fff;border-radius:15px;overflow:hidden;box-shadow:0 5px 15px #0000001a}.customer-revenue-header[_ngcontent-%COMP%]{display:grid;grid-template-columns:2fr 1fr 1fr 1fr;gap:20px;padding:20px;background:#f8f9fa;font-weight:600;color:#2c3e50;border-bottom:1px solid #dee2e6}.customer-revenue-row[_ngcontent-%COMP%]{display:grid;grid-template-columns:2fr 1fr 1fr 1fr;gap:20px;padding:15px 20px;border-bottom:1px solid #f1f3f4;transition:background-color .2s ease}.customer-revenue-row[_ngcontent-%COMP%]:hover{background:#f8f9fa}.customer-revenue-row[_ngcontent-%COMP%]:last-child{border-bottom:none}.customer-name[_ngcontent-%COMP%]{font-weight:500;color:#2c3e50}.revenue-amount[_ngcontent-%COMP%]{color:#28a745;font-weight:600}.invoice-count[_ngcontent-%COMP%]{color:#6c757d}.outstanding[_ngcontent-%COMP%]{color:#dc3545;font-weight:500}.outstanding.paid[_ngcontent-%COMP%]{color:#28a745}.report-options[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));gap:20px;margin-bottom:40px}.report-card[_ngcontent-%COMP%]{background:#fff;padding:25px;border-radius:15px;box-shadow:0 5px 15px #0000001a;text-align:center;transition:transform .3s ease}.report-card[_ngcontent-%COMP%]:hover{transform:translateY(-3px)}.report-card[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{color:#2c3e50;margin-bottom:15px;font-size:18px;font-weight:600}.report-card[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#6c757d;margin-bottom:20px;line-height:1.5}.report-btn[_ngcontent-%COMP%]{padding:12px 24px;background:linear-gradient(135deg,#007bff,#0056b3);color:#fff;border:none;border-radius:8px;cursor:pointer;font-weight:500;transition:all .3s ease}.report-btn[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 5px 15px #007bff4d}.quick-stats[_ngcontent-%COMP%]{background:#fff;padding:30px;border-radius:15px;box-shadow:0 5px 15px #0000001a}.quick-stats[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{color:#2c3e50;margin-bottom:25px;font-size:20px;font-weight:600;text-align:center}.stats-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:20px}.stat-item[_ngcontent-%COMP%]{text-align:center;padding:20px;background:#f8f9fa;border-radius:10px;transition:transform .2s ease}.stat-item[_ngcontent-%COMP%]:hover{transform:translateY(-2px)}.stat-label[_ngcontent-%COMP%]{display:block;color:#6c757d;font-size:14px;font-weight:500;margin-bottom:8px}.stat-value[_ngcontent-%COMP%]{display:block;color:#2c3e50;font-size:24px;font-weight:700}.radio-group[_ngcontent-%COMP%]{display:flex;gap:20px;margin-bottom:20px}.radio-option[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;cursor:pointer;font-weight:500;color:#495057}.radio-option[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]{width:18px;height:18px;accent-color:#667eea}.customer-search[_ngcontent-%COMP%]{margin-top:15px}.search-results[_ngcontent-%COMP%]{max-height:200px;overflow-y:auto;border:1px solid #e9ecef;border-radius:8px;margin-top:10px;background:#fff}.customer-result[_ngcontent-%COMP%]{padding:15px;border-bottom:1px solid #f8f9fa;cursor:pointer;transition:background-color .2s ease}.customer-result[_ngcontent-%COMP%]:hover{background-color:#f8f9fa}.customer-result[_ngcontent-%COMP%]:last-child{border-bottom:none}.customer-info[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:4px}.customer-name[_ngcontent-%COMP%]{font-weight:600;color:#2c3e50}.customer-mobile[_ngcontent-%COMP%]{color:#667eea;font-weight:500}.customer-email[_ngcontent-%COMP%]{color:#6c757d;font-size:13px}.selected-customer[_ngcontent-%COMP%]{margin-top:15px;padding:15px;background:#e8f5e8;border-radius:8px;border:1px solid #28a745}.selected-customer[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{color:#155724;margin:0 0 10px;font-size:16px}.add-customer-btn[_ngcontent-%COMP%]{background:#28a745;color:#fff;border:none;padding:10px 15px;border-radius:6px;cursor:pointer;font-size:14px;margin-top:10px;transition:background-color .3s ease}.add-customer-btn[_ngcontent-%COMP%]:hover{background:#218838}.new-customer-form[_ngcontent-%COMP%]{background:#f8f9fa;padding:20px;border-radius:8px;margin-top:15px}.new-customer-form[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{color:#2c3e50;margin:0 0 15px}.service-item[_ngcontent-%COMP%]{background:#f8f9fa;padding:20px;border-radius:8px;margin-bottom:15px;border:1px solid #e9ecef}.service-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:15px}.service-header[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{color:#2c3e50;margin:0;font-size:1.1rem}.remove-service-btn[_ngcontent-%COMP%]{background:#dc3545;color:#fff;border:none;width:30px;height:30px;border-radius:50%;cursor:pointer;font-size:16px;display:flex;align-items:center;justify-content:center;transition:background-color .3s ease}.remove-service-btn[_ngcontent-%COMP%]:hover{background:#c82333}.add-service-btn[_ngcontent-%COMP%]{background:#17a2b8;color:#fff;border:none;padding:12px 20px;border-radius:8px;cursor:pointer;font-size:14px;font-weight:500;transition:background-color .3s ease}.add-service-btn[_ngcontent-%COMP%]:hover{background:#138496}.payment-summary[_ngcontent-%COMP%]{background:#f8f9fa;padding:20px;border-radius:8px;border:1px solid #e9ecef}.summary-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:10px 0;border-bottom:1px solid #e9ecef}.summary-row[_ngcontent-%COMP%]:last-child{border-bottom:none}.summary-row.total[_ngcontent-%COMP%]{font-size:1.2rem;font-weight:600;color:#2c3e50;border-top:2px solid #667eea;padding-top:15px;margin-top:10px}.summary-row[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{font-weight:500;color:#495057}.summary-row[_ngcontent-%COMP%]   .amount[_ngcontent-%COMP%]{font-weight:600;color:#28a745;font-size:1.1rem}.summary-row.total[_ngcontent-%COMP%]   .amount[_ngcontent-%COMP%]{color:#667eea;font-size:1.3rem}.invoice-search-section[_ngcontent-%COMP%]{background:#f8f9fa;padding:20px;border-radius:8px;margin-bottom:25px;border:1px solid #e9ecef}.invoice-stats[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:20px;margin-bottom:30px}.invoice-stats[_ngcontent-%COMP%]   .stat-card[_ngcontent-%COMP%]{background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;padding:20px;border-radius:12px;text-align:center;box-shadow:0 4px 12px #667eea4d}.invoice-stats[_ngcontent-%COMP%]   .stat-card[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 10px;font-size:14px;opacity:.9}.invoice-stats[_ngcontent-%COMP%]   .stat-card[_ngcontent-%COMP%]   .stat-number[_ngcontent-%COMP%]{font-size:2rem;font-weight:700;margin:0}.invoice-stats[_ngcontent-%COMP%]   .stat-card[_ngcontent-%COMP%]   .stat-number.paid[_ngcontent-%COMP%]{color:#4caf50}.invoice-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:20px}.invoice-card[_ngcontent-%COMP%]{background:#fff;border-radius:12px;box-shadow:0 4px 12px #0000001a;border:1px solid #e9ecef;overflow:hidden;transition:transform .2s ease,box-shadow .3s ease}.invoice-card[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 8px 20px #00000026}.invoice-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:20px;background:linear-gradient(135deg,#f8f9fa,#e9ecef);border-bottom:1px solid #dee2e6}.invoice-basic-info[_ngcontent-%COMP%]{display:flex;align-items:center;gap:15px}.invoice-basic-info[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0;color:#2c3e50;font-size:1.2rem;font-weight:600}.invoice-date[_ngcontent-%COMP%]{color:#6c757d;font-size:14px;font-weight:500}.status-badge[_ngcontent-%COMP%]{padding:4px 12px;border-radius:20px;font-size:12px;font-weight:600;text-transform:uppercase}.status-badge.status-paid[_ngcontent-%COMP%]{background:#d4edda;color:#155724;border:1px solid #c3e6cb}.status-badge.status-partial[_ngcontent-%COMP%]{background:#fff3cd;color:#856404;border:1px solid #ffeaa7}.status-badge.status-pending[_ngcontent-%COMP%]{background:#f8d7da;color:#721c24;border:1px solid #f5c6cb}.invoice-actions[_ngcontent-%COMP%]{display:flex;gap:8px;margin-top:10px}.view-btn[_ngcontent-%COMP%], .edit-btn[_ngcontent-%COMP%], .delete-btn[_ngcontent-%COMP%], .whatsapp-btn[_ngcontent-%COMP%]{padding:6px 12px;border:none;border-radius:4px;cursor:pointer;font-size:12px;font-weight:500;transition:all .3s ease;text-decoration:none;display:inline-flex;align-items:center;gap:4px}.view-btn[_ngcontent-%COMP%]{background:#28a745;color:#fff}.view-btn[_ngcontent-%COMP%]:hover{background:#218838;transform:translateY(-1px)}.whatsapp-btn[_ngcontent-%COMP%]{background:#25d366;color:#fff}.whatsapp-btn[_ngcontent-%COMP%]:hover{background:#20b954;transform:translateY(-1px)}.edit-btn[_ngcontent-%COMP%]{background:#ffc107;color:#212529}.edit-btn[_ngcontent-%COMP%]:hover{background:#e0a800;transform:translateY(-1px)}.delete-btn[_ngcontent-%COMP%]{background:#dc3545;color:#fff}.delete-btn[_ngcontent-%COMP%]:hover{background:#c82333;transform:translateY(-1px)}.invoice-details[_ngcontent-%COMP%]{padding:20px;display:grid;grid-template-columns:repeat(auto-fit,minmax(300px,1fr));gap:20px}.invoice-section[_ngcontent-%COMP%]{background:#f8f9fa;padding:15px;border-radius:8px;border:1px solid #e9ecef}.invoice-section[_ngcontent-%COMP%]   h5[_ngcontent-%COMP%]{margin:0 0 15px;color:#2c3e50;font-size:16px;font-weight:600;border-bottom:2px solid #667eea;padding-bottom:8px}.service-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:10px}.service-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-start;padding:10px;background:#fff;border-radius:6px;border:1px solid #e9ecef}.service-info[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:4px}.service-description[_ngcontent-%COMP%]{font-weight:500;color:#2c3e50}.service-notes[_ngcontent-%COMP%]{font-size:12px;color:#6c757d;font-style:italic}.service-amount[_ngcontent-%COMP%]{font-weight:600;color:#28a745;font-size:14px}.payment-details[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:8px}.payment-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:8px 0;border-bottom:1px solid #e9ecef}.payment-row[_ngcontent-%COMP%]:last-child{border-bottom:none}.payment-row.total[_ngcontent-%COMP%]{font-weight:600;font-size:1.1rem;color:#2c3e50;border-top:2px solid #667eea;padding-top:12px;margin-top:8px}.payment-row[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{color:#495057;font-weight:500}.payment-row[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{color:#2c3e50;font-weight:600}.payment-row[_ngcontent-%COMP%]   .value.paid[_ngcontent-%COMP%]{color:#28a745}.bank-info[_ngcontent-%COMP%]{font-size:12px;color:#6c757d}.status-actions[_ngcontent-%COMP%]{grid-column:1 / -1}.status-buttons[_ngcontent-%COMP%]{display:flex;gap:10px;flex-wrap:wrap}.status-btn[_ngcontent-%COMP%]{padding:8px 16px;border:none;border-radius:6px;cursor:pointer;font-size:13px;font-weight:500;transition:all .2s ease}.paid-btn[_ngcontent-%COMP%]{background:#28a745;color:#fff}.paid-btn[_ngcontent-%COMP%]:hover{background:#218838}.partial-btn[_ngcontent-%COMP%]{background:#ffc107;color:#212529}.partial-btn[_ngcontent-%COMP%]:hover{background:#e0a800}.pending-btn[_ngcontent-%COMP%]{background:#dc3545;color:#fff}.pending-btn[_ngcontent-%COMP%]:hover{background:#c82333}.no-invoices[_ngcontent-%COMP%]{text-align:center;padding:40px;color:#6c757d}.no-invoices[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin-bottom:15px}.clear-filters-btn[_ngcontent-%COMP%]{background:#667eea;color:#fff;border:none;padding:10px 20px;border-radius:6px;cursor:pointer;font-size:14px;font-weight:500;transition:background-color .3s ease}.clear-filters-btn[_ngcontent-%COMP%]:hover{background:#5a6fd8}.accordion-navigation[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:10px}.accordion-item[_ngcontent-%COMP%]{border:1px solid #e0e0e0;border-radius:12px;overflow:hidden;box-shadow:0 2px 8px #0000001a;transition:all .3s ease}.accordion-header[_ngcontent-%COMP%]{width:100%;padding:20px;background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;border:none;cursor:pointer;display:flex;align-items:center;justify-content:space-between;font-size:16px;font-weight:600;text-align:left;transition:all .3s ease}.accordion-header[_ngcontent-%COMP%]:hover{background:linear-gradient(135deg,#5a6fd8,#6a4190);transform:translateY(-1px)}.accordion-header.active[_ngcontent-%COMP%]{background:linear-gradient(135deg,#5a6fd8,#6a4190)}.accordion-header[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]:first-child{font-size:18px;margin-right:12px}.accordion-icon[_ngcontent-%COMP%]{font-size:14px;transition:transform .3s ease}.accordion-icon.rotated[_ngcontent-%COMP%]{transform:rotate(180deg)}.accordion-content[_ngcontent-%COMP%]{max-height:0;overflow:hidden;transition:max-height .3s ease;background:#fff}.accordion-content.expanded[_ngcontent-%COMP%]{max-height:500px}.accordion-content[_ngcontent-%COMP%]   .sub-functions[_ngcontent-%COMP%]{padding:20px;border-top:1px solid #f0f0f0}.accordion-content[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:10px}.accordion-content[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:15px 20px;background:#f8f9fa;border:1px solid #e0e0e0;border-radius:8px;cursor:pointer;display:flex;align-items:center;gap:10px;font-size:14px;font-weight:500;color:#495057;text-decoration:none;transition:all .3s ease}.accordion-content[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background:#e9ecef;transform:translateY(-1px);box-shadow:0 2px 8px #0000001a}.accordion-content[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:16px;color:#667eea}.quick-stats[_ngcontent-%COMP%]{margin:30px 0}.stats-title[_ngcontent-%COMP%]{color:#333;font-size:1.5rem;font-weight:600;margin-bottom:20px;text-align:center}.stats-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:20px}.stat-card[_ngcontent-%COMP%]{background:#fff;padding:25px;border-radius:15px;box-shadow:0 5px 15px #0000001a;display:flex;align-items:center;gap:20px;transition:all .3s ease}.stat-card[_ngcontent-%COMP%]:hover{transform:translateY(-5px);box-shadow:0 10px 25px #00000026}.stat-icon[_ngcontent-%COMP%]{width:60px;height:60px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:1.5rem;color:#fff}.total-revenue[_ngcontent-%COMP%]   .stat-icon[_ngcontent-%COMP%]{background:linear-gradient(135deg,#667eea,#764ba2)}.outstanding-amount[_ngcontent-%COMP%]   .stat-icon[_ngcontent-%COMP%]{background:linear-gradient(135deg,#f093fb,#f5576c)}.collection-rate[_ngcontent-%COMP%]   .stat-icon[_ngcontent-%COMP%]{background:linear-gradient(135deg,#4facfe,#00f2fe)}.total-customers[_ngcontent-%COMP%]   .stat-icon[_ngcontent-%COMP%]{background:linear-gradient(135deg,#43e97b,#38f9d7)}.total-invoices[_ngcontent-%COMP%]   .stat-icon[_ngcontent-%COMP%]{background:linear-gradient(135deg,#fa709a,#fee140)}.stat-content[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 8px;color:#666;font-size:.9rem;font-weight:500;text-transform:uppercase;letter-spacing:.5px}.stat-value[_ngcontent-%COMP%]{margin:0;color:#333;font-size:1.8rem;font-weight:700}@media (max-width: 768px){.invoice-header[_ngcontent-%COMP%]{flex-direction:column;gap:15px;align-items:flex-start}.invoice-basic-info[_ngcontent-%COMP%]{flex-direction:column;gap:8px;align-items:flex-start}.invoice-actions[_ngcontent-%COMP%]{align-self:stretch}.invoice-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{flex:1;padding:10px;font-size:11px}.invoice-details[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:15px}.invoice-stats[_ngcontent-%COMP%]{grid-template-columns:repeat(2,1fr)}.status-buttons[_ngcontent-%COMP%]{justify-content:center}.status-btn[_ngcontent-%COMP%]{flex:1;min-width:100px}.accordion-header[_ngcontent-%COMP%]{padding:16px;font-size:15px}.accordion-content[_ngcontent-%COMP%]   .sub-functions[_ngcontent-%COMP%]{padding:15px}.accordion-content[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:12px 16px;font-size:13px}}.coming-soon-overlay[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background:#0009;-webkit-backdrop-filter:blur(4px);backdrop-filter:blur(4px);display:flex;align-items:center;justify-content:center;z-index:1000;animation:_ngcontent-%COMP%_fadeIn .3s ease-in-out}.coming-soon-modal[_ngcontent-%COMP%]{background:linear-gradient(135deg,#667eea,#764ba2);border-radius:20px;box-shadow:0 25px 50px #0000004d;max-width:500px;width:90%;max-height:90vh;overflow-y:auto;animation:_ngcontent-%COMP%_slideIn .4s ease-out;position:relative}.coming-soon-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:30px 30px 0;position:relative}.coming-soon-icon[_ngcontent-%COMP%]{background:#fff3;border-radius:50%;width:60px;height:60px;display:flex;align-items:center;justify-content:center;font-size:24px;color:#fff;animation:_ngcontent-%COMP%_bounce 2s infinite}.close-btn[_ngcontent-%COMP%]{background:#fff3;border:none;border-radius:50%;width:40px;height:40px;color:#fff;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:all .3s ease;font-size:18px}.close-btn[_ngcontent-%COMP%]:hover{background:#ffffff4d;transform:scale(1.1)}.coming-soon-content[_ngcontent-%COMP%]{padding:20px 30px 30px;text-align:center;color:#fff}.coming-soon-content[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:32px;margin:0 0 10px;font-weight:700;text-shadow:0 2px 4px rgba(0,0,0,.3)}.coming-soon-content[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:20px;margin:0 0 20px;font-weight:500;opacity:.9}.coming-soon-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:16px;margin:0 0 20px;opacity:.8;line-height:1.5}.feature-list[_ngcontent-%COMP%]{list-style:none;padding:0;margin:0 0 30px;text-align:left}.feature-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{padding:10px 0;font-size:15px;display:flex;align-items:center;gap:12px;opacity:.9}.feature-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{background:#fff3;border-radius:50%;width:32px;height:32px;display:flex;align-items:center;justify-content:center;font-size:14px;flex-shrink:0}.coming-soon-footer[_ngcontent-%COMP%]{text-align:center}.timeline[_ngcontent-%COMP%]{font-size:14px;margin:0 0 20px;opacity:.8}.timeline[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{color:gold;font-weight:600}.notify-btn[_ngcontent-%COMP%]{background:#ffffffe6;color:#667eea;border:none;border-radius:25px;padding:12px 24px;font-size:16px;font-weight:600;cursor:pointer;transition:all .3s ease;display:inline-flex;align-items:center;gap:8px;box-shadow:0 4px 15px #0003}.notify-btn[_ngcontent-%COMP%]:hover{background:#fff;transform:translateY(-2px);box-shadow:0 6px 20px #0000004d}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0}to{opacity:1}}@keyframes _ngcontent-%COMP%_slideIn{0%{opacity:0;transform:translateY(-50px) scale(.9)}to{opacity:1;transform:translateY(0) scale(1)}}@keyframes _ngcontent-%COMP%_bounce{0%,20%,50%,80%,to{transform:translateY(0)}40%{transform:translateY(-10px)}60%{transform:translateY(-5px)}}@media (max-width: 768px){.coming-soon-modal[_ngcontent-%COMP%]{margin:20px;width:calc(100% - 40px)}.coming-soon-header[_ngcontent-%COMP%], .coming-soon-content[_ngcontent-%COMP%]{padding:20px}.coming-soon-content[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:28px}.coming-soon-content[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:18px}.feature-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{font-size:14px}}"]})};function zq(n,e){if(n&1){let t=de();m(0,"div",4)(1,"label"),y(2,"Salutation & Name *"),g(),m(3,"div",33)(4,"select",34),ne("ngModelChange",function(i){B(t);let o=A();return re(o.newCustomer.prefix,i)||(o.newCustomer.prefix=i),U(i)}),m(5,"option",35),y(6,"Prefix"),g(),m(7,"option",36),y(8,"Mr."),g(),m(9,"option",37),y(10,"Mrs."),g(),m(11,"option",38),y(12,"Ms."),g(),m(13,"option",39),y(14,"Dr."),g(),m(15,"option",40),y(16,"Prof."),g(),m(17,"option",41),y(18,"Er."),g(),m(19,"option",42),y(20,"Adv."),g(),m(21,"option",43),y(22,"CA."),g()(),m(23,"input",44),ne("ngModelChange",function(i){B(t);let o=A();return re(o.newCustomer.firstName,i)||(o.newCustomer.firstName=i),U(i)}),g()()()}if(n&2){let t=A();I(4),te("ngModel",t.newCustomer.prefix),I(19),te("ngModel",t.newCustomer.firstName)}}function Hq(n,e){if(n&1){let t=de();m(0,"div",4)(1,"label",45),y(2,"Middle Name"),g(),m(3,"input",46),ne("ngModelChange",function(i){B(t);let o=A();return re(o.newCustomer.middleName,i)||(o.newCustomer.middleName=i),U(i)}),g()()}if(n&2){let t=A();I(3),te("ngModel",t.newCustomer.middleName)}}function Wq(n,e){if(n&1){let t=de();m(0,"div",4)(1,"label",47),y(2,"Last Name *"),g(),m(3,"input",48),ne("ngModelChange",function(i){B(t);let o=A();return re(o.newCustomer.lastName,i)||(o.newCustomer.lastName=i),U(i)}),g()()}if(n&2){let t=A();I(3),te("ngModel",t.newCustomer.lastName)}}function qq(n,e){if(n&1){let t=de();m(0,"div",4)(1,"label",49),y(2,"Company Name *"),g(),m(3,"input",50),ne("ngModelChange",function(i){B(t);let o=A();return re(o.newCustomer.companyName,i)||(o.newCustomer.companyName=i),U(i)}),g()()}if(n&2){let t=A();I(3),te("ngModel",t.newCustomer.companyName)}}function Gq(n,e){if(n&1){let t=de();m(0,"div",4)(1,"label",51),y(2,"Company Type *"),g(),m(3,"select",52),ne("ngModelChange",function(i){B(t);let o=A();return re(o.newCustomer.companyType,i)||(o.newCustomer.companyType=i),U(i)}),m(4,"option",35),y(5,"Select Company Type"),g(),m(6,"option",53),y(7,"Pvt Ltd"),g(),m(8,"option",54),y(9,"LLP"),g(),m(10,"option",55),y(11,"Partnership"),g(),m(12,"option",56),y(13,"Proprietorship"),g(),m(14,"option",57),y(15,"Public Ltd"),g(),m(16,"option",58),y(17,"Trust"),g(),m(18,"option",59),y(19,"Society"),g(),m(20,"option",60),y(21,"FPCL"),g()()()}if(n&2){let t=A();I(3),te("ngModel",t.newCustomer.companyType)}}function Kq(n,e){if(n&1&&(m(0,"option",61),y(1),g()),n&2){let t=e.$implicit;V("value",t.code),I(),vs(" ",t.code," (",t.country,") ")}}var zg=class n{constructor(e,t){this.router=e;this.customerService=t}newCustomer={customerType:"individual",prefix:"Mr.",firstName:"",middleName:"",lastName:"",companyName:"",companyType:"",countryCode:"+91",mobile:"",gst:"",email:"",addressLine1:"",village:"",taluka:"",district:"",pinCode:""};prefixOptions=["Mr.","Mrs.","Ms.","Dr.","Prof."];countryCodeOptions=[{code:"+91",country:"India"},{code:"+1",country:"USA"},{code:"+44",country:"UK"},{code:"+86",country:"China"},{code:"+81",country:"Japan"},{code:"+49",country:"Germany"},{code:"+33",country:"France"},{code:"+61",country:"Australia"},{code:"+971",country:"UAE"}];addCustomer(){return w(this,null,function*(){let e=!1,t="";if(this.newCustomer.customerType==="individual"?(e=!!(this.newCustomer.prefix&&this.newCustomer.firstName&&this.newCustomer.lastName&&this.newCustomer.countryCode&&this.newCustomer.mobile&&this.newCustomer.addressLine1&&this.newCustomer.village&&this.newCustomer.district),t=`${this.newCustomer.prefix} ${this.newCustomer.firstName} ${this.newCustomer.middleName?this.newCustomer.middleName+" ":""}${this.newCustomer.lastName}`.trim()):this.newCustomer.customerType==="company"&&(e=!!(this.newCustomer.companyName&&this.newCustomer.companyType&&this.newCustomer.countryCode&&this.newCustomer.mobile&&this.newCustomer.addressLine1&&this.newCustomer.village&&this.newCustomer.district),t=`${this.newCustomer.companyName} (${this.newCustomer.companyType})`),e)try{let r=`${this.newCustomer.countryCode} ${this.newCustomer.mobile}`,i=`${this.newCustomer.addressLine1}, ${this.newCustomer.village}${this.newCustomer.taluka?", "+this.newCustomer.taluka:""}, ${this.newCustomer.district}${this.newCustomer.pinCode?", "+this.newCustomer.pinCode:""}`,o={name:t,mobile:r,gst:this.newCustomer.gst||"",email:this.newCustomer.email||"",address:i,dueAmount:0};console.log("\u{1F4BE} Saving customer to Firestore:",o);let s=yield this.customerService.addCustomer(o);console.log("\u2705 Customer saved successfully with ID:",s),alert("Customer added successfully!"),this.newCustomer={customerType:"individual",prefix:"Mr.",firstName:"",middleName:"",lastName:"",companyName:"",companyType:"",countryCode:"+91",mobile:"",gst:"",email:"",addressLine1:"",village:"",taluka:"",district:"",pinCode:""},this.router.navigate(["/dashboard"])}catch(r){console.error("\u274C Error adding customer:",r),alert("Error adding customer. Please try again.")}else alert("Please fill in all mandatory fields")})}goBack(){this.router.navigate(["/dashboard"],{queryParams:{category:"customers"}})}static \u0275fac=function(t){return new(t||n)(q(it),q(gi))};static \u0275cmp=Pt({type:n,selectors:[["app-add-customer"]],decls:64,vars:17,consts:[[1,"add-customer"],[1,"header"],[1,"form-container"],[3,"ngSubmit"],[1,"form-group"],[1,"radio-group-horizontal"],[1,"radio-option"],["type","radio","name","customerType","value","individual",3,"ngModelChange","ngModel"],["type","radio","name","customerType","value","company",3,"ngModelChange","ngModel"],["class","form-group",4,"ngIf"],["for","mobile"],[1,"mobile-input-group"],["id","countryCode","name","countryCode","required","",1,"country-code-select",3,"ngModelChange","ngModel"],[3,"value",4,"ngFor","ngForOf"],["id","mobile","type","tel","name","mobile","placeholder","Enter mobile number","required","",1,"mobile-input",3,"ngModelChange","ngModel"],["for","gst"],["id","gst","type","text","name","gst","placeholder","Enter GST number",3,"ngModelChange","ngModel"],["for","email"],["id","email","type","email","name","email","placeholder","Enter email address",3,"ngModelChange","ngModel"],[1,"address-section"],["for","addressLine1"],["id","addressLine1","type","text","name","addressLine1","placeholder","Enter address line 1","required","",3,"ngModelChange","ngModel"],["for","village"],["id","village","type","text","name","village","placeholder","Enter village name","required","",3,"ngModelChange","ngModel"],["for","taluka"],["id","taluka","type","text","name","taluka","placeholder","Enter taluka name",3,"ngModelChange","ngModel"],["for","district"],["id","district","type","text","name","district","placeholder","Enter district name","required","",3,"ngModelChange","ngModel"],["for","pinCode"],["id","pinCode","type","text","name","pinCode","placeholder","Enter pin code","pattern","[0-9]{6}",3,"ngModelChange","ngModel"],[1,"button-group"],["type","button",1,"cancel-btn",3,"click"],["type","submit",1,"submit-btn"],[1,"name-input-group"],["name","prefix",1,"prefix-select",3,"ngModelChange","ngModel"],["value",""],["value","Mr."],["value","Mrs."],["value","Ms."],["value","Dr."],["value","Prof."],["value","Er."],["value","Adv."],["value","CA."],["id","firstName","type","text","name","firstName","placeholder","First Name","required","",1,"name-input",3,"ngModelChange","ngModel"],["for","middleName"],["id","middleName","type","text","name","middleName","placeholder","Enter middle name",3,"ngModelChange","ngModel"],["for","lastName"],["id","lastName","type","text","name","lastName","placeholder","Enter last name","required","",3,"ngModelChange","ngModel"],["for","companyName"],["id","companyName","type","text","name","companyName","placeholder","Enter company name","required","",3,"ngModelChange","ngModel"],["for","companyType"],["id","companyType","name","companyType","required","",3,"ngModelChange","ngModel"],["value","Pvt Ltd"],["value","LLP"],["value","Partnership"],["value","Proprietorship"],["value","Public Ltd"],["value","Trust"],["value","Society"],["value","FPCL"],[3,"value"]],template:function(t,r){t&1&&(m(0,"div",0)(1,"div",1)(2,"h2"),y(3,"Add New Customer"),g()(),m(4,"div",2)(5,"form",3),z("ngSubmit",function(){return r.addCustomer()}),m(6,"div",4)(7,"label"),y(8,"Customer Type *"),g(),m(9,"div",5)(10,"label",6)(11,"input",7),ne("ngModelChange",function(o){return re(r.newCustomer.customerType,o)||(r.newCustomer.customerType=o),o}),g(),y(12," Individual "),g(),m(13,"label",6)(14,"input",8),ne("ngModelChange",function(o){return re(r.newCustomer.customerType,o)||(r.newCustomer.customerType=o),o}),g(),y(15," Company "),g()()(),ie(16,zq,24,2,"div",9)(17,Hq,4,1,"div",9)(18,Wq,4,1,"div",9)(19,qq,4,1,"div",9)(20,Gq,22,1,"div",9),m(21,"div",4)(22,"label",10),y(23,"Mobile Number *"),g(),m(24,"div",11)(25,"select",12),ne("ngModelChange",function(o){return re(r.newCustomer.countryCode,o)||(r.newCustomer.countryCode=o),o}),ie(26,Kq,2,3,"option",13),g(),m(27,"input",14),ne("ngModelChange",function(o){return re(r.newCustomer.mobile,o)||(r.newCustomer.mobile=o),o}),g()()(),m(28,"div",4)(29,"label",15),y(30,"GST Number"),g(),m(31,"input",16),ne("ngModelChange",function(o){return re(r.newCustomer.gst,o)||(r.newCustomer.gst=o),o}),g()(),m(32,"div",4)(33,"label",17),y(34,"Email Address"),g(),m(35,"input",18),ne("ngModelChange",function(o){return re(r.newCustomer.email,o)||(r.newCustomer.email=o),o}),g()(),m(36,"div",19)(37,"h4"),y(38,"Address Information"),g(),m(39,"div",4)(40,"label",20),y(41,"Address Line 1 *"),g(),m(42,"input",21),ne("ngModelChange",function(o){return re(r.newCustomer.addressLine1,o)||(r.newCustomer.addressLine1=o),o}),g()(),m(43,"div",4)(44,"label",22),y(45,"Village *"),g(),m(46,"input",23),ne("ngModelChange",function(o){return re(r.newCustomer.village,o)||(r.newCustomer.village=o),o}),g()(),m(47,"div",4)(48,"label",24),y(49,"Taluka"),g(),m(50,"input",25),ne("ngModelChange",function(o){return re(r.newCustomer.taluka,o)||(r.newCustomer.taluka=o),o}),g()(),m(51,"div",4)(52,"label",26),y(53,"District *"),g(),m(54,"input",27),ne("ngModelChange",function(o){return re(r.newCustomer.district,o)||(r.newCustomer.district=o),o}),g()(),m(55,"div",4)(56,"label",28),y(57,"Pin Code"),g(),m(58,"input",29),ne("ngModelChange",function(o){return re(r.newCustomer.pinCode,o)||(r.newCustomer.pinCode=o),o}),g()()(),m(59,"div",30)(60,"button",31),z("click",function(){return r.goBack()}),y(61,"Cancel"),g(),m(62,"button",32),y(63,"Add Customer"),g()()()()()),t&2&&(I(11),te("ngModel",r.newCustomer.customerType),I(3),te("ngModel",r.newCustomer.customerType),I(2),V("ngIf",r.newCustomer.customerType==="individual"),I(),V("ngIf",r.newCustomer.customerType==="individual"),I(),V("ngIf",r.newCustomer.customerType==="individual"),I(),V("ngIf",r.newCustomer.customerType==="company"),I(),V("ngIf",r.newCustomer.customerType==="company"),I(5),te("ngModel",r.newCustomer.countryCode),I(),V("ngForOf",r.countryCodeOptions),I(),te("ngModel",r.newCustomer.mobile),I(4),te("ngModel",r.newCustomer.gst),I(4),te("ngModel",r.newCustomer.email),I(7),te("ngModel",r.newCustomer.addressLine1),I(4),te("ngModel",r.newCustomer.village),I(4),te("ngModel",r.newCustomer.taluka),I(4),te("ngModel",r.newCustomer.district),I(4),te("ngModel",r.newCustomer.pinCode))},dependencies:[Ot,Tn,Wt,Mn,Uo,Wc,qc,tr,$o,Nd,pi,Bo,Hi,Fd,Tr,zi],styles:["[_nghost-%COMP%]{display:block;background:#f8f9fa;min-height:calc(100vh - 120px)}.add-customer[_ngcontent-%COMP%]{padding:40px 20px;max-width:800px;margin:0 auto}.header[_ngcontent-%COMP%]{margin-bottom:30px}.back-btn[_ngcontent-%COMP%]{background:#6c757d;color:#fff;border:none;border-radius:8px;padding:10px 15px;cursor:pointer;font-size:14px;margin-bottom:20px;transition:all .3s ease}.back-btn[_ngcontent-%COMP%]:hover{background:#5a6268}.header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{color:#2c3e50;font-size:32px;margin:0;font-weight:600}.form-container[_ngcontent-%COMP%]{background:#fffffff2;border-radius:20px;padding:40px;box-shadow:0 20px 40px #0000001a;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px)}.form-group[_ngcontent-%COMP%]{margin-bottom:20px}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:8px;color:#555;font-size:14px;font-weight:500}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{width:100%;padding:15px 20px;border:1px solid #e0e0e0;border-radius:10px;font-size:14px;box-sizing:border-box;outline:none;transition:all .3s ease}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus, .form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus{border-color:#667eea;box-shadow:0 0 10px #667eea4d}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]::placeholder{color:#aaa}.mobile-input-group[_ngcontent-%COMP%], .name-input-group[_ngcontent-%COMP%]{display:flex;gap:10px}.prefix-select[_ngcontent-%COMP%], .prefix-input[_ngcontent-%COMP%]{flex:0 0 80px;min-width:80px}.name-input[_ngcontent-%COMP%]{flex:1}.country-code-select[_ngcontent-%COMP%]{flex:0 0 180px;min-width:180px}.mobile-input[_ngcontent-%COMP%]{flex:1}.address-section[_ngcontent-%COMP%]{margin-top:30px;padding-top:20px;border-top:1px solid #e0e0e0}.address-section[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{color:#333;margin-bottom:20px;font-size:18px;font-weight:600}.button-group[_ngcontent-%COMP%]{display:flex;gap:15px;justify-content:flex-end;margin-top:30px}.cancel-btn[_ngcontent-%COMP%]{background:#f8f9fa;color:#6c757d;border:1px solid #dee2e6;border-radius:10px;padding:15px 30px;font-size:16px;font-weight:600;cursor:pointer;transition:all .3s ease}.cancel-btn[_ngcontent-%COMP%]:hover{background:#e9ecef;transform:translateY(-1px)}.submit-btn[_ngcontent-%COMP%]{background:#28a745;color:#fff;border:none;border-radius:10px;padding:15px 30px;font-size:16px;font-weight:600;cursor:pointer;transition:all .3s ease}.submit-btn[_ngcontent-%COMP%]:hover{background:#218838;transform:translateY(-2px);box-shadow:0 10px 20px #28a7454d}.radio-group-horizontal[_ngcontent-%COMP%]{display:flex;gap:20px;margin-top:5px}.radio-option[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;cursor:pointer;font-size:14px;color:#555;font-weight:400}.radio-option[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]{width:auto;margin:0;cursor:pointer}.radio-option[_ngcontent-%COMP%]:hover{color:#667eea}@media (max-width: 768px){.mobile-input-group[_ngcontent-%COMP%], .name-input-group[_ngcontent-%COMP%]{flex-direction:column}.country-code-select[_ngcontent-%COMP%], .prefix-select[_ngcontent-%COMP%], .prefix-input[_ngcontent-%COMP%]{flex:1;min-width:auto}.button-group[_ngcontent-%COMP%]{flex-direction:column}.add-customer[_ngcontent-%COMP%]{padding:10px}.form-container[_ngcontent-%COMP%]{padding:20px}}"]})};var Hg=class n{constructor(){}generateCustomerLedger(e,t){return w(this,null,function*(){try{console.log("Generating professional ledger for customer:",e.name);let{default:r}=yield import("./chunk-FJXHYOGL.js");console.log("jsPDF imported successfully");let i=new r({orientation:"portrait",unit:"mm",format:"a4"});console.log("jsPDF instance created successfully");let o=!1;try{yield import("./chunk-3PXEOZNP.js"),typeof i.autoTable=="function"?(o=!0,console.log("autoTable is available")):console.log("autoTable function not found on doc instance")}catch(_){console.log("Failed to load autoTable, will use manual table:",_)}let s=i.internal.pageSize.getWidth();console.log("Page width:",s);try{i.setFontSize(16),i.setFont("helvetica","bold"),i.text("GLOBAL FINANCIAL SERVICES",s/2,20,{align:"center"}),i.setFontSize(10),i.setFont("helvetica","normal"),i.text("Office No. 4, Jay Ganesh Apartment,",s/2,28,{align:"center"}),i.text("Opposite Thatte Nagar Bus Stop, Thatte Nagar,",s/2,34,{align:"center"}),i.text("Nashik - 422003",s/2,40,{align:"center"}),i.setFontSize(14),i.setFont("helvetica","bold"),i.text(`${e.name}`,s/2,52,{align:"center"}),i.text("Ledger Account",s/2,60,{align:"center"}),i.setFontSize(10),i.setFont("helvetica","normal"),i.text(`Mobile: ${e.mobile}`,s/2,68,{align:"center"}),e.address&&i.text(`Address: ${e.address}`,s/2,74,{align:"center"});let _=new Date,b=t.length>0?new Date(Math.min(...t.map(N=>new Date(N.invoiceDate).getTime()))):_;i.text(`Period: ${this.formatDateRange(b)} to ${this.formatDateRange(_)}`,s/2,82,{align:"center"}),i.setFontSize(8),i.text("Page 1",s-20,82),console.log("Clean header created successfully")}catch(_){throw console.error("Error creating header:",_),new Error("Failed to create PDF header")}let a=[],c=0,u=t.sort((_,b)=>new Date(_.invoiceDate).getTime()-new Date(b.invoiceDate).getTime());u.forEach(_=>{let b=this.formatDateShort(new Date(_.invoiceDate));c+=_.totalAmount,a.push([b,"By Sales A/c (against Invoice)","Sales Invoice",_.invoiceNumber,this.formatAmount(_.totalAmount),"",this.formatAmount(c)]),_.advanceReceived>0&&(c-=_.advanceReceived,a.push([b,"To Cash/Bank A/c (against payment)","Bank Payment",`PAY-${_.invoiceNumber}`,"",this.formatAmount(_.advanceReceived),this.formatAmount(c)]))});let d=u.reduce((_,b)=>_+b.totalAmount,0),f=u.reduce((_,b)=>_+b.advanceReceived,0),v=d-f;if(a.push(["","Closing Balance","","",this.formatAmount(d),this.formatAmount(f),this.formatAmount(v)]),o){console.log("Using autoTable for professional layout");try{i.autoTable({head:[["Date","Particulars","Vch Type","Vch No.","Debit","Credit","Balance"]],body:a,startY:90,theme:"grid",styles:{fontSize:8,cellPadding:2,lineWidth:.5,lineColor:[0,0,0],textColor:[0,0,0]},headStyles:{fillColor:[255,255,255],textColor:[0,0,0],fontStyle:"bold",halign:"center",lineWidth:.5,lineColor:[0,0,0]},columnStyles:{0:{cellWidth:20,halign:"center"},1:{cellWidth:48,halign:"left"},2:{cellWidth:22,halign:"center"},3:{cellWidth:22,halign:"center"},4:{cellWidth:20,halign:"right"},5:{cellWidth:20,halign:"right"},6:{cellWidth:24,halign:"right"}},margin:{left:14,right:14},didParseCell:function(_){_.row.index===a.length-1&&(_.cell.styles.fontStyle="bold",_.cell.styles.fillColor=[255,255,255])}}),console.log("autoTable created successfully")}catch(_){console.error("Error with autoTable, falling back to manual:",_),this.createManualTable(i,a)}}else console.log("autoTable not available, using manual table layout"),this.createManualTable(i,a);try{let _=i.internal.pageSize.getHeight();i.setFontSize(8),i.setFont("helvetica","italic"),i.text("Generated by Global Financial Services",s/2,_-10,{align:"center"}),i.text(`Generated on: ${this.formatDateTime(new Date)}`,s/2,_-5,{align:"center"}),console.log("Footer created successfully")}catch(_){console.error("Error creating footer:",_)}try{let _=`${e.name}_Ledger_${this.formatDate(new Date)}.pdf`;console.log("Saving professional ledger as:",_),i.save(_),console.log("Professional ledger PDF saved successfully")}catch(_){throw console.error("Error saving PDF:",_),new Error("Failed to save PDF file")}}catch(r){console.error("Error in professional ledger generation:",r);let i="Error generating ledger: ";throw r instanceof Error?i+=r.message:i+="Unknown error occurred.",alert(i),r}})}createManualTable(e,t){try{console.log("Creating clean manual table layout");let r=90,i=8,o=[20,48,22,22,20,20,24],s=14;e.setFontSize(8),e.setFont("helvetica","bold");let a=["Date","Particulars","Vch Type","Vch No.","Debit","Credit","Balance"],c=s;a.forEach((d,f)=>{try{e.text(d,c+o[f]/2,r+5,{align:"center"})}catch{e.text(d,c+o[f]/2,r+5)}c+=o[f]}),e.setFont("helvetica","normal");let u=r+i;t.forEach((d,f)=>{let v=s;f===t.length-1?e.setFont("helvetica","bold"):e.setFont("helvetica","normal"),d.forEach((_,b)=>{let N=_||"";try{if(b>=4)e.text(N,v+o[b]-2,u+5,{align:"right"});else if(b===0||b===2||b===3)e.text(N,v+o[b]/2,u+5,{align:"center"});else{let R=N,G=30;R.length>G&&(R=R.substring(0,G-3)+"..."),e.text(R,v+2,u+5)}}catch{e.text(N.toString().substring(0,15),v+2,u+5)}v+=o[b]}),u+=i});try{e.setLineWidth(.5),e.setDrawColor(0,0,0);let d=s;for(let f=0;f<=o.length;f++)e.line(d,r,d,u),f<o.length&&(d+=o[f]);for(let f=0;f<=t.length+1;f++){let v=r+f*i;e.line(s,v,s+o.reduce((_,b)=>_+b,0),v)}}catch{console.warn("Border drawing failed, continuing without borders")}console.log("Clean manual table created successfully")}catch(r){throw console.error("Error in manual table creation:",r),new Error("Failed to create table layout")}}formatAmount(e){return e.toLocaleString("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2})}formatDateShort(e){let t=e.getDate().toString().padStart(2,"0"),r=e.toLocaleDateString("en-US",{month:"short"}),i=e.getFullYear().toString().substr(-2);return`${t}-${r}-${i}`}formatDateRange(e){let t=e.getDate().toString().padStart(2,"0"),r=e.toLocaleDateString("en-US",{month:"short"}),i=e.getFullYear().toString().substr(-2);return`${t}-${r}-${i}`}formatDateTime(e){return e.toLocaleDateString("en-IN")+" "+e.toLocaleTimeString("en-IN")}formatDate(e){let t=e.getDate().toString().padStart(2,"0"),r=(e.getMonth()+1).toString().padStart(2,"0"),i=e.getFullYear();return`${t}-${r}-${i}`}static \u0275fac=function(t){return new(t||n)};static \u0275prov=H({token:n,factory:n.\u0275fac,providedIn:"root"})};function Qq(n,e){n&1&&(m(0,"div",4)(1,"p"),y(2,"Loading customer data..."),g()())}function Zq(n,e){if(n&1){let t=de();m(0,"button",17),z("click",function(){B(t);let i=A(2);return U(i.clearSearch())}),K(1,"i",18),g()}}function Jq(n,e){if(n&1&&(m(0,"div",19)(1,"p"),y(2),g()()),n&2){let t=A(2);I(2),vs("Showing ",t.filteredCustomers.length," of ",t.customers.length," customers")}}function Xq(n,e){if(n&1&&(m(0,"div",29)(1,"span",30),y(2,"\u{1F3E2} GST Number:"),g(),m(3,"span",31),y(4),g()()),n&2){let t=A().$implicit;I(4),se(t.gst)}}function eG(n,e){n&1&&(m(0,"span",42),y(1,"FULLY PAID"),g())}function tG(n,e){if(n&1&&(m(0,"div",29)(1,"span",30),y(2,"\u{1F4E7} Email:"),g(),m(3,"span",31),y(4),g()()),n&2){let t=A(2).$implicit;I(4),se(t.email)}}function nG(n,e){if(n&1){let t=de();m(0,"div",43)(1,"div",44),ie(2,tG,5,1,"div",32),m(3,"div",29)(4,"span",30),y(5,"\u{1F4CD} Address:"),g(),m(6,"span",31),y(7),g()(),m(8,"div",45)(9,"button",46),z("click",function(){B(t);let i=A().$implicit,o=A(2);return U(o.editCustomer(i.id))}),K(10,"i",47),y(11," Edit Customer "),g(),m(12,"button",48),z("click",function(){B(t);let i=A().$implicit,o=A(2);return U(o.deleteCustomer(i.id))}),K(13,"i",49),y(14," Delete Customer "),g()()()()}if(n&2){let t=A().$implicit;I(2),V("ngIf",t.email),I(5),se(t.address)}}function rG(n,e){if(n&1){let t=de();m(0,"div",20)(1,"div",21)(2,"div",22)(3,"h3"),y(4),g(),m(5,"div",23)(6,"button",24),z("click",function(){let i=B(t).$implicit,o=A(2);return U(o.viewCustomerInvoices(i))}),K(7,"i",25),y(8),g(),m(9,"button",26),z("click",function(){let i=B(t).$implicit,o=A(2);return U(o.generateCustomerLedger(i))}),K(10,"i",27),y(11," Download Ledger "),g()()(),m(12,"div",28)(13,"div",29)(14,"span",30),y(15,"\u{1F4F1} Mobile:"),g(),m(16,"span",31),y(17),g()(),ie(18,Xq,5,1,"div",32),m(19,"div",33)(20,"div",34)(21,"span",30),y(22,"\u{1F4B0} Total Transactions:"),g(),m(23,"span",35),y(24),Ve(25,"number"),g()(),m(26,"div",34)(27,"span",30),y(28,"\u26A0\uFE0F Total Due Amount:"),g(),m(29,"span",36),y(30),Ve(31,"number"),ie(32,eG,2,0,"span",37),g()(),m(33,"div",34)(34,"span",30),y(35,"\u{1F4C4} Total Invoices:"),g(),m(36,"span",31),y(37),g()()()(),m(38,"div",38)(39,"button",39),z("click",function(){let i=B(t).$implicit,o=A(2);return U(o.toggleCustomerCardExpansion(i.id))}),K(40,"i",40),y(41),g()()(),ie(42,nG,15,2,"div",41),g()}if(n&2){let t=e.$implicit,r=A(2);Ze("customer-expanded",r.isCustomerCardExpanded(t.id)),I(4),se(t.name),I(4),pe(" View Invoices (",t.invoiceCount,") "),I(9),se(t.mobile),I(),V("ngIf",t.gst),I(6),pe("\u20B9",je(25,19,t.totalTransactionAmount,"1.2-2"),""),I(5),Ze("no-due",t.totalDueAmount===0),I(),pe(" \u20B9",je(31,22,t.totalDueAmount,"1.2-2")," "),I(2),V("ngIf",t.totalDueAmount===0),I(5),se(t.invoiceCount),I(2),V("title",r.isCustomerCardExpanded(t.id)?"Hide Details":"Show Details"),I(),Ze("fa-chevron-down",!r.isCustomerCardExpanded(t.id))("fa-chevron-up",r.isCustomerCardExpanded(t.id)),I(),pe(" ",r.isCustomerCardExpanded(t.id)?"Hide Details":"Show Details"," "),I(),V("ngIf",r.isCustomerCardExpanded(t.id))}}function iG(n,e){if(n&1){let t=de();m(0,"div",50)(1,"p"),y(2),m(3,"button",51),z("click",function(){B(t);let i=A(2);return U(i.clearSearch())}),y(4,"Clear search"),g()()()}if(n&2){let t=A(2);I(2),pe('No customers found matching "',t.customerSearchTerm,'". ')}}function oG(n,e){if(n&1){let t=de();m(0,"div",50)(1,"p"),y(2,"No customers found. "),m(3,"a",52),z("click",function(){B(t);let i=A(2);return U(i.goBack())}),y(4,"Add your first customer"),g()()()}}function sG(n,e){if(n&1){let t=de();m(0,"div",5)(1,"div",6)(2,"div",7)(3,"input",8),ne("ngModelChange",function(i){B(t);let o=A();return re(o.customerSearchTerm,i)||(o.customerSearchTerm=i),U(i)}),z("input",function(){B(t);let i=A();return U(i.onCustomerSearch())}),g(),ie(4,Zq,2,0,"button",9),g(),ie(5,Jq,3,2,"div",10),g(),m(6,"div",11)(7,"div",12)(8,"h3"),y(9,"Total Customers"),g(),m(10,"p",13),y(11),g()()(),m(12,"div",14),ie(13,rG,43,25,"div",15)(14,iG,5,1,"div",16)(15,oG,5,0,"div",16),g()()}if(n&2){let t=A();I(3),te("ngModel",t.customerSearchTerm),I(),V("ngIf",t.customerSearchTerm),I(),V("ngIf",t.customerSearchTerm),I(6),se(t.customerSearchTerm?t.filteredCustomers.length:t.customers.length),I(2),V("ngForOf",t.filteredCustomers),I(),V("ngIf",t.filteredCustomers.length===0&&t.customerSearchTerm),I(),V("ngIf",t.customers.length===0&&!t.customerSearchTerm)}}var Wg=class n{constructor(e,t,r,i,o){this.router=e;this.customerService=t;this.invoiceService=r;this.pdfService=i;this.ledgerService=o}customers=[];filteredCustomers=[];allInvoices=[];isLoading=!0;customerSearchTerm="";expandedCustomerCards=new Set;ngOnInit(){return w(this,null,function*(){yield this.loadCustomersWithStats()})}loadCustomersWithStats(){return w(this,null,function*(){try{this.isLoading=!0;let e=yield this.customerService.getCustomers();this.allInvoices=yield this.invoiceService.getInvoices(),this.customers=e.map(t=>{let r=t.mobile.replace(/\D/g,""),o=this.allInvoices.filter(c=>c?.customer?.mobile?c.customer.mobile.replace(/\D/g,"")===r&&r.length>=10:!1).filter((c,u,d)=>u===d.findIndex(f=>f.invoiceNumber===c.invoiceNumber)),s=o.reduce((c,u)=>{let d=Number(u.totalAmount)||0;return c+d},0),a=o.reduce((c,u)=>{let d=Number(u.balancePayable)||0;return c+d},0);return le(L({},t),{totalTransactionAmount:Math.round(s*100)/100,totalDueAmount:Math.round(a*100)/100,invoiceCount:o.length})}),this.filteredCustomers=[...this.customers]}catch(e){console.error("Error loading customer data:",e)}finally{this.isLoading=!1}})}refreshData(){return w(this,null,function*(){yield this.loadCustomersWithStats()})}get totalTransactionAmount(){let e=this.filteredCustomers.reduce((t,r)=>{let i=Number(r.totalTransactionAmount)||0;return t+i},0);return Math.round(e*100)/100}get totalDueAmount(){let e=this.filteredCustomers.reduce((t,r)=>{let i=Number(r.totalDueAmount)||0;return t+i},0);return Math.round(e*100)/100}get filteredTotalTransactionAmount(){return this.totalTransactionAmount}get filteredTotalDueAmount(){return this.totalDueAmount}viewCustomerInvoices(e){this.router.navigate(["/view-invoices"],{queryParams:{customer:e.mobile}})}generateCustomerLedger(e){return w(this,null,function*(){try{let t=this.allInvoices.filter(r=>r.customer.mobile===e.mobile);if(t.length===0){alert("No transactions found for this customer.");return}this.ledgerService.generateCustomerLedger(e,t)}catch(t){console.error("Error in generateCustomerLedger:",t),console.error("Error details:",{message:t instanceof Error?t.message:"Unknown error",stack:t instanceof Error?t.stack:"No stack trace",name:t instanceof Error?t.name:"Unknown error type"});let r="Error generating ledger. ";t instanceof Error?r+=t.message:r+="Please check the console for more details.",alert(r)}})}toggleCustomerCardExpansion(e){this.expandedCustomerCards.has(e)?this.expandedCustomerCards.delete(e):this.expandedCustomerCards.add(e)}isCustomerCardExpanded(e){return this.expandedCustomerCards.has(e)}onCustomerSearch(){this.filterCustomers()}filterCustomers(){let e=this.customerSearchTerm.trim();if(!e){this.filteredCustomers=[...this.customers];return}let t=e.toLowerCase();this.filteredCustomers=this.customers.filter(r=>{let i=e.length>=3&&r.name.toLowerCase().includes(t),o=e.replace(/\D/g,""),s=o.length>=4&&r.mobile.replace(/\D/g,"").includes(o),a=r.email&&r.email.toLowerCase().includes(t),c=r.address&&r.address.toLowerCase().includes(t),u=r.gst&&r.gst.toLowerCase().includes(t);return i||s||a||c||u})}clearSearch(){this.customerSearchTerm="",this.filteredCustomers=[...this.customers]}testLedgerService(){}goBack(){this.router.navigate(["/dashboard"],{queryParams:{category:"customers"}})}editCustomer(e){this.router.navigate(["/add-customer"],{queryParams:{edit:e}})}deleteCustomer(e){return w(this,null,function*(){let t=this.customers.find(i=>i.id===e);if(!t){alert("Customer not found!");return}let r=`\u26A0\uFE0F DELETE CUSTOMER WARNING \u26A0\uFE0F

Are you absolutely sure you want to delete this customer?

Customer: ${t.name}
Mobile: ${t.mobile}
${t.email?"Email: "+t.email:""}

This action will permanently delete:
\u2022 Customer profile and contact information
\u2022 ${t.invoiceCount} invoice(s) worth \u20B9${t.totalTransactionAmount.toLocaleString("en-IN")}
\u2022 Outstanding dues of \u20B9${t.totalDueAmount.toLocaleString("en-IN")}
\u2022 All transaction history and records

\u26A0\uFE0F THIS ACTION CANNOT BE UNDONE! \u26A0\uFE0F

Type "DELETE" in the prompt below to confirm deletion.`;if(confirm(r)){let i=prompt('Type "DELETE" to confirm permanent deletion:');if(i==="DELETE")try{yield this.customerService.deleteCustomer(e),yield this.loadCustomersWithStats(),alert(`Customer "${t.name}" and all associated data have been permanently deleted.`)}catch(o){console.error("Error deleting customer:",o),alert("Error deleting customer. Please try again.")}else i!==null&&alert('Deletion cancelled. You must type "DELETE" exactly to confirm.')}})}static \u0275fac=function(t){return new(t||n)(q(it),q(gi),q(nr),q(mi),q(Hg))};static \u0275cmp=Pt({type:n,selectors:[["app-view-customer"]],decls:6,vars:2,consts:[[1,"view-customer"],[1,"header"],["class","loading",4,"ngIf"],["class","customers-container",4,"ngIf"],[1,"loading"],[1,"customers-container"],[1,"search-section"],[1,"search-container"],["type","text","placeholder","Search customers by name, mobile, email, address, or GST number...",1,"search-input",3,"ngModelChange","input","ngModel"],["class","clear-search-btn","title","Clear Search",3,"click",4,"ngIf"],["class","search-results-info",4,"ngIf"],[1,"customer-stats"],[1,"stat-card"],[1,"stat-number"],[1,"customer-list"],["class","customer-card",3,"customer-expanded",4,"ngFor","ngForOf"],["class","no-customers",4,"ngIf"],["title","Clear Search",1,"clear-search-btn",3,"click"],[1,"fas","fa-times"],[1,"search-results-info"],[1,"customer-card"],[1,"customer-minimal-view"],[1,"customer-header"],[1,"customer-actions-minimal"],["title","View Customer Invoices",1,"action-btn","invoices-btn",3,"click"],[1,"fas","fa-file-invoice"],["title","Download Customer Ledger",1,"action-btn","ledger-btn",3,"click"],[1,"fas","fa-download"],[1,"customer-basic-info"],[1,"detail-row"],[1,"label"],[1,"value"],["class","detail-row",4,"ngIf"],[1,"transaction-summary"],[1,"summary-row"],[1,"value","transaction-amount"],[1,"value","due-amount"],["class","paid-badge",4,"ngIf"],[1,"show-details-container"],[1,"show-details-btn",3,"click","title"],[1,"fas"],["class","customer-detailed-view",4,"ngIf"],[1,"paid-badge"],[1,"customer-detailed-view"],[1,"detailed-info"],[1,"customer-actions-detailed"],["title","Edit Customer",1,"action-btn","edit-btn",3,"click"],[1,"fas","fa-edit"],["title","Delete Customer",1,"action-btn","delete-btn",3,"click"],[1,"fas","fa-trash"],[1,"no-customers"],[1,"clear-search-btn-inline",3,"click"],[3,"click"]],template:function(t,r){t&1&&(m(0,"div",0)(1,"div",1)(2,"h2"),y(3,"View Customers"),g()(),ie(4,Qq,3,0,"div",2)(5,sG,16,7,"div",3),g()),t&2&&(I(4),V("ngIf",r.isLoading),I(),V("ngIf",!r.isLoading))},dependencies:[Ot,Tn,Wt,mr,Mn,tr,pi,Tr,Ss],styles:["[_nghost-%COMP%]{display:block;background:#f8f9fa;min-height:calc(100vh - 120px)}.view-customer[_ngcontent-%COMP%]{padding:40px 20px;max-width:1200px;margin:0 auto}.header[_ngcontent-%COMP%]{margin-bottom:30px;display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:15px}.refresh-btn[_ngcontent-%COMP%]{background:#667eea;color:#fff;border:none;border-radius:8px;padding:10px 15px;cursor:pointer;font-size:14px;transition:all .3s ease;display:flex;align-items:center;gap:8px}.refresh-btn[_ngcontent-%COMP%]:hover{background:#5a6fd8;transform:translateY(-1px)}.refresh-btn[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{transition:transform .3s ease}.refresh-btn[_ngcontent-%COMP%]:hover   i[_ngcontent-%COMP%]{transform:rotate(180deg)}.back-btn[_ngcontent-%COMP%]{background:#6c757d;color:#fff;border:none;border-radius:8px;padding:10px 15px;cursor:pointer;font-size:14px;margin-bottom:20px;transition:all .3s ease}.back-btn[_ngcontent-%COMP%]:hover{background:#5a6268}.header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{color:#333;font-size:32px;margin:0;font-weight:600}.customers-container[_ngcontent-%COMP%]{background:#fff;border-radius:20px;padding:30px;box-shadow:0 4px 6px #0000001a;border:1px solid #e9ecef}.customer-stats[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:20px;margin-bottom:30px}.stat-card[_ngcontent-%COMP%]{background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;padding:20px;border-radius:15px;text-align:center;box-shadow:0 10px 20px #667eea4d}.stat-card[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 10px;font-size:16px;font-weight:500}.stat-number[_ngcontent-%COMP%]{font-size:28px;font-weight:700;margin:0}.customer-list[_ngcontent-%COMP%]{display:grid;gap:20px}.customer-card[_ngcontent-%COMP%]{background:#fff;border-radius:15px;padding:25px;box-shadow:0 5px 15px #0000001a;transition:transform .3s ease,box-shadow .3s ease}.customer-card[_ngcontent-%COMP%]:hover{transform:translateY(-3px);box-shadow:0 10px 25px #00000026}.customer-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px;padding-bottom:15px;border-bottom:2px solid #f0f0f0}.customer-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;color:#333;font-size:20px;font-weight:600}.customer-actions[_ngcontent-%COMP%]{display:flex;gap:8px;flex-wrap:wrap}.edit-btn[_ngcontent-%COMP%], .delete-btn[_ngcontent-%COMP%], .invoices-btn[_ngcontent-%COMP%], .ledger-btn[_ngcontent-%COMP%]{padding:8px 12px;border:none;border-radius:6px;cursor:pointer;font-size:12px;font-weight:500;transition:all .2s ease;display:flex;align-items:center;gap:4px}.edit-btn[_ngcontent-%COMP%]{background-color:#ffc107;color:#212529}.edit-btn[_ngcontent-%COMP%]:hover{background-color:#e0a800}.delete-btn[_ngcontent-%COMP%]{background-color:#dc3545;color:#fff}.delete-btn[_ngcontent-%COMP%]:hover{background-color:#c82333}.invoices-btn[_ngcontent-%COMP%]{background-color:#007bff;color:#fff}.invoices-btn[_ngcontent-%COMP%]:hover{background-color:#0056b3}.ledger-btn[_ngcontent-%COMP%]{background-color:#28a745;color:#fff}.ledger-btn[_ngcontent-%COMP%]:hover{background-color:#218838}.customer-details[_ngcontent-%COMP%]{display:grid;gap:15px}.detail-row[_ngcontent-%COMP%]{display:flex;align-items:flex-start;gap:15px}.label[_ngcontent-%COMP%]{font-weight:600;color:#555;min-width:120px;font-size:14px}.value[_ngcontent-%COMP%]{color:#333;flex:1;font-size:14px;line-height:1.5}.due-row[_ngcontent-%COMP%]{margin-top:10px;padding-top:15px;border-top:1px solid #f0f0f0}.due-amount[_ngcontent-%COMP%]{font-weight:700;color:#dc3545}.due-amount.no-due[_ngcontent-%COMP%]{color:#28a745}.paid-badge[_ngcontent-%COMP%]{background:#28a745;color:#fff;padding:2px 8px;border-radius:12px;font-size:10px;font-weight:600;margin-left:8px}.transaction-summary[_ngcontent-%COMP%]{background:#f8f9fa;border-radius:8px;padding:15px;margin-top:15px;border-left:4px solid #007bff}.summary-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:8px}.summary-row[_ngcontent-%COMP%]:last-child{margin-bottom:0}.summary-row[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{font-weight:500;color:#495057}.summary-row[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-weight:600}.summary-row[_ngcontent-%COMP%]   .value.transaction-amount[_ngcontent-%COMP%]{color:#28a745}.summary-row[_ngcontent-%COMP%]   .value.due-amount[_ngcontent-%COMP%]{color:#dc3545}.summary-row[_ngcontent-%COMP%]   .value.no-due[_ngcontent-%COMP%]{color:#28a745}.no-customers[_ngcontent-%COMP%]{text-align:center;padding:40px;color:#666}.no-customers[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#667eea;cursor:pointer;text-decoration:underline}.loading[_ngcontent-%COMP%]{text-align:center;padding:40px;color:#fff;font-size:16px}.search-section[_ngcontent-%COMP%]{margin-bottom:30px}.search-container[_ngcontent-%COMP%]{position:relative;max-width:600px;margin:0 auto}.search-input[_ngcontent-%COMP%]{width:100%;padding:15px 45px 15px 20px;border:2px solid #e0e0e0;border-radius:25px;font-size:16px;background:#fff;transition:all .3s ease;box-shadow:0 4px 15px #0000001a}.search-input[_ngcontent-%COMP%]:focus{outline:none;border-color:#667eea;box-shadow:0 4px 20px #667eea33}.clear-search-btn[_ngcontent-%COMP%]{position:absolute;right:15px;top:50%;transform:translateY(-50%);background:none;border:none;color:#999;cursor:pointer;padding:5px;border-radius:50%;transition:all .3s ease}.clear-search-btn[_ngcontent-%COMP%]:hover{background:#f5f5f5;color:#667eea}.search-results-info[_ngcontent-%COMP%]{text-align:center;margin-top:15px;color:#666;font-size:14px}.clear-search-btn-inline[_ngcontent-%COMP%]{background:none;border:none;color:#667eea;text-decoration:underline;cursor:pointer;font-size:inherit}@media (max-width: 768px){.customer-header[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;gap:15px}.customer-actions[_ngcontent-%COMP%]{flex-direction:column}.action-btn[_ngcontent-%COMP%]{justify-content:center;padding:10px 12px;font-size:13px}.detail-row[_ngcontent-%COMP%]{flex-direction:column;gap:5px}.label[_ngcontent-%COMP%]{min-width:auto}.view-customer[_ngcontent-%COMP%]{padding:10px}.customers-container[_ngcontent-%COMP%]{padding:20px}.customer-stats[_ngcontent-%COMP%]{grid-template-columns:1fr}}.customer-minimal-view[_ngcontent-%COMP%]{padding:0}.customer-detailed-view[_ngcontent-%COMP%]{margin-top:15px;padding:15px;background:#f8f9fa;border-radius:10px;border:1px solid #e9ecef;animation:_ngcontent-%COMP%_slideDown .3s ease-out}@keyframes _ngcontent-%COMP%_slideDown{0%{opacity:0;transform:translateY(-10px)}to{opacity:1;transform:translateY(0)}}.customer-actions-minimal[_ngcontent-%COMP%]{display:flex;gap:10px;flex-wrap:wrap;align-items:center}.customer-actions-detailed[_ngcontent-%COMP%]{display:flex;gap:10px;margin-top:15px;justify-content:flex-start}.customer-basic-info[_ngcontent-%COMP%]{margin-top:15px}.show-details-container[_ngcontent-%COMP%]{margin-top:15px;padding-top:15px;border-top:1px solid #e9ecef;display:flex;justify-content:center}.show-details-btn[_ngcontent-%COMP%]{background:#6c757d;color:#fff;border:none;border-radius:8px;padding:8px 12px;cursor:pointer;font-size:12px;transition:all .3s ease;display:flex;align-items:center;gap:5px}.show-details-btn[_ngcontent-%COMP%]:hover{background:#545862;transform:translateY(-1px)}.detailed-info[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:10px}.customer-expanded[_ngcontent-%COMP%]{box-shadow:0 8px 25px #00000026;transform:scale(1.02);transition:all .3s ease}@media (max-width: 768px){.customer-actions-minimal[_ngcontent-%COMP%]{flex-direction:column;align-items:stretch}.customer-actions-detailed[_ngcontent-%COMP%]{flex-direction:column}.show-details-container[_ngcontent-%COMP%]{order:1}.show-details-btn[_ngcontent-%COMP%]{width:100%;justify-content:center}}"]})};function aG(n,e){if(n&1){let t=de();m(0,"div",64),z("click",function(){let i=B(t).$implicit,o=A(4);return U(o.selectCustomer(i))}),m(1,"div",65)(2,"span",66),y(3),g(),m(4,"span",67),y(5),g()()()}if(n&2){let t=e.$implicit,r=A(4);Ze("selected",(r.invoice.customer==null?null:r.invoice.customer.id)===t.id),I(3),se(t.name),I(2),se(t.mobile)}}function cG(n,e){if(n&1&&(m(0,"div",62),ie(1,aG,6,4,"div",63),g()),n&2){let t=A(3);I(),V("ngForOf",t.searchResults)}}function lG(n,e){if(n&1){let t=de();m(0,"div",68)(1,"div",69)(2,"h4"),y(3,"Selected Customer:"),g(),m(4,"button",70),z("click",function(){B(t);let i=A(3);return U(i.clearSelectedCustomer())}),K(5,"i",71),g()(),m(6,"div",72)(7,"p")(8,"strong"),y(9),g()(),m(10,"p"),y(11),g(),m(12,"p"),y(13),g()()()}if(n&2){let t=A(3);I(9),se(t.invoice.customer.firstName?t.invoice.customer.prefix+" "+t.invoice.customer.firstName+" "+t.invoice.customer.lastName:t.invoice.customer.id),I(2),pe("Mobile: ",t.invoice.customer.mobile,""),I(2),pe("Address: ",t.invoice.customer.address,"")}}function uG(n,e){if(n&1&&(m(0,"div",73),K(1,"i",74),m(2,"p"),y(3,'No customer found with "'),m(4,"strong"),y(5),g(),y(6,'"'),g(),m(7,"p",75),y(8,"You can add this as a new customer using the button below."),g()()),n&2){let t=A(3);I(5),se(t.invoice.searchTerm)}}function dG(n,e){if(n&1){let t=de();m(0,"button",76),z("click",function(){B(t);let i=A(3);return U(i.showAddNewCustomer())}),K(1,"i",77),y(2," Add New Customer "),g()}}function hG(n,e){if(n&1){let t=de();m(0,"div",55)(1,"div",6)(2,"label",56),y(3,"Search Customer (Name or Mobile)"),g(),m(4,"input",57),ne("ngModelChange",function(i){B(t);let o=A(2);return re(o.invoice.searchTerm,i)||(o.invoice.searchTerm=i),U(i)}),z("input",function(){B(t);let i=A(2);return U(i.searchCustomer())}),g()(),ie(5,cG,2,1,"div",58)(6,lG,14,3,"div",59)(7,uG,9,1,"div",60)(8,dG,3,0,"button",61),g()}if(n&2){let t=A(2);I(4),te("ngModel",t.invoice.searchTerm),I(),V("ngIf",t.searchResults.length>0),I(),V("ngIf",t.invoice.customer),I(),V("ngIf",t.invoice.searchTerm&&t.searchResults.length===0&&!t.invoice.customer),I(),V("ngIf",t.invoice.searchTerm&&t.searchResults.length===0&&!t.invoice.customer)}}function fG(n,e){if(n&1){let t=de();m(0,"div",5)(1,"div",85)(2,"label",104),y(3,"Prefix"),g(),m(4,"input",105),ne("ngModelChange",function(i){B(t);let o=A(3);return re(o.newCustomer.prefix,i)||(o.newCustomer.prefix=i),U(i)}),g()(),m(5,"div",6)(6,"label",106),y(7,"First Name *"),g(),m(8,"input",107),ne("ngModelChange",function(i){B(t);let o=A(3);return re(o.newCustomer.firstName,i)||(o.newCustomer.firstName=i),U(i)}),g()()()}if(n&2){let t=A(3);I(4),te("ngModel",t.newCustomer.prefix),I(4),te("ngModel",t.newCustomer.firstName)}}function pG(n,e){if(n&1){let t=de();m(0,"div",6)(1,"label",108),y(2,"Middle Name"),g(),m(3,"input",109),ne("ngModelChange",function(i){B(t);let o=A(3);return re(o.newCustomer.middleName,i)||(o.newCustomer.middleName=i),U(i)}),g()()}if(n&2){let t=A(3);I(3),te("ngModel",t.newCustomer.middleName)}}function mG(n,e){if(n&1){let t=de();m(0,"div",6)(1,"label",110),y(2,"Last Name *"),g(),m(3,"input",111),ne("ngModelChange",function(i){B(t);let o=A(3);return re(o.newCustomer.lastName,i)||(o.newCustomer.lastName=i),U(i)}),g()()}if(n&2){let t=A(3);I(3),te("ngModel",t.newCustomer.lastName)}}function gG(n,e){if(n&1){let t=de();m(0,"div",6)(1,"label",112),y(2,"Company Name *"),g(),m(3,"input",113),ne("ngModelChange",function(i){B(t);let o=A(3);return re(o.newCustomer.companyName,i)||(o.newCustomer.companyName=i),U(i)}),g()()}if(n&2){let t=A(3);I(3),te("ngModel",t.newCustomer.companyName)}}function vG(n,e){if(n&1&&(m(0,"option",116),y(1),g()),n&2){let t=e.$implicit;V("value",t),I(),se(t)}}function _G(n,e){if(n&1){let t=de();m(0,"div",6)(1,"label",114),y(2,"Company Type *"),g(),m(3,"select",115),ne("ngModelChange",function(i){B(t);let o=A(3);return re(o.newCustomer.companyType,i)||(o.newCustomer.companyType=i),U(i)}),m(4,"option",21),y(5,"Select Company Type"),g(),ie(6,vG,2,2,"option",22),g()()}if(n&2){let t=A(3);I(3),te("ngModel",t.newCustomer.companyType),I(3),V("ngForOf",t.companyTypeOptions)}}function yG(n,e){if(n&1&&(m(0,"option",116),y(1),g()),n&2){let t=e.$implicit;V("value",t.code),I(),vs("",t.code," ",t.country,"")}}function wG(n,e){if(n&1){let t=de();m(0,"div",117)(1,"button",118),z("click",function(){B(t);let i=A(3);return U(i.addNewCustomer())}),y(2," \u{1F4BE} Save Customer "),g()()}}function CG(n,e){if(n&1){let t=de();m(0,"div",78)(1,"div",79)(2,"div",80)(3,"h3"),y(4,"\u{1F464} Customer Information"),g(),m(5,"div",6)(6,"label"),y(7,"Customer Type *"),g(),m(8,"div",11)(9,"label",12)(10,"input",81),ne("ngModelChange",function(i){B(t);let o=A(2);return re(o.newCustomer.customerType,i)||(o.newCustomer.customerType=i),U(i)}),g(),m(11,"span",14),y(12,"Individual"),g()(),m(13,"label",12)(14,"input",82),ne("ngModelChange",function(i){B(t);let o=A(2);return re(o.newCustomer.customerType,i)||(o.newCustomer.customerType=i),U(i)}),g(),m(15,"span",14),y(16,"Company"),g()()()(),ie(17,fG,9,2,"div",83)(18,pG,4,1,"div",84)(19,mG,4,1,"div",84)(20,gG,4,1,"div",84)(21,_G,7,2,"div",84),m(22,"div",6)(23,"label"),y(24,"Mobile Number *"),g(),m(25,"div",5)(26,"div",85)(27,"select",86),ne("ngModelChange",function(i){B(t);let o=A(2);return re(o.newCustomer.countryCode,i)||(o.newCustomer.countryCode=i),U(i)}),ie(28,yG,2,3,"option",22),g()(),m(29,"div",6)(30,"input",87),ne("ngModelChange",function(i){B(t);let o=A(2);return re(o.newCustomer.mobile,i)||(o.newCustomer.mobile=i),U(i)}),g()()()(),m(31,"div",5)(32,"div",6)(33,"label",88),y(34,"GST Number"),g(),m(35,"input",89),ne("ngModelChange",function(i){B(t);let o=A(2);return re(o.newCustomer.gst,i)||(o.newCustomer.gst=i),U(i)}),g()(),m(36,"div",6)(37,"label",90),y(38,"Email Address"),g(),m(39,"input",91),ne("ngModelChange",function(i){B(t);let o=A(2);return re(o.newCustomer.email,i)||(o.newCustomer.email=i),U(i)}),g()()()(),m(40,"div",92)(41,"h3"),y(42,"\u{1F4CD} Address Information"),g(),m(43,"div",6)(44,"label",93),y(45,"Address Line 1 *"),g(),m(46,"input",94),ne("ngModelChange",function(i){B(t);let o=A(2);return re(o.newCustomer.addressLine1,i)||(o.newCustomer.addressLine1=i),U(i)}),g()(),m(47,"div",5)(48,"div",6)(49,"label",95),y(50,"Village *"),g(),m(51,"input",96),ne("ngModelChange",function(i){B(t);let o=A(2);return re(o.newCustomer.village,i)||(o.newCustomer.village=i),U(i)}),g()(),m(52,"div",6)(53,"label",97),y(54,"Taluka"),g(),m(55,"input",98),ne("ngModelChange",function(i){B(t);let o=A(2);return re(o.newCustomer.taluka,i)||(o.newCustomer.taluka=i),U(i)}),g()()(),m(56,"div",5)(57,"div",6)(58,"label",99),y(59,"District *"),g(),m(60,"input",100),ne("ngModelChange",function(i){B(t);let o=A(2);return re(o.newCustomer.district,i)||(o.newCustomer.district=i),U(i)}),g()(),m(61,"div",6)(62,"label",101),y(63,"Pin Code"),g(),m(64,"input",102),ne("ngModelChange",function(i){B(t);let o=A(2);return re(o.newCustomer.pinCode,i)||(o.newCustomer.pinCode=i),U(i)}),g()()()(),ie(65,wG,3,0,"div",103),g()()}if(n&2){let t=A(2);I(10),te("ngModel",t.newCustomer.customerType),I(4),te("ngModel",t.newCustomer.customerType),I(3),V("ngIf",t.newCustomer.customerType==="individual"),I(),V("ngIf",t.newCustomer.customerType==="individual"),I(),V("ngIf",t.newCustomer.customerType==="individual"),I(),V("ngIf",t.newCustomer.customerType==="company"),I(),V("ngIf",t.newCustomer.customerType==="company"),I(6),te("ngModel",t.newCustomer.countryCode),I(),V("ngForOf",t.countryCodeOptions),I(2),te("ngModel",t.newCustomer.mobile),I(5),te("ngModel",t.newCustomer.gst),I(4),te("ngModel",t.newCustomer.email),I(7),te("ngModel",t.newCustomer.addressLine1),I(5),te("ngModel",t.newCustomer.village),I(4),te("ngModel",t.newCustomer.taluka),I(5),te("ngModel",t.newCustomer.district),I(4),te("ngModel",t.newCustomer.pinCode),I(),V("ngIf",t.showAddCustomerForm)}}function bG(n,e){if(n&1&&(m(0,"option",116),y(1),g()),n&2){let t=e.$implicit;V("value",t),I(),se(t)}}function IG(n,e){if(n&1){let t=de();m(0,"input",119),ne("ngModelChange",function(i){B(t);let o=A(2);return re(o.newService.customDescription,i)||(o.newService.customDescription=i),U(i)}),z("focus",function(i){B(t);let o=A(2);return U(o.onCustomDescriptionFocus(i))}),g()}if(n&2){let t=A(2);te("ngModel",t.newService.customDescription)}}function EG(n,e){if(n&1&&(m(0,"p"),y(1),g()),n&2){let t=A().$implicit;I(),se(t.notes)}}function xG(n,e){if(n&1){let t=de();m(0,"div",122)(1,"div",123)(2,"h5"),y(3),g(),ie(4,EG,2,1,"p",124),g(),m(5,"div",125)(6,"span",126),y(7),Ve(8,"number"),g(),m(9,"button",127),z("click",function(){let i=B(t).index,o=A(3);return U(o.removeServiceFromList(i))}),y(10," \u2715 "),g()()()}if(n&2){let t=e.$implicit,r=A(3);I(3),se(r.getServiceDisplayName(t)),I(),V("ngIf",t.notes),I(3),pe("\u20B9",je(8,3,t.amount,"1.2-2"),"")}}function SG(n,e){if(n&1&&(m(0,"div",120)(1,"h4"),y(2,"\u{1F4CB} Added Services:"),g(),ie(3,xG,11,6,"div",121),g()),n&2){let t=A(2);I(3),V("ngForOf",t.invoice.serviceDetails)}}function TG(n,e){if(n&1&&(m(0,"option",116),y(1),g()),n&2){let t=e.$implicit;V("value",t),I(),se(t)}}function DG(n,e){if(n&1&&(m(0,"option",116),y(1),g()),n&2){let t=e.$implicit;V("value",t),I(),se(t)}}function MG(n,e){if(n&1){let t=de();m(0,"div",1)(1,"div",2)(2,"h2"),y(3),g()(),m(4,"form",3)(5,"div",4)(6,"h3"),y(7,"\u{1F4CB} Invoice Details"),g(),m(8,"div",5)(9,"div",6)(10,"label",7),y(11,"Invoice Date"),g(),m(12,"input",8),ne("ngModelChange",function(i){B(t);let o=A();return re(o.invoice.invoiceDate,i)||(o.invoice.invoiceDate=i),U(i)}),z("change",function(){B(t);let i=A();return U(i.onInvoiceDateChange())}),g()(),m(13,"div",6)(14,"label",9),y(15,"Invoice Number"),g(),m(16,"input",10),ne("ngModelChange",function(i){B(t);let o=A();return re(o.invoice.invoiceNumber,i)||(o.invoice.invoiceNumber=i),U(i)}),g()()()(),m(17,"div",4)(18,"h3"),y(19,"\u{1F464} Customer Details"),g(),m(20,"div",11)(21,"label",12)(22,"input",13),ne("ngModelChange",function(i){B(t);let o=A();return re(o.invoice.customerType,i)||(o.invoice.customerType=i),U(i)}),z("change",function(){B(t);let i=A();return U(i.onCustomerTypeChange())}),g(),m(23,"span",14),y(24,"Existing Customer"),g()(),m(25,"label",12)(26,"input",15),ne("ngModelChange",function(i){B(t);let o=A();return re(o.invoice.customerType,i)||(o.invoice.customerType=i),U(i)}),z("change",function(){B(t);let i=A();return U(i.onCustomerTypeChange())}),g(),m(27,"span",14),y(28,"New Customer"),g()()(),ie(29,hG,9,5,"div",16)(30,CG,66,18,"div",17),g(),m(31,"div",4)(32,"h3"),y(33,"\u{1F4BC} Service Details"),g(),m(34,"div",18)(35,"h4"),y(36),g(),m(37,"div",6)(38,"label",19),y(39,"Service Description / Particulars *"),g(),m(40,"select",20),ne("ngModelChange",function(i){B(t);let o=A();return re(o.newService.description,i)||(o.newService.description=i),U(i)}),z("change",function(i){B(t);let o=A();return U(o.onNewServiceDescriptionChange(i))}),m(41,"option",21),y(42,"Select a service or enter custom description"),g(),ie(43,bG,2,2,"option",22),m(44,"option",23),y(45,"\u26A1 Enter Custom Description"),g()(),ie(46,IG,1,1,"input",24),g(),m(47,"div",5)(48,"div",6)(49,"label",25),y(50,"Amount *"),g(),m(51,"input",26),ne("ngModelChange",function(i){B(t);let o=A();return re(o.newService.amount,i)||(o.newService.amount=i),U(i)}),z("focus",function(i){B(t);let o=A();return U(o.onAmountFocus(i))}),g()(),m(52,"div",6)(53,"label",27),y(54,"Notes (Optional)"),g(),m(55,"input",28),ne("ngModelChange",function(i){B(t);let o=A();return re(o.newService.notes,i)||(o.newService.notes=i),U(i)}),g()()(),m(56,"button",29),z("click",function(){B(t);let i=A();return U(i.addServiceToList())}),y(57," Add Service "),g()(),ie(58,SG,4,1,"div",30),g(),m(59,"div",31)(60,"h3",32),y(61,"\u{1F4B0} Payment Summary"),g(),m(62,"div",33)(63,"div",34)(64,"h4"),y(65,"Payment Details"),g()(),m(66,"div",35)(67,"div",36)(68,"span",37),y(69,"Total Amount:"),g(),m(70,"span",38),y(71),Ve(72,"number"),g()()(),m(73,"div",39)(74,"div",40)(75,"label",41),y(76,"Advance Received"),g(),m(77,"input",42),ne("ngModelChange",function(i){B(t);let o=A();return re(o.invoice.advanceReceived,i)||(o.invoice.advanceReceived=i),U(i)}),z("input",function(){B(t);let i=A();return U(i.onAmountChange())})("focus",function(i){B(t);let o=A();return U(o.onAmountFocus(i))}),g()(),m(78,"div",40)(79,"label",43),y(80,"Payment Type"),g(),m(81,"select",44),ne("ngModelChange",function(i){B(t);let o=A();return re(o.invoice.paymentType,i)||(o.invoice.paymentType=i),U(i)}),m(82,"option",21),y(83,"Select Payment Type"),g(),ie(84,TG,2,2,"option",22),g()(),m(85,"div",40)(86,"label",45),y(87,"Payment Notes"),g(),m(88,"textarea",46),ne("ngModelChange",function(i){B(t);let o=A();return re(o.invoice.paymentNotes,i)||(o.invoice.paymentNotes=i),U(i)}),y(89,"            "),g()()(),m(90,"div",47)(91,"div",48)(92,"span",37),y(93,"Balance / Net Payable:"),g(),m(94,"span",49),y(95),Ve(96,"number"),g()()()()(),m(97,"div",4)(98,"h3"),y(99,"\u{1F3E6} Bank Account"),g(),m(100,"div",6)(101,"label",50),y(102,"Select Bank Account (To Receive Amount) *"),g(),m(103,"select",51),ne("ngModelChange",function(i){B(t);let o=A();return re(o.invoice.selectedBank,i)||(o.invoice.selectedBank=i),U(i)}),m(104,"option",21),y(105,"Select Bank Account"),g(),ie(106,DG,2,2,"option",22),g()()(),m(107,"div",52)(108,"button",53),z("click",function(){B(t);let i=A();return U(i.goBack())}),y(109,"Cancel"),g(),m(110,"button",54),z("click",function(){B(t);let i=A();return U(i.isEditMode?i.updateAndPreview():i.previewInvoice())}),y(111),g()()()()}if(n&2){let t=A();I(3),se(t.isEditMode?"Edit Invoice":"Create Invoice"),I(9),te("ngModel",t.invoice.invoiceDate),V("max",t.getCurrentDate()),I(4),te("ngModel",t.invoice.invoiceNumber),I(6),te("ngModel",t.invoice.customerType),I(4),te("ngModel",t.invoice.customerType),I(3),V("ngIf",t.invoice.customerType==="existing"),I(),V("ngIf",t.invoice.customerType==="new"||t.showAddCustomerForm),I(6),se(t.invoice.serviceDetails.length>0?"Add Another Service:":"Add Service:"),I(4),te("ngModel",t.newService.description),I(3),V("ngForOf",t.serviceOptions),I(3),V("ngIf",t.newService.description==="custom"),I(5),te("ngModel",t.newService.amount),I(4),te("ngModel",t.newService.notes),I(),V("disabled",!t.canAddService()),I(2),V("ngIf",t.invoice.serviceDetails.length>0),I(13),pe("\u20B9",je(72,26,t.invoice.totalAmount,"1.2-2"),""),I(6),te("ngModel",t.invoice.advanceReceived),I(4),te("ngModel",t.invoice.paymentType),V("disabled",!t.invoice.advanceReceived||t.invoice.advanceReceived<=0),I(3),V("ngForOf",t.paymentTypeOptions),I(4),te("ngModel",t.invoice.paymentNotes),I(7),pe("\u20B9",je(96,29,t.invoice.balancePayable,"1.2-2"),""),I(8),te("ngModel",t.invoice.selectedBank),I(3),V("ngForOf",t.bankAccounts),I(5),pe(" ",t.isEditMode?"Update Invoice":"Preview Invoice"," ")}}var qg=class n{constructor(e,t,r,i){this.router=e;this.route=t;this.invoiceService=r;this.customerService=i;this.calculateTotals()}isEditMode=!1;editInvoiceId=null;showPreview=!1;savedInvoiceId=null;invoice={invoiceNumber:"",invoiceDate:this.getCurrentDate(),customer:null,customerType:"existing",searchTerm:"",serviceDetails:[],totalAmount:0,advanceReceived:0,balancePayable:0,selectedBank:"",paymentType:"",paymentNotes:""};existingCustomers=[];searchResults=[];showAddCustomerForm=!1;showCustomerSearch=!1;newCustomer={customerType:"individual",prefix:"Mr.",firstName:"",middleName:"",lastName:"",companyName:"",companyType:"",countryCode:"+91",mobile:"",gst:"",email:"",addressLine1:"",village:"",taluka:"",district:"",pinCode:""};bankAccounts=["HDFC Bank - Current Account (****1234)","ICICI Bank - Savings Account (****5678)","SBI Bank - Current Account (****9012)","Axis Bank - Current Account (****3456)"];serviceOptions=["Incorporation of Producer Company","ITR Filing","GST Filing","Company Registration","GST Registration","Income Tax Return","Audit Services","Compliance Services","Other Services"];countryCodeOptions=[{code:"+91",country:"India"},{code:"+1",country:"USA"},{code:"+44",country:"UK"},{code:"+86",country:"China"},{code:"+81",country:"Japan"}];companyTypeOptions=["Private Limited","Public Limited","LLP","Partnership","Sole Proprietorship","OPC"];paymentTypeOptions=["Cash","UPI","Bank Transfer","Card Payment","Cheque","Online Payment","NEFT/RTGS","Other"];prefixOptions=["Mr.","Mrs.","Ms.","Dr.","Prof.","Er.","Adv.","CA.","M/s."];newService={description:"",customDescription:"",amount:null,notes:""};ngOnInit(){return w(this,null,function*(){this.invoice.invoiceDate=this.getCurrentDate(),this.invoice.invoiceNumber=yield this.generateInvoiceNumber(),this.initializeInvoice(),this.loadCustomers(),this.route.queryParams.subscribe(e=>{e.edit?(this.isEditMode=!0,this.editInvoiceId=e.edit,this.editInvoiceId&&this.loadInvoiceForEdit(this.editInvoiceId)):e.mode==="edit"&&this.restoreFromPreviewEdit()})})}restoreFromPreviewEdit(){try{let e=sessionStorage.getItem("editInvoiceData");if(e){let t=JSON.parse(e);console.log("Restoring from preview edit:",t),t.invoiceData&&(this.invoice=L({},t.invoiceData),this.invoice.customerType=this.invoice.customerType||"existing",this.invoice.invoiceDate=this.invoice.invoiceDate||this.getCurrentDate(),this.invoice.serviceDetails&&Array.isArray(this.invoice.serviceDetails)?this.invoice.serviceDetails=this.invoice.serviceDetails.map(r=>({description:r.description||"",amount:Number(r.amount)||0,notes:r.notes||""})):this.invoice.serviceDetails=[],this.isEditMode=t.isEditMode||!1,this.editInvoiceId=t.editInvoiceId||null,this.invoice.customer&&(this.invoice.customerType="existing"),console.log("Restored invoice:",this.invoice),console.log("Edit mode:",this.isEditMode),console.log("Edit ID:",this.editInvoiceId),sessionStorage.removeItem("editInvoiceData"),this.calculateTotals())}}catch(e){console.error("Error restoring form from preview edit:",e),alert(`Error restoring form data: ${e instanceof Error?e.message:"Unknown error"}`)}}loadCustomers(){return w(this,null,function*(){try{this.existingCustomers=yield this.customerService.getCustomers(),this.existingCustomers.length===0&&(yield this.addSampleCustomers(),this.existingCustomers=yield this.customerService.getCustomers())}catch(e){console.error("Error loading customers:",e),this.existingCustomers=[]}})}addSampleCustomers(){return w(this,null,function*(){let e=[{name:"Mr. Rahul Sharma",mobile:"+91 9876543210",email:"rahul.sharma@email.com",address:"123 MG Road, Mumbai, Maharashtra - 400001",gst:"GST123456789",dueAmount:0},{name:"Ms. Priya Patel",mobile:"+91 9876543211",email:"priya.patel@email.com",address:"456 FC Road, Pune, Maharashtra - 411004",gst:"GST987654321",dueAmount:0},{name:"Innovative Solutions Pvt Ltd",mobile:"+91 9876543212",email:"contact@innovative.com",address:"789 IT Park, Bangalore, Karnataka - 560001",gst:"GST456789123",dueAmount:0}];for(let t of e)try{yield this.customerService.addCustomer(t)}catch(r){console.error("Error adding sample customer:",r)}})}loadInvoiceForEdit(e){return w(this,null,function*(){try{console.log("Loading invoice for edit, ID:",e);let t=yield this.invoiceService.getInvoiceById(e);if(console.log("Retrieved invoice:",t),t){if(this.invoice.invoiceNumber=t.invoiceNumber,this.invoice.invoiceDate=t.invoiceDate,this.invoice.totalAmount=t.totalAmount,this.invoice.advanceReceived=t.advanceReceived,this.invoice.balancePayable=t.balancePayable,this.invoice.selectedBank=t.selectedBank,t.customer){this.invoice.customerType="existing";let r=t.customer.name||"",i=t.customer.address||"";this.invoice.customer={id:r,prefix:"",firstName:r.split(" ")[0]||"",lastName:r.split(" ").slice(1).join(" ")||"",mobile:t.customer.mobile||"",email:t.customer.email||"",address:i.split(",")[0]||"",city:"",state:"",pincode:""}}t.serviceDetails&&Array.isArray(t.serviceDetails)?(this.invoice.serviceDetails=t.serviceDetails.map(r=>({description:r.description||"",amount:Number(r.amount)||0,notes:r.notes||""})),console.log("Mapped service details:",this.invoice.serviceDetails)):(console.warn("No service details found or invalid format"),this.invoice.serviceDetails=[]),this.calculateTotals(),console.log("Invoice form populated successfully")}else throw new Error("Invoice not found")}catch(t){console.error("Error loading invoice for edit:",t),alert(`Error loading invoice data: ${t instanceof Error?t.message:"Unknown error"}`)}})}generateInvoiceNumber(){return w(this,null,function*(){return yield this.invoiceService.generateNextInvoiceNumber(this.invoice.invoiceDate)})}onInvoiceDateChange(){return w(this,null,function*(){let e=new Date(this.invoice.invoiceDate),t=new Date;if(e.setHours(0,0,0,0),t.setHours(0,0,0,0),e>t){alert("Future dates are not allowed. Please select today's date or an earlier date."),this.invoice.invoiceDate=this.getCurrentDate();return}this.isEditMode||(this.invoice.invoiceNumber=yield this.generateInvoiceNumber())})}getCurrentDate(){return new Date().toISOString().split("T")[0]}onCustomerTypeChange(){this.invoice.customer=null,this.searchResults=[],this.showAddCustomerForm=!1,this.showCustomerSearch=this.invoice.customerType==="existing"}searchCustomer(){if(!this.invoice.searchTerm.trim()){this.searchResults=[];return}let e=this.invoice.searchTerm.toLowerCase();this.searchResults=this.existingCustomers.filter(t=>t.mobile.includes(e)||t.name.toLowerCase().includes(e)||t.email.toLowerCase().includes(e))}selectCustomer(e){this.invoice.customer={id:e.id,prefix:"",firstName:e.name.split(" ")[0]||"",lastName:e.name.split(" ").slice(1).join(" ")||"",mobile:e.mobile,email:e.email,address:e.address,city:"",state:"",pincode:""},this.searchResults=[],this.invoice.searchTerm=`${e.name} (${e.mobile})`}clearSelectedCustomer(){this.invoice.customer=null,this.invoice.searchTerm="",this.searchResults=[]}showAddNewCustomer(){this.invoice.customerType="new",this.showAddCustomerForm=!0}addNewCustomer(){return w(this,null,function*(){let e=!1,t="";if(this.newCustomer.customerType==="individual"?(e=!!(this.newCustomer.prefix&&this.newCustomer.firstName&&this.newCustomer.lastName&&this.newCustomer.countryCode&&this.newCustomer.mobile&&this.newCustomer.addressLine1&&this.newCustomer.village&&this.newCustomer.district),t=`${this.newCustomer.prefix} ${this.newCustomer.firstName} ${this.newCustomer.middleName?this.newCustomer.middleName+" ":""}${this.newCustomer.lastName}`.trim()):this.newCustomer.customerType==="company"&&(e=!!(this.newCustomer.companyName&&this.newCustomer.companyType&&this.newCustomer.countryCode&&this.newCustomer.mobile&&this.newCustomer.addressLine1&&this.newCustomer.village&&this.newCustomer.district),t=`${this.newCustomer.companyName} (${this.newCustomer.companyType})`),e)try{let r=`${this.newCustomer.countryCode} ${this.newCustomer.mobile}`,i=`${this.newCustomer.addressLine1}, ${this.newCustomer.village}${this.newCustomer.taluka?", "+this.newCustomer.taluka:""}, ${this.newCustomer.district}${this.newCustomer.pinCode?", "+this.newCustomer.pinCode:""}`,o={name:t,mobile:r,email:this.newCustomer.email||"",address:i,gst:this.newCustomer.gst||"",dueAmount:0},s=yield this.customerService.addCustomer(o),a=L({id:s},o);yield this.loadCustomers();let c=this.existingCustomers.find(u=>u.id===s);c&&this.selectCustomer(c),this.showAddCustomerForm=!1,this.newCustomer={customerType:"individual",prefix:"Mr.",firstName:"",middleName:"",lastName:"",companyName:"",companyType:"",countryCode:"+91",mobile:"",gst:"",email:"",addressLine1:"",village:"",taluka:"",district:"",pinCode:""}}catch(r){console.error("Error adding customer:",r),alert("Error adding customer. Please try again.")}else alert("Please fill in all mandatory fields")})}addServiceDetail(){this.invoice.serviceDetails.push({description:"",amount:0,notes:""})}removeServiceDetail(e){this.invoice.serviceDetails.length>1&&(this.invoice.serviceDetails.splice(e,1),this.calculateTotals())}calculateTotals(){this.invoice.totalAmount=this.invoice.serviceDetails.reduce((e,t)=>e+(t.amount||0),0),this.invoice.balancePayable=this.invoice.totalAmount-(this.invoice.advanceReceived||0)}onAmountChange(){this.calculateTotals()}onAdvanceChange(){this.calculateTotals()}previewInvoice(){return w(this,null,function*(){if(this.validateInvoice())try{let e=yield this.prepareInvoiceData();sessionStorage.setItem("tempInvoiceData",JSON.stringify({invoiceData:e,formData:{invoice:this.invoice,newCustomer:this.newCustomer,isEditMode:this.isEditMode,editInvoiceId:this.editInvoiceId}})),this.router.navigate(["/invoice-preview"],{queryParams:{mode:"preview"}})}catch(e){console.error("Error preparing invoice data:",e),alert("Error preparing invoice data. Please try again.")}else console.log("Validation failed")})}updateAndPreview(){return w(this,null,function*(){if(this.validateInvoice())try{let e=yield this.prepareInvoiceData();sessionStorage.setItem("tempInvoiceData",JSON.stringify({invoiceData:e,formData:{invoice:this.invoice,newCustomer:this.newCustomer,isEditMode:this.isEditMode,editInvoiceId:this.editInvoiceId}})),this.router.navigate(["/invoice-preview"],{queryParams:{mode:"preview"}})}catch(e){console.error("Error preparing invoice data:",e),alert("Error preparing invoice data. Please try again.")}else console.log("Validation failed")})}prepareInvoiceData(){return w(this,null,function*(){let e;if(this.invoice.customerType==="new")try{let r=this.newCustomer.customerType==="company"?this.newCustomer.companyName:`${this.newCustomer.prefix} ${this.newCustomer.firstName} ${this.newCustomer.middleName?this.newCustomer.middleName+" ":""}${this.newCustomer.lastName}`.trim(),i=`${this.newCustomer.countryCode} ${this.newCustomer.mobile}`,o=`${this.newCustomer.addressLine1}, ${this.newCustomer.village}, ${this.newCustomer.taluka}, ${this.newCustomer.district} - ${this.newCustomer.pinCode}`.trim(),s={name:r,mobile:i,email:this.newCustomer.email||"",address:o,gst:this.newCustomer.gst||"",dueAmount:0},a=yield this.customerService.addCustomer(s);console.log("\u2705 New customer saved to Firestore with ID:",a),e={id:a,name:r,mobile:i,email:this.newCustomer.email||"",address:o,gst:this.newCustomer.gst||""}}catch(r){throw console.error("\u274C Error saving new customer:",r),new Error("Failed to save customer. Please try again.")}else e={id:this.invoice.customer.id,name:this.invoice.customer.firstName?`${this.invoice.customer.prefix} ${this.invoice.customer.firstName} ${this.invoice.customer.lastName}`.trim():this.invoice.customer.id,mobile:this.invoice.customer.mobile,email:this.invoice.customer.email,address:`${this.invoice.customer.address}, ${this.invoice.customer.city}, ${this.invoice.customer.state} - ${this.invoice.customer.pincode}`,gst:""};let t=this.invoice.serviceDetails.map(r=>({description:r.description,customDescription:r.customDescription,quantity:1,rate:r.amount,amount:r.amount,notes:r.notes||""}));return{invoiceNumber:this.invoice.invoiceNumber,invoiceDate:this.invoice.invoiceDate,customer:e,serviceDetails:t,totalAmount:this.invoice.totalAmount,advanceReceived:this.invoice.advanceReceived,balancePayable:this.invoice.balancePayable,selectedBank:this.invoice.selectedBank,createdAt:new Date,status:this.invoice.balancePayable===0?"PAID":this.invoice.advanceReceived>0?"PARTIAL":"PENDING"}})}saveInvoice(){return w(this,null,function*(){if(this.validateInvoice())try{let e=yield this.prepareInvoiceData();if(this.isEditMode&&this.editInvoiceId)yield this.invoiceService.updateInvoice(this.editInvoiceId,e),this.savedInvoiceId=this.editInvoiceId;else{let t=yield this.invoiceService.addInvoice(e);this.savedInvoiceId=t}this.showPreview=!0}catch(e){console.error("Error saving invoice:",e),alert(this.isEditMode?"Error updating invoice. Please try again.":"Error creating invoice. Please try again.")}})}validateInvoice(){if(!this.invoice.customer&&this.invoice.customerType==="existing")return alert("Please select a customer"),!1;if(this.invoice.customerType==="new"){let e=!1;if(this.newCustomer.customerType==="individual"?e=!!(this.newCustomer.firstName&&this.newCustomer.lastName&&this.newCustomer.mobile&&this.newCustomer.addressLine1):this.newCustomer.customerType==="company"&&(e=!!(this.newCustomer.companyName&&this.newCustomer.companyType&&this.newCustomer.mobile&&this.newCustomer.addressLine1)),!e)return alert("Please fill all mandatory customer details"),!1}return this.invoice.serviceDetails.some(e=>!e.description||e.amount<=0)?(alert("Please fill all service details with valid amounts"),!1):this.invoice.selectedBank?!0:(alert("Please select a bank account"),!1)}onAmountFocus(e){(e.target.value==="0"||e.target.value===0)&&(e.target.value="")}onCustomDescriptionFocus(e){setTimeout(()=>{e.target.select()},0)}onServiceDescriptionChange(e,t){let r=t.target.value;this.invoice.serviceDetails[e].description=r,r==="custom"?this.invoice.serviceDetails[e].customDescription="":delete this.invoice.serviceDetails[e].customDescription}onNewServiceDescriptionChange(e){let t=e.target.value;this.newService.description=t,t!=="custom"&&(this.newService.customDescription="")}canAddService(){let e=this.newService.description&&(this.newService.description!=="custom"||this.newService.description==="custom"&&this.newService.customDescription&&this.newService.customDescription.trim().length>0),t=this.newService.amount!==null&&this.newService.amount>0;return!!e&&t}addServiceToList(){if(this.canAddService()){let e={description:this.newService.description,customDescription:this.newService.customDescription,amount:this.newService.amount||0,notes:this.newService.notes};this.invoice.serviceDetails.push(e),this.onAmountChange(),this.newService={description:"",customDescription:"",amount:null,notes:""}}}removeServiceFromList(e){this.invoice.serviceDetails.splice(e,1),this.onAmountChange()}initializeInvoice(){(!this.invoice.serviceDetails||this.invoice.serviceDetails.length===0)&&(this.invoice.serviceDetails=[])}getServiceDisplayName(e){return e.description==="custom"?e.customDescription||"Custom Service":e.description}goBack(){this.router.navigate(["/dashboard"],{queryParams:{category:"invoices"}})}returnToForm(){this.showPreview=!1}cancelInvoice(){sessionStorage.removeItem("tempInvoiceData"),sessionStorage.removeItem("editInvoiceData"),this.router.navigate(["/dashboard"],{queryParams:{category:"invoices"}})}printInvoice(){this.savedInvoiceId&&window.print()}shareViaWhatsApp(){if(this.savedInvoiceId&&this.invoice.customer){let e=`Invoice ${this.invoice.invoiceNumber} for amount \u20B9${this.invoice.totalAmount} has been generated. Balance amount: \u20B9${this.invoice.balancePayable}`,t=`https://wa.me/91${this.invoice.customer.mobile}?text=${encodeURIComponent(e)}`;window.open(t,"_blank")}}static \u0275fac=function(t){return new(t||n)(q(it),q(qt),q(nr),q(gi))};static \u0275cmp=Pt({type:n,selectors:[["app-create-invoice"]],decls:1,vars:1,consts:[["class","create-invoice-container",4,"ngIf"],[1,"create-invoice-container"],[1,"invoice-header"],[1,"invoice-form"],[1,"form-section"],[1,"form-row"],[1,"form-group"],["for","invoiceDate"],["type","date","id","invoiceDate","name","invoiceDate",1,"form-control",3,"ngModelChange","change","ngModel","max"],["for","invoiceNumber"],["type","text","id","invoiceNumber","name","invoiceNumber","readonly","","title","Invoice number is auto-generated based on selected date",1,"form-control",3,"ngModelChange","ngModel"],[1,"radio-group"],[1,"radio-option"],["type","radio","name","customerType","value","existing",3,"ngModelChange","change","ngModel"],[1,"radio-text"],["type","radio","name","customerType","value","new",3,"ngModelChange","change","ngModel"],["class","customer-search",4,"ngIf"],["class","new-customer-form",4,"ngIf"],[1,"add-service-form"],["for","newServiceDescription"],["id","newServiceDescription","name","newServiceDescription",1,"form-control","service-dropdown",3,"ngModelChange","change","ngModel"],["value",""],[3,"value",4,"ngFor","ngForOf"],["value","custom"],["type","text","name","newCustomDescription","placeholder","Enter your custom service description...","class","form-control custom-input",3,"ngModel","ngModelChange","focus",4,"ngIf"],["for","newServiceAmount"],["type","number","id","newServiceAmount","name","newServiceAmount","min","0","step","0.01","placeholder","0",1,"form-control",3,"ngModelChange","focus","ngModel"],["for","newServiceNotes"],["type","text","id","newServiceNotes","name","newServiceNotes","placeholder","e.g., Including challan fees",1,"form-control",3,"ngModelChange","ngModel"],["type","button",1,"add-service-btn",3,"click","disabled"],["class","service-list",4,"ngIf"],[1,"form-section","payment-summary-section"],[1,"section-title"],[1,"payment-summary"],[1,"payment-header"],[1,"amount-display"],[1,"summary-row","total-amount"],[1,"label"],[1,"amount","primary"],[1,"payment-section"],[1,"form-group","compact"],["for","advanceReceived"],["type","number","id","advanceReceived","name","advanceReceived","min","0","step","0.01","placeholder","0",1,"form-control",3,"ngModelChange","input","focus","ngModel"],["for","paymentType"],["id","paymentType","name","paymentType",1,"form-control",3,"ngModelChange","ngModel","disabled"],["for","paymentNotes"],["id","paymentNotes","name","paymentNotes","placeholder","Enter payment details, reference number, etc.","rows","2",1,"form-control",3,"ngModelChange","ngModel"],[1,"balance-section"],[1,"summary-row","balance-payable"],[1,"amount","highlight"],["for","bankAccount"],["id","bankAccount","name","bankAccount","required","",1,"form-control",3,"ngModelChange","ngModel"],[1,"action-buttons"],["type","button",1,"cancel-btn",3,"click"],["type","button",1,"preview-btn",3,"click"],[1,"customer-search"],["for","customerSearch"],["type","text","id","customerSearch","name","customerSearch","placeholder","Enter customer name or mobile number",1,"form-control",3,"ngModelChange","input","ngModel"],["class","search-results",4,"ngIf"],["class","selected-customer",4,"ngIf"],["class","no-results-message",4,"ngIf"],["type","button","class","add-customer-btn",3,"click",4,"ngIf"],[1,"search-results"],["class","customer-result",3,"selected","click",4,"ngFor","ngForOf"],[1,"customer-result",3,"click"],[1,"customer-info"],[1,"customer-name"],[1,"customer-mobile"],[1,"selected-customer"],[1,"selected-customer-header"],["type","button","title","Clear selected customer",1,"clear-customer-btn",3,"click"],[1,"fas","fa-times"],[1,"customer-card","selected"],[1,"no-results-message"],[1,"fas","fa-search"],[1,"help-text"],["type","button",1,"add-customer-btn",3,"click"],[1,"fas","fa-user-plus"],[1,"new-customer-form"],[1,"customer-form-container"],[1,"form-section","customer-info-section"],["type","radio","name","newCustomerType","value","individual",3,"ngModelChange","ngModel"],["type","radio","name","newCustomerType","value","company",3,"ngModelChange","ngModel"],["class","form-row",4,"ngIf"],["class","form-group",4,"ngIf"],[1,"form-group","small"],["name","countryCode",1,"form-control",3,"ngModelChange","ngModel"],["type","tel","name","mobile","placeholder","Enter mobile number","required","",1,"form-control",3,"ngModelChange","ngModel"],["for","gst"],["type","text","name","gst","placeholder","Enter GST number",1,"form-control",3,"ngModelChange","ngModel"],["for","email"],["type","email","name","email","placeholder","Enter email address",1,"form-control",3,"ngModelChange","ngModel"],[1,"form-section","address-info-section"],["for","addressLine1"],["type","text","name","addressLine1","placeholder","Enter address line 1","required","",1,"form-control",3,"ngModelChange","ngModel"],["for","village"],["type","text","name","village","placeholder","Enter village name","required","",1,"form-control",3,"ngModelChange","ngModel"],["for","taluka"],["type","text","name","taluka","placeholder","Enter taluka name",1,"form-control",3,"ngModelChange","ngModel"],["for","district"],["type","text","name","district","placeholder","Enter district name","required","",1,"form-control",3,"ngModelChange","ngModel"],["for","pinCode"],["type","text","name","pinCode","placeholder","Enter pin code","pattern","[0-9]{6}",1,"form-control",3,"ngModelChange","ngModel"],["class","form-section action-section",4,"ngIf"],["for","prefix"],["type","text","name","prefix","placeholder","Mr./Ms./Dr.",1,"form-control",3,"ngModelChange","ngModel"],["for","firstName"],["type","text","name","firstName","placeholder","Enter first name","required","",1,"form-control",3,"ngModelChange","ngModel"],["for","middleName"],["type","text","name","middleName","placeholder","Enter middle name",1,"form-control",3,"ngModelChange","ngModel"],["for","lastName"],["type","text","name","lastName","placeholder","Enter last name","required","",1,"form-control",3,"ngModelChange","ngModel"],["for","companyName"],["type","text","name","companyName","placeholder","Enter company name","required","",1,"form-control",3,"ngModelChange","ngModel"],["for","companyType"],["name","companyType","required","",1,"form-control",3,"ngModelChange","ngModel"],[3,"value"],[1,"form-section","action-section"],["type","button",1,"save-customer-btn",3,"click"],["type","text","name","newCustomDescription","placeholder","Enter your custom service description...",1,"form-control","custom-input",3,"ngModelChange","focus","ngModel"],[1,"service-list"],["class","service-item-display",4,"ngFor","ngForOf"],[1,"service-item-display"],[1,"service-details"],[4,"ngIf"],[1,"service-actions"],[1,"service-amount"],["type","button","title","Remove service",1,"remove-service-btn",3,"click"]],template:function(t,r){t&1&&ie(0,MG,112,32,"div",0),t&2&&V("ngIf",!r.showPreview)},dependencies:[Ot,Tn,Wt,mr,Mn,Uo,Wc,qc,tr,Od,$o,Nd,pi,Bo,Hi,Fd,kd,Tr,zi],styles:[`[_nghost-%COMP%]{display:block;background:#f8f9fa;min-height:calc(100vh - 120px)}.create-invoice-container[_ngcontent-%COMP%]{max-width:900px;margin:0 auto;padding:40px 20px;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,sans-serif}.invoice-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:30px;padding-bottom:15px;border-bottom:2px solid #e9ecef}.invoice-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{color:#2c3e50;margin:0;font-size:2rem;font-weight:600}.back-btn[_ngcontent-%COMP%]{background:#6c757d;color:#fff;border:none;padding:10px 20px;border-radius:8px;cursor:pointer;font-size:14px;transition:background-color .3s ease}.back-btn[_ngcontent-%COMP%]:hover{background:#5a6268}.invoice-form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:30px}.form-section[_ngcontent-%COMP%]{background:#fff;padding:25px;border-radius:12px;box-shadow:0 2px 8px #0000001a;border:1px solid #e9ecef}.form-section[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{color:#2c3e50;margin:0 0 20px;font-size:1.3rem;font-weight:600;padding-bottom:10px;border-bottom:2px solid #f8f9fa}.form-row[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:15px;margin-bottom:15px}.form-group[_ngcontent-%COMP%]{display:flex;flex-direction:column}.form-group.small[_ngcontent-%COMP%]{max-width:120px}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-weight:500;color:#495057;margin-bottom:6px;font-size:14px}.form-control[_ngcontent-%COMP%]{padding:14px 16px;border:2px solid #e9ecef;border-radius:12px;font-size:14px;transition:all .3s ease;background-color:#fff;box-shadow:0 2px 4px #0000000d}.form-control[_ngcontent-%COMP%]:focus{outline:none;border-color:#007bff;box-shadow:0 0 0 4px #007bff1a;transform:translateY(-1px)}.form-control[_ngcontent-%COMP%]:hover{border-color:#b3d7ff}.form-control.readonly[_ngcontent-%COMP%], .form-control[readonly][_ngcontent-%COMP%]{background-color:#f8f9fa;color:#6c757d;cursor:not-allowed;border-color:#dee2e6;box-shadow:inset 0 2px 4px #0000000d}.form-control[_ngcontent-%COMP%]:invalid{border-color:#dc3545}.service-dropdown[_ngcontent-%COMP%]{appearance:none;background-image:url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6,9 12,15 18,9'%3e%3c/polyline%3e%3c/svg%3e");background-repeat:no-repeat;background-position:right 12px center;background-size:16px;padding-right:40px;cursor:pointer}.service-dropdown[_ngcontent-%COMP%]::-ms-expand{display:none}.custom-input[_ngcontent-%COMP%]{margin-top:8px;border-color:#667eea;background-color:#f8f9ff;animation:_ngcontent-%COMP%_slideDown .3s ease}@keyframes _ngcontent-%COMP%_slideDown{0%{opacity:0;transform:translateY(-10px)}to{opacity:1;transform:translateY(0)}}.radio-group[_ngcontent-%COMP%]{display:flex;gap:20px;margin-bottom:25px;padding:15px;background:#f8f9fa;border-radius:12px;border:2px solid #e9ecef}.radio-option[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px;cursor:pointer;font-weight:500;color:#495057;padding:8px 16px;border-radius:8px;transition:all .3s ease;position:relative}.radio-option[_ngcontent-%COMP%]:hover{background:#007bff1a;color:#007bff}.radio-option[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]{width:20px;height:20px;margin:0;accent-color:#007bff;cursor:pointer}.radio-option[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]:checked + .radio-text[_ngcontent-%COMP%]{color:#007bff;font-weight:600}.radio-text[_ngcontent-%COMP%]{font-size:14px;transition:all .3s ease;-webkit-user-select:none;user-select:none}.search-results[_ngcontent-%COMP%]{max-height:300px;overflow-y:auto;margin-top:10px;border:1px solid #e9ecef;border-radius:12px;background:#fafbfc;padding:8px}.customer-result[_ngcontent-%COMP%]{border:2px solid #e9ecef;border-radius:12px;padding:16px;margin-bottom:8px;cursor:pointer;transition:all .3s ease;background:#fff;box-shadow:0 2px 4px #0000000d;position:relative;overflow:hidden}.customer-result[_ngcontent-%COMP%]:before{content:"";position:absolute;left:0;top:0;bottom:0;width:4px;background:#e9ecef;transition:background-color .3s ease}.customer-result[_ngcontent-%COMP%]:hover{border-color:#007bff;background:#f8f9ff;box-shadow:0 4px 12px #007bff26;transform:translateY(-1px)}.customer-result[_ngcontent-%COMP%]:hover:before{background:#007bff}.customer-result.selected[_ngcontent-%COMP%]{border-color:#28a745;background:#f8fff9;box-shadow:0 4px 16px #28a74533;transform:scale(1.02)}.customer-result.selected[_ngcontent-%COMP%]:before{background:#28a745}.customer-info[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:6px}.customer-name[_ngcontent-%COMP%]{font-weight:600;font-size:16px;color:#2c3e50;display:flex;align-items:center;gap:8px}.customer-name[_ngcontent-%COMP%]:before{content:"\\1f464";font-size:14px}.customer-mobile[_ngcontent-%COMP%]{font-size:14px;color:#6c757d;display:flex;align-items:center;gap:8px}.customer-mobile[_ngcontent-%COMP%]:before{content:"\\1f4f1";font-size:12px}.customer-email[_ngcontent-%COMP%]{font-size:13px;color:#6c757d;display:flex;align-items:center;gap:8px}.customer-email[_ngcontent-%COMP%]:before{content:"\\1f4e7";font-size:12px}.selected-customer[_ngcontent-%COMP%]{margin-top:12px;padding:16px;background:linear-gradient(135deg,#f0f8ff,#e6f3ff);border:2px solid #007bff;border-radius:12px;box-shadow:0 4px 16px #007bff26;position:relative;animation:_ngcontent-%COMP%_slideIn .3s ease}@keyframes _ngcontent-%COMP%_slideIn{0%{opacity:0;transform:translate(-20px)}to{opacity:1;transform:translate(0)}}.selected-customer[_ngcontent-%COMP%]:before{content:"\\2705";position:absolute;top:-8px;right:16px;background:#007bff;color:#fff;width:20px;height:20px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:10px}.selected-customer-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:12px}.selected-customer-header[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0;color:#0056b3;font-size:15px;font-weight:600;display:flex;align-items:center;gap:6px}.clear-customer-btn[_ngcontent-%COMP%]{background:#dc3545;color:#fff;border:none;border-radius:8px;width:32px;height:32px;cursor:pointer;font-size:14px;display:flex;align-items:center;justify-content:center;transition:all .3s ease;box-shadow:0 2px 4px #dc35454d}.clear-customer-btn[_ngcontent-%COMP%]:hover{background:#c82333;transform:scale(1.1);box-shadow:0 4px 8px #dc354566}.clear-customer-btn[_ngcontent-%COMP%]:active{transform:scale(.95)}.customer-card.selected[_ngcontent-%COMP%]{border:none;background:transparent;padding:0;box-shadow:none}.customer-card.selected[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:6px 0;padding:6px 10px;background:#fffc;border-radius:6px;border-left:3px solid #007bff;font-size:13px;line-height:1.4}.customer-card.selected[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{color:#0056b3}.add-customer-btn[_ngcontent-%COMP%]{background:linear-gradient(135deg,#17a2b8,#138496);color:#fff;border:none;padding:14px 24px;border-radius:12px;cursor:pointer;font-size:15px;font-weight:600;transition:all .3s ease;margin-top:15px;width:100%;display:flex;align-items:center;justify-content:center;gap:8px;box-shadow:0 4px 12px #17a2b84d;border:2px solid transparent}.add-customer-btn[_ngcontent-%COMP%]:hover{background:linear-gradient(135deg,#138496,#0f6674);transform:translateY(-2px);box-shadow:0 6px 20px #17a2b866}.add-customer-btn[_ngcontent-%COMP%]:active{transform:translateY(0);box-shadow:0 2px 8px #17a2b84d}.add-customer-btn[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:16px}.no-results-message[_ngcontent-%COMP%]{text-align:center;padding:12px 16px;background:#f8f9fa;border:1px solid #dee2e6;border-radius:8px;color:#6c757d;max-width:400px;margin:10px auto}.no-results-message[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:18px;color:#adb5bd;margin-bottom:6px}.no-results-message[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:4px 0;font-size:13px;line-height:1.3}.no-results-message[_ngcontent-%COMP%]   .help-text[_ngcontent-%COMP%]{font-size:11px;color:#868e96;font-style:italic;margin-top:6px}.customer-search[_ngcontent-%COMP%]{margin-top:15px}.customer-search[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]{margin-bottom:15px}.customer-search[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]{background:#fff;border:2px solid #e9ecef;border-radius:12px;padding:14px 16px;font-size:14px;transition:all .3s ease;box-shadow:0 2px 4px #0000000d}.customer-search[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]:focus{border-color:#007bff;box-shadow:0 0 0 4px #007bff1a;transform:translateY(-1px)}.customer-search[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-weight:600;color:#495057;margin-bottom:8px;font-size:14px;display:flex;align-items:center;gap:6px}.customer-search[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]:before{content:"\\1f50d";font-size:12px}.service-list[_ngcontent-%COMP%]{margin-top:20px;background:#f8f9fa;border-radius:8px;padding:20px;border:1px solid #e9ecef}.service-list[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{color:#495057;font-size:16px;font-weight:600;margin-bottom:16px;display:flex;align-items:center;gap:8px;padding-bottom:8px;border-bottom:2px solid #007bff}.service-list[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]:before{content:"\\fffd";font-size:16px}.service-item-display[_ngcontent-%COMP%]{border:1px solid #dee2e6;border-radius:6px;padding:16px;margin-bottom:12px;background:#fff;display:flex;justify-content:space-between;align-items:center;transition:all .2s ease;position:relative;animation:_ngcontent-%COMP%_slideInFromLeft .3s ease-out}@keyframes _ngcontent-%COMP%_slideInFromLeft{0%{opacity:0;transform:translate(-20px)}to{opacity:1;transform:translate(0)}}.service-item-display[_ngcontent-%COMP%]:hover{box-shadow:0 2px 8px #007bff26;border-color:#007bff}.service-item-display[_ngcontent-%COMP%]:last-child{margin-bottom:0}.service-details[_ngcontent-%COMP%]{flex:1}.service-details[_ngcontent-%COMP%]   h5[_ngcontent-%COMP%]{margin:0 0 4px;color:#343a40;font-weight:600;font-size:15px}.service-details[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;color:#6c757d;font-size:13px;font-style:italic}.service-actions[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px}.service-amount[_ngcontent-%COMP%]{font-weight:600;color:#28a745;font-size:15px;background:#f8fff9;padding:6px 12px;border-radius:4px;border:1px solid #c3e6cb;min-width:80px;text-align:center}.remove-service-btn[_ngcontent-%COMP%]{background:#dc3545;color:#fff;border:none;border-radius:4px;width:30px;height:30px;cursor:pointer;font-size:14px;display:flex;align-items:center;justify-content:center;transition:background-color .2s ease}.remove-service-btn[_ngcontent-%COMP%]:hover{background:#c82333}.add-service-form[_ngcontent-%COMP%]{background:#fff;border:1px solid #dee2e6;border-radius:8px;padding:20px;margin-top:16px;box-shadow:0 1px 3px #0000000d}.add-service-form[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 16px;color:#495057;font-size:16px;font-weight:600;text-align:left;padding-bottom:8px;border-bottom:2px solid #007bff}.service-dropdown[_ngcontent-%COMP%]{background:#fff;border:1px solid #ced4da;border-radius:4px;padding:10px 12px;font-size:14px;width:100%;transition:border-color .2s ease}.service-dropdown[_ngcontent-%COMP%]:focus{border-color:#007bff;outline:none;box-shadow:0 0 0 2px #007bff1a}.custom-input[_ngcontent-%COMP%]{margin-top:10px;background:#fff;border:1px solid #ced4da;border-radius:4px;padding:10px 12px;transition:border-color .2s ease}.custom-input[_ngcontent-%COMP%]:focus{border-color:#007bff;outline:none;box-shadow:0 0 0 2px #007bff1a}.add-service-btn[_ngcontent-%COMP%]{background:#007bff;color:#fff;border:none;padding:10px 20px;border-radius:4px;cursor:pointer;font-size:14px;font-weight:500;transition:background-color .2s ease;margin-top:16px;width:100%;display:flex;align-items:center;justify-content:center;gap:6px}.add-service-btn[_ngcontent-%COMP%]:before{content:"+";font-size:16px;font-weight:700}.add-service-btn[_ngcontent-%COMP%]:hover{background:#0056b3}.add-service-btn[_ngcontent-%COMP%]:disabled{background:#6c757d;cursor:not-allowed}.form-section[_ngcontent-%COMP%]:has(.service-list){background:linear-gradient(135deg,#fff,#f8f9fa);border-left:4px solid #007bff}.form-section[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{color:#495057;margin:0 0 20px;font-size:1.2rem;font-weight:600;padding-bottom:12px;border-bottom:2px solid #e9ecef;display:flex;align-items:center;gap:8px}.service-empty-state[_ngcontent-%COMP%]{text-align:center;padding:30px 20px;color:#6c757d;font-style:italic;background:#f8f9fa;border:2px dashed #dee2e6;border-radius:6px;margin:20px 0}.service-empty-state[_ngcontent-%COMP%]:before{content:"\\1f4dd";display:block;font-size:24px;margin-bottom:8px}.payment-summary-section[_ngcontent-%COMP%]{background:#fff;border:1px solid #e9ecef;border-radius:16px;box-shadow:0 4px 16px #00000014;padding:25px}.payment-summary-section[_ngcontent-%COMP%]   .section-title[_ngcontent-%COMP%]{background:none;color:#495057;margin:-25px -25px 20px;padding:0;font-size:1.3rem;font-weight:600;text-align:left;box-shadow:none}.payment-summary[_ngcontent-%COMP%]{background:transparent;border:none;border-radius:0;padding:0;margin-top:0}.payment-header[_ngcontent-%COMP%]{text-align:center;margin-bottom:16px}.payment-header[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0;font-size:1.1rem;font-weight:600;color:#495057;background:#6c757d14;padding:8px 16px;border-radius:20px;display:inline-block}.amount-display[_ngcontent-%COMP%]{background:#fff;border:1px solid #e9ecef;border-radius:12px;padding:16px;margin-bottom:16px}.summary-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:6px 0;margin:0}.summary-row.total-amount[_ngcontent-%COMP%]{padding:0;border:none}.summary-row[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{font-weight:500;color:#495057;font-size:14px}.summary-row[_ngcontent-%COMP%]   .amount[_ngcontent-%COMP%]{font-weight:700;font-size:16px;color:#28a745}.summary-row[_ngcontent-%COMP%]   .amount.primary[_ngcontent-%COMP%]{font-size:18px;color:#28a745}.summary-row[_ngcontent-%COMP%]   .amount.highlight[_ngcontent-%COMP%]{font-size:18px;color:#495057;background:#fff;padding:8px 12px;border-radius:8px;border:1px solid #e9ecef;font-weight:700}.payment-section[_ngcontent-%COMP%]{margin:16px 0;background:#fff;border-radius:12px;padding:16px;border:1px solid #e9ecef}.payment-section[_ngcontent-%COMP%]   .form-group.compact[_ngcontent-%COMP%]{margin-bottom:12px}.payment-section[_ngcontent-%COMP%]   .form-group.compact[_ngcontent-%COMP%]:last-child{margin-bottom:0}.payment-section[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{color:#495057;font-weight:500;font-size:13px;margin-bottom:4px}.payment-section[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]{background:#fff;border:1px solid #ced4da;color:#495057;border-radius:8px;padding:8px 12px;font-size:13px;transition:all .3s ease}.payment-section[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]:focus{background:#fff;border-color:#80bdff;box-shadow:0 0 0 2px #007bff33;outline:none}.payment-section[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]:disabled{background:#f5f5f5;color:#9e9e9e;border-color:#e0e0e0}.balance-section[_ngcontent-%COMP%]{background:#fff;border-radius:12px;padding:16px;margin-top:16px;border:1px solid #e9ecef}.balance-section[_ngcontent-%COMP%]   .summary-row[_ngcontent-%COMP%]{margin:0;padding:0}.balance-section[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{color:#495057!important;font-weight:500;font-size:14px}.balance-section[_ngcontent-%COMP%]   .amount.highlight[_ngcontent-%COMP%]{background:#fff;color:#dc3545!important;border:1px solid #e9ecef;font-weight:700;font-size:18px}.action-buttons[_ngcontent-%COMP%]{display:flex;gap:15px;justify-content:center;margin-top:30px;flex-wrap:wrap}.cancel-btn[_ngcontent-%COMP%]{background:#6c757d;color:#fff;border:none;padding:12px 30px;border-radius:8px;cursor:pointer;font-size:16px;font-weight:500;transition:background-color .3s ease}.cancel-btn[_ngcontent-%COMP%]:hover{background:#5a6268}.preview-btn[_ngcontent-%COMP%]{background:#007bff;color:#fff;border:none;padding:12px 30px;border-radius:8px;cursor:pointer;font-size:16px;font-weight:500;transition:background-color .3s ease}.preview-btn[_ngcontent-%COMP%]:hover{background:#0056b3}.preview-section[_ngcontent-%COMP%]{background:#fff;border-radius:12px;padding:30px;margin-top:20px;box-shadow:0 4px 6px #0000001a}.preview-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:30px;padding-bottom:15px;border-bottom:2px solid #f0f0f0}.preview-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{color:#333;margin:0}.preview-actions[_ngcontent-%COMP%]{display:flex;gap:10px}.return-btn[_ngcontent-%COMP%]{background:#6c757d;color:#fff;border:none;padding:10px 20px;border-radius:6px;cursor:pointer;font-weight:500;transition:all .3s ease}.return-btn[_ngcontent-%COMP%]:hover{background:#5a6268;transform:translateY(-1px)}.invoice-preview[_ngcontent-%COMP%]{margin-bottom:30px}.invoice-header-preview[_ngcontent-%COMP%]{text-align:center;margin-bottom:30px;padding:20px;background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;border-radius:8px}.invoice-header-preview[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 10px;font-size:1.5rem}.customer-details-preview[_ngcontent-%COMP%]{margin-bottom:25px;padding:20px;background:#f8f9fa;border-radius:8px}.customer-details-preview[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 15px;color:#333;font-size:1.1rem}.services-preview[_ngcontent-%COMP%]{margin-bottom:25px}.services-preview[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 15px;color:#333;font-size:1.1rem}.services-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;border:1px solid #ddd;border-radius:8px;overflow:hidden}.services-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .services-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:12px 15px;text-align:left;border-bottom:1px solid #ddd}.services-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background:#f8f9fa;font-weight:600;color:#333}.services-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:last-child{text-align:right;font-weight:500}.payment-summary-preview[_ngcontent-%COMP%]{background:#f8f9fa;padding:20px;border-radius:8px;margin-bottom:25px}.payment-summary-preview[_ngcontent-%COMP%]   .summary-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;padding:8px 0;border-bottom:1px solid #e0e0e0}.payment-summary-preview[_ngcontent-%COMP%]   .summary-row.total[_ngcontent-%COMP%]{font-weight:700;font-size:1.1rem;color:#333;border-bottom:none;margin-top:10px;padding-top:15px;border-top:2px solid #333}.bank-details-preview[_ngcontent-%COMP%]{background:#f8f9fa;padding:20px;border-radius:8px;margin-bottom:25px}.bank-details-preview[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 15px;color:#333;font-size:1.1rem}.preview-footer-actions[_ngcontent-%COMP%]{display:flex;justify-content:center;gap:20px;margin-top:30px;padding-top:20px;border-top:2px solid #f0f0f0}.print-btn[_ngcontent-%COMP%], .whatsapp-btn[_ngcontent-%COMP%]{padding:15px 30px;border:none;border-radius:8px;font-weight:600;font-size:1rem;cursor:pointer;transition:all .3s ease;display:flex;align-items:center;gap:8px}.print-btn[_ngcontent-%COMP%]{background:#007bff;color:#fff}.print-btn[_ngcontent-%COMP%]:hover:not(:disabled){background:#0056b3;transform:translateY(-2px)}.whatsapp-btn[_ngcontent-%COMP%]{background:#25d366;color:#fff}.whatsapp-btn[_ngcontent-%COMP%]:hover:not(:disabled){background:#20b358;transform:translateY(-2px)}.print-btn[_ngcontent-%COMP%]:disabled, .whatsapp-btn[_ngcontent-%COMP%]:disabled{background:#6c757d;cursor:not-allowed;opacity:.6}@media print{.preview-header[_ngcontent-%COMP%], .preview-footer-actions[_ngcontent-%COMP%]{display:none!important}.preview-section[_ngcontent-%COMP%]{box-shadow:none;margin:0;padding:0}}@media (max-width: 768px){.service-dropdown[_ngcontent-%COMP%]{font-size:16px;min-height:44px;background-size:20px;background-position:right 16px center;padding-right:48px}.custom-input[_ngcontent-%COMP%]{font-size:16px;min-height:44px}.form-control[_ngcontent-%COMP%]{font-size:16px;min-height:44px;padding:14px}.create-invoice-container[_ngcontent-%COMP%], .customer-form-container[_ngcontent-%COMP%]{padding:15px}.invoice-header[_ngcontent-%COMP%]{flex-direction:column;gap:15px;text-align:center}.form-section[_ngcontent-%COMP%]{padding:20px 15px}.form-row[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:10px}.radio-group[_ngcontent-%COMP%]{flex-direction:column;gap:15px}.action-buttons[_ngcontent-%COMP%]{flex-direction:column-reverse}.action-buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:100%}.invoice-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1.5rem}}@media (max-width: 480px){.create-invoice-container[_ngcontent-%COMP%], .customer-form-container[_ngcontent-%COMP%]{padding:10px}.form-section[_ngcontent-%COMP%]{padding:15px 10px}.service-item[_ngcontent-%COMP%], .payment-summary[_ngcontent-%COMP%]{padding:15px}}.new-customer-form[_ngcontent-%COMP%]{margin-top:20px}.customer-form-container[_ngcontent-%COMP%]{max-width:900px;margin:0 auto;padding:0;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,sans-serif;display:flex;flex-direction:column;gap:30px}.customer-info-section[_ngcontent-%COMP%]{background:#fff;padding:25px;border-radius:12px;box-shadow:0 2px 8px #0000001a;border:1px solid #e9ecef}.customer-info-section[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{color:#2c3e50;margin:0 0 20px;font-size:1.3rem;font-weight:600;padding-bottom:10px;border-bottom:2px solid #f8f9fa}.address-info-section[_ngcontent-%COMP%]{background:#fff;padding:25px;border-radius:12px;box-shadow:0 2px 8px #0000001a;border:1px solid #e9ecef}.address-info-section[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{color:#2c3e50;margin:0 0 20px;font-size:1.3rem;font-weight:600;padding-bottom:10px;border-bottom:2px solid #f8f9fa}.action-section[_ngcontent-%COMP%]{background:#fff;padding:25px;border-radius:12px;box-shadow:0 2px 8px #0000001a;border:1px solid #e9ecef;text-align:center}.save-customer-btn[_ngcontent-%COMP%]{background:linear-gradient(135deg,#28a745,#20c997);color:#fff;border:none;padding:12px 24px;border-radius:8px;font-size:16px;font-weight:600;cursor:pointer;transition:all .3s ease;box-shadow:0 4px 12px #28a7454d;min-width:180px}.save-customer-btn[_ngcontent-%COMP%]:hover{background:linear-gradient(135deg,#218838,#1da88a);transform:translateY(-2px);box-shadow:0 6px 16px #28a74566}.save-customer-btn[_ngcontent-%COMP%]:active{transform:translateY(0)}.customer-info-section[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%], .address-info-section[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]{padding:14px 16px;border:2px solid #e9ecef;border-radius:12px;font-size:14px;transition:all .3s ease;background-color:#fff;box-shadow:0 2px 4px #0000000d}.customer-info-section[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]:focus, .address-info-section[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]:focus{outline:none;border-color:#007bff;box-shadow:0 0 0 4px #007bff1a;transform:translateY(-1px)}.customer-info-section[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]:hover, .address-info-section[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]:hover{border-color:#b3d7ff}.customer-info-section[_ngcontent-%COMP%]   label[_ngcontent-%COMP%], .address-info-section[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-weight:500;color:#495057;margin-bottom:6px;font-size:14px}.customer-info-section[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%], .address-info-section[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin-bottom:15px}.customer-info-section[_ngcontent-%COMP%]   .form-row[_ngcontent-%COMP%], .address-info-section[_ngcontent-%COMP%]   .form-row[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:15px;margin-bottom:15px}.customer-info-section[_ngcontent-%COMP%]   .form-group.small[_ngcontent-%COMP%], .address-info-section[_ngcontent-%COMP%]   .form-group.small[_ngcontent-%COMP%]{max-width:120px}`]})};var XI=bh("Share",{web:()=>import("./chunk-MVB7U576.js").then(n=>new n.ShareWeb)});function PG(n){n.CapacitorUtils.Synapse=new Proxy({},{get(e,t){return new Proxy({},{get(r,i){return(o,s,a)=>{let c=n.Capacitor.Plugins[t];if(c===void 0){a(new Error(`Capacitor plugin ${t} not found`));return}if(typeof c[i]!="function"){a(new Error(`Method ${i} not found in Capacitor plugin ${t}`));return}w(null,null,function*(){try{let u=yield c[i](o);s(u)}catch(u){a(u)}})}}})}})}function AG(n){n.CapacitorUtils.Synapse=new Proxy({},{get(e,t){return n.cordova.plugins[t]}})}function Gk(n=!1){typeof window>"u"||(window.CapacitorUtils=window.CapacitorUtils||{},window.Capacitor!==void 0&&!n?PG(window):window.cordova!==void 0&&AG(window))}var eE=bh("Filesystem",{web:()=>import("./chunk-6VWV7NJR.js").then(n=>new n.FilesystemWeb)});Gk();var Gg=class n{shareInvoiceViaWhatsApp(e,t,r,i,o,s){return w(this,null,function*(){try{Bv.isNativePlatform()?yield this.shareNative(e,t,r,i,o,s):yield this.shareWeb(e,t,r,i,o,s)}catch(a){throw console.error("Share failed:",a),a}})}shareNative(e,t,r,i,o,s){return w(this,null,function*(){try{let a=yield this.blobToBase64(e),c=yield eE.writeFile({path:t,data:a,directory:Uv.Cache,encoding:mS.UTF8}),u=this.createWhatsAppMessage(r,o,s);yield XI.share({title:"Invoice from Global Financial Services",text:u,files:[c.uri],dialogTitle:"Share Invoice via WhatsApp"}),yield eE.deleteFile({path:t,directory:Uv.Cache})}catch(a){throw console.error("Native share failed:",a),a}})}shareWeb(e,t,r,i,o,s){return w(this,null,function*(){let a=this.createWhatsAppMessage(r,o,s);if(navigator.share&&navigator.canShare)try{let c=[new File([e],t,{type:"application/pdf"})];navigator.canShare({files:c})?yield navigator.share({title:"Invoice",text:a,files:c}):this.openWhatsAppWeb(i,a)}catch{console.log("Web share cancelled or failed, falling back to WhatsApp web"),this.openWhatsAppWeb(i,a)}else this.openWhatsAppWeb(i,a)})}openWhatsAppWeb(e,t){let r=e.replace(/\D/g,""),i=encodeURIComponent(t),o=`https://wa.me/${r}?text=${i}`;window.open(o,"_blank")}createWhatsAppMessage(e,t,r){return`Hello ${e},

Please find attached your invoice ${t} for \u20B9${r.toFixed(2)}.

Thank you for your business!

Best regards,
Global Financial Services
ACCOUNTING & FINANCIAL SERVICES`}blobToBase64(e){return w(this,null,function*(){return new Promise((t,r)=>{let i=new FileReader;i.onload=()=>{let s=i.result.split(",")[1];t(s)},i.onerror=r,i.readAsDataURL(e)})})}shareQuickWhatsAppMessage(e,t,r){return w(this,null,function*(){try{Bv.isNativePlatform()?yield XI.share({title:"Message from Global Financial Services",text:r,dialogTitle:"Share via WhatsApp"}):this.openWhatsAppWeb(t,r)}catch(i){console.error("Quick share failed:",i),this.openWhatsAppWeb(t,r)}})}static \u0275fac=function(t){return new(t||n)};static \u0275prov=H({token:n,factory:n.\u0275fac,providedIn:"root"})};function NG(n,e){if(n&1){let t=de();m(0,"div",22)(1,"div",23),K(2,"i",24),m(3,"span"),y(4,"Showing invoices for: "),m(5,"strong"),y(6),g(),y(7),g(),m(8,"button",25),z("click",function(){B(t);let i=A();return U(i.clearCustomerFilter())}),K(9,"i",26),y(10," Clear Filter "),g()()()}if(n&2){let t=A();I(6),se(t.getCustomerNameFromFilter()),I(),pe(" (",t.customerFilter,")")}}function RG(n,e){if(n&1){let t=de();m(0,"button",47),z("click",function(){B(t);let i=A(2).$implicit,o=A();return U(o.addPayment(i.id))}),K(1,"i",48),y(2," Add Payment "),g()}}function kG(n,e){if(n&1){let t=de();m(0,"div",30)(1,"div",31)(2,"div",32)(3,"h4",33),y(4),g(),m(5,"span",34),y(6),Ve(7,"date"),g(),m(8,"span",35),y(9),g()(),m(10,"div",36),ie(11,RG,3,0,"button",37),m(12,"button",38),z("click",function(){B(t);let i=A().$implicit,o=A();return U(o.toggleCardExpansion(i.id))}),K(13,"i",39),y(14," Show Details "),g()()(),m(15,"div",40)(16,"div",41)(17,"div",42)(18,"span",43),y(19,"Customer:"),g(),m(20,"span",44),y(21),g()(),m(22,"div",42)(23,"span",43),y(24,"Mobile:"),g(),m(25,"span",44),y(26),g()()(),m(27,"div",41)(28,"div",42)(29,"span",43),y(30,"Total Amount:"),g(),m(31,"span",45),y(32),Ve(33,"number"),g()(),m(34,"div",42)(35,"span",43),y(36,"Due Amount:"),g(),m(37,"span",46),y(38),Ve(39,"number"),g()()()()()}if(n&2){let t=A().$implicit;I(4),se(t.invoiceNumber),I(2),se(je(7,12,t.invoiceDate,"shortDate")),I(2),eu("status-"+t.status.toLowerCase()),I(),pe(" ",t.status," "),I(2),V("ngIf",t.balancePayable>0),I(10),se(t.customer.name),I(5),se(t.customer.mobile),I(6),pe("\u20B9",je(33,15,t.totalAmount,"1.2-2"),""),I(5),Ze("paid",t.balancePayable===0),I(),pe(" \u20B9",je(39,18,t.balancePayable,"1.2-2")," ")}}function FG(n,e){if(n&1&&(m(0,"div",67)(1,"span",68),y(2),g(),m(3,"span",69),y(4),Ve(5,"number"),g()()),n&2){let t=e.$implicit;I(2),se(t.description),I(2),pe("\u20B9",je(5,2,t.amount,"1.2-2"),"")}}function LG(n,e){if(n&1){let t=de();m(0,"button",47),z("click",function(){B(t);let i=A(2).$implicit,o=A();return U(o.addPayment(i.id))}),K(1,"i",48),y(2," Add Payment "),g()}}function VG(n,e){if(n&1){let t=de();m(0,"div",49)(1,"div",50)(2,"div",32)(3,"h4",33),y(4),g(),m(5,"span",34),y(6),Ve(7,"date"),g(),m(8,"span",35),y(9),g()(),m(10,"div",51)(11,"button",52),z("click",function(){B(t);let i=A().$implicit,o=A();return U(o.printInvoice(i.id))}),K(12,"i",53),g(),m(13,"button",54),z("click",function(){B(t);let i=A().$implicit,o=A();return U(o.shareOnWhatsApp(i.id))}),K(14,"i",55),g(),m(15,"button",56),z("click",function(){B(t);let i=A().$implicit,o=A();return U(o.editInvoice(i.id))}),K(16,"i",57),g(),m(17,"button",58),z("click",function(){B(t);let i=A().$implicit,o=A();return U(o.deleteInvoice(i.id))}),K(18,"i",59),g()()(),m(19,"div",60)(20,"div",61)(21,"span",62),y(22,"\u{1F464}"),g(),y(23," Customer Details "),g(),m(24,"div",42)(25,"span",43),y(26,"Name:"),g(),m(27,"span",44),y(28),g()(),m(29,"div",42)(30,"span",43),y(31,"Mobile:"),g(),m(32,"span",44),y(33),g()(),m(34,"div",42)(35,"span",43),y(36,"Address:"),g(),m(37,"span",44),y(38),g()()(),m(39,"div",60)(40,"div",61)(41,"span",62),y(42,"\u{1F527}"),g(),y(43," Services "),g(),ie(44,FG,6,5,"div",63),g(),m(45,"div",60)(46,"div",61)(47,"span",62),y(48,"\u{1F4B0}"),g(),y(49," Payment Summary "),g(),m(50,"div",42)(51,"span",43),y(52,"Total Amount:"),g(),m(53,"span",44),y(54),Ve(55,"number"),g()(),m(56,"div",42)(57,"span",43),y(58,"Advance Received:"),g(),m(59,"span",44),y(60),Ve(61,"number"),g()(),m(62,"div",42)(63,"span",43),y(64,"Balance Payable:"),g(),m(65,"span",44),y(66),Ve(67,"number"),g()(),m(68,"div",42)(69,"span",43),y(70,"Bank Account:"),g(),m(71,"span",44),y(72),g()()(),m(73,"div",64),ie(74,LG,3,0,"button",37),m(75,"button",65),z("click",function(){B(t);let i=A().$implicit,o=A();return U(o.toggleCardExpansion(i.id))}),K(76,"i",66),y(77," Hide Details "),g()()()}if(n&2){let t=A().$implicit;I(4),se(t.invoiceNumber),I(2),se(je(7,16,t.invoiceDate,"shortDate")),I(2),eu("status-"+t.status.toLowerCase()),I(),pe(" ",t.status," "),I(19),se(t.customer.name),I(5),se(t.customer.mobile),I(5),se(t.customer.address),I(6),V("ngForOf",t.serviceDetails),I(10),pe("\u20B9",je(55,19,t.totalAmount,"1.2-2"),""),I(6),pe("\u20B9",je(61,22,t.advanceReceived,"1.2-2"),""),I(5),Ze("paid",t.balancePayable===0),I(),pe(" \u20B9",je(67,25,t.balancePayable,"1.2-2")," "),I(6),se(t.selectedBank),I(2),V("ngIf",t.balancePayable>0)}}function jG(n,e){if(n&1&&(m(0,"div",27),ie(1,kG,40,21,"div",28)(2,VG,78,28,"div",29),g()),n&2){let t=e.$implicit,r=A();Ze("expanded",r.isCardExpanded(t.id)),I(),V("ngIf",!r.isCardExpanded(t.id)),I(),V("ngIf",r.isCardExpanded(t.id))}}function BG(n,e){if(n&1){let t=de();m(0,"div",70)(1,"p"),y(2,"No invoices found matching your search criteria."),g(),m(3,"button",71),z("click",function(){B(t);let i=A();return i.invoiceSearchTerm="",i.selectedInvoiceStatus="ALL",U(i.filterInvoices())}),y(4," Clear Filters "),g()()}}function UG(n,e){n&1&&(m(0,"div",70)(1,"p"),y(2,"No invoices created yet. Create your first invoice using the Create Invoice form."),g()())}function $G(n,e){if(n&1&&(m(0,"option",94),y(1),g()),n&2){let t=e.$implicit;V("value",t),I(),se(t)}}function zG(n,e){n&1&&K(0,"i",95)}function HG(n,e){n&1&&K(0,"i",96)}function WG(n,e){if(n&1){let t=de();m(0,"div",77)(1,"div",78)(2,"div",79)(3,"span",32),y(4),g(),m(5,"span",80),y(6),Ve(7,"number"),g()()(),m(8,"form",81),z("ngSubmit",function(){B(t);let i=A(2);return U(i.submitPayment())}),m(9,"div",82)(10,"div",5)(11,"label"),y(12,"Amount *"),g(),m(13,"input",83),ne("ngModelChange",function(i){B(t);let o=A(2);return re(o.paymentForm.amount,i)||(o.paymentForm.amount=i),U(i)}),g()(),m(14,"div",5)(15,"label"),y(16,"Method *"),g(),m(17,"select",84),ne("ngModelChange",function(i){B(t);let o=A(2);return re(o.paymentForm.paymentType,i)||(o.paymentForm.paymentType=i),U(i)}),ie(18,$G,2,2,"option",85),g()(),m(19,"div",5)(20,"label"),y(21,"Notes "),m(22,"span",86),y(23,"(Optional)"),g()(),m(24,"input",87),ne("ngModelChange",function(i){B(t);let o=A(2);return re(o.paymentForm.notes,i)||(o.paymentForm.notes=i),U(i)}),g()(),m(25,"div",5)(26,"label"),y(27,"Date *"),g(),m(28,"input",88),ne("ngModelChange",function(i){B(t);let o=A(2);return re(o.paymentForm.paymentDate,i)||(o.paymentForm.paymentDate=i),U(i)}),g()()(),m(29,"div",89)(30,"button",90),z("click",function(){B(t);let i=A(2);return U(i.closePaymentModal())}),y(31,"Cancel"),g(),m(32,"button",91),ie(33,zG,1,0,"i",92)(34,HG,1,0,"i",93),y(35),g()()()()}if(n&2){let t=A(2);I(4),se(t.selectedInvoiceForPayment.invoiceNumber),I(2),pe("\u20B9",je(7,13,t.selectedInvoiceForPayment.balancePayable,"1.2-2"),""),I(7),te("ngModel",t.paymentForm.amount),V("max",t.selectedInvoiceForPayment.balancePayable),I(4),te("ngModel",t.paymentForm.paymentType),I(),V("ngForOf",t.paymentTypes),I(6),te("ngModel",t.paymentForm.notes),I(4),te("ngModel",t.paymentForm.paymentDate),I(2),V("disabled",t.isProcessingPayment),I(2),V("disabled",t.isProcessingPayment),I(),V("ngIf",t.isProcessingPayment),I(),V("ngIf",!t.isProcessingPayment),I(),pe(" ",t.isProcessingPayment?"Processing...":"Record Payment"," ")}}function qG(n,e){if(n&1){let t=de();m(0,"div",72),z("click",function(){B(t);let i=A();return U(i.closePaymentModal())}),m(1,"div",73),z("click",function(i){return B(t),U(i.stopPropagation())}),m(2,"div",74)(3,"h3"),y(4,"\u{1F4B0} Record Payment"),g(),m(5,"button",75),z("click",function(){B(t);let i=A();return U(i.closePaymentModal())}),K(6,"i",26),g()(),ie(7,WG,36,16,"div",76),g()()}if(n&2){let t=A();I(7),V("ngIf",t.selectedInvoiceForPayment)}}function GG(n,e){if(n&1&&(m(0,"div",97)(1,"div",98)(2,"div",99),xD(),m(3,"svg",100),K(4,"circle",101)(5,"path",102),g()(),SD(),m(6,"h3",103),y(7,"Payment Recorded!"),g(),m(8,"p",104),y(9),Ve(10,"number"),g(),m(11,"p",105),y(12,"Payment has been successfully recorded"),g()()()),n&2){let t=A();I(9),pe("\u20B9",je(10,1,t.successPaymentAmount,"1.2-2"),"")}}var Kg=class n{constructor(e,t,r,i,o){this.invoiceService=e;this.router=t;this.route=r;this.pdfService=i;this.nativeShareService=o}invoices=[];filteredInvoices=[];invoiceSearchTerm="";selectedInvoiceStatus="ALL";isLoading=!0;customerFilter="";totalInvoiceAmount=0;totalPendingAmount=0;paidInvoicesCount=0;expandedCards=new Set;showPaymentModal=!1;selectedInvoiceForPayment=null;isProcessingPayment=!1;paymentForm={amount:0,paymentType:"Cash",paymentDate:"",notes:"",reference:""};paymentTypes=["Cash","Bank Transfer","UPI","Cheque","Card","Online"];showPaymentSuccess=!1;successPaymentAmount=0;ngOnInit(){this.route.queryParams.subscribe(e=>{this.customerFilter=e.customer||"",console.log("Customer filter from query params:",this.customerFilter)}),this.debugInvoices(),this.loadInvoices().then(()=>{this.customerFilter&&this.applyCustomerFilter()})}loadInvoices(){return w(this,null,function*(){try{this.isLoading=!0,console.log("Loading invoices..."),this.invoices=yield this.invoiceService.getInvoices(),console.log("Loaded invoices:",this.invoices),this.filteredInvoices=[...this.invoices],this.calculateStatistics()}catch(e){console.error("Error loading invoices:",e),alert("Error loading invoices. Please refresh the page.")}finally{this.isLoading=!1}})}calculateStatistics(){this.totalInvoiceAmount=this.invoices.reduce((e,t)=>e+t.totalAmount,0),this.totalPendingAmount=this.invoices.reduce((e,t)=>e+t.balancePayable,0),this.paidInvoicesCount=this.invoices.filter(e=>e.status==="PAID").length}onInvoiceSearch(){this.filterInvoices()}onStatusFilterChange(){this.filterInvoices()}filterInvoices(){this.filteredInvoices=this.invoices.filter(e=>{let t=!this.invoiceSearchTerm||e.invoiceNumber.toLowerCase().includes(this.invoiceSearchTerm.toLowerCase())||e.customer.name.toLowerCase().includes(this.invoiceSearchTerm.toLowerCase())||e.customer.mobile.includes(this.invoiceSearchTerm),r=this.selectedInvoiceStatus==="ALL"||e.status===this.selectedInvoiceStatus;return t&&r}),this.calculateFilteredStatistics()}applyCustomerFilter(){console.log("Applying customer filter for mobile:",this.customerFilter),this.filteredInvoices=this.invoices.filter(e=>e.customer.mobile===this.customerFilter),console.log("Filtered invoices for customer:",this.filteredInvoices),this.invoiceSearchTerm=this.customerFilter,this.calculateFilteredStatistics()}calculateFilteredStatistics(){this.totalInvoiceAmount=this.filteredInvoices.reduce((e,t)=>e+t.totalAmount,0),this.totalPendingAmount=this.filteredInvoices.reduce((e,t)=>e+t.balancePayable,0),this.paidInvoicesCount=this.filteredInvoices.filter(e=>e.status==="PAID").length}printInvoice(e){return w(this,null,function*(){try{let t=this.invoices.find(r=>r.id===e);if(t){let r=document.querySelector(`[data-invoice-id="${e}"][title="Print Invoice"]`);r&&(r.disabled=!0,r.innerHTML='<i class="fas fa-spinner fa-spin"></i> Generating...'),this.pdfService.generateInvoicePDF(t),setTimeout(()=>{r&&(r.disabled=!1,r.innerHTML='<i class="fas fa-print"></i> Print')},2e3)}else alert("Invoice not found!")}catch(t){console.error("Error printing invoice:",t),alert("Error generating PDF. Please try again.");let r=document.querySelector(`[data-invoice-id="${e}"][title="Print Invoice"]`);r&&(r.disabled=!1,r.innerHTML='<i class="fas fa-print"></i> Print')}})}shareOnWhatsApp(e){return w(this,null,function*(){try{let t=this.invoices.find(s=>s.id===e);if(!t){alert("Invoice not found!");return}let r=document.querySelector(`[data-invoice-id="${e}"][title="Share on WhatsApp"]`);r&&(r.disabled=!0,r.innerHTML='<i class="fas fa-spinner fa-spin"></i> Generating PDF...');let i=yield this.generatePDFBlob(t);r&&(r.innerHTML='<i class="fab fa-whatsapp"></i> Opening WhatsApp...');let o=`${t.customer.name.replace(/[^a-zA-Z0-9]/g,"_")}_${t.invoiceNumber}.pdf`;yield this.nativeShareService.shareInvoiceViaWhatsApp(i,o,t.customer.name,t.customer.mobile,t.invoiceNumber,t.totalAmount),setTimeout(()=>{r&&(r.disabled=!1,r.innerHTML='<i class="fab fa-whatsapp"></i> WhatsApp')},2e3)}catch(t){console.error("Error sharing on WhatsApp:",t),alert("Error sharing invoice. Please try again.");let r=document.querySelector(`[data-invoice-id="${e}"][title="Share on WhatsApp"]`);r&&(r.disabled=!1,r.innerHTML='<i class="fab fa-whatsapp"></i> WhatsApp')}})}generatePDFBlob(e){return w(this,null,function*(){return new Promise((t,r)=>{try{import("./chunk-FJXHYOGL.js").then(({default:i})=>{let o=new i;this.generatePDFContent(o,e);let s=o.output("blob");t(s)}).catch(r)}catch(i){r(i)}})})}generatePDFContent(e,t){e.setFontSize(20),e.text("INVOICE",105,20,{align:"center"}),e.setFontSize(12),e.text(`Invoice Number: ${t.invoiceNumber}`,20,40),e.text(`Date: ${new Date(t.invoiceDate).toLocaleDateString("en-IN")}`,20,50),e.text(`Customer: ${t.customer.name}`,20,60),e.text(`Mobile: ${t.customer.mobile}`,20,70),e.text(`Total Amount: \u20B9${t.totalAmount}`,20,80),e.text(`Balance: \u20B9${t.balancePayable}`,20,90);let r=110;e.text("Services:",20,r),r+=10,t.serviceDetails.forEach((i,o)=>{e.text(`${o+1}. ${i.description} - \u20B9${i.amount}`,25,r),r+=8})}editInvoice(e){this.router.navigate(["/create-invoice"],{queryParams:{edit:e}})}deleteInvoice(e){return w(this,null,function*(){if(confirm("Are you sure you want to delete this invoice?"))try{yield this.invoiceService.deleteInvoice(e),yield this.loadInvoices()}catch(t){console.error("Error deleting invoice:",t)}})}updateInvoiceStatus(e,t){return w(this,null,function*(){if(t)try{yield this.invoiceService.updateInvoice(e,{status:t}),yield this.loadInvoices()}catch(r){console.error("Error updating invoice status:",r),alert("Error updating invoice status. Please try again.")}})}addPayment(e){let t=this.invoices.find(i=>i.id===e);if(!t){alert("Invoice not found!");return}let r=t.balancePayable;if(r<=0){alert("This invoice is already fully paid!");return}this.showPaymentModal||(this.selectedInvoiceForPayment=t,this.paymentForm={amount:r,paymentType:"Cash",paymentDate:new Date().toISOString().split("T")[0],notes:"",reference:""},this.showPaymentModal=!0,console.log("Payment modal opened for invoice:",t.invoiceNumber,"Amount:",r))}closePaymentModal(){this.showPaymentModal=!1,this.selectedInvoiceForPayment=null,this.isProcessingPayment=!1,this.resetPaymentForm(),console.log("Payment modal closed and form reset")}resetPaymentForm(){this.paymentForm={amount:0,paymentType:"Cash",paymentDate:"",notes:"",reference:""}}submitPayment(){return w(this,null,function*(){if(!this.selectedInvoiceForPayment){alert("No invoice selected for payment!");return}if(!this.isProcessingPayment){if(!this.paymentForm.amount||this.paymentForm.amount<=0){alert("Please enter a valid payment amount greater than 0!");return}if(this.paymentForm.amount>this.selectedInvoiceForPayment.balancePayable){alert(`Payment amount cannot exceed the remaining balance of \u20B9${this.selectedInvoiceForPayment.balancePayable.toLocaleString("en-IN")}!`);return}if(!this.paymentForm.paymentDate){alert("Please select a payment date!");return}if(this.selectedInvoiceForPayment.balancePayable<=0){alert("This invoice is already fully paid!"),this.closePaymentModal();return}this.isProcessingPayment=!0;try{let e=this.selectedInvoiceForPayment,t=Number(this.paymentForm.amount);if(isNaN(t)||t<=0){alert("Invalid payment amount entered!");return}let r=e.advanceReceived+t,i=e.totalAmount-r,o="PARTIAL";i<=0?o="PAID":r===0&&(o="PENDING");let s=`Payment: \u20B9${t.toLocaleString("en-IN")} via ${this.paymentForm.paymentType} on ${this.paymentForm.paymentDate}${this.paymentForm.reference?` (Ref: ${this.paymentForm.reference})`:""}${this.paymentForm.notes?` - ${this.paymentForm.notes}`:""}`;yield this.invoiceService.updateInvoice(e.id,{advanceReceived:r,balancePayable:i,status:o});let a=t;this.closePaymentModal(),yield this.loadInvoices(),this.successPaymentAmount=a,this.showPaymentSuccess=!0,setTimeout(()=>{this.showPaymentSuccess=!1},3e3)}catch(e){console.error("Error adding payment:",e),alert("Error adding payment. Please try again.")}finally{this.isProcessingPayment=!1}}})}toggleCardExpansion(e){this.expandedCards.has(e)?this.expandedCards.delete(e):this.expandedCards.add(e)}isCardExpanded(e){return this.expandedCards.has(e)}goBackToDashboard(){this.router.navigate(["/dashboard"],{queryParams:{category:"invoices"}})}debugInvoices(){let e=localStorage.getItem("globalfinserv_invoices");console.log("Raw localStorage data:",e),console.log("Parsed invoices:",e?JSON.parse(e):"No data"),console.log("Current invoices array:",this.invoices),console.log("Filtered invoices array:",this.filteredInvoices)}clearCustomerFilter(){this.customerFilter="",this.invoiceSearchTerm="",this.filteredInvoices=[...this.invoices],this.calculateStatistics(),this.router.navigate(["/view-invoices"])}getCustomerNameFromFilter(){return!this.customerFilter||this.filteredInvoices.length===0?this.customerFilter:this.filteredInvoices[0].customer.name}static \u0275fac=function(t){return new(t||n)(q(nr),q(it),q(qt),q(mi),q(Gg))};static \u0275cmp=Pt({type:n,selectors:[["app-view-invoices"]],decls:35,vars:9,consts:[[1,"view-invoices-container"],[1,"invoice-header"],["class","customer-filter-indicator",4,"ngIf"],[1,"invoice-search-section"],[1,"form-row"],[1,"form-group"],["for","invoiceSearch"],["type","text","id","invoiceSearch","name","invoiceSearch","placeholder","Search by invoice number, customer name, or mobile number",3,"ngModelChange","input","ngModel"],["for","statusFilter"],["id","statusFilter","name","statusFilter",3,"ngModelChange","change","ngModel"],["value","ALL"],["value","PAID"],["value","PARTIAL"],["value","PENDING"],[1,"invoice-stats"],[1,"stat-card"],[1,"stat-number"],[1,"invoice-cards-container"],["class","invoice-card",3,"expanded",4,"ngFor","ngForOf"],["class","no-invoices",4,"ngIf"],["class","payment-modal-overlay",3,"click",4,"ngIf"],["class","payment-success-overlay",4,"ngIf"],[1,"customer-filter-indicator"],[1,"filter-info"],[1,"fas","fa-filter"],[1,"clear-filter-btn",3,"click"],[1,"fas","fa-times"],[1,"invoice-card"],["class","invoice-minimal-view",4,"ngIf"],["class","invoice-detailed-view",4,"ngIf"],[1,"invoice-minimal-view"],[1,"minimal-header"],[1,"invoice-info"],[1,"invoice-number"],[1,"invoice-date"],[1,"status-badge"],[1,"minimal-actions"],["class","payment-btn add-payment-btn",3,"click",4,"ngIf"],[1,"show-details-btn",3,"click"],[1,"fas","fa-eye"],[1,"minimal-content"],[1,"minimal-section"],[1,"detail-row"],[1,"detail-label"],[1,"detail-value"],[1,"detail-value","amount-total"],[1,"detail-value","amount-due"],[1,"payment-btn","add-payment-btn",3,"click"],[1,"fas","fa-plus"],[1,"invoice-detailed-view"],[1,"detailed-header"],[1,"header-actions"],["title","Print Invoice",1,"action-btn","print-btn",3,"click"],[1,"fas","fa-print"],["title","Share on WhatsApp",1,"action-btn","whatsapp-btn",3,"click"],[1,"fab","fa-whatsapp"],["title","Edit Invoice",1,"action-btn","edit-btn",3,"click"],[1,"fas","fa-edit"],["title","Delete Invoice",1,"action-btn","delete-btn",3,"click"],[1,"fas","fa-trash"],[1,"card-section"],[1,"section-header"],[1,"section-icon"],["class","service-item",4,"ngFor","ngForOf"],[1,"bottom-card-actions"],[1,"hide-details-btn",3,"click"],[1,"fas","fa-eye-slash"],[1,"service-item"],[1,"service-description"],[1,"service-amount"],[1,"no-invoices"],[1,"clear-filters-btn",3,"click"],[1,"payment-modal-overlay",3,"click"],[1,"payment-modal",3,"click"],[1,"payment-modal-header"],[1,"close-modal-btn",3,"click"],["class","payment-modal-content",4,"ngIf"],[1,"payment-modal-content"],[1,"payment-invoice-details"],[1,"invoice-summary"],[1,"remaining-amount"],[1,"payment-form",3,"ngSubmit"],[1,"ultra-compact-row"],["type","number","name","paymentAmount","min","0.01","step","0.01","placeholder","\u20B90.00","required","",1,"form-control","compact",3,"ngModelChange","ngModel","max"],["name","paymentType","required","",1,"form-control","compact",3,"ngModelChange","ngModel"],[3,"value",4,"ngFor","ngForOf"],[1,"optional-label"],["type","text","name","paymentNotes","placeholder","Add payment notes...","maxlength","200",1,"form-control","compact",3,"ngModelChange","ngModel"],["type","date","name","paymentDate","required","",1,"form-control","compact",3,"ngModelChange","ngModel"],[1,"payment-modal-actions"],["type","button",1,"cancel-btn","compact",3,"click","disabled"],["type","submit",1,"submit-payment-btn","compact",3,"disabled"],["class","fas fa-spinner fa-spin",4,"ngIf"],["class","fas fa-check",4,"ngIf"],[3,"value"],[1,"fas","fa-spinner","fa-spin"],[1,"fas","fa-check"],[1,"payment-success-overlay"],[1,"payment-success-container"],[1,"success-checkmark"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 52 52",1,"checkmark"],["cx","26","cy","26","r","25","fill","none",1,"checkmark-circle"],["fill","none","d","m14.1 27.2l7.1 7.2 16.7-16.8",1,"checkmark-check"],[1,"success-title"],[1,"success-amount"],[1,"success-message"]],template:function(t,r){t&1&&(m(0,"div",0)(1,"div",1)(2,"h2"),y(3,"View Invoices"),g()(),ie(4,NG,11,2,"div",2),m(5,"div",3)(6,"div",4)(7,"div",5)(8,"label",6),y(9,"Search Invoices"),g(),m(10,"input",7),ne("ngModelChange",function(o){return re(r.invoiceSearchTerm,o)||(r.invoiceSearchTerm=o),o}),z("input",function(){return r.onInvoiceSearch()}),g()(),m(11,"div",5)(12,"label",8),y(13,"Filter by Status"),g(),m(14,"select",9),ne("ngModelChange",function(o){return re(r.selectedInvoiceStatus,o)||(r.selectedInvoiceStatus=o),o}),z("change",function(){return r.onStatusFilterChange()}),m(15,"option",10),y(16,"All Invoices"),g(),m(17,"option",11),y(18,"Paid"),g(),m(19,"option",12),y(20,"Partially Paid"),g(),m(21,"option",13),y(22,"Pending"),g()()()()(),m(23,"div",14)(24,"div",15)(25,"h4"),y(26,"Total Invoices"),g(),m(27,"p",16),y(28),g()()(),m(29,"div",17),ie(30,jG,3,4,"div",18)(31,BG,5,0,"div",19)(32,UG,3,0,"div",19),g()(),ie(33,qG,8,1,"div",20)(34,GG,13,4,"div",21)),t&2&&(I(4),V("ngIf",r.customerFilter),I(6),te("ngModel",r.invoiceSearchTerm),I(4),te("ngModel",r.selectedInvoiceStatus),I(14),se(r.customerFilter?r.filteredInvoices.length:r.invoices.length),I(2),V("ngForOf",r.filteredInvoices),I(),V("ngIf",r.filteredInvoices.length===0&&r.invoices.length>0),I(),V("ngIf",r.invoices.length===0),I(),V("ngIf",r.showPaymentModal),I(),V("ngIf",r.showPaymentSuccess))},dependencies:[Ot,Tn,Wt,mr,uu,Mn,Uo,Wc,qc,tr,Od,$o,pi,Bo,Hi,JI,kd,ZI,Tr,zi,Ss],styles:['[_nghost-%COMP%]{display:block;background:#f8f9fa}.view-invoices-container[_ngcontent-%COMP%]{max-width:1400px;margin:0 auto;padding:20px 40px;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,sans-serif}.invoice-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:30px;padding:20px;background:#fff;border-radius:12px;box-shadow:0 2px 8px #0000001a}.invoice-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{color:#2c3e50;margin:0;font-size:2rem;font-weight:600}.back-btn[_ngcontent-%COMP%]{background:#6c757d;color:#fff;border:none;padding:10px 20px;border-radius:8px;cursor:pointer;font-size:14px;transition:background-color .3s ease}.back-btn[_ngcontent-%COMP%]:hover{background:#5a6268}.invoice-search-section[_ngcontent-%COMP%]{background:#fff;padding:25px;border-radius:12px;margin-bottom:30px;box-shadow:0 2px 8px #0000001a;border:1px solid #e9ecef}.form-row[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:15px}.form-group[_ngcontent-%COMP%]{margin-bottom:20px}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:8px;color:#555;font-size:14px;font-weight:500}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{width:100%;padding:12px 15px;border:1px solid #e0e0e0;border-radius:10px;font-size:14px;box-sizing:border-box;outline:none;transition:all .3s ease}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus, .form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus{border-color:#667eea;box-shadow:0 0 10px #667eea4d}.invoice-stats[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:20px;margin-bottom:30px}.invoice-stats[_ngcontent-%COMP%]   .stat-card[_ngcontent-%COMP%]{background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;padding:20px;border-radius:12px;text-align:center;box-shadow:0 4px 12px #667eea4d}.invoice-stats[_ngcontent-%COMP%]   .stat-card[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 10px;font-size:14px;opacity:.9}.invoice-stats[_ngcontent-%COMP%]   .stat-card[_ngcontent-%COMP%]   .stat-number[_ngcontent-%COMP%]{font-size:2rem;font-weight:700;margin:0}.invoice-stats[_ngcontent-%COMP%]   .stat-card[_ngcontent-%COMP%]   .stat-number.paid[_ngcontent-%COMP%]{color:#4caf50}.invoice-stats[_ngcontent-%COMP%]   .stat-card[_ngcontent-%COMP%]   .stat-number.due-amount[_ngcontent-%COMP%]{color:#ff6b6b}.invoice-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:20px;max-height:70vh;overflow-y:auto;padding:15px;background:#fff;border-radius:12px;box-shadow:0 2px 8px #0000001a;border:1px solid #e9ecef}.invoice-list[_ngcontent-%COMP%]:before{content:""}.invoice-cards-container[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(400px,1fr));gap:20px;margin-bottom:10px}.invoice-card[_ngcontent-%COMP%]{background:#fff;border-radius:8px;box-shadow:0 2px 8px #0000001a;overflow:hidden;border:1px solid #e9ecef;transition:all .2s ease}.invoice-card[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 4px 16px #00000026}.invoice-card.expanded[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr 1fr;grid-template-rows:auto auto;gap:0}.invoice-card.expanded[_ngcontent-%COMP%]   .detailed-header[_ngcontent-%COMP%]{grid-column:1 / -1}.card-section[_ngcontent-%COMP%]{padding:16px 20px;border-right:1px solid #f0f2f5;border-bottom:1px solid #f0f2f5}.card-section[_ngcontent-%COMP%]:nth-child(3n){border-right:none}.card-section[_ngcontent-%COMP%]:nth-child(n+4){border-bottom:none}.card-section.status-management[_ngcontent-%COMP%]{grid-column:1 / -1;border-right:none}.section-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;margin-bottom:12px;font-weight:600;color:#495057;border-bottom:1px solid #e9ecef;padding-bottom:8px;font-size:14px}.section-icon[_ngcontent-%COMP%]{font-size:14px}.section-title[_ngcontent-%COMP%]{font-size:14px;font-weight:600}.section-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:6px}.detail-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:2px 0;min-height:20px}.detail-label[_ngcontent-%COMP%]{font-size:13px;color:#6c757d;font-weight:500;min-width:120px}.detail-value[_ngcontent-%COMP%]{font-size:13px;color:#495057;font-weight:500;text-align:right;flex:1}.service-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:2px 0;min-height:20px}.service-name[_ngcontent-%COMP%]{font-size:13px;color:#495057;font-weight:500;flex:1}.service-amount[_ngcontent-%COMP%]{font-size:13px;color:#28a745;font-weight:600}.more-services[_ngcontent-%COMP%]{font-size:11px;color:#6c757d;font-style:italic;margin-top:4px}.amount-total[_ngcontent-%COMP%], .amount-advance[_ngcontent-%COMP%], .amount-balance[_ngcontent-%COMP%]{color:#495057;font-weight:600}.bank-info[_ngcontent-%COMP%]{color:#007bff;font-size:12px}.status-buttons[_ngcontent-%COMP%]{display:flex;gap:10px;margin-top:8px}.status-btn[_ngcontent-%COMP%]{flex:1;padding:8px 16px;border:none;border-radius:6px;font-size:13px;font-weight:500;cursor:pointer;transition:all .2s ease}.status-btn.mark-paid[_ngcontent-%COMP%]{background-color:#28a745;color:#fff}.status-btn.mark-paid[_ngcontent-%COMP%]:hover:not(:disabled){background-color:#218838}.status-btn.mark-paid.active[_ngcontent-%COMP%], .status-btn.mark-paid[_ngcontent-%COMP%]:disabled{background-color:#155724;opacity:.7;cursor:not-allowed}.status-btn.mark-pending[_ngcontent-%COMP%]{background-color:#dc3545;color:#fff}.status-btn.mark-pending[_ngcontent-%COMP%]:hover:not(:disabled){background-color:#c82333}.status-btn.mark-pending.active[_ngcontent-%COMP%], .status-btn.mark-pending[_ngcontent-%COMP%]:disabled{background-color:#721c24;opacity:.7;cursor:not-allowed}.invoice-card-compact[_ngcontent-%COMP%]{background:#fff;border-radius:12px;box-shadow:0 2px 8px #0000001a;border:1px solid #e9ecef;overflow:hidden;transition:transform .2s ease,box-shadow .3s ease}.invoice-card-compact[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 4px 16px #00000026}.card-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:16px 20px 12px;background:linear-gradient(135deg,#f8f9fa,#e9ecef);border-bottom:1px solid #dee2e6}.invoice-info[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:4px}.invoice-number[_ngcontent-%COMP%]{margin:0;color:#2c3e50;font-size:1.1rem;font-weight:600}.invoice-date[_ngcontent-%COMP%]{color:#6c757d;font-size:13px;font-weight:500}.status-badge[_ngcontent-%COMP%]{padding:4px 12px;border-radius:15px;font-size:11px;font-weight:600;text-transform:uppercase;letter-spacing:.5px}.status-paid[_ngcontent-%COMP%]{background:#d4edda;color:#155724;border:1px solid #c3e6cb}.status-pending[_ngcontent-%COMP%]{background:#f8d7da;color:#721c24;border:1px solid #f5c6cb}.status-partial[_ngcontent-%COMP%]{background:#fff3cd;color:#856404;border:1px solid #ffeaa7}.card-body[_ngcontent-%COMP%]{padding:16px 20px}.customer-details[_ngcontent-%COMP%]{margin-bottom:12px}.customer-name[_ngcontent-%COMP%], .customer-mobile[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;margin-bottom:6px;font-size:14px;color:#495057}.customer-name[_ngcontent-%COMP%]{font-weight:600;color:#2c3e50}.customer-name[_ngcontent-%COMP%]   i[_ngcontent-%COMP%], .customer-mobile[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{width:14px;color:#6c757d;font-size:12px}.service-details[_ngcontent-%COMP%]{margin-bottom:16px}.service-info[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;font-size:13px;color:#495057;line-height:1.4}.service-info[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{width:14px;color:#6c757d;font-size:12px}.more-services[_ngcontent-%COMP%]{background:#e9ecef;color:#6c757d;padding:2px 6px;border-radius:10px;font-size:11px;font-weight:500;margin-left:8px}.amount-details[_ngcontent-%COMP%]{background:#f8f9fa;padding:12px;border-radius:8px;border:1px solid #e9ecef}.amount-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:6px;font-size:14px}.amount-row[_ngcontent-%COMP%]:last-child{margin-bottom:0}.amount-row[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{color:#6c757d;font-weight:500}.amount-row[_ngcontent-%COMP%]   .amount[_ngcontent-%COMP%]{font-weight:600}.total-amount[_ngcontent-%COMP%]{color:#2c3e50;font-size:15px}.advance-amount[_ngcontent-%COMP%]{color:#17a2b8}.balance-amount[_ngcontent-%COMP%]{color:#dc3545}.balance-amount.paid[_ngcontent-%COMP%]{color:#28a745}.balance-row[_ngcontent-%COMP%]{border-top:1px solid #dee2e6;padding-top:8px;margin-top:8px;font-weight:600}.paid-badge[_ngcontent-%COMP%]{background:#28a745;color:#fff;padding:2px 6px;border-radius:10px;font-size:10px;font-weight:600;margin-left:8px}.card-actions[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:12px 20px;background:#f8f9fa;border-top:1px solid #e9ecef}.action-buttons[_ngcontent-%COMP%]{display:flex;gap:8px}.action-btn[_ngcontent-%COMP%]{padding:8px 10px;border:none;border-radius:6px;cursor:pointer;font-size:12px;transition:all .2s ease;display:flex;align-items:center;justify-content:center;min-width:36px;height:32px}.action-btn[_ngcontent-%COMP%]:hover{transform:translateY(-1px);box-shadow:0 2px 4px #0003}.print-btn[_ngcontent-%COMP%]{background:#28a745;color:#fff}.print-btn[_ngcontent-%COMP%]:hover{background:#218838}.whatsapp-btn[_ngcontent-%COMP%]{background:#25d366;color:#fff}.whatsapp-btn[_ngcontent-%COMP%]:hover{background:#20b954}.edit-btn[_ngcontent-%COMP%]{background:#ffc107;color:#212529}.edit-btn[_ngcontent-%COMP%]:hover{background:#e0a800}.delete-btn[_ngcontent-%COMP%]{background:#dc3545;color:#fff}.delete-btn[_ngcontent-%COMP%]:hover{background:#c82333}.status-select[_ngcontent-%COMP%]{padding:6px 10px;border:1px solid #ddd;border-radius:6px;font-size:12px;background:#fff;cursor:pointer;min-width:120px}.status-select[_ngcontent-%COMP%]:focus{outline:none;border-color:#667eea;box-shadow:0 0 0 2px #667eea33}.payment-actions[_ngcontent-%COMP%]{display:flex;gap:8px;margin-top:15px;padding-top:15px;border-top:1px solid #f0f2f5}.payment-btn[_ngcontent-%COMP%]{flex:1;padding:10px 16px;border:none;border-radius:8px;font-size:13px;font-weight:500;cursor:pointer;transition:all .2s ease;display:flex;align-items:center;justify-content:center;gap:6px;min-width:120px;height:40px}.payment-btn.add-payment-btn[_ngcontent-%COMP%]{background-color:#007bff;color:#fff}.payment-btn.add-payment-btn[_ngcontent-%COMP%]:hover{background-color:#0056b3}.show-details-btn[_ngcontent-%COMP%], .hide-details-btn[_ngcontent-%COMP%]{background-color:#007bff;color:#fff;border:none;padding:10px 16px;border-radius:8px;cursor:pointer;font-size:13px;font-weight:500;transition:background-color .2s ease;display:flex;align-items:center;justify-content:center;gap:6px;min-width:120px;height:40px}.payment-btn.paid-btn[_ngcontent-%COMP%]{background-color:#28a745;color:#fff}.payment-btn.paid-btn[_ngcontent-%COMP%]:hover{background-color:#218838}.payment-btn.pending-btn[_ngcontent-%COMP%]{background-color:#dc3545;color:#fff}.payment-btn.pending-btn[_ngcontent-%COMP%]:hover{background-color:#c82333}.payment-btn[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed}.invoice-minimal-view[_ngcontent-%COMP%]{padding:20px;display:flex;flex-direction:column;gap:15px}.minimal-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding-bottom:15px;border-bottom:1px solid #e9ecef}.invoice-info[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:5px}.invoice-number[_ngcontent-%COMP%]{margin:0;color:#2c3e50;font-size:1.2rem;font-weight:600}.invoice-date[_ngcontent-%COMP%]{color:#6c757d;font-size:13px}.status-badge[_ngcontent-%COMP%]{padding:4px 8px;border-radius:12px;font-size:11px;font-weight:600;text-transform:uppercase;width:fit-content}.status-badge.status-paid[_ngcontent-%COMP%]{background-color:#d4edda;color:#155724}.status-badge.status-pending[_ngcontent-%COMP%]{background-color:#f8d7da;color:#721c24}.status-badge.status-partial[_ngcontent-%COMP%]{background-color:#fff3cd;color:#856404}.show-details-btn[_ngcontent-%COMP%]:hover, .hide-details-btn[_ngcontent-%COMP%]:hover{background-color:#0056b3}.minimal-content[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:20px}.minimal-section[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:8px}.amount-total[_ngcontent-%COMP%]{color:#28a745;font-weight:600}.amount-due[_ngcontent-%COMP%]{color:#dc3545;font-weight:600}.amount-due.paid[_ngcontent-%COMP%]{color:#28a745}.invoice-detailed-view[_ngcontent-%COMP%]{display:flex;flex-direction:column}.detailed-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:16px 20px;background:linear-gradient(135deg,#f8f9fa,#e9ecef);border-bottom:1px solid #dee2e6}.header-actions[_ngcontent-%COMP%]{display:flex;gap:8px;align-items:center}.action-btn[_ngcontent-%COMP%]{padding:6px 8px;border:none;border-radius:4px;cursor:pointer;font-size:12px;transition:all .2s ease;min-width:32px;height:32px;display:flex;align-items:center;justify-content:center}.print-btn[_ngcontent-%COMP%]{background-color:#6c757d;color:#fff}.print-btn[_ngcontent-%COMP%]:hover{background-color:#5a6268}.whatsapp-btn[_ngcontent-%COMP%]{background-color:#25d366;color:#fff}.whatsapp-btn[_ngcontent-%COMP%]:hover{background-color:#1da851}.edit-btn[_ngcontent-%COMP%]{background-color:#ffc107;color:#212529}.edit-btn[_ngcontent-%COMP%]:hover{background-color:#e0a800}.delete-btn[_ngcontent-%COMP%]{background-color:#dc3545;color:#fff}.delete-btn[_ngcontent-%COMP%]:hover{background-color:#c82333}.customer-filter-indicator[_ngcontent-%COMP%]{background:#e3f2fd;border:1px solid #2196f3;border-radius:8px;padding:12px 16px;margin-bottom:20px}.filter-info[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;color:#1976d2;font-weight:500}.filter-info[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:#2196f3}.clear-filter-btn[_ngcontent-%COMP%]{background:#2196f3;color:#fff;border:none;border-radius:4px;padding:4px 8px;cursor:pointer;font-size:12px;margin-left:auto;transition:background-color .2s ease}.clear-filter-btn[_ngcontent-%COMP%]:hover{background:#1976d2}.clear-filter-btn[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{margin-right:4px}@media (max-width: 1200px){.services[_ngcontent-%COMP%]{max-width:150px}.customer-info[_ngcontent-%COMP%]{min-width:120px}}@media (max-width: 1024px){.invoice-cards-container[_ngcontent-%COMP%]{grid-template-columns:1fr}.invoice-card.expanded[_ngcontent-%COMP%]{grid-template-columns:1fr;grid-template-rows:auto}.invoice-card.expanded[_ngcontent-%COMP%]   .card-section[_ngcontent-%COMP%]{border-right:none;border-bottom:1px solid #f0f2f5}.invoice-card.expanded[_ngcontent-%COMP%]   .card-section[_ngcontent-%COMP%]:last-child{border-bottom:none}}@media (max-width: 768px){.view-invoices-container[_ngcontent-%COMP%]{padding:20px}.header-actions[_ngcontent-%COMP%]{flex-wrap:wrap;gap:6px}.action-btn[_ngcontent-%COMP%]{min-width:28px;height:28px;font-size:11px}}@media (max-width: 480px){.view-invoices-container[_ngcontent-%COMP%]{padding:15px}.payment-actions[_ngcontent-%COMP%]{flex-direction:column;gap:8px}.payment-btn[_ngcontent-%COMP%]{font-size:12px;padding:8px 10px}.header-actions[_ngcontent-%COMP%]{justify-content:center}}@media (max-width: 768px){.minimal-content[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:15px}.minimal-header[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;gap:10px}.show-details-btn[_ngcontent-%COMP%], .hide-details-btn[_ngcontent-%COMP%]{width:100%;justify-content:center}}.payment-modal-overlay[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background:#0009;display:flex;justify-content:center;align-items:center;z-index:9999;-webkit-backdrop-filter:blur(2px);backdrop-filter:blur(2px);overflow-y:auto}.payment-modal[_ngcontent-%COMP%]{background:#fff;border-radius:12px;box-shadow:0 10px 30px #0000004d;width:90%;max-width:450px;max-height:65vh;animation:_ngcontent-%COMP%_modalSlideIn .3s ease-out}@keyframes _ngcontent-%COMP%_modalSlideIn{0%{opacity:0;transform:translateY(-50px) scale(.9)}to{opacity:1;transform:translateY(0) scale(1)}}.payment-modal-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:15px 20px;border-bottom:1px solid #e9ecef;background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;border-radius:12px 12px 0 0}.payment-modal-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;font-size:1.3rem;font-weight:600}.close-modal-btn[_ngcontent-%COMP%]{background:none;border:none;color:#fff;font-size:1.5rem;cursor:pointer;padding:5px;border-radius:50%;transition:background-color .3s ease}.close-modal-btn[_ngcontent-%COMP%]:hover{background:#fff3}.payment-modal-content[_ngcontent-%COMP%]{padding:15px 20px}.payment-invoice-details[_ngcontent-%COMP%]{background:#f8f9fa;padding:10px 15px;border-radius:8px;margin-bottom:15px;border-left:4px solid #28a745}.invoice-summary[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:8px}.invoice-info[_ngcontent-%COMP%]{font-weight:600;color:#2c3e50;font-size:.95rem}.remaining-amount[_ngcontent-%COMP%]{color:#e74c3c!important;font-weight:700;font-size:1rem!important}.ultra-compact-row[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr 1fr;gap:10px;margin-bottom:15px}.payment-form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:15px}.payment-form[_ngcontent-%COMP%]   .form-row[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:20px}.payment-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]{display:flex;flex-direction:column}.payment-form[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-weight:600;margin-bottom:4px;color:#2c3e50;font-size:.85rem}.payment-form[_ngcontent-%COMP%]   .optional-label[_ngcontent-%COMP%]{color:#6c757d;font-weight:400;font-size:.75rem;font-style:italic}.payment-form[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]{padding:12px 15px;border:2px solid #e9ecef;border-radius:8px;font-size:1rem;transition:border-color .3s ease,box-shadow .3s ease}.payment-form[_ngcontent-%COMP%]   .form-control.compact[_ngcontent-%COMP%]{padding:8px 10px;border:2px solid #e9ecef;border-radius:6px;font-size:.9rem;transition:border-color .3s ease,box-shadow .3s ease}.payment-form[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]:focus, .payment-form[_ngcontent-%COMP%]   .form-control.compact[_ngcontent-%COMP%]:focus{outline:none;border-color:#667eea;box-shadow:0 0 0 2px #667eea1a}.payment-form[_ngcontent-%COMP%]   textarea.form-control[_ngcontent-%COMP%]{resize:vertical;min-height:80px}.payment-modal-actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:15px;margin-top:30px;padding-top:20px;border-top:1px solid #e9ecef}.cancel-btn[_ngcontent-%COMP%]{background:#6c757d;color:#fff;border:none;padding:12px 25px;border-radius:8px;cursor:pointer;font-size:1rem;transition:background-color .3s ease}.cancel-btn.compact[_ngcontent-%COMP%]{padding:10px 20px;font-size:.9rem}.cancel-btn[_ngcontent-%COMP%]:hover{background:#5a6268}.submit-payment-btn[_ngcontent-%COMP%]{background:linear-gradient(135deg,#28a745,#20c997);color:#fff;border:none;padding:12px 25px;border-radius:8px;cursor:pointer;font-size:1rem;font-weight:600;transition:transform .2s ease,box-shadow .3s ease}.submit-payment-btn.compact[_ngcontent-%COMP%]{padding:10px 20px;font-size:.9rem}.submit-payment-btn[_ngcontent-%COMP%]:hover{transform:translateY(-1px);box-shadow:0 4px 12px #28a74566}.submit-payment-btn[_ngcontent-%COMP%]:active{transform:translateY(0)}@media (max-width: 768px){.payment-modal-overlay[_ngcontent-%COMP%]{padding:5px;align-items:center;justify-content:center}.payment-modal[_ngcontent-%COMP%]{width:95%;max-width:none;margin:0 auto;max-height:85vh}.payment-modal-content[_ngcontent-%COMP%], .payment-modal-header[_ngcontent-%COMP%]{padding:12px 15px}.payment-form[_ngcontent-%COMP%]   .form-row[_ngcontent-%COMP%], .compact-form-row[_ngcontent-%COMP%], .ultra-compact-row[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:10px}.compact-form-row[_ngcontent-%COMP%]:last-of-type, .ultra-compact-row[_ngcontent-%COMP%]:last-of-type{grid-template-columns:1fr}.payment-modal-actions[_ngcontent-%COMP%]{flex-direction:row;gap:8px;margin-top:10px;padding-top:10px;position:static;background:none;border-top:none}.cancel-btn[_ngcontent-%COMP%], .submit-payment-btn[_ngcontent-%COMP%], .cancel-btn.compact[_ngcontent-%COMP%], .submit-payment-btn.compact[_ngcontent-%COMP%]{flex:1;padding:12px 15px;font-size:.9rem;border-radius:6px}.submit-payment-btn[_ngcontent-%COMP%], .cancel-btn[_ngcontent-%COMP%]{order:2}}@media (max-width: 480px){.payment-modal[_ngcontent-%COMP%]{width:98%;max-height:90vh}.payment-modal-header[_ngcontent-%COMP%]{padding:10px 12px}.payment-modal-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:1.1rem}.payment-modal-content[_ngcontent-%COMP%]{padding:8px 10px}.payment-invoice-details[_ngcontent-%COMP%]{padding:6px 10px;margin-bottom:8px}.invoice-info[_ngcontent-%COMP%]{font-size:.85rem}.remaining-amount[_ngcontent-%COMP%]{font-size:.9rem!important}.payment-form[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:.75rem;margin-bottom:2px}.payment-form[_ngcontent-%COMP%]   .form-control.compact[_ngcontent-%COMP%]{padding:6px 8px;font-size:.8rem;font-size:16px}.payment-modal-actions[_ngcontent-%COMP%]{padding:12px 0 0;margin-top:15px}.cancel-btn[_ngcontent-%COMP%], .submit-payment-btn[_ngcontent-%COMP%]{padding:14px;font-size:16px}}.minimal-actions[_ngcontent-%COMP%]{display:flex;gap:10px;align-items:center}.bottom-card-actions[_ngcontent-%COMP%]{display:flex;justify-content:center;gap:15px;margin-top:20px;padding-top:15px;border-top:1px solid #e9ecef}.payment-success-overlay[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background:#000c;display:flex;justify-content:center;align-items:center;z-index:10000;animation:_ngcontent-%COMP%_fadeIn .3s ease-in-out}.payment-success-container[_ngcontent-%COMP%]{background:#fff;padding:40px;border-radius:20px;text-align:center;max-width:400px;animation:_ngcontent-%COMP%_slideIn .5s ease-out}.success-checkmark[_ngcontent-%COMP%]{margin-bottom:20px}.checkmark[_ngcontent-%COMP%]{width:80px;height:80px;border-radius:50%;display:block;stroke-width:2;stroke:#4caf50;stroke-miterlimit:10;margin:0 auto;animation:_ngcontent-%COMP%_checkmark .6s cubic-bezier(.65,0,.45,1) forwards}.checkmark-circle[_ngcontent-%COMP%]{stroke-dasharray:166;stroke-dashoffset:166;stroke-width:2;stroke-miterlimit:10;stroke:#4caf50;fill:none;animation:_ngcontent-%COMP%_stroke .6s cubic-bezier(.65,0,.45,1) forwards}.checkmark-check[_ngcontent-%COMP%]{transform-origin:50% 50%;stroke-dasharray:48;stroke-dashoffset:48;stroke-width:3;stroke:#4caf50;animation:_ngcontent-%COMP%_stroke .3s cubic-bezier(.65,0,.45,1) .8s forwards}.success-title[_ngcontent-%COMP%]{color:#4caf50;font-size:24px;font-weight:600;margin:10px 0}.success-amount[_ngcontent-%COMP%]{color:#2c3e50;font-size:32px;font-weight:700;margin:10px 0}.success-message[_ngcontent-%COMP%]{color:#6c757d;font-size:16px;margin:10px 0}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0}to{opacity:1}}@keyframes _ngcontent-%COMP%_slideIn{0%{transform:scale(.8) translateY(20px);opacity:0}to{transform:scale(1) translateY(0);opacity:1}}@keyframes _ngcontent-%COMP%_stroke{to{stroke-dashoffset:0}}@keyframes _ngcontent-%COMP%_checkmark{0%{stroke-dashoffset:166}to{stroke-dashoffset:0}}']})};var KG=()=>[1,2,3,4,5,6];function YG(n,e){n&1&&(m(0,"div",4),K(1,"div",5),m(2,"p"),y(3,"Loading invoice..."),g()())}function QG(n,e){n&1&&(m(0,"div",48),K(1,"i",49),m(2,"span"),y(3,"Invoice Saved!"),g()())}function ZG(n,e){if(n&1&&(m(0,"p"),y(1),g()),n&2){let t=A(2);I(),pe("Email: ",t.invoice.customer.email,"")}}function JG(n,e){if(n&1&&(m(0,"p"),y(1),g()),n&2){let t=A(2);I(),pe("GST: ",t.invoice.customer.gst,"")}}function XG(n,e){if(n&1&&(m(0,"tr")(1,"td"),y(2),g(),m(3,"td"),y(4),g(),m(5,"td",32),y(6),Ve(7,"number"),g()()),n&2){let t=e.$implicit,r=e.index,i=A(2);I(2),se(r+1),I(2),se(i.getServiceDescription(t)),I(2),se(je(7,3,t.amount,"1.2-2"))}}function eK(n,e){n&1&&(m(0,"tr",50)(1,"td"),y(2,"\xA0"),g(),m(3,"td"),y(4,"\xA0"),g(),m(5,"td"),y(6,"\xA0"),g()())}function tK(n,e){n&1&&K(0,"i",54)}function nK(n,e){n&1&&K(0,"i",55)}function rK(n,e){if(n&1){let t=de();m(0,"button",51),z("click",function(){B(t);let i=A(2);return U(i.createInvoice())}),ie(1,tK,1,0,"i",52)(2,nK,1,0,"i",53),y(3),g()}if(n&2){let t=A(2);V("disabled",t.isCreating),I(),V("ngIf",!t.isCreating),I(),V("ngIf",t.isCreating),I(),pe(" ",t.isCreating?"Saving Invoice...":"Save Invoice"," ")}}function iK(n,e){n&1&&(m(0,"p",56),y(1,' Click "Cancel" to discard this invoice and return to dashboard '),g())}function oK(n,e){if(n&1){let t=de();m(0,"div",6)(1,"div",7)(2,"button",8),z("click",function(){B(t);let i=A();return U(i.goBack())}),K(3,"i",9),y(4),g(),m(5,"div",10)(6,"button",11),z("click",function(){B(t);let i=A();return U(i.printInvoice())}),K(7,"i",12),m(8,"span"),y(9,"Download"),g()(),m(10,"button",13),z("click",function(){B(t);let i=A();return U(i.shareOnWhatsApp())}),K(11,"i",14),m(12,"span"),y(13,"WhatsApp"),g()(),ie(14,QG,4,0,"div",15),g()(),m(15,"div",16)(16,"div",17)(17,"h1"),y(18,"GLOBAL FINANCIAL SERVICES"),g(),m(19,"h2"),y(20,"ACCOUNTING & FINANCIAL SERVICES"),g(),m(21,"div",18)(22,"p"),y(23,"Flat No. 602, Ashirvad Symphani, Meera Datar Road, Near K K Wagh College,"),g(),m(24,"p"),y(25,"Panchavati, Nashik - 422003."),g(),m(26,"p"),y(27,"Cell : 9623736781 | Cell : 9604722533"),g()()(),m(28,"div",19)(29,"h3"),y(30,"INVOICE"),g()(),m(31,"div",20)(32,"div",21)(33,"h4"),y(34,"TO,"),g(),m(35,"div",22)(36,"p")(37,"strong"),y(38),g()(),m(39,"p"),y(40),g(),m(41,"p"),y(42),g(),ie(43,ZG,2,1,"p",23)(44,JG,2,1,"p",23),g()(),m(45,"div",24)(46,"table")(47,"tr")(48,"td")(49,"strong"),y(50,"Invoice No:"),g()(),m(51,"td"),y(52),g()(),m(53,"tr")(54,"td")(55,"strong"),y(56,"Invoice Date:"),g()(),m(57,"td"),y(58),Ve(59,"date"),g()(),m(60,"tr")(61,"td")(62,"strong"),y(63,"Status:"),g()(),m(64,"td",25),y(65),g()()()()(),m(66,"div",26)(67,"table",27)(68,"thead")(69,"tr")(70,"th"),y(71,"Sr. No."),g(),m(72,"th"),y(73,"Description of Services"),g(),m(74,"th"),y(75,"Amount (\u20B9)"),g()()(),m(76,"tbody"),ie(77,XG,8,6,"tr",28)(78,eK,7,0,"tr",29),g()()(),m(79,"div",30)(80,"div",31)(81,"table")(82,"tr")(83,"td")(84,"strong"),y(85,"Total Amount:"),g()(),m(86,"td",32)(87,"strong"),y(88),Ve(89,"number"),g()()(),m(90,"tr")(91,"td")(92,"strong"),y(93,"Advance Received:"),g()(),m(94,"td",32),y(95),Ve(96,"number"),g()(),m(97,"tr",33)(98,"td")(99,"strong"),y(100,"Balance Payable:"),g()(),m(101,"td",34)(102,"strong"),y(103),Ve(104,"number"),g()()()()()(),m(105,"div",35)(106,"h4"),y(107,"Bank Details:"),g(),m(108,"p"),y(109),g()(),m(110,"div",36)(111,"div",37)(112,"p"),y(113,"For Global Financial Services"),g(),K(114,"div",38),m(115,"p"),y(116,"Authorized Signatory"),g()(),m(117,"div",39)(118,"p")(119,"strong"),y(120,"Terms & Conditions:"),g()(),m(121,"ul")(122,"li"),y(123,"Payment is due within 30 days of invoice date"),g(),m(124,"li"),y(125,"Late payments may incur additional charges"),g(),m(126,"li"),y(127,"All disputes subject to Nashik jurisdiction"),g()()()()(),m(128,"div",40)(129,"div",41),ie(130,rK,4,4,"button",42),m(131,"button",43),z("click",function(){B(t);let i=A();return U(i.editInvoice())}),K(132,"i",44),y(133," EDIT "),g(),m(134,"button",45),z("click",function(){B(t);let i=A();return U(i.cancelInvoice())}),K(135,"i",46),y(136," Cancel "),g()(),ie(137,iK,2,0,"p",47),g()()}if(n&2){let t=A();I(4),pe(" ",t.isPreviewMode?"Back to Form":"Back"," "),I(2),V("disabled",t.isPreviewMode&&!t.invoiceCreated),I(4),V("disabled",t.isPreviewMode&&!t.invoiceCreated),I(4),V("ngIf",t.isPreviewMode&&t.invoiceCreated),I(24),se(t.invoice.customer.name),I(2),se(t.invoice.customer.address),I(2),pe("Mobile: ",t.invoice.customer.mobile,""),I(),V("ngIf",t.invoice.customer.email),I(),V("ngIf",t.invoice.customer.gst),I(8),se(t.invoice.invoiceNumber),I(6),se(je(59,22,t.invoice.invoiceDate,"dd/MM/yyyy")),I(6),eu("status-"+t.invoice.status.toLowerCase()),I(),pe(" ",t.invoice.status," "),I(12),V("ngForOf",t.invoice.serviceDetails),I(),V("ngForOf",iM(34,KG).slice(t.invoice.serviceDetails.length)),I(10),pe("\u20B9",je(89,25,t.invoice.totalAmount,"1.2-2"),""),I(7),pe("\u20B9",je(96,28,t.invoice.advanceReceived,"1.2-2"),""),I(8),pe("\u20B9",je(104,31,t.invoice.balancePayable,"1.2-2"),""),I(6),se(t.invoice.selectedBank),I(21),V("ngIf",t.isPreviewMode&&!t.invoiceCreated),I(7),V("ngIf",t.isPreviewMode)}}function sK(n,e){if(n&1){let t=de();m(0,"div",57)(1,"h3"),y(2,"Invoice not found"),g(),m(3,"button",8),z("click",function(){B(t);let i=A();return U(i.goBack())}),K(4,"i",9),y(5," Back to Dashboard "),g()()}}var jd=class n{constructor(e,t,r,i){this.route=e;this.router=t;this.invoiceService=r;this.pdfService=i}invoice=null;isLoading=!0;isPreviewMode=!1;isCreating=!1;invoiceCreated=!1;formData=null;ngOnInit(){this.route.queryParams.subscribe(e=>{if(e.mode==="preview")this.isPreviewMode=!0,this.loadPreviewData();else{let t=this.route.snapshot.paramMap.get("id");t?this.loadInvoice(t):this.router.navigate(["/dashboard"])}})}loadPreviewData(){try{let e=sessionStorage.getItem("tempInvoiceData");if(console.log("Loading preview data from sessionStorage:",e),e){let t=JSON.parse(e);console.log("Parsed preview data:",t),this.invoice=t.invoiceData,this.formData=t.formData,this.isLoading=!1,console.log("Preview loaded - Invoice:",this.invoice),console.log("Preview loaded - Form data:",this.formData),console.log("\u{1F504} isPreviewMode:",this.isPreviewMode),console.log("\u2705 invoiceCreated:",this.invoiceCreated)}else console.warn("No invoice data found for preview"),alert("No invoice data found for preview!"),this.router.navigate(["/create-invoice"])}catch(e){console.error("Error loading preview data:",e),alert("Error loading preview data!"),this.router.navigate(["/create-invoice"])}}loadInvoice(e){return w(this,null,function*(){try{let t=yield this.invoiceService.getInvoices();if(this.invoice=t.find(r=>r.id===e)||null,!this.invoice){alert("Invoice not found!"),this.router.navigate(["/dashboard"]);return}}catch(t){console.error("Error loading invoice:",t),alert("Error loading invoice!"),this.router.navigate(["/dashboard"])}finally{this.isLoading=!1}})}printInvoice(){this.invoice&&this.pdfService.generateInvoicePDF(this.invoice)}shareOnWhatsApp(){if(this.invoice)try{this.pdfService.generateInvoicePDF(this.invoice),setTimeout(()=>{let e=`\u{1F9FE} *Invoice ${this.invoice.invoiceNumber}*

\u{1F464} Customer: ${this.invoice.customer.name}
\u{1F4C5} Date: ${new Date(this.invoice.invoiceDate).toLocaleDateString("en-IN")}
\u{1F4B0} Total: \u20B9${this.invoice.totalAmount.toLocaleString("en-IN")}
\u{1F4B3} Advance: \u20B9${this.invoice.advanceReceived.toLocaleString("en-IN")}
\u{1F504} Balance: \u20B9${this.invoice.balancePayable.toLocaleString("en-IN")}
\u{1F4CA} Status: *${this.invoice.status}*

\u{1F4BC} *Services:*
${this.invoice.serviceDetails.map((i,o)=>{let s=this.getServiceDescription(i);return`${o+1}. ${s} - \u20B9${i.amount.toLocaleString("en-IN")}`}).join(`
`)}

\u{1F3E6} *Payment:*
${this.invoice.selectedBank}

\u{1F4F1} *GLOBAL FINANCIAL SERVICES*
\u260E\uFE0F 9623736781 | 9604722533
\u{1F4CD} Nashik - 422003

Thank you for your business! \u{1F64F}`,r=`https://wa.me/${this.invoice.customer.mobile.replace(/\D/g,"")}?text=${encodeURIComponent(e)}`;window.open(r,"_blank")},1500)}catch(e){console.error("Error sharing on WhatsApp:",e),alert("Error sharing invoice. Please try again.")}}createInvoice(){return w(this,null,function*(){if(console.log("\u{1F680} createInvoice() called"),console.log("\u{1F4CA} Current state - isPreviewMode:",this.isPreviewMode),console.log("\u{1F4CA} Current state - invoice:",this.invoice),console.log("\u{1F4CA} Current state - isCreating:",this.isCreating),!this.isPreviewMode||!this.invoice||this.isCreating){console.warn("\u26A0\uFE0F createInvoice conditions not met");return}this.isCreating=!0,console.log("\u{1F4BE} Starting invoice creation process...");try{let e;this.formData&&this.formData.isEditMode&&this.formData.editInvoiceId?(yield this.invoiceService.updateInvoice(this.formData.editInvoiceId,this.invoice),e=this.formData.editInvoiceId,this.invoice.id=e):(this.invoice.invoiceNumber=yield this.invoiceService.generateNextInvoiceNumber(this.invoice.invoiceDate),e=yield this.invoiceService.addInvoice(this.invoice),this.invoice.id=e),sessionStorage.removeItem("tempInvoiceData"),this.invoiceCreated=!0,this.isPreviewMode=!1,this.router.navigate(["/invoice-preview",e],{replaceUrl:!0})}catch(e){console.error("Error saving invoice:",e),alert("Error saving invoice. Please try again.")}finally{this.isCreating=!1}})}editInvoice(){if(this.isPreviewMode){let e={isEditMode:!0,editInvoiceId:this.formData?.editInvoiceId||null,invoiceData:this.invoice,formData:this.formData};sessionStorage.setItem("editInvoiceData",JSON.stringify(e)),this.router.navigate(["/create-invoice"],{queryParams:{mode:"edit"}})}else this.invoice&&this.router.navigate(["/create-invoice"],{queryParams:{edit:this.invoice.id}})}goBack(){if(this.isPreviewMode){let e={invoiceData:this.invoice,formData:this.formData,isEditMode:this.formData?.isEditMode||!1,editInvoiceId:this.formData?.editInvoiceId||null};sessionStorage.setItem("editInvoiceData",JSON.stringify(e)),this.router.navigate(["/create-invoice"],{queryParams:{mode:"edit"}})}else this.router.navigate(["/dashboard"],{queryParams:{category:"invoices"}})}cancelInvoice(){this.isPreviewMode?confirm("Are you sure you want to cancel this invoice? Any unsaved changes will be lost.")&&(sessionStorage.removeItem("tempInvoiceData"),sessionStorage.removeItem("editInvoiceData"),this.router.navigate(["/dashboard"],{queryParams:{category:"invoices"}})):this.router.navigate(["/dashboard"],{queryParams:{category:"invoices"}})}getServiceDescription(e){return e.description==="custom"&&e.customDescription?e.customDescription:e.description}static \u0275fac=function(t){return new(t||n)(q(qt),q(it),q(nr),q(mi))};static \u0275cmp=Pt({type:n,selectors:[["app-invoice-preview"]],decls:4,vars:3,consts:[[1,"invoice-preview-container"],["class","loading-container",4,"ngIf"],["class","invoice-preview",4,"ngIf"],["class","error-container",4,"ngIf"],[1,"loading-container"],[1,"loading-spinner"],[1,"invoice-preview"],[1,"action-header"],[1,"back-btn",3,"click"],[1,"fas","fa-arrow-left"],[1,"action-buttons"],["title","Download PDF",1,"print-btn",3,"click","disabled"],[1,"fas","fa-download"],["title","Share on WhatsApp",1,"whatsapp-btn",3,"click","disabled"],[1,"fab","fa-whatsapp"],["class","invoice-saved-indicator",4,"ngIf"],[1,"invoice-document"],[1,"company-header"],[1,"company-address"],[1,"invoice-title"],[1,"invoice-header-info"],[1,"customer-section"],[1,"customer-details"],[4,"ngIf"],[1,"invoice-details"],[1,"status-badge"],[1,"services-section"],[1,"services-table"],[4,"ngFor","ngForOf"],["class","empty-row",4,"ngFor","ngForOf"],[1,"totals-section"],[1,"totals-table"],[1,"amount"],[1,"balance-row"],[1,"amount","balance"],[1,"bank-section"],[1,"invoice-footer"],[1,"signature-section"],[1,"signature-line"],[1,"terms-section"],[1,"bottom-actions"],[1,"bottom-buttons"],["class","save-invoice-btn",3,"disabled","click",4,"ngIf"],[1,"edit-btn",3,"click"],[1,"fas","fa-edit"],[1,"cancel-invoice-btn",3,"click"],[1,"fas","fa-times"],["class","cancel-note",4,"ngIf"],[1,"invoice-saved-indicator"],[1,"fas","fa-check-circle"],[1,"empty-row"],[1,"save-invoice-btn",3,"click","disabled"],["class","fas fa-save",4,"ngIf"],["class","fas fa-spinner fa-spin",4,"ngIf"],[1,"fas","fa-save"],[1,"fas","fa-spinner","fa-spin"],[1,"cancel-note"],[1,"error-container"]],template:function(t,r){t&1&&(m(0,"div",0),ie(1,YG,4,0,"div",1)(2,oK,138,35,"div",2)(3,sK,6,0,"div",3),g()),t&2&&(I(),V("ngIf",r.isLoading),I(),V("ngIf",!r.isLoading&&r.invoice),I(),V("ngIf",!r.isLoading&&!r.invoice))},dependencies:[Ot,Tn,Wt,mr,uu],styles:["[_nghost-%COMP%]{display:block;background:#f8f9fa;min-height:100vh}.invoice-preview-container[_ngcontent-%COMP%]{max-width:900px;margin:0 auto;padding:20px}.loading-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:60px 20px;text-align:center}.loading-spinner[_ngcontent-%COMP%]{width:40px;height:40px;border:4px solid #f3f3f3;border-top:4px solid #667eea;border-radius:50%;animation:_ngcontent-%COMP%_spin 1s linear infinite;margin-bottom:15px}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.action-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:30px;padding:20px;background:#fff;border-radius:12px;box-shadow:0 2px 8px #0000001a}.back-btn[_ngcontent-%COMP%]{background:#6c757d;color:#fff;border:none;padding:12px 20px;border-radius:8px;cursor:pointer;font-size:14px;font-weight:500;display:flex;align-items:center;gap:8px;transition:all .3s ease}.back-btn[_ngcontent-%COMP%]:hover{background:#5a6268;transform:translateY(-2px)}.action-buttons[_ngcontent-%COMP%]{display:flex;gap:12px}.print-btn[_ngcontent-%COMP%], .whatsapp-btn[_ngcontent-%COMP%], .edit-btn[_ngcontent-%COMP%], .save-invoice-btn[_ngcontent-%COMP%]{padding:12px 20px;border:none;border-radius:8px;cursor:pointer;font-size:14px;font-weight:500;display:flex;align-items:center;gap:8px;transition:all .3s ease}.print-btn[_ngcontent-%COMP%]{background:#28a745;color:#fff}.print-btn[_ngcontent-%COMP%]:hover{background:#218838;transform:translateY(-2px)}.print-btn[_ngcontent-%COMP%]:disabled{background:#6c757d;color:#adb5bd;cursor:not-allowed;transform:none;opacity:.6}.whatsapp-btn[_ngcontent-%COMP%]{background:#25d366;color:#fff}.whatsapp-btn[_ngcontent-%COMP%]:hover{background:#20b954;transform:translateY(-2px)}.whatsapp-btn[_ngcontent-%COMP%]:disabled{background:#6c757d;color:#adb5bd;cursor:not-allowed;transform:none;opacity:.6}.edit-btn[_ngcontent-%COMP%]{background:#ffc107;color:#212529}.edit-btn[_ngcontent-%COMP%]:hover{background:#e0a800;transform:translateY(-2px)}.save-invoice-btn[_ngcontent-%COMP%]{background:#667eea;color:#fff}.save-invoice-btn[_ngcontent-%COMP%]:hover:not(:disabled){background:#5a6fd8;transform:translateY(-2px)}.save-invoice-btn[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed;transform:none}.invoice-saved-indicator[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;background:#d4edda;color:#155724;padding:12px 16px;border-radius:8px;font-size:14px;font-weight:600;border:1px solid #c3e6cb}.invoice-saved-indicator[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:#28a745;font-size:16px}.invoice-document[_ngcontent-%COMP%]{background:#fff;padding:40px;border-radius:12px;box-shadow:0 4px 20px #0000001a;font-family:Arial,sans-serif;line-height:1.4}.company-header[_ngcontent-%COMP%]{text-align:center;margin-bottom:30px;border-bottom:2px solid #e9ecef;padding-bottom:20px}.company-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{color:#3498db;font-size:28px;font-weight:700;margin:0 0 5px}.company-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{color:#27ae60;font-size:18px;font-weight:600;margin:0 0 15px}.company-address[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:2px 0;color:#555;font-size:14px}.invoice-title[_ngcontent-%COMP%]{text-align:center;margin-bottom:30px}.invoice-title[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{background:#2c3e50;color:#fff;padding:12px 0;margin:0;font-size:20px;font-weight:700;border-radius:6px}.invoice-header-info[_ngcontent-%COMP%]{display:grid;grid-template-columns:2fr 1fr;gap:30px;margin-bottom:30px}.customer-section[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 10px;color:#2c3e50;font-weight:700}.customer-details[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:3px 0;color:#333;font-size:14px}.invoice-details[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse}.invoice-details[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:6px 8px;border:1px solid #dee2e6;font-size:14px}.invoice-details[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:first-child{background:#f8f9fa;font-weight:500;width:40%}.status-badge[_ngcontent-%COMP%]{padding:4px 12px;border-radius:20px;font-size:12px;font-weight:600;text-transform:uppercase}.status-badge.status-paid[_ngcontent-%COMP%]{background:#d4edda;color:#155724}.status-badge.status-partial[_ngcontent-%COMP%]{background:#fff3cd;color:#856404}.status-badge.status-pending[_ngcontent-%COMP%]{background:#f8d7da;color:#721c24}.services-section[_ngcontent-%COMP%]{margin-bottom:30px}.services-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;margin-bottom:20px}.services-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .services-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{border:1px solid #dee2e6;padding:12px;text-align:left}.services-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background:#f8f9fa;font-weight:700;color:#2c3e50}.services-table[_ngcontent-%COMP%]   .amount[_ngcontent-%COMP%]{text-align:right;width:150px}.empty-row[_ngcontent-%COMP%]{height:40px}.totals-section[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;margin-bottom:30px}.totals-table[_ngcontent-%COMP%]{width:300px}.totals-table[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse}.totals-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:8px 12px;border:1px solid #dee2e6}.totals-table[_ngcontent-%COMP%]   .amount[_ngcontent-%COMP%]{text-align:right;width:120px}.balance-row[_ngcontent-%COMP%]{background:#f8f9fa;font-weight:700}.balance-row[_ngcontent-%COMP%]   .balance[_ngcontent-%COMP%]{color:#dc3545;font-size:16px}.bank-section[_ngcontent-%COMP%]{margin-bottom:30px;padding:15px;background:#f8f9fa;border-radius:6px;border-left:4px solid #3498db}.bank-section[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 8px;color:#2c3e50}.bank-section[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;color:#555;font-size:14px}.invoice-footer[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:30px;margin-top:40px;padding-top:20px;border-top:2px solid #e9ecef}.signature-section[_ngcontent-%COMP%]{text-align:center}.signature-line[_ngcontent-%COMP%]{width:200px;height:1px;background:#000;margin:40px auto 10px}.terms-section[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{margin:10px 0;padding-left:20px}.terms-section[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{margin-bottom:5px;font-size:13px;color:#666}.error-container[_ngcontent-%COMP%]{text-align:center;padding:60px 20px}.error-container[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{color:#dc3545;margin-bottom:20px}.cancel-section[_ngcontent-%COMP%]{margin-top:30px;text-align:center;padding:20px}.cancel-invoice-btn[_ngcontent-%COMP%]{background:#dc3545;color:#fff;border:none;padding:14px 28px;border-radius:8px;cursor:pointer;font-size:16px;font-weight:600;display:inline-flex;align-items:center;gap:10px;transition:all .3s ease;box-shadow:0 2px 8px #dc35454d}.cancel-invoice-btn[_ngcontent-%COMP%]:hover{background:#c82333;transform:translateY(-2px);box-shadow:0 4px 12px #dc354566}.cancel-note[_ngcontent-%COMP%]{margin-top:10px;font-size:14px;color:#6c757d;text-align:center;line-height:1.4}.cancel-invoice-btn[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:16px}.create-invoice-section[_ngcontent-%COMP%]{margin-top:30px;padding:0 20px}.create-invoice-container[_ngcontent-%COMP%]{background:#fff;border-radius:12px;padding:30px;box-shadow:0 2px 8px #0000001a;text-align:center}.create-invoice-btn[_ngcontent-%COMP%]{background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;border:none;border-radius:12px;padding:16px 32px;font-size:18px;font-weight:600;cursor:pointer;transition:all .3s ease;display:inline-flex;align-items:center;gap:10px;min-width:200px;justify-content:center}.create-invoice-btn[_ngcontent-%COMP%]:hover:not(:disabled){transform:translateY(-2px);box-shadow:0 8px 16px #667eea4d}.create-invoice-btn[_ngcontent-%COMP%]:disabled{opacity:.7;cursor:not-allowed;transform:none}.invoice-created-message[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:10px;background:#d4edda;color:#155724;padding:16px 24px;border-radius:12px;font-size:18px;font-weight:600;border:2px solid #c3e6cb}.invoice-created-message[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:20px;color:#28a745}@media (max-width: 768px){.invoice-preview-container[_ngcontent-%COMP%]{padding:10px}.action-header[_ngcontent-%COMP%]{flex-direction:column;gap:15px;align-items:stretch;padding:15px}.action-buttons[_ngcontent-%COMP%]{flex-wrap:wrap;gap:8px}.action-buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{flex:1;min-width:0;padding:10px 12px;font-size:13px}.invoice-document[_ngcontent-%COMP%]{padding:20px}.company-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:24px}.company-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:16px}.invoice-header-info[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:20px}.services-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .services-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:8px;font-size:13px}.invoice-footer[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:20px}.signature-line[_ngcontent-%COMP%]{width:150px}.create-invoice-container[_ngcontent-%COMP%]{padding:20px}.create-invoice-btn[_ngcontent-%COMP%]{padding:14px 24px;font-size:16px;min-width:180px}.invoice-created-message[_ngcontent-%COMP%]{padding:14px 20px;font-size:16px}.invoice-saved-indicator[_ngcontent-%COMP%]{flex-direction:column;gap:4px;text-align:center;padding:8px 12px;font-size:12px}.cancel-section[_ngcontent-%COMP%]{padding:15px}.cancel-invoice-btn[_ngcontent-%COMP%]{padding:12px 24px;font-size:14px}}.bottom-actions[_ngcontent-%COMP%]{margin-top:30px;padding:20px;background:#fff;border-radius:12px;box-shadow:0 2px 8px #0000001a;text-align:center}.bottom-buttons[_ngcontent-%COMP%]{display:flex;justify-content:center;gap:15px;margin-bottom:15px;flex-wrap:wrap}.cancel-note[_ngcontent-%COMP%]{margin:0;font-size:14px;color:#6c757d}"]})};var Kk=[{path:"",redirectTo:"login",pathMatch:"full"},{path:"login",component:jg},{path:"dashboard",component:$g},{path:"add-customer",component:zg},{path:"view-customer",component:Wg},{path:"create-invoice",component:qg},{path:"view-invoices",component:Kg},{path:"invoice-preview/:id",component:jd},{path:"invoice-preview",component:jd}];var Yk="@firebase/database",Qk="1.0.20";var JE="";function aK(n){JE=n}var cE=class{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,t){t==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),Rt(t))}get(e){let t=this.domStorage_.getItem(this.prefixedName_(e));return t==null?null:cc(t)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}};var lE=class{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,t){t==null?delete this.cache_[e]:this.cache_[e]=t}get(e){return Zr(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}};var D2=function(n){try{if(typeof window<"u"&&typeof window[n]<"u"){let e=window[n];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new cE(e)}}catch{}return new lE},na=D2("localStorage"),uE=D2("sessionStorage");var Qc=new Zn("@firebase/database"),cK=function(){let n=1;return function(){return n++}}(),M2=function(n){let e=cA(n),t=new zp;t.update(e);let r=t.digest();return lc.encodeByteArray(r)},Jd=function(...n){let e="";for(let t=0;t<n.length;t++){let r=n[t];Array.isArray(r)||r&&typeof r=="object"&&typeof r.length=="number"?e+=Jd.apply(null,r):typeof r=="object"?e+=Rt(r):e+=r,e+=" "}return e},ra=null,Zk=!0,lK=function(n,e){Y(!e||n===!0||n===!1,"Can't turn on custom loggers persistently."),n===!0?(Qc.logLevel=Ee.VERBOSE,ra=Qc.log.bind(Qc),e&&uE.set("logging_enabled",!0)):typeof n=="function"?ra=n:(ra=null,uE.remove("logging_enabled"))},an=function(...n){if(Zk===!0&&(Zk=!1,ra===null&&uE.get("logging_enabled")===!0&&lK(!0)),ra){let e=Jd.apply(null,n);ra(e)}},Xd=function(n){return function(...e){an(n,...e)}},dE=function(...n){let e="FIREBASE INTERNAL ERROR: "+Jd(...n);Qc.error(e)},qi=function(...n){let e=`FIREBASE FATAL ERROR: ${Jd(...n)}`;throw Qc.error(e),new Error(e)},zn=function(...n){let e="FIREBASE WARNING: "+Jd(...n);Qc.warn(e)},uK=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&zn("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},P2=function(n){return typeof n=="number"&&(n!==n||n===Number.POSITIVE_INFINITY||n===Number.NEGATIVE_INFINITY)},dK=function(n){if(Qr()||document.readyState==="complete")n();else{let e=!1,t=function(){if(!document.body){setTimeout(t,Math.floor(10));return}e||(e=!0,n())};document.addEventListener?(document.addEventListener("DOMContentLoaded",t,!1),window.addEventListener("load",t,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&t()}),window.attachEvent("onload",t))}},Jc="[MIN_NAME]",ia="[MAX_NAME]",ol=function(n,e){if(n===e)return 0;if(n===Jc||e===ia)return-1;if(e===Jc||n===ia)return 1;{let t=Jk(n),r=Jk(e);return t!==null?r!==null?t-r===0?n.length-e.length:t-r:-1:r!==null?1:n<e?-1:1}},hK=function(n,e){return n===e?0:n<e?-1:1},Bd=function(n,e){if(e&&n in e)return e[n];throw new Error("Missing required key ("+n+") in object: "+Rt(e))},XE=function(n){if(typeof n!="object"||n===null)return Rt(n);let e=[];for(let r in n)e.push(r);e.sort();let t="{";for(let r=0;r<e.length;r++)r!==0&&(t+=","),t+=Rt(e[r]),t+=":",t+=XE(n[e[r]]);return t+="}",t},A2=function(n,e){let t=n.length;if(t<=e)return[n];let r=[];for(let i=0;i<t;i+=e)i+e>t?r.push(n.substring(i,t)):r.push(n.substring(i,i+e));return r};function or(n,e){for(let t in n)n.hasOwnProperty(t)&&e(t,n[t])}var O2=function(n){Y(!P2(n),"Invalid JSON number");let e=11,t=52,r=(1<<e-1)-1,i,o,s,a,c;n===0?(o=0,s=0,i=1/n===-1/0?1:0):(i=n<0,n=Math.abs(n),n>=Math.pow(2,1-r)?(a=Math.min(Math.floor(Math.log(n)/Math.LN2),r),o=a+r,s=Math.round(n*Math.pow(2,t-a)-Math.pow(2,t))):(o=0,s=Math.round(n/Math.pow(2,1-r-t))));let u=[];for(c=t;c;c-=1)u.push(s%2?1:0),s=Math.floor(s/2);for(c=e;c;c-=1)u.push(o%2?1:0),o=Math.floor(o/2);u.push(i?1:0),u.reverse();let d=u.join(""),f="";for(c=0;c<64;c+=8){let v=parseInt(d.substr(c,8),2).toString(16);v.length===1&&(v="0"+v),f=f+v}return f.toLowerCase()},fK=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},pK=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};var mK=new RegExp("^-?(0*)\\d{1,10}$"),gK=-2147483648,vK=2147483647,Jk=function(n){if(mK.test(n)){let e=Number(n);if(e>=gK&&e<=vK)return e}return null},eh=function(n){try{n()}catch(e){setTimeout(()=>{let t=e.stack||"";throw zn("Exception was thrown by user callback.",t),e},Math.floor(0))}},_K=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},Wd=function(n,e){let t=setTimeout(n,e);return typeof t=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(t):typeof t=="object"&&t.unref&&t.unref(),t};var hE=class{constructor(e,t){this.appCheckProvider=t,this.appName=e.name,vn(e)&&e.settings.appCheckToken&&(this.serverAppAppCheckToken=e.settings.appCheckToken),this.appCheck=t?.getImmediate({optional:!0}),this.appCheck||t?.get().then(r=>this.appCheck=r)}getToken(e){if(this.serverAppAppCheckToken){if(e)throw new Error("Attempted reuse of `FirebaseServerApp.appCheckToken` after previous usage failed.");return Promise.resolve({token:this.serverAppAppCheckToken})}return this.appCheck?this.appCheck.getToken(e):new Promise((t,r)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(t,r):t(null)},0)})}addTokenChangeListener(e){var t;(t=this.appCheckProvider)===null||t===void 0||t.get().then(r=>r.addTokenListener(e))}notifyForInvalidToken(){zn(`Provided AppCheck credentials for the app named "${this.appName}" are invalid. This usually indicates your app was not initialized correctly.`)}};var fE=class{constructor(e,t,r){this.appName_=e,this.firebaseOptions_=t,this.authProvider_=r,this.auth_=null,this.auth_=r.getImmediate({optional:!0}),this.auth_||r.onInit(i=>this.auth_=i)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(t=>t&&t.code==="auth/token-not-initialized"?(an("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(t)):new Promise((t,r)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(t,r):t(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(t=>t.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(t=>t.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',zn(e)}},qd=(()=>{class n{constructor(t){this.accessToken=t}getToken(t){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(t){t(this.accessToken)}removeTokenChangeListener(t){}notifyForInvalidToken(){}}n.OWNER="owner";return n})(),Qg="5",N2="v",R2="s",k2="r",F2="f",L2=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,V2="ls",j2="p",pE="ac",B2="websocket",U2="long_polling";var Zg=class{constructor(e,t,r,i,o=!1,s="",a=!1,c=!1,u=null){this.secure=t,this.namespace=r,this.webSocketOnly=i,this.nodeAdmin=o,this.persistenceKey=s,this.includeNamespaceInQueryParams=a,this.isUsingEmulator=c,this.emulatorOptions=u,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=na.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&na.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){let e=this.secure?"https://":"http://",t=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${t}`}};function yK(n){return n.host!==n.internalHost||n.isCustomHost()||n.includeNamespaceInQueryParams}function $2(n,e,t){Y(typeof e=="string","typeof type must == string"),Y(typeof t=="object","typeof params must == object");let r;if(e===B2)r=(n.secure?"wss://":"ws://")+n.internalHost+"/.ws?";else if(e===U2)r=(n.secure?"https://":"http://")+n.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);yK(n)&&(t.ns=n.namespace);let i=[];return or(t,(o,s)=>{i.push(o+"="+s)}),r+i.join("&")}var mE=class{constructor(){this.counters_={}}incrementCounter(e,t=1){Zr(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t}get(){return QP(this.counters_)}};var tE={},nE={};function ex(n){let e=n.toString();return tE[e]||(tE[e]=new mE),tE[e]}function wK(n,e){let t=n.toString();return nE[t]||(nE[t]=e()),nE[t]}var gE=class{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,t){for(this.pendingResponses[e]=t;this.pendingResponses[this.currentResponseNum];){let r=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let i=0;i<r.length;++i)r[i]&&eh(()=>{this.onMessage_(r[i])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}};var Xk="start",CK="close",bK="pLPCommand",IK="pRTLPCB",z2="id",H2="pw",W2="ser",EK="cb",xK="seg",SK="ts",TK="d",DK="dframe",q2=1870,G2=30,MK=q2-G2,PK=25e3,AK=3e4,vE=class n{constructor(e,t,r,i,o,s,a){this.connId=e,this.repoInfo=t,this.applicationId=r,this.appCheckToken=i,this.authToken=o,this.transportSessionId=s,this.lastSessionId=a,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=Xd(e),this.stats_=ex(t),this.urlFn=c=>(this.appCheckToken&&(c[pE]=this.appCheckToken),$2(t,U2,c))}open(e,t){this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new gE(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(AK)),dK(()=>{if(this.isClosed_)return;this.scriptTagHolder=new _E((...o)=>{let[s,a,c,u,d]=o;if(this.incrementIncomingBytes_(o),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,s===Xk)this.id=a,this.password=c;else if(s===CK)a?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(a,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+s)},(...o)=>{let[s,a]=o;this.incrementIncomingBytes_(o),this.myPacketOrderer.handleResponse(s,a)},()=>{this.onClosed_()},this.urlFn);let r={};r[Xk]="t",r[W2]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(r[EK]=this.scriptTagHolder.uniqueCallbackIdentifier),r[N2]=Qg,this.transportSessionId&&(r[R2]=this.transportSessionId),this.lastSessionId&&(r[V2]=this.lastSessionId),this.applicationId&&(r[j2]=this.applicationId),this.appCheckToken&&(r[pE]=this.appCheckToken),typeof location<"u"&&location.hostname&&L2.test(location.hostname)&&(r[k2]=F2);let i=this.urlFn(r);this.log_("Connecting via long-poll to "+i),this.scriptTagHolder.addTag(i,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){n.forceAllow_=!0}static forceDisallow(){n.forceDisallow_=!0}static isAvailable(){return Qr()?!1:n.forceAllow_?!0:!n.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!fK()&&!pK()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){let t=Rt(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);let r=hw(t),i=A2(r,MK);for(let o=0;o<i.length;o++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,i.length,i[o]),this.curSegmentNum++}addDisconnectPingFrame(e,t){if(Qr())return;this.myDisconnFrame=document.createElement("iframe");let r={};r[DK]="t",r[z2]=e,r[H2]=t,this.myDisconnFrame.src=this.urlFn(r),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){let t=Rt(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)}},_E=class n{constructor(e,t,r,i){if(this.onDisconnect=r,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0,Qr())this.commandCB=e,this.onMessageCB=t;else{this.uniqueCallbackIdentifier=cK(),window[bK+this.uniqueCallbackIdentifier]=e,window[IK+this.uniqueCallbackIdentifier]=t,this.myIFrame=n.createIFrame_();let o="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(o='<script>document.domain="'+document.domain+'";<\/script>');let s="<html><body>"+o+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(s),this.myIFrame.doc.close()}catch(a){an("frame writing exception"),a.stack&&an(a.stack),an(a)}}}static createIFrame_(){let e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||an("No IE domain setting required")}catch{let r=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+r+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));let e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;let e={};e[z2]=this.myID,e[H2]=this.myPW,e[W2]=this.currentSerial;let t=this.urlFn(e),r="",i=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+G2+r.length<=q2;){let s=this.pendingSegs.shift();r=r+"&"+xK+i+"="+s.seg+"&"+SK+i+"="+s.ts+"&"+TK+i+"="+s.d,i++}return t=t+r,this.addLongPollTag_(t,this.currentSerial),!0}else return!1}enqueueSegment(e,t,r){this.pendingSegs.push({seg:e,ts:t,d:r}),this.alive&&this.newRequest_()}addLongPollTag_(e,t){this.outstandingRequests.add(t);let r=()=>{this.outstandingRequests.delete(t),this.newRequest_()},i=setTimeout(r,Math.floor(PK)),o=()=>{clearTimeout(i),r()};this.addTag(e,o)}addTag(e,t){Qr()?this.doNodeLongPoll(e,t):setTimeout(()=>{try{if(!this.sendNewPolls)return;let r=this.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=e,r.onload=r.onreadystatechange=function(){let i=r.readyState;(!i||i==="loaded"||i==="complete")&&(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),t())},r.onerror=()=>{an("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(r)}catch{}},Math.floor(1))}};var OK=16384,NK=45e3,Jg=null;typeof MozWebSocket<"u"?Jg=MozWebSocket:typeof WebSocket<"u"&&(Jg=WebSocket);var Ud=(()=>{class n{constructor(t,r,i,o,s,a,c){this.connId=t,this.applicationId=i,this.appCheckToken=o,this.authToken=s,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=Xd(this.connId),this.stats_=ex(r),this.connURL=n.connectionURL_(r,a,c,o,i),this.nodeAdmin=r.nodeAdmin}static connectionURL_(t,r,i,o,s){let a={};return a[N2]=Qg,!Qr()&&typeof location<"u"&&location.hostname&&L2.test(location.hostname)&&(a[k2]=F2),r&&(a[R2]=r),i&&(a[V2]=i),o&&(a[pE]=o),s&&(a[j2]=s),$2(t,B2,a)}open(t,r){this.onDisconnect=r,this.onMessage=t,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,na.set("previous_websocket_failure",!0);try{let i;if(Qr()){let o=this.nodeAdmin?"AdminNode":"Node";i={headers:{"User-Agent":`Firebase/${Qg}/${JE}/${process.platform}/${o}`,"X-Firebase-GMPID":this.applicationId||""}},this.authToken&&(i.headers.Authorization=`Bearer ${this.authToken}`),this.appCheckToken&&(i.headers["X-Firebase-AppCheck"]=this.appCheckToken);let s=process.env,a=this.connURL.indexOf("wss://")===0?s.HTTPS_PROXY||s.https_proxy:s.HTTP_PROXY||s.http_proxy;a&&(i.proxy={origin:a})}this.mySock=new Jg(this.connURL,[],i)}catch(i){this.log_("Error instantiating WebSocket.");let o=i.message||i.data;o&&this.log_(o),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=i=>{this.handleIncomingFrame(i)},this.mySock.onerror=i=>{this.log_("WebSocket error.  Closing connection.");let o=i.message||i.data;o&&this.log_(o),this.onClosed_()}}start(){}static forceDisallow(){n.forceDisallow_=!0}static isAvailable(){let t=!1;if(typeof navigator<"u"&&navigator.userAgent){let r=/Android ([0-9]{0,}\.[0-9]{0,})/,i=navigator.userAgent.match(r);i&&i.length>1&&parseFloat(i[1])<4.4&&(t=!0)}return!t&&Jg!==null&&!n.forceDisallow_}static previouslyFailed(){return na.isInMemoryStorage||na.get("previous_websocket_failure")===!0}markConnectionHealthy(){na.remove("previous_websocket_failure")}appendFrame_(t){if(this.frames.push(t),this.frames.length===this.totalFrames){let r=this.frames.join("");this.frames=null;let i=cc(r);this.onMessage(i)}}handleNewFrameCount_(t){this.totalFrames=t,this.frames=[]}extractFrameCount_(t){if(Y(this.frames===null,"We already have a frame buffer"),t.length<=6){let r=Number(t);if(!isNaN(r))return this.handleNewFrameCount_(r),null}return this.handleNewFrameCount_(1),t}handleIncomingFrame(t){if(this.mySock===null)return;let r=t.data;if(this.bytesReceived+=r.length,this.stats_.incrementCounter("bytes_received",r.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(r);else{let i=this.extractFrameCount_(r);i!==null&&this.appendFrame_(i)}}send(t){this.resetKeepAlive();let r=Rt(t);this.bytesSent+=r.length,this.stats_.incrementCounter("bytes_sent",r.length);let i=A2(r,OK);i.length>1&&this.sendString_(String(i.length));for(let o=0;o<i.length;o++)this.sendString_(i[o])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(NK))}sendString_(t){try{this.mySock.send(t)}catch(r){this.log_("Exception thrown from WebSocket.send():",r.message||r.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}n.responsesRequiredToBeHealthy=2,n.healthyTimeout=3e4;return n})(),RK=(()=>{class n{static get ALL_TRANSPORTS(){return[vE,Ud]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}constructor(t){this.initTransports_(t)}initTransports_(t){let r=Ud&&Ud.isAvailable(),i=r&&!Ud.previouslyFailed();if(t.webSocketOnly&&(r||zn("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),i=!0),i)this.transports_=[Ud];else{let o=this.transports_=[];for(let s of n.ALL_TRANSPORTS)s&&s.isAvailable()&&o.push(s);n.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}n.globalTransportInitialized_=!1;return n})(),kK=6e4,FK=5e3,LK=10*1024,VK=100*1024,rE="t",e2="d",jK="s",t2="r",BK="e",n2="o",r2="a",i2="n",o2="p",UK="h",yE=class{constructor(e,t,r,i,o,s,a,c,u,d){this.id=e,this.repoInfo_=t,this.applicationId_=r,this.appCheckToken_=i,this.authToken_=o,this.onMessage_=s,this.onReady_=a,this.onDisconnect_=c,this.onKill_=u,this.lastSessionId=d,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=Xd("c:"+this.id+":"),this.transportManager_=new RK(t),this.log_("Connection created"),this.start_()}start_(){let e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;let t=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(t,r)},Math.floor(0));let i=e.healthyTimeout||0;i>0&&(this.healthyTimeout_=Wd(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>VK?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>LK?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(i)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return t=>{e===this.conn_?this.onConnectionLost_(t):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return t=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(t):e===this.secondaryConn_?this.onSecondaryMessageReceived_(t):this.log_("message on old connection"))}}sendRequest(e){let t={t:"d",d:e};this.sendData_(t)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(rE in e){let t=e[rE];t===r2?this.upgradeIfSecondaryHealthy_():t===t2?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):t===n2&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){let t=Bd("t",e),r=Bd("d",e);if(t==="c")this.onSecondaryControl_(r);else if(t==="d")this.pendingDataMessages.push(r);else throw new Error("Unknown protocol layer: "+t)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:o2,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:r2,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:i2,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){let t=Bd("t",e),r=Bd("d",e);t==="c"?this.onControl_(r):t==="d"&&this.onDataMessage_(r)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){let t=Bd(rE,e);if(e2 in e){let r=e[e2];if(t===UK){let i=Object.assign({},r);this.repoInfo_.isUsingEmulator&&(i.h=this.repoInfo_.host),this.onHandshake_(i)}else if(t===i2){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let i=0;i<this.pendingDataMessages.length;++i)this.onDataMessage_(this.pendingDataMessages[i]);this.pendingDataMessages=[],this.tryCleanupConnection()}else t===jK?this.onConnectionShutdown_(r):t===t2?this.onReset_(r):t===BK?dE("Server Error: "+r):t===n2?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):dE("Unknown control packet command: "+t)}}onHandshake_(e){let t=e.ts,r=e.v,i=e.h;this.sessionId=e.s,this.repoInfo_.host=i,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),Qg!==r&&zn("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){let e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;let t=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(t,r),Wd(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(kK))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,t){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):Wd(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(FK))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:o2,d:{}}}))}onSecondaryConnectionLost_(){let e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(na.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}};var Xg=class{put(e,t,r,i){}merge(e,t,r,i){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,t,r){}onDisconnectMerge(e,t,r){}onDisconnectCancel(e,t){}reportStats(e){}};var ev=class{constructor(e){this.allowedEvents_=e,this.listeners_={},Y(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...t){if(Array.isArray(this.listeners_[e])){let r=[...this.listeners_[e]];for(let i=0;i<r.length;i++)r[i].callback.apply(r[i].context,t)}}on(e,t,r){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:r});let i=this.getInitialEvent(e);i&&t.apply(r,i)}off(e,t,r){this.validateEventType_(e);let i=this.listeners_[e]||[];for(let o=0;o<i.length;o++)if(i[o].callback===t&&(!r||r===i[o].context)){i.splice(o,1);return}}validateEventType_(e){Y(this.allowedEvents_.find(t=>t===e),"Unknown event: "+e)}};var tv=class n extends ev{static getInstance(){return new n}constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!Lu()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}getInitialEvent(e){return Y(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}};var s2=32,a2=768,Xe=class{constructor(e,t){if(t===void 0){this.pieces_=e.split("/");let r=0;for(let i=0;i<this.pieces_.length;i++)this.pieces_[i].length>0&&(this.pieces_[r]=this.pieces_[i],r++);this.pieces_.length=r,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=t}toString(){let e="";for(let t=this.pieceNum_;t<this.pieces_.length;t++)this.pieces_[t]!==""&&(e+="/"+this.pieces_[t]);return e||"/"}};function Ge(){return new Xe("")}function Re(n){return n.pieceNum_>=n.pieces_.length?null:n.pieces_[n.pieceNum_]}function Ho(n){return n.pieces_.length-n.pieceNum_}function ot(n){let e=n.pieceNum_;return e<n.pieces_.length&&e++,new Xe(n.pieces_,e)}function K2(n){return n.pieceNum_<n.pieces_.length?n.pieces_[n.pieces_.length-1]:null}function $K(n){let e="";for(let t=n.pieceNum_;t<n.pieces_.length;t++)n.pieces_[t]!==""&&(e+="/"+encodeURIComponent(String(n.pieces_[t])));return e||"/"}function Y2(n,e=0){return n.pieces_.slice(n.pieceNum_+e)}function Q2(n){if(n.pieceNum_>=n.pieces_.length)return null;let e=[];for(let t=n.pieceNum_;t<n.pieces_.length-1;t++)e.push(n.pieces_[t]);return new Xe(e,0)}function Vt(n,e){let t=[];for(let r=n.pieceNum_;r<n.pieces_.length;r++)t.push(n.pieces_[r]);if(e instanceof Xe)for(let r=e.pieceNum_;r<e.pieces_.length;r++)t.push(e.pieces_[r]);else{let r=e.split("/");for(let i=0;i<r.length;i++)r[i].length>0&&t.push(r[i])}return new Xe(t,0)}function Ae(n){return n.pieceNum_>=n.pieces_.length}function rr(n,e){let t=Re(n),r=Re(e);if(t===null)return e;if(t===r)return rr(ot(n),ot(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+n+")")}function Z2(n,e){if(Ho(n)!==Ho(e))return!1;for(let t=n.pieceNum_,r=e.pieceNum_;t<=n.pieces_.length;t++,r++)if(n.pieces_[t]!==e.pieces_[r])return!1;return!0}function Mr(n,e){let t=n.pieceNum_,r=e.pieceNum_;if(Ho(n)>Ho(e))return!1;for(;t<n.pieces_.length;){if(n.pieces_[t]!==e.pieces_[r])return!1;++t,++r}return!0}var wE=class{constructor(e,t){this.errorPrefix_=t,this.parts_=Y2(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let r=0;r<this.parts_.length;r++)this.byteLength_+=Uu(this.parts_[r]);J2(this)}};function zK(n,e){n.parts_.length>0&&(n.byteLength_+=1),n.parts_.push(e),n.byteLength_+=Uu(e),J2(n)}function HK(n){let e=n.parts_.pop();n.byteLength_-=Uu(e),n.parts_.length>0&&(n.byteLength_-=1)}function J2(n){if(n.byteLength_>a2)throw new Error(n.errorPrefix_+"has a key path longer than "+a2+" bytes ("+n.byteLength_+").");if(n.parts_.length>s2)throw new Error(n.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+s2+") or object contains a cycle "+ta(n))}function ta(n){return n.parts_.length===0?"":"in property '"+n.parts_.join(".")+"'"}var CE=class n extends ev{static getInstance(){return new n}constructor(){super(["visible"]);let e,t;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(t="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(t="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(t="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(t="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,t&&document.addEventListener(t,()=>{let r=!document[e];r!==this.visible_&&(this.visible_=r,this.trigger("visible",r))},!1)}getInitialEvent(e){return Y(e==="visible","Unknown event type: "+e),[this.visible_]}};var $d=1e3,WK=60*5*1e3,c2=30*1e3,qK=1.3,GK=3e4,KK="server_kill",l2=3,tx=(()=>{class n extends Xg{constructor(t,r,i,o,s,a,c,u){if(super(),this.repoInfo_=t,this.applicationId_=r,this.onDataUpdate_=i,this.onConnectStatus_=o,this.onServerInfoUpdate_=s,this.authTokenProvider_=a,this.appCheckTokenProvider_=c,this.authOverride_=u,this.id=n.nextPersistentConnectionId_++,this.log_=Xd("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=$d,this.maxReconnectDelay_=WK,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,u&&!Qr())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");CE.getInstance().on("visible",this.onVisible_,this),t.host.indexOf("fblocal")===-1&&tv.getInstance().on("online",this.onOnline_,this)}sendRequest(t,r,i){let o=++this.requestNumber_,s={r:o,a:t,b:r};this.log_(Rt(s)),Y(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(s),i&&(this.requestCBHash_[o]=i)}get(t){this.initConnection_();let r=new Yr,o={action:"g",request:{p:t._path.toString(),q:t._queryObject},onComplete:a=>{let c=a.d;a.s==="ok"?r.resolve(c):r.reject(c)}};this.outstandingGets_.push(o),this.outstandingGetCount_++;let s=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(s),r.promise}listen(t,r,i,o){this.initConnection_();let s=t._queryIdentifier,a=t._path.toString();this.log_("Listen called for "+a+" "+s),this.listens.has(a)||this.listens.set(a,new Map),Y(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"listen() called for non-default but complete query"),Y(!this.listens.get(a).has(s),"listen() called twice for same path/queryId.");let c={onComplete:o,hashFn:r,query:t,tag:i};this.listens.get(a).set(s,c),this.connected_&&this.sendListen_(c)}sendGet_(t){let r=this.outstandingGets_[t];this.sendRequest("g",r.request,i=>{delete this.outstandingGets_[t],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),r.onComplete&&r.onComplete(i)})}sendListen_(t){let r=t.query,i=r._path.toString(),o=r._queryIdentifier;this.log_("Listen on "+i+" for "+o);let s={p:i},a="q";t.tag&&(s.q=r._queryObject,s.t=t.tag),s.h=t.hashFn(),this.sendRequest(a,s,c=>{let u=c.d,d=c.s;n.warnOnListenWarnings_(u,r),(this.listens.get(i)&&this.listens.get(i).get(o))===t&&(this.log_("listen response",c),d!=="ok"&&this.removeListen_(i,o),t.onComplete&&t.onComplete(d,u))})}static warnOnListenWarnings_(t,r){if(t&&typeof t=="object"&&Zr(t,"w")){let i=Ds(t,"w");if(Array.isArray(i)&&~i.indexOf("no_index")){let o='".indexOn": "'+r._queryParams.getIndex().toString()+'"',s=r._path.toString();zn(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${o} at ${s} to your security rules for better performance.`)}}}refreshAuthToken(t){this.authToken_=t,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(t)}reduceReconnectDelayIfAdminCredential_(t){(t&&t.length===40||oA(t))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=c2)}refreshAppCheckToken(t){this.appCheckToken_=t,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){let t=this.authToken_,r=iA(t)?"auth":"gauth",i={cred:t};this.authOverride_===null?i.noauth=!0:typeof this.authOverride_=="object"&&(i.authvar=this.authOverride_),this.sendRequest(r,i,o=>{let s=o.s,a=o.d||"error";this.authToken_===t&&(s==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(s,a))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},t=>{let r=t.s,i=t.d||"error";r==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(r,i)})}unlisten(t,r){let i=t._path.toString(),o=t._queryIdentifier;this.log_("Unlisten called for "+i+" "+o),Y(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(i,o)&&this.connected_&&this.sendUnlisten_(i,o,t._queryObject,r)}sendUnlisten_(t,r,i,o){this.log_("Unlisten on "+t+" for "+r);let s={p:t},a="n";o&&(s.q=i,s.t=o),this.sendRequest(a,s)}onDisconnectPut(t,r,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",t,r,i):this.onDisconnectRequestQueue_.push({pathString:t,action:"o",data:r,onComplete:i})}onDisconnectMerge(t,r,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",t,r,i):this.onDisconnectRequestQueue_.push({pathString:t,action:"om",data:r,onComplete:i})}onDisconnectCancel(t,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",t,null,r):this.onDisconnectRequestQueue_.push({pathString:t,action:"oc",data:null,onComplete:r})}sendOnDisconnect_(t,r,i,o){let s={p:r,d:i};this.log_("onDisconnect "+t,s),this.sendRequest(t,s,a=>{o&&setTimeout(()=>{o(a.s,a.d)},Math.floor(0))})}put(t,r,i,o){this.putInternal("p",t,r,i,o)}merge(t,r,i,o){this.putInternal("m",t,r,i,o)}putInternal(t,r,i,o,s){this.initConnection_();let a={p:r,d:i};s!==void 0&&(a.h=s),this.outstandingPuts_.push({action:t,request:a,onComplete:o}),this.outstandingPutCount_++;let c=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(c):this.log_("Buffering put: "+r)}sendPut_(t){let r=this.outstandingPuts_[t].action,i=this.outstandingPuts_[t].request,o=this.outstandingPuts_[t].onComplete;this.outstandingPuts_[t].queued=this.connected_,this.sendRequest(r,i,s=>{this.log_(r+" response",s),delete this.outstandingPuts_[t],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),o&&o(s.s,s.d)})}reportStats(t){if(this.connected_){let r={c:t};this.log_("reportStats",r),this.sendRequest("s",r,i=>{if(i.s!=="ok"){let s=i.d;this.log_("reportStats","Error sending stats: "+s)}})}}onDataMessage_(t){if("r"in t){this.log_("from server: "+Rt(t));let r=t.r,i=this.requestCBHash_[r];i&&(delete this.requestCBHash_[r],i(t.b))}else{if("error"in t)throw"A server-side error has occurred: "+t.error;"a"in t&&this.onDataPush_(t.a,t.b)}}onDataPush_(t,r){this.log_("handleServerMessage",t,r),t==="d"?this.onDataUpdate_(r.p,r.d,!1,r.t):t==="m"?this.onDataUpdate_(r.p,r.d,!0,r.t):t==="c"?this.onListenRevoked_(r.p,r.q):t==="ac"?this.onAuthRevoked_(r.s,r.d):t==="apc"?this.onAppCheckRevoked_(r.s,r.d):t==="sd"?this.onSecurityDebugPacket_(r):dE("Unrecognized action received from server: "+Rt(t)+`
Are you using the latest client?`)}onReady_(t,r){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(t),this.lastSessionId=r,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(t){Y(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(t))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(t){t&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=$d,this.realtime_||this.scheduleConnect_(0)),this.visible_=t}onOnline_(t){t?(this.log_("Browser went online."),this.reconnectDelay_=$d,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>GK&&(this.reconnectDelay_=$d),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());let t=Math.max(0,new Date().getTime()-this.lastConnectionAttemptTime_),r=Math.max(0,this.reconnectDelay_-t);r=Math.random()*r,this.log_("Trying to reconnect in "+r+"ms"),this.scheduleConnect_(r),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*qK)}this.onConnectStatus_(!1)}establishConnection_(){return w(this,null,function*(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;let t=this.onDataMessage_.bind(this),r=this.onReady_.bind(this),i=this.onRealtimeDisconnect_.bind(this),o=this.id+":"+n.nextConnectionId_++,s=this.lastSessionId,a=!1,c=null,u=function(){c?c.close():(a=!0,i())},d=function(v){Y(c,"sendRequest call when we're not connected not allowed."),c.sendRequest(v)};this.realtime_={close:u,sendRequest:d};let f=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{let[v,_]=yield Promise.all([this.authTokenProvider_.getToken(f),this.appCheckTokenProvider_.getToken(f)]);a?an("getToken() completed but was canceled"):(an("getToken() completed. Creating connection."),this.authToken_=v&&v.accessToken,this.appCheckToken_=_&&_.token,c=new yE(o,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,t,r,i,b=>{zn(b+" ("+this.repoInfo_.toString()+")"),this.interrupt(KK)},s))}catch(v){this.log_("Failed to get token: "+v),a||(this.repoInfo_.nodeAdmin&&zn(v),u())}}})}interrupt(t){an("Interrupting connection for reason: "+t),this.interruptReasons_[t]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(t){an("Resuming connection for reason: "+t),delete this.interruptReasons_[t],ju(this.interruptReasons_)&&(this.reconnectDelay_=$d,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(t){let r=t-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:r})}cancelSentTransactions_(){for(let t=0;t<this.outstandingPuts_.length;t++){let r=this.outstandingPuts_[t];r&&"h"in r.request&&r.queued&&(r.onComplete&&r.onComplete("disconnect"),delete this.outstandingPuts_[t],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(t,r){let i;r?i=r.map(s=>XE(s)).join("$"):i="default";let o=this.removeListen_(t,i);o&&o.onComplete&&o.onComplete("permission_denied")}removeListen_(t,r){let i=new Xe(t).toString(),o;if(this.listens.has(i)){let s=this.listens.get(i);o=s.get(r),s.delete(r),s.size===0&&this.listens.delete(i)}else o=void 0;return o}onAuthRevoked_(t,r){an("Auth token revoked: "+t+"/"+r),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(t==="invalid_token"||t==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=l2&&(this.reconnectDelay_=c2,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(t,r){an("App check token revoked: "+t+"/"+r),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(t==="invalid_token"||t==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=l2&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(t){this.securityDebugCallback_?this.securityDebugCallback_(t):"msg"in t&&console.log("FIREBASE: "+t.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(let t of this.listens.values())for(let r of t.values())this.sendListen_(r);for(let t=0;t<this.outstandingPuts_.length;t++)this.outstandingPuts_[t]&&this.sendPut_(t);for(;this.onDisconnectRequestQueue_.length;){let t=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(t.action,t.pathString,t.data,t.onComplete)}for(let t=0;t<this.outstandingGets_.length;t++)this.outstandingGets_[t]&&this.sendGet_(t)}sendConnectStats_(){let t={},r="js";Qr()&&(this.repoInfo_.nodeAdmin?r="admin_node":r="node"),t["sdk."+r+"."+JE.replace(/\./g,"-")]=1,Lu()?t["framework.cordova"]=1:Gp()&&(t["framework.reactnative"]=1),this.reportStats(t)}shouldReconnect_(){let t=tv.getInstance().currentlyOnline();return ju(this.interruptReasons_)&&t}}n.nextPersistentConnectionId_=0,n.nextConnectionId_=0;return n})(),ke=class n{constructor(e,t){this.name=e,this.node=t}static Wrap(e,t){return new n(e,t)}};var Xc=class{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,t){let r=new ke(Jc,e),i=new ke(Jc,t);return this.compare(r,i)!==0}minPost(){return ke.MIN}};var Yg,nv=class extends Xc{static get __EMPTY_NODE(){return Yg}static set __EMPTY_NODE(e){Yg=e}compare(e,t){return ol(e.name,t.name)}isDefinedOn(e){throw Ts("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,t){return!1}minPost(){return ke.MIN}maxPost(){return new ke(ia,Yg)}makePost(e,t){return Y(typeof e=="string","KeyIndex indexValue must always be a string."),new ke(e,Yg)}toString(){return".key"}},Zc=new nv;var Kc=class{constructor(e,t,r,i,o=null){this.isReverse_=i,this.resultGenerator_=o,this.nodeStack_=[];let s=1;for(;!e.isEmpty();)if(e=e,s=t?r(e.key,t):1,i&&(s*=-1),s<0)this.isReverse_?e=e.left:e=e.right;else if(s===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),t;if(this.resultGenerator_?t=this.resultGenerator_(e.key,e.value):t={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return t}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}},Dr=(()=>{class n{constructor(t,r,i,o,s){this.key=t,this.value=r,this.color=i??n.RED,this.left=o??ir.EMPTY_NODE,this.right=s??ir.EMPTY_NODE}copy(t,r,i,o,s){return new n(t??this.key,r??this.value,i??this.color,o??this.left,s??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||!!t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,r,i){let o=this,s=i(t,o.key);return s<0?o=o.copy(null,null,null,o.left.insert(t,r,i),null):s===0?o=o.copy(null,r,null,null,null):o=o.copy(null,null,null,null,o.right.insert(t,r,i)),o.fixUp_()}removeMin_(){if(this.left.isEmpty())return ir.EMPTY_NODE;let t=this;return!t.left.isRed_()&&!t.left.left.isRed_()&&(t=t.moveRedLeft_()),t=t.copy(null,null,null,t.left.removeMin_(),null),t.fixUp_()}remove(t,r){let i,o;if(i=this,r(t,i.key)<0)!i.left.isEmpty()&&!i.left.isRed_()&&!i.left.left.isRed_()&&(i=i.moveRedLeft_()),i=i.copy(null,null,null,i.left.remove(t,r),null);else{if(i.left.isRed_()&&(i=i.rotateRight_()),!i.right.isEmpty()&&!i.right.isRed_()&&!i.right.left.isRed_()&&(i=i.moveRedRight_()),r(t,i.key)===0){if(i.right.isEmpty())return ir.EMPTY_NODE;o=i.right.min_(),i=i.copy(o.key,o.value,null,null,i.right.removeMin_())}i=i.copy(null,null,null,null,i.right.remove(t,r))}return i.fixUp_()}isRed_(){return this.color}fixUp_(){let t=this;return t.right.isRed_()&&!t.left.isRed_()&&(t=t.rotateLeft_()),t.left.isRed_()&&t.left.left.isRed_()&&(t=t.rotateRight_()),t.left.isRed_()&&t.right.isRed_()&&(t=t.colorFlip_()),t}moveRedLeft_(){let t=this.colorFlip_();return t.right.left.isRed_()&&(t=t.copy(null,null,null,null,t.right.rotateRight_()),t=t.rotateLeft_(),t=t.colorFlip_()),t}moveRedRight_(){let t=this.colorFlip_();return t.left.left.isRed_()&&(t=t.rotateRight_(),t=t.colorFlip_()),t}rotateLeft_(){let t=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight_(){let t=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip_(){let t=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,r)}checkMaxDepth_(){let t=this.check_();return Math.pow(2,t)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");let t=this.left.check_();if(t!==this.right.check_())throw new Error("Black depths differ");return t+(this.isRed_()?0:1)}}return n.RED=!0,n.BLACK=!1,n})(),bE=class{copy(e,t,r,i,o){return this}insert(e,t,r){return new Dr(e,t,null)}remove(e,t){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}},ir=class n{constructor(e,t=n.EMPTY_NODE){this.comparator_=e,this.root_=t}insert(e,t){return new n(this.comparator_,this.root_.insert(e,t,this.comparator_).copy(null,null,Dr.BLACK,null,null))}remove(e){return new n(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,Dr.BLACK,null,null))}get(e){let t,r=this.root_;for(;!r.isEmpty();){if(t=this.comparator_(e,r.key),t===0)return r.value;t<0?r=r.left:t>0&&(r=r.right)}return null}getPredecessorKey(e){let t,r=this.root_,i=null;for(;!r.isEmpty();)if(t=this.comparator_(e,r.key),t===0){if(r.left.isEmpty())return i?i.key:null;for(r=r.left;!r.right.isEmpty();)r=r.right;return r.key}else t<0?r=r.left:t>0&&(i=r,r=r.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new Kc(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,t){return new Kc(this.root_,e,this.comparator_,!1,t)}getReverseIteratorFrom(e,t){return new Kc(this.root_,e,this.comparator_,!0,t)}getReverseIterator(e){return new Kc(this.root_,null,this.comparator_,!0,e)}};ir.EMPTY_NODE=new bE;function YK(n,e){return ol(n.name,e.name)}function nx(n,e){return ol(n,e)}var IE;function QK(n){IE=n}var X2=function(n){return typeof n=="number"?"number:"+O2(n):"string:"+n},eF=function(n){if(n.isLeafNode()){let e=n.val();Y(typeof e=="string"||typeof e=="number"||typeof e=="object"&&Zr(e,".sv"),"Priority must be a string or number.")}else Y(n===IE||n.isEmpty(),"priority of unexpected type.");Y(n===IE||n.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};var u2,el=(()=>{class n{static set __childrenNodeConstructor(t){u2=t}static get __childrenNodeConstructor(){return u2}constructor(t,r=n.__childrenNodeConstructor.EMPTY_NODE){this.value_=t,this.priorityNode_=r,this.lazyHash_=null,Y(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),eF(this.priorityNode_)}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(t){return new n(this.value_,t)}getImmediateChild(t){return t===".priority"?this.priorityNode_:n.__childrenNodeConstructor.EMPTY_NODE}getChild(t){return Ae(t)?this:Re(t)===".priority"?this.priorityNode_:n.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(t,r){return null}updateImmediateChild(t,r){return t===".priority"?this.updatePriority(r):r.isEmpty()&&t!==".priority"?this:n.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(t,r).updatePriority(this.priorityNode_)}updateChild(t,r){let i=Re(t);return i===null?r:r.isEmpty()&&i!==".priority"?this:(Y(i!==".priority"||Ho(t)===1,".priority must be the last token in a path"),this.updateImmediateChild(i,n.__childrenNodeConstructor.EMPTY_NODE.updateChild(ot(t),r)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(t,r){return!1}val(t){return t&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let t="";this.priorityNode_.isEmpty()||(t+="priority:"+X2(this.priorityNode_.val())+":");let r=typeof this.value_;t+=r+":",r==="number"?t+=O2(this.value_):t+=this.value_,this.lazyHash_=M2(t)}return this.lazyHash_}getValue(){return this.value_}compareTo(t){return t===n.__childrenNodeConstructor.EMPTY_NODE?1:t instanceof n.__childrenNodeConstructor?-1:(Y(t.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(t))}compareToLeafNode_(t){let r=typeof t.value_,i=typeof this.value_,o=n.VALUE_TYPE_ORDER.indexOf(r),s=n.VALUE_TYPE_ORDER.indexOf(i);return Y(o>=0,"Unknown leaf type: "+r),Y(s>=0,"Unknown leaf type: "+i),o===s?i==="object"?0:this.value_<t.value_?-1:this.value_===t.value_?0:1:s-o}withIndex(){return this}isIndexed(){return!0}equals(t){if(t===this)return!0;if(t.isLeafNode()){let r=t;return this.value_===r.value_&&this.priorityNode_.equals(r.priorityNode_)}else return!1}}n.VALUE_TYPE_ORDER=["object","boolean","number","string"];return n})(),tF,nF;function ZK(n){tF=n}function JK(n){nF=n}var EE=class extends Xc{compare(e,t){let r=e.node.getPriority(),i=t.node.getPriority(),o=r.compareTo(i);return o===0?ol(e.name,t.name):o}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,t){return!e.getPriority().equals(t.getPriority())}minPost(){return ke.MIN}maxPost(){return new ke(ia,new el("[PRIORITY-POST]",nF))}makePost(e,t){let r=tF(e);return new ke(t,new el("[PRIORITY-POST]",r))}toString(){return".priority"}},ln=new EE;var XK=Math.log(2),xE=class{constructor(e){let t=o=>parseInt(Math.log(o)/XK,10),r=o=>parseInt(Array(o+1).join("1"),2);this.count=t(e+1),this.current_=this.count-1;let i=r(this.count);this.bits_=e+1&i}nextBitIsOne(){let e=!(this.bits_&1<<this.current_);return this.current_--,e}},rv=function(n,e,t,r){n.sort(e);let i=function(c,u){let d=u-c,f,v;if(d===0)return null;if(d===1)return f=n[c],v=t?t(f):f,new Dr(v,f.node,Dr.BLACK,null,null);{let _=parseInt(d/2,10)+c,b=i(c,_),N=i(_+1,u);return f=n[_],v=t?t(f):f,new Dr(v,f.node,Dr.BLACK,b,N)}},o=function(c){let u=null,d=null,f=n.length,v=function(b,N){let R=f-b,G=f;f-=b;let oe=i(R+1,G),ce=n[R],Fe=t?t(ce):ce;_(new Dr(Fe,ce.node,N,null,oe))},_=function(b){u?(u.left=b,u=b):(d=b,u=b)};for(let b=0;b<c.count;++b){let N=c.nextBitIsOne(),R=Math.pow(2,c.count-(b+1));N?v(R,Dr.BLACK):(v(R,Dr.BLACK),v(R,Dr.RED))}return d},s=new xE(n.length),a=o(s);return new ir(r||e,a)};var iE,Gc={},tl=class n{static get Default(){return Y(Gc&&ln,"ChildrenNode.ts has not been loaded"),iE=iE||new n({".priority":Gc},{".priority":ln}),iE}constructor(e,t){this.indexes_=e,this.indexSet_=t}get(e){let t=Ds(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof ir?t:null}hasIndex(e){return Zr(this.indexSet_,e.toString())}addIndex(e,t){Y(e!==Zc,"KeyIndex always exists and isn't meant to be added to the IndexMap.");let r=[],i=!1,o=t.getIterator(ke.Wrap),s=o.getNext();for(;s;)i=i||e.isDefinedOn(s.node),r.push(s),s=o.getNext();let a;i?a=rv(r,e.getCompare()):a=Gc;let c=e.toString(),u=Object.assign({},this.indexSet_);u[c]=e;let d=Object.assign({},this.indexes_);return d[c]=a,new n(d,u)}addToIndexes(e,t){let r=Bu(this.indexes_,(i,o)=>{let s=Ds(this.indexSet_,o);if(Y(s,"Missing index implementation for "+o),i===Gc)if(s.isDefinedOn(e.node)){let a=[],c=t.getIterator(ke.Wrap),u=c.getNext();for(;u;)u.name!==e.name&&a.push(u),u=c.getNext();return a.push(e),rv(a,s.getCompare())}else return Gc;else{let a=t.get(e.name),c=i;return a&&(c=c.remove(new ke(e.name,a))),c.insert(e,e.node)}});return new n(r,this.indexSet_)}removeFromIndexes(e,t){let r=Bu(this.indexes_,i=>{if(i===Gc)return i;{let o=t.get(e.name);return o?i.remove(new ke(e.name,o)):i}});return new n(r,this.indexSet_)}};var zd,ut=(()=>{class n{static get EMPTY_NODE(){return zd||(zd=new n(new ir(nx),null,tl.Default))}constructor(t,r,i){this.children_=t,this.priorityNode_=r,this.indexMap_=i,this.lazyHash_=null,this.priorityNode_&&eF(this.priorityNode_),this.children_.isEmpty()&&Y(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}isLeafNode(){return!1}getPriority(){return this.priorityNode_||zd}updatePriority(t){return this.children_.isEmpty()?this:new n(this.children_,t,this.indexMap_)}getImmediateChild(t){if(t===".priority")return this.getPriority();{let r=this.children_.get(t);return r===null?zd:r}}getChild(t){let r=Re(t);return r===null?this:this.getImmediateChild(r).getChild(ot(t))}hasChild(t){return this.children_.get(t)!==null}updateImmediateChild(t,r){if(Y(r,"We should always be passing snapshot nodes"),t===".priority")return this.updatePriority(r);{let i=new ke(t,r),o,s;r.isEmpty()?(o=this.children_.remove(t),s=this.indexMap_.removeFromIndexes(i,this.children_)):(o=this.children_.insert(t,r),s=this.indexMap_.addToIndexes(i,this.children_));let a=o.isEmpty()?zd:this.priorityNode_;return new n(o,a,s)}}updateChild(t,r){let i=Re(t);if(i===null)return r;{Y(Re(t)!==".priority"||Ho(t)===1,".priority must be the last token in a path");let o=this.getImmediateChild(i).updateChild(ot(t),r);return this.updateImmediateChild(i,o)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(t){if(this.isEmpty())return null;let r={},i=0,o=0,s=!0;if(this.forEachChild(ln,(a,c)=>{r[a]=c.val(t),i++,s&&n.INTEGER_REGEXP_.test(a)?o=Math.max(o,Number(a)):s=!1}),!t&&s&&o<2*i){let a=[];for(let c in r)a[c]=r[c];return a}else return t&&!this.getPriority().isEmpty()&&(r[".priority"]=this.getPriority().val()),r}hash(){if(this.lazyHash_===null){let t="";this.getPriority().isEmpty()||(t+="priority:"+X2(this.getPriority().val())+":"),this.forEachChild(ln,(r,i)=>{let o=i.hash();o!==""&&(t+=":"+r+":"+o)}),this.lazyHash_=t===""?"":M2(t)}return this.lazyHash_}getPredecessorChildName(t,r,i){let o=this.resolveIndex_(i);if(o){let s=o.getPredecessorKey(new ke(t,r));return s?s.name:null}else return this.children_.getPredecessorKey(t)}getFirstChildName(t){let r=this.resolveIndex_(t);if(r){let i=r.minKey();return i&&i.name}else return this.children_.minKey()}getFirstChild(t){let r=this.getFirstChildName(t);return r?new ke(r,this.children_.get(r)):null}getLastChildName(t){let r=this.resolveIndex_(t);if(r){let i=r.maxKey();return i&&i.name}else return this.children_.maxKey()}getLastChild(t){let r=this.getLastChildName(t);return r?new ke(r,this.children_.get(r)):null}forEachChild(t,r){let i=this.resolveIndex_(t);return i?i.inorderTraversal(o=>r(o.name,o.node)):this.children_.inorderTraversal(r)}getIterator(t){return this.getIteratorFrom(t.minPost(),t)}getIteratorFrom(t,r){let i=this.resolveIndex_(r);if(i)return i.getIteratorFrom(t,o=>o);{let o=this.children_.getIteratorFrom(t.name,ke.Wrap),s=o.peek();for(;s!=null&&r.compare(s,t)<0;)o.getNext(),s=o.peek();return o}}getReverseIterator(t){return this.getReverseIteratorFrom(t.maxPost(),t)}getReverseIteratorFrom(t,r){let i=this.resolveIndex_(r);if(i)return i.getReverseIteratorFrom(t,o=>o);{let o=this.children_.getReverseIteratorFrom(t.name,ke.Wrap),s=o.peek();for(;s!=null&&r.compare(s,t)>0;)o.getNext(),s=o.peek();return o}}compareTo(t){return this.isEmpty()?t.isEmpty()?0:-1:t.isLeafNode()||t.isEmpty()?1:t===th?-1:0}withIndex(t){if(t===Zc||this.indexMap_.hasIndex(t))return this;{let r=this.indexMap_.addIndex(t,this.children_);return new n(this.children_,this.priorityNode_,r)}}isIndexed(t){return t===Zc||this.indexMap_.hasIndex(t)}equals(t){if(t===this)return!0;if(t.isLeafNode())return!1;{let r=t;if(this.getPriority().equals(r.getPriority()))if(this.children_.count()===r.children_.count()){let i=this.getIterator(ln),o=r.getIterator(ln),s=i.getNext(),a=o.getNext();for(;s&&a;){if(s.name!==a.name||!s.node.equals(a.node))return!1;s=i.getNext(),a=o.getNext()}return s===null&&a===null}else return!1;else return!1}}resolveIndex_(t){return t===Zc?null:this.indexMap_.get(t.toString())}}return n.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,n})(),SE=class extends ut{constructor(){super(new ir(nx),ut.EMPTY_NODE,tl.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return ut.EMPTY_NODE}isEmpty(){return!1}},th=new SE;Object.defineProperties(ke,{MIN:{value:new ke(Jc,ut.EMPTY_NODE)},MAX:{value:new ke(ia,th)}});nv.__EMPTY_NODE=ut.EMPTY_NODE;el.__childrenNodeConstructor=ut;QK(th);JK(th);var eY=!0;function cn(n,e=null){if(n===null)return ut.EMPTY_NODE;if(typeof n=="object"&&".priority"in n&&(e=n[".priority"]),Y(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof n=="object"&&".value"in n&&n[".value"]!==null&&(n=n[".value"]),typeof n!="object"||".sv"in n){let t=n;return new el(t,cn(e))}if(!(n instanceof Array)&&eY){let t=[],r=!1;if(or(n,(s,a)=>{if(s.substring(0,1)!=="."){let c=cn(a);c.isEmpty()||(r=r||!c.getPriority().isEmpty(),t.push(new ke(s,c)))}}),t.length===0)return ut.EMPTY_NODE;let o=rv(t,YK,s=>s.name,nx);if(r){let s=rv(t,ln.getCompare());return new ut(o,cn(e),new tl({".priority":s},{".priority":ln}))}else return new ut(o,cn(e),tl.Default)}else{let t=ut.EMPTY_NODE;return or(n,(r,i)=>{if(Zr(n,r)&&r.substring(0,1)!=="."){let o=cn(i);(o.isLeafNode()||!o.isEmpty())&&(t=t.updateImmediateChild(r,o))}}),t.updatePriority(cn(e))}}ZK(cn);var TE=class extends Xc{constructor(e){super(),this.indexPath_=e,Y(!Ae(e)&&Re(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,t){let r=this.extractChild(e.node),i=this.extractChild(t.node),o=r.compareTo(i);return o===0?ol(e.name,t.name):o}makePost(e,t){let r=cn(e),i=ut.EMPTY_NODE.updateChild(this.indexPath_,r);return new ke(t,i)}maxPost(){let e=ut.EMPTY_NODE.updateChild(this.indexPath_,th);return new ke(ia,e)}toString(){return Y2(this.indexPath_,0).join("/")}};var DE=class extends Xc{compare(e,t){let r=e.node.compareTo(t.node);return r===0?ol(e.name,t.name):r}isDefinedOn(e){return!0}indexedValueChanged(e,t){return!e.equals(t)}minPost(){return ke.MIN}maxPost(){return ke.MAX}makePost(e,t){let r=cn(e);return new ke(t,r)}toString(){return".value"}},tY=new DE;function nY(n){return{type:"value",snapshotNode:n}}function rY(n,e){return{type:"child_added",snapshotNode:e,childName:n}}function iY(n,e){return{type:"child_removed",snapshotNode:e,childName:n}}function d2(n,e,t){return{type:"child_changed",snapshotNode:e,childName:n,oldSnap:t}}function oY(n,e){return{type:"child_moved",snapshotNode:e,childName:n}}var ME=class n{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=ln}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return Y(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return Y(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:Jc}hasEnd(){return this.endSet_}getIndexEndValue(){return Y(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return Y(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:ia}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return Y(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===ln}copy(){let e=new n;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}};function h2(n){let e={};if(n.isDefault())return e;let t;if(n.index_===ln?t="$priority":n.index_===tY?t="$value":n.index_===Zc?t="$key":(Y(n.index_ instanceof TE,"Unrecognized index type!"),t=n.index_.toString()),e.orderBy=Rt(t),n.startSet_){let r=n.startAfterSet_?"startAfter":"startAt";e[r]=Rt(n.indexStartValue_),n.startNameSet_&&(e[r]+=","+Rt(n.indexStartName_))}if(n.endSet_){let r=n.endBeforeSet_?"endBefore":"endAt";e[r]=Rt(n.indexEndValue_),n.endNameSet_&&(e[r]+=","+Rt(n.indexEndName_))}return n.limitSet_&&(n.isViewFromLeft()?e.limitToFirst=n.limit_:e.limitToLast=n.limit_),e}function f2(n){let e={};if(n.startSet_&&(e.sp=n.indexStartValue_,n.startNameSet_&&(e.sn=n.indexStartName_),e.sin=!n.startAfterSet_),n.endSet_&&(e.ep=n.indexEndValue_,n.endNameSet_&&(e.en=n.indexEndName_),e.ein=!n.endBeforeSet_),n.limitSet_){e.l=n.limit_;let t=n.viewFrom_;t===""&&(n.isViewFromLeft()?t="l":t="r"),e.vf=t}return n.index_!==ln&&(e.i=n.index_.toString()),e}var PE=class n extends Xg{reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,t){return t!==void 0?"tag$"+t:(Y(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}constructor(e,t,r,i){super(),this.repoInfo_=e,this.onDataUpdate_=t,this.authTokenProvider_=r,this.appCheckTokenProvider_=i,this.log_=Xd("p:rest:"),this.listens_={}}listen(e,t,r,i){let o=e._path.toString();this.log_("Listen called for "+o+" "+e._queryIdentifier);let s=n.getListenId_(e,r),a={};this.listens_[s]=a;let c=h2(e._queryParams);this.restRequest_(o+".json",c,(u,d)=>{let f=d;if(u===404&&(f=null,u=null),u===null&&this.onDataUpdate_(o,f,!1,r),Ds(this.listens_,s)===a){let v;u?u===401?v="permission_denied":v="rest_error:"+u:v="ok",i(v,null)}})}unlisten(e,t){let r=n.getListenId_(e,t);delete this.listens_[r]}get(e){let t=h2(e._queryParams),r=e._path.toString(),i=new Yr;return this.restRequest_(r+".json",t,(o,s)=>{let a=s;o===404&&(a=null,o=null),o===null?(this.onDataUpdate_(r,a,!1,null),i.resolve(a)):i.reject(new Error(a))}),i.promise}refreshAuthToken(e){}restRequest_(e,t={},r){return t.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([i,o])=>{i&&i.accessToken&&(t.auth=i.accessToken),o&&o.token&&(t.ac=o.token);let s=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+Ms(t);this.log_("Sending REST request for "+s);let a=new XMLHttpRequest;a.onreadystatechange=()=>{if(r&&a.readyState===4){this.log_("REST Response for "+s+" received. status:",a.status,"response:",a.responseText);let c=null;if(a.status>=200&&a.status<300){try{c=cc(a.responseText)}catch{zn("Failed to parse JSON response for "+s+": "+a.responseText)}r(null,c)}else a.status!==401&&a.status!==404&&zn("Got unsuccessful REST response for "+s+" Status: "+a.status),r(a.status);r=null}},a.open("GET",s,!0),a.send()})}};var AE=class{constructor(){this.rootNode_=ut.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)}};function iv(){return{value:null,children:new Map}}function rF(n,e,t){if(Ae(e))n.value=t,n.children.clear();else if(n.value!==null)n.value=n.value.updateChild(e,t);else{let r=Re(e);n.children.has(r)||n.children.set(r,iv());let i=n.children.get(r);e=ot(e),rF(i,e,t)}}function OE(n,e,t){n.value!==null?t(e,n.value):sY(n,(r,i)=>{let o=new Xe(e.toString()+"/"+r);OE(i,o,t)})}function sY(n,e){n.children.forEach((t,r)=>{e(r,t)})}var NE=class{constructor(e){this.collection_=e,this.last_=null}get(){let e=this.collection_.get(),t=Object.assign({},e);return this.last_&&or(this.last_,(r,i)=>{t[r]=t[r]-i}),this.last_=e,t}};var p2=10*1e3,aY=30*1e3,cY=5*60*1e3,RE=class{constructor(e,t){this.server_=t,this.statsToReport_={},this.statsListener_=new NE(e);let r=p2+(aY-p2)*Math.random();Wd(this.reportStats_.bind(this),Math.floor(r))}reportStats_(){let e=this.statsListener_.get(),t={},r=!1;or(e,(i,o)=>{o>0&&Zr(this.statsToReport_,i)&&(t[i]=o,r=!0)}),r&&this.server_.reportStats(t),Wd(this.reportStats_.bind(this),Math.floor(Math.random()*2*cY))}};var Wi=function(n){return n[n.OVERWRITE=0]="OVERWRITE",n[n.MERGE=1]="MERGE",n[n.ACK_USER_WRITE=2]="ACK_USER_WRITE",n[n.LISTEN_COMPLETE=3]="LISTEN_COMPLETE",n}(Wi||{});function iF(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function oF(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function sF(n){return{fromUser:!1,fromServer:!0,queryId:n,tagged:!0}}var kE=class n{constructor(e,t,r){this.path=e,this.affectedTree=t,this.revert=r,this.type=Wi.ACK_USER_WRITE,this.source=iF()}operationForChild(e){if(Ae(this.path)){if(this.affectedTree.value!=null)return Y(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{let t=this.affectedTree.subtree(new Xe(e));return new n(Ge(),t,this.revert)}}else return Y(Re(this.path)===e,"operationForChild called for unrelated child."),new n(ot(this.path),this.affectedTree,this.revert)}};var nl=class n{constructor(e,t,r){this.source=e,this.path=t,this.snap=r,this.type=Wi.OVERWRITE}operationForChild(e){return Ae(this.path)?new n(this.source,Ge(),this.snap.getImmediateChild(e)):new n(this.source,ot(this.path),this.snap)}};var ov=class n{constructor(e,t,r){this.source=e,this.path=t,this.children=r,this.type=Wi.MERGE}operationForChild(e){if(Ae(this.path)){let t=this.children.subtree(new Xe(e));return t.isEmpty()?null:t.value?new nl(this.source,Ge(),t.value):new n(this.source,Ge(),t)}else return Y(Re(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new n(this.source,ot(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}};var Yd=class{constructor(e,t,r){this.node_=e,this.fullyInitialized_=t,this.filtered_=r}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(Ae(e))return this.isFullyInitialized()&&!this.filtered_;let t=Re(e);return this.isCompleteForChild(t)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}};function lY(n,e,t,r){let i=[],o=[];return e.forEach(s=>{s.type==="child_changed"&&n.index_.indexedValueChanged(s.oldSnap,s.snapshotNode)&&o.push(oY(s.childName,s.snapshotNode))}),Hd(n,i,"child_removed",e,r,t),Hd(n,i,"child_added",e,r,t),Hd(n,i,"child_moved",o,r,t),Hd(n,i,"child_changed",e,r,t),Hd(n,i,"value",e,r,t),i}function Hd(n,e,t,r,i,o){let s=r.filter(a=>a.type===t);s.sort((a,c)=>dY(n,a,c)),s.forEach(a=>{let c=uY(n,a,o);i.forEach(u=>{u.respondsTo(a.type)&&e.push(u.createEvent(c,n.query_))})})}function uY(n,e,t){return e.type==="value"||e.type==="child_removed"||(e.prevName=t.getPredecessorChildName(e.childName,e.snapshotNode,n.index_)),e}function dY(n,e,t){if(e.childName==null||t.childName==null)throw Ts("Should only compare child_ events.");let r=new ke(e.childName,e.snapshotNode),i=new ke(t.childName,t.snapshotNode);return n.index_.compare(r,i)}function aF(n,e){return{eventCache:n,serverCache:e}}function Gd(n,e,t,r){return aF(new Yd(e,t,r),n.serverCache)}function cF(n,e,t,r){return aF(n.eventCache,new Yd(e,t,r))}function FE(n){return n.eventCache.isFullyInitialized()?n.eventCache.getNode():null}function oa(n){return n.serverCache.isFullyInitialized()?n.serverCache.getNode():null}var oE,hY=()=>(oE||(oE=new ir(hK)),oE),Pn=class n{static fromObject(e){let t=new n(null);return or(e,(r,i)=>{t=t.set(new Xe(r),i)}),t}constructor(e,t=hY()){this.value=e,this.children=t}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,t){if(this.value!=null&&t(this.value))return{path:Ge(),value:this.value};if(Ae(e))return null;{let r=Re(e),i=this.children.get(r);if(i!==null){let o=i.findRootMostMatchingPathAndValue(ot(e),t);return o!=null?{path:Vt(new Xe(r),o.path),value:o.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(Ae(e))return this;{let t=Re(e),r=this.children.get(t);return r!==null?r.subtree(ot(e)):new n(null)}}set(e,t){if(Ae(e))return new n(t,this.children);{let r=Re(e),o=(this.children.get(r)||new n(null)).set(ot(e),t),s=this.children.insert(r,o);return new n(this.value,s)}}remove(e){if(Ae(e))return this.children.isEmpty()?new n(null):new n(null,this.children);{let t=Re(e),r=this.children.get(t);if(r){let i=r.remove(ot(e)),o;return i.isEmpty()?o=this.children.remove(t):o=this.children.insert(t,i),this.value===null&&o.isEmpty()?new n(null):new n(this.value,o)}else return this}}get(e){if(Ae(e))return this.value;{let t=Re(e),r=this.children.get(t);return r?r.get(ot(e)):null}}setTree(e,t){if(Ae(e))return t;{let r=Re(e),o=(this.children.get(r)||new n(null)).setTree(ot(e),t),s;return o.isEmpty()?s=this.children.remove(r):s=this.children.insert(r,o),new n(this.value,s)}}fold(e){return this.fold_(Ge(),e)}fold_(e,t){let r={};return this.children.inorderTraversal((i,o)=>{r[i]=o.fold_(Vt(e,i),t)}),t(e,this.value,r)}findOnPath(e,t){return this.findOnPath_(e,Ge(),t)}findOnPath_(e,t,r){let i=this.value?r(t,this.value):!1;if(i)return i;if(Ae(e))return null;{let o=Re(e),s=this.children.get(o);return s?s.findOnPath_(ot(e),Vt(t,o),r):null}}foreachOnPath(e,t){return this.foreachOnPath_(e,Ge(),t)}foreachOnPath_(e,t,r){if(Ae(e))return this;{this.value&&r(t,this.value);let i=Re(e),o=this.children.get(i);return o?o.foreachOnPath_(ot(e),Vt(t,i),r):new n(null)}}foreach(e){this.foreach_(Ge(),e)}foreach_(e,t){this.children.inorderTraversal((r,i)=>{i.foreach_(Vt(e,r),t)}),this.value&&t(e,this.value)}foreachChild(e){this.children.inorderTraversal((t,r)=>{r.value&&e(t,r.value)})}};var Pr=class n{constructor(e){this.writeTree_=e}static empty(){return new n(new Pn(null))}};function Kd(n,e,t){if(Ae(e))return new Pr(new Pn(t));{let r=n.writeTree_.findRootMostValueAndPath(e);if(r!=null){let i=r.path,o=r.value,s=rr(i,e);return o=o.updateChild(s,t),new Pr(n.writeTree_.set(i,o))}else{let i=new Pn(t),o=n.writeTree_.setTree(e,i);return new Pr(o)}}}function m2(n,e,t){let r=n;return or(t,(i,o)=>{r=Kd(r,Vt(e,i),o)}),r}function g2(n,e){if(Ae(e))return Pr.empty();{let t=n.writeTree_.setTree(e,new Pn(null));return new Pr(t)}}function LE(n,e){return sa(n,e)!=null}function sa(n,e){let t=n.writeTree_.findRootMostValueAndPath(e);return t!=null?n.writeTree_.get(t.path).getChild(rr(t.path,e)):null}function v2(n){let e=[],t=n.writeTree_.value;return t!=null?t.isLeafNode()||t.forEachChild(ln,(r,i)=>{e.push(new ke(r,i))}):n.writeTree_.children.inorderTraversal((r,i)=>{i.value!=null&&e.push(new ke(r,i.value))}),e}function zo(n,e){if(Ae(e))return n;{let t=sa(n,e);return t!=null?new Pr(new Pn(t)):new Pr(n.writeTree_.subtree(e))}}function VE(n){return n.writeTree_.isEmpty()}function rl(n,e){return lF(Ge(),n.writeTree_,e)}function lF(n,e,t){if(e.value!=null)return t.updateChild(n,e.value);{let r=null;return e.children.inorderTraversal((i,o)=>{i===".priority"?(Y(o.value!==null,"Priority writes must always be leaf nodes"),r=o.value):t=lF(Vt(n,i),o,t)}),!t.getChild(n).isEmpty()&&r!==null&&(t=t.updateChild(Vt(n,".priority"),r)),t}}function uF(n,e){return mF(e,n)}function fY(n,e,t,r,i){Y(r>n.lastWriteId,"Stacking an older write on top of newer ones"),i===void 0&&(i=!0),n.allWrites.push({path:e,snap:t,writeId:r,visible:i}),i&&(n.visibleWrites=Kd(n.visibleWrites,e,t)),n.lastWriteId=r}function pY(n,e){for(let t=0;t<n.allWrites.length;t++){let r=n.allWrites[t];if(r.writeId===e)return r}return null}function mY(n,e){let t=n.allWrites.findIndex(a=>a.writeId===e);Y(t>=0,"removeWrite called with nonexistent writeId.");let r=n.allWrites[t];n.allWrites.splice(t,1);let i=r.visible,o=!1,s=n.allWrites.length-1;for(;i&&s>=0;){let a=n.allWrites[s];a.visible&&(s>=t&&gY(a,r.path)?i=!1:Mr(r.path,a.path)&&(o=!0)),s--}if(i){if(o)return vY(n),!0;if(r.snap)n.visibleWrites=g2(n.visibleWrites,r.path);else{let a=r.children;or(a,c=>{n.visibleWrites=g2(n.visibleWrites,Vt(r.path,c))})}return!0}else return!1}function gY(n,e){if(n.snap)return Mr(n.path,e);for(let t in n.children)if(n.children.hasOwnProperty(t)&&Mr(Vt(n.path,t),e))return!0;return!1}function vY(n){n.visibleWrites=dF(n.allWrites,_Y,Ge()),n.allWrites.length>0?n.lastWriteId=n.allWrites[n.allWrites.length-1].writeId:n.lastWriteId=-1}function _Y(n){return n.visible}function dF(n,e,t){let r=Pr.empty();for(let i=0;i<n.length;++i){let o=n[i];if(e(o)){let s=o.path,a;if(o.snap)Mr(t,s)?(a=rr(t,s),r=Kd(r,a,o.snap)):Mr(s,t)&&(a=rr(s,t),r=Kd(r,Ge(),o.snap.getChild(a)));else if(o.children){if(Mr(t,s))a=rr(t,s),r=m2(r,a,o.children);else if(Mr(s,t))if(a=rr(s,t),Ae(a))r=m2(r,Ge(),o.children);else{let c=Ds(o.children,Re(a));if(c){let u=c.getChild(ot(a));r=Kd(r,Ge(),u)}}}else throw Ts("WriteRecord should have .snap or .children")}}return r}function hF(n,e,t,r,i){if(!r&&!i){let o=sa(n.visibleWrites,e);if(o!=null)return o;{let s=zo(n.visibleWrites,e);if(VE(s))return t;if(t==null&&!LE(s,Ge()))return null;{let a=t||ut.EMPTY_NODE;return rl(s,a)}}}else{let o=zo(n.visibleWrites,e);if(!i&&VE(o))return t;if(!i&&t==null&&!LE(o,Ge()))return null;{let s=function(u){return(u.visible||i)&&(!r||!~r.indexOf(u.writeId))&&(Mr(u.path,e)||Mr(e,u.path))},a=dF(n.allWrites,s,e),c=t||ut.EMPTY_NODE;return rl(a,c)}}}function yY(n,e,t){let r=ut.EMPTY_NODE,i=sa(n.visibleWrites,e);if(i)return i.isLeafNode()||i.forEachChild(ln,(o,s)=>{r=r.updateImmediateChild(o,s)}),r;if(t){let o=zo(n.visibleWrites,e);return t.forEachChild(ln,(s,a)=>{let c=rl(zo(o,new Xe(s)),a);r=r.updateImmediateChild(s,c)}),v2(o).forEach(s=>{r=r.updateImmediateChild(s.name,s.node)}),r}else{let o=zo(n.visibleWrites,e);return v2(o).forEach(s=>{r=r.updateImmediateChild(s.name,s.node)}),r}}function wY(n,e,t,r,i){Y(r||i,"Either existingEventSnap or existingServerSnap must exist");let o=Vt(e,t);if(LE(n.visibleWrites,o))return null;{let s=zo(n.visibleWrites,o);return VE(s)?i.getChild(t):rl(s,i.getChild(t))}}function CY(n,e,t,r){let i=Vt(e,t),o=sa(n.visibleWrites,i);if(o!=null)return o;if(r.isCompleteForChild(t)){let s=zo(n.visibleWrites,i);return rl(s,r.getNode().getImmediateChild(t))}else return null}function bY(n,e){return sa(n.visibleWrites,e)}function IY(n,e,t,r,i,o,s){let a,c=zo(n.visibleWrites,e),u=sa(c,Ge());if(u!=null)a=u;else if(t!=null)a=rl(c,t);else return[];if(a=a.withIndex(s),!a.isEmpty()&&!a.isLeafNode()){let d=[],f=s.getCompare(),v=o?a.getReverseIteratorFrom(r,s):a.getIteratorFrom(r,s),_=v.getNext();for(;_&&d.length<i;)f(_,r)!==0&&d.push(_),_=v.getNext();return d}else return[]}function EY(){return{visibleWrites:Pr.empty(),allWrites:[],lastWriteId:-1}}function jE(n,e,t,r){return hF(n.writeTree,n.treePath,e,t,r)}function fF(n,e){return yY(n.writeTree,n.treePath,e)}function _2(n,e,t,r){return wY(n.writeTree,n.treePath,e,t,r)}function sv(n,e){return bY(n.writeTree,Vt(n.treePath,e))}function xY(n,e,t,r,i,o){return IY(n.writeTree,n.treePath,e,t,r,i,o)}function rx(n,e,t){return CY(n.writeTree,n.treePath,e,t)}function pF(n,e){return mF(Vt(n.treePath,e),n.writeTree)}function mF(n,e){return{treePath:n,writeTree:e}}var BE=class{constructor(){this.changeMap=new Map}trackChildChange(e){let t=e.type,r=e.childName;Y(t==="child_added"||t==="child_changed"||t==="child_removed","Only child changes supported for tracking"),Y(r!==".priority","Only non-priority child changes can be tracked.");let i=this.changeMap.get(r);if(i){let o=i.type;if(t==="child_added"&&o==="child_removed")this.changeMap.set(r,d2(r,e.snapshotNode,i.snapshotNode));else if(t==="child_removed"&&o==="child_added")this.changeMap.delete(r);else if(t==="child_removed"&&o==="child_changed")this.changeMap.set(r,iY(r,i.oldSnap));else if(t==="child_changed"&&o==="child_added")this.changeMap.set(r,rY(r,e.snapshotNode));else if(t==="child_changed"&&o==="child_changed")this.changeMap.set(r,d2(r,e.snapshotNode,i.oldSnap));else throw Ts("Illegal combination of changes: "+e+" occurred after "+i)}else this.changeMap.set(r,e)}getChanges(){return Array.from(this.changeMap.values())}};var UE=class{getCompleteChild(e){return null}getChildAfterChild(e,t,r){return null}},gF=new UE,Qd=class{constructor(e,t,r=null){this.writes_=e,this.viewCache_=t,this.optCompleteServerCache_=r}getCompleteChild(e){let t=this.viewCache_.eventCache;if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);{let r=this.optCompleteServerCache_!=null?new Yd(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return rx(this.writes_,e,r)}}getChildAfterChild(e,t,r){let i=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:oa(this.viewCache_),o=xY(this.writes_,i,t,1,r,e);return o.length===0?null:o[0]}};function SY(n,e){Y(e.eventCache.getNode().isIndexed(n.filter.getIndex()),"Event snap not indexed"),Y(e.serverCache.getNode().isIndexed(n.filter.getIndex()),"Server snap not indexed")}function TY(n,e,t,r,i){let o=new BE,s,a;if(t.type===Wi.OVERWRITE){let u=t;u.source.fromUser?s=$E(n,e,u.path,u.snap,r,i,o):(Y(u.source.fromServer,"Unknown source."),a=u.source.tagged||e.serverCache.isFiltered()&&!Ae(u.path),s=av(n,e,u.path,u.snap,r,i,a,o))}else if(t.type===Wi.MERGE){let u=t;u.source.fromUser?s=MY(n,e,u.path,u.children,r,i,o):(Y(u.source.fromServer,"Unknown source."),a=u.source.tagged||e.serverCache.isFiltered(),s=zE(n,e,u.path,u.children,r,i,a,o))}else if(t.type===Wi.ACK_USER_WRITE){let u=t;u.revert?s=OY(n,e,u.path,r,i,o):s=PY(n,e,u.path,u.affectedTree,r,i,o)}else if(t.type===Wi.LISTEN_COMPLETE)s=AY(n,e,t.path,r,o);else throw Ts("Unknown operation type: "+t.type);let c=o.getChanges();return DY(e,s,c),{viewCache:s,changes:c}}function DY(n,e,t){let r=e.eventCache;if(r.isFullyInitialized()){let i=r.getNode().isLeafNode()||r.getNode().isEmpty(),o=FE(n);(t.length>0||!n.eventCache.isFullyInitialized()||i&&!r.getNode().equals(o)||!r.getNode().getPriority().equals(o.getPriority()))&&t.push(nY(FE(e)))}}function vF(n,e,t,r,i,o){let s=e.eventCache;if(sv(r,t)!=null)return e;{let a,c;if(Ae(t))if(Y(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){let u=oa(e),d=u instanceof ut?u:ut.EMPTY_NODE,f=fF(r,d);a=n.filter.updateFullNode(e.eventCache.getNode(),f,o)}else{let u=jE(r,oa(e));a=n.filter.updateFullNode(e.eventCache.getNode(),u,o)}else{let u=Re(t);if(u===".priority"){Y(Ho(t)===1,"Can't have a priority with additional path components");let d=s.getNode();c=e.serverCache.getNode();let f=_2(r,t,d,c);f!=null?a=n.filter.updatePriority(d,f):a=s.getNode()}else{let d=ot(t),f;if(s.isCompleteForChild(u)){c=e.serverCache.getNode();let v=_2(r,t,s.getNode(),c);v!=null?f=s.getNode().getImmediateChild(u).updateChild(d,v):f=s.getNode().getImmediateChild(u)}else f=rx(r,u,e.serverCache);f!=null?a=n.filter.updateChild(s.getNode(),u,f,d,i,o):a=s.getNode()}}return Gd(e,a,s.isFullyInitialized()||Ae(t),n.filter.filtersNodes())}}function av(n,e,t,r,i,o,s,a){let c=e.serverCache,u,d=s?n.filter:n.filter.getIndexedFilter();if(Ae(t))u=d.updateFullNode(c.getNode(),r,null);else if(d.filtersNodes()&&!c.isFiltered()){let _=c.getNode().updateChild(t,r);u=d.updateFullNode(c.getNode(),_,null)}else{let _=Re(t);if(!c.isCompleteForPath(t)&&Ho(t)>1)return e;let b=ot(t),R=c.getNode().getImmediateChild(_).updateChild(b,r);_===".priority"?u=d.updatePriority(c.getNode(),R):u=d.updateChild(c.getNode(),_,R,b,gF,null)}let f=cF(e,u,c.isFullyInitialized()||Ae(t),d.filtersNodes()),v=new Qd(i,f,o);return vF(n,f,t,i,v,a)}function $E(n,e,t,r,i,o,s){let a=e.eventCache,c,u,d=new Qd(i,e,o);if(Ae(t))u=n.filter.updateFullNode(e.eventCache.getNode(),r,s),c=Gd(e,u,!0,n.filter.filtersNodes());else{let f=Re(t);if(f===".priority")u=n.filter.updatePriority(e.eventCache.getNode(),r),c=Gd(e,u,a.isFullyInitialized(),a.isFiltered());else{let v=ot(t),_=a.getNode().getImmediateChild(f),b;if(Ae(v))b=r;else{let N=d.getCompleteChild(f);N!=null?K2(v)===".priority"&&N.getChild(Q2(v)).isEmpty()?b=N:b=N.updateChild(v,r):b=ut.EMPTY_NODE}if(_.equals(b))c=e;else{let N=n.filter.updateChild(a.getNode(),f,b,v,d,s);c=Gd(e,N,a.isFullyInitialized(),n.filter.filtersNodes())}}}return c}function y2(n,e){return n.eventCache.isCompleteForChild(e)}function MY(n,e,t,r,i,o,s){let a=e;return r.foreach((c,u)=>{let d=Vt(t,c);y2(e,Re(d))&&(a=$E(n,a,d,u,i,o,s))}),r.foreach((c,u)=>{let d=Vt(t,c);y2(e,Re(d))||(a=$E(n,a,d,u,i,o,s))}),a}function w2(n,e,t){return t.foreach((r,i)=>{e=e.updateChild(r,i)}),e}function zE(n,e,t,r,i,o,s,a){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let c=e,u;Ae(t)?u=r:u=new Pn(null).setTree(t,r);let d=e.serverCache.getNode();return u.children.inorderTraversal((f,v)=>{if(d.hasChild(f)){let _=e.serverCache.getNode().getImmediateChild(f),b=w2(n,_,v);c=av(n,c,new Xe(f),b,i,o,s,a)}}),u.children.inorderTraversal((f,v)=>{let _=!e.serverCache.isCompleteForChild(f)&&v.value===null;if(!d.hasChild(f)&&!_){let b=e.serverCache.getNode().getImmediateChild(f),N=w2(n,b,v);c=av(n,c,new Xe(f),N,i,o,s,a)}}),c}function PY(n,e,t,r,i,o,s){if(sv(i,t)!=null)return e;let a=e.serverCache.isFiltered(),c=e.serverCache;if(r.value!=null){if(Ae(t)&&c.isFullyInitialized()||c.isCompleteForPath(t))return av(n,e,t,c.getNode().getChild(t),i,o,a,s);if(Ae(t)){let u=new Pn(null);return c.getNode().forEachChild(Zc,(d,f)=>{u=u.set(new Xe(d),f)}),zE(n,e,t,u,i,o,a,s)}else return e}else{let u=new Pn(null);return r.foreach((d,f)=>{let v=Vt(t,d);c.isCompleteForPath(v)&&(u=u.set(d,c.getNode().getChild(v)))}),zE(n,e,t,u,i,o,a,s)}}function AY(n,e,t,r,i){let o=e.serverCache,s=cF(e,o.getNode(),o.isFullyInitialized()||Ae(t),o.isFiltered());return vF(n,s,t,r,gF,i)}function OY(n,e,t,r,i,o){let s;if(sv(r,t)!=null)return e;{let a=new Qd(r,e,i),c=e.eventCache.getNode(),u;if(Ae(t)||Re(t)===".priority"){let d;if(e.serverCache.isFullyInitialized())d=jE(r,oa(e));else{let f=e.serverCache.getNode();Y(f instanceof ut,"serverChildren would be complete if leaf node"),d=fF(r,f)}d=d,u=n.filter.updateFullNode(c,d,o)}else{let d=Re(t),f=rx(r,d,e.serverCache);f==null&&e.serverCache.isCompleteForChild(d)&&(f=c.getImmediateChild(d)),f!=null?u=n.filter.updateChild(c,d,f,ot(t),a,o):e.eventCache.getNode().hasChild(d)?u=n.filter.updateChild(c,d,ut.EMPTY_NODE,ot(t),a,o):u=c,u.isEmpty()&&e.serverCache.isFullyInitialized()&&(s=jE(r,oa(e)),s.isLeafNode()&&(u=n.filter.updateFullNode(u,s,o)))}return s=e.serverCache.isFullyInitialized()||sv(r,Ge())!=null,Gd(e,u,s,n.filter.filtersNodes())}}function NY(n,e){let t=oa(n.viewCache_);return t&&(n.query._queryParams.loadsAllData()||!Ae(e)&&!t.getImmediateChild(Re(e)).isEmpty())?t.getChild(e):null}function C2(n,e,t,r){e.type===Wi.MERGE&&e.source.queryId!==null&&(Y(oa(n.viewCache_),"We should always have a full cache before handling merges"),Y(FE(n.viewCache_),"Missing event cache, even though we have a server cache"));let i=n.viewCache_,o=TY(n.processor_,i,e,t,r);return SY(n.processor_,o.viewCache),Y(o.viewCache.serverCache.isFullyInitialized()||!i.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),n.viewCache_=o.viewCache,RY(n,o.changes,o.viewCache.eventCache.getNode(),null)}function RY(n,e,t,r){let i=r?[r]:n.eventRegistrations_;return lY(n.eventGenerator_,e,t,i)}var b2;function kY(n){Y(!b2,"__referenceConstructor has already been defined"),b2=n}function ix(n,e,t,r){let i=e.source.queryId;if(i!==null){let o=n.views.get(i);return Y(o!=null,"SyncTree gave us an op for an invalid query."),C2(o,e,t,r)}else{let o=[];for(let s of n.views.values())o=o.concat(C2(s,e,t,r));return o}}function ox(n,e){let t=null;for(let r of n.views.values())t=t||NY(r,e);return t}var I2;function FY(n){Y(!I2,"__referenceConstructor has already been defined"),I2=n}var cv=class{constructor(e){this.listenProvider_=e,this.syncPointTree_=new Pn(null),this.pendingWriteTree_=EY(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}};function LY(n,e,t,r,i){return fY(n.pendingWriteTree_,e,t,r,i),i?uv(n,new nl(iF(),e,t)):[]}function Yc(n,e,t=!1){let r=pY(n.pendingWriteTree_,e);if(mY(n.pendingWriteTree_,e)){let o=new Pn(null);return r.snap!=null?o=o.set(Ge(),!0):or(r.children,s=>{o=o.set(new Xe(s),!0)}),uv(n,new kE(r.path,o,t))}else return[]}function lv(n,e,t){return uv(n,new nl(oF(),e,t))}function VY(n,e,t){let r=Pn.fromObject(t);return uv(n,new ov(oF(),e,r))}function jY(n,e,t,r){let i=CF(n,r);if(i!=null){let o=bF(i),s=o.path,a=o.queryId,c=rr(s,e),u=new nl(sF(a),c,t);return IF(n,s,u)}else return[]}function BY(n,e,t,r){let i=CF(n,r);if(i){let o=bF(i),s=o.path,a=o.queryId,c=rr(s,e),u=Pn.fromObject(t),d=new ov(sF(a),c,u);return IF(n,s,d)}else return[]}function _F(n,e,t){let i=n.pendingWriteTree_,o=n.syncPointTree_.findOnPath(e,(s,a)=>{let c=rr(s,e),u=ox(a,c);if(u)return u});return hF(i,e,o,t,!0)}function uv(n,e){return yF(e,n.syncPointTree_,null,uF(n.pendingWriteTree_,Ge()))}function yF(n,e,t,r){if(Ae(n.path))return wF(n,e,t,r);{let i=e.get(Ge());t==null&&i!=null&&(t=ox(i,Ge()));let o=[],s=Re(n.path),a=n.operationForChild(s),c=e.children.get(s);if(c&&a){let u=t?t.getImmediateChild(s):null,d=pF(r,s);o=o.concat(yF(a,c,u,d))}return i&&(o=o.concat(ix(i,n,r,t))),o}}function wF(n,e,t,r){let i=e.get(Ge());t==null&&i!=null&&(t=ox(i,Ge()));let o=[];return e.children.inorderTraversal((s,a)=>{let c=t?t.getImmediateChild(s):null,u=pF(r,s),d=n.operationForChild(s);d&&(o=o.concat(wF(d,a,c,u)))}),i&&(o=o.concat(ix(i,n,r,t))),o}function CF(n,e){return n.tagToQueryMap.get(e)}function bF(n){let e=n.indexOf("$");return Y(e!==-1&&e<n.length-1,"Bad queryKey."),{queryId:n.substr(e+1),path:new Xe(n.substr(0,e))}}function IF(n,e,t){let r=n.syncPointTree_.get(e);Y(r,"Missing sync point for query tag that we're tracking");let i=uF(n.pendingWriteTree_,e);return ix(r,t,i,null)}var HE=class n{constructor(e){this.node_=e}getImmediateChild(e){let t=this.node_.getImmediateChild(e);return new n(t)}node(){return this.node_}},WE=class n{constructor(e,t){this.syncTree_=e,this.path_=t}getImmediateChild(e){let t=Vt(this.path_,e);return new n(this.syncTree_,t)}node(){return _F(this.syncTree_,this.path_)}},UY=function(n){return n=n||{},n.timestamp=n.timestamp||new Date().getTime(),n},E2=function(n,e,t){if(!n||typeof n!="object")return n;if(Y(".sv"in n,"Unexpected leaf node or priority contents"),typeof n[".sv"]=="string")return $Y(n[".sv"],e,t);if(typeof n[".sv"]=="object")return zY(n[".sv"],e);Y(!1,"Unexpected server value: "+JSON.stringify(n,null,2))},$Y=function(n,e,t){switch(n){case"timestamp":return t.timestamp;default:Y(!1,"Unexpected server value: "+n)}},zY=function(n,e,t){n.hasOwnProperty("increment")||Y(!1,"Unexpected server value: "+JSON.stringify(n,null,2));let r=n.increment;typeof r!="number"&&Y(!1,"Unexpected increment value: "+r);let i=e.node();if(Y(i!==null&&typeof i<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return r;let s=i.getValue();return typeof s!="number"?r:s+r},HY=function(n,e,t,r){return sx(e,new WE(t,n),r)},WY=function(n,e,t){return sx(n,new HE(e),t)};function sx(n,e,t){let r=n.getPriority().val(),i=E2(r,e.getImmediateChild(".priority"),t),o;if(n.isLeafNode()){let s=n,a=E2(s.getValue(),e,t);return a!==s.getValue()||i!==s.getPriority().val()?new el(a,cn(i)):n}else{let s=n;return o=s,i!==s.getPriority().val()&&(o=o.updatePriority(new el(i))),s.forEachChild(ln,(a,c)=>{let u=sx(c,e.getImmediateChild(a),t);u!==c&&(o=o.updateImmediateChild(a,u))}),o}}var Zd=class{constructor(e="",t=null,r={children:{},childCount:0}){this.name=e,this.parent=t,this.node=r}};function ax(n,e){let t=e instanceof Xe?e:new Xe(e),r=n,i=Re(t);for(;i!==null;){let o=Ds(r.node.children,i)||{children:{},childCount:0};r=new Zd(i,r,o),t=ot(t),i=Re(t)}return r}function sl(n){return n.node.value}function EF(n,e){n.node.value=e,qE(n)}function xF(n){return n.node.childCount>0}function qY(n){return sl(n)===void 0&&!xF(n)}function dv(n,e){or(n.node.children,(t,r)=>{e(new Zd(t,n,r))})}function SF(n,e,t,r){t&&!r&&e(n),dv(n,i=>{SF(i,e,!0,r)}),t&&r&&e(n)}function GY(n,e,t){let r=t?n:n.parent;for(;r!==null;){if(e(r))return!0;r=r.parent}return!1}function nh(n){return new Xe(n.parent===null?n.name:nh(n.parent)+"/"+n.name)}function qE(n){n.parent!==null&&KY(n.parent,n.name,n)}function KY(n,e,t){let r=qY(t),i=Zr(n.node.children,e);r&&i?(delete n.node.children[e],n.node.childCount--,qE(n)):!r&&!i&&(n.node.children[e]=t.node,n.node.childCount++,qE(n))}var YY=/[\[\].#$\/\u0000-\u001F\u007F]/,QY=/[\[\].#$\u0000-\u001F\u007F]/,sE=10*1024*1024,TF=function(n){return typeof n=="string"&&n.length!==0&&!YY.test(n)},ZY=function(n){return typeof n=="string"&&n.length!==0&&!QY.test(n)},JY=function(n){return n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),ZY(n)};var DF=function(n,e,t){let r=t instanceof Xe?new wE(t,n):t;if(e===void 0)throw new Error(n+"contains undefined "+ta(r));if(typeof e=="function")throw new Error(n+"contains a function "+ta(r)+" with contents = "+e.toString());if(P2(e))throw new Error(n+"contains "+e.toString()+" "+ta(r));if(typeof e=="string"&&e.length>sE/3&&Uu(e)>sE)throw new Error(n+"contains a string greater than "+sE+" utf8 bytes "+ta(r)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let i=!1,o=!1;if(or(e,(s,a)=>{if(s===".value")i=!0;else if(s!==".priority"&&s!==".sv"&&(o=!0,!TF(s)))throw new Error(n+" contains an invalid key ("+s+") "+ta(r)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);zK(r,s),DF(n,a,r),HK(r)}),i&&o)throw new Error(n+' contains ".value" child '+ta(r)+" in addition to actual children.")}};var XY=function(n,e){let t=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!TF(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||t.length!==0&&!JY(t))throw new Error(aA(n,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};var GE=class{constructor(){this.eventLists_=[],this.recursionDepth_=0}};function eQ(n,e){let t=null;for(let r=0;r<e.length;r++){let i=e[r],o=i.getPath();t!==null&&!Z2(o,t.path)&&(n.eventLists_.push(t),t=null),t===null&&(t={events:[],path:o}),t.events.push(i)}t&&n.eventLists_.push(t)}function aa(n,e,t){eQ(n,t),tQ(n,r=>Mr(r,e)||Mr(e,r))}function tQ(n,e){n.recursionDepth_++;let t=!0;for(let r=0;r<n.eventLists_.length;r++){let i=n.eventLists_[r];if(i){let o=i.path;e(o)?(nQ(n.eventLists_[r]),n.eventLists_[r]=null):t=!1}}t&&(n.eventLists_=[]),n.recursionDepth_--}function nQ(n){for(let e=0;e<n.events.length;e++){let t=n.events[e];if(t!==null){n.events[e]=null;let r=t.getEventRunner();ra&&an("event: "+t.toString()),eh(r)}}}var rQ="repo_interrupt",iQ=25,KE=class{constructor(e,t,r,i){this.repoInfo_=e,this.forceRestClient_=t,this.authTokenProvider_=r,this.appCheckProvider_=i,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new GE,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=iv(),this.transactionQueueTree_=new Zd,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}};function oQ(n,e,t){if(n.stats_=ex(n.repoInfo_),n.forceRestClient_||_K())n.server_=new PE(n.repoInfo_,(r,i,o,s)=>{x2(n,r,i,o,s)},n.authTokenProvider_,n.appCheckProvider_),setTimeout(()=>S2(n,!0),0);else{if(typeof t<"u"&&t!==null){if(typeof t!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{Rt(t)}catch(r){throw new Error("Invalid authOverride provided: "+r)}}n.persistentConnection_=new tx(n.repoInfo_,e,(r,i,o,s)=>{x2(n,r,i,o,s)},r=>{S2(n,r)},r=>{aQ(n,r)},n.authTokenProvider_,n.appCheckProvider_,t),n.server_=n.persistentConnection_}n.authTokenProvider_.addTokenChangeListener(r=>{n.server_.refreshAuthToken(r)}),n.appCheckProvider_.addTokenChangeListener(r=>{n.server_.refreshAppCheckToken(r.token)}),n.statsReporter_=wK(n.repoInfo_,()=>new RE(n.stats_,n.server_)),n.infoData_=new AE,n.infoSyncTree_=new cv({startListening:(r,i,o,s)=>{let a=[],c=n.infoData_.getNode(r._path);return c.isEmpty()||(a=lv(n.infoSyncTree_,r._path,c),setTimeout(()=>{s("ok")},0)),a},stopListening:()=>{}}),cx(n,"connected",!1),n.serverSyncTree_=new cv({startListening:(r,i,o,s)=>(n.server_.listen(r,o,i,(a,c)=>{let u=s(a,c);aa(n.eventQueue_,r._path,u)}),[]),stopListening:(r,i)=>{n.server_.unlisten(r,i)}})}function sQ(n){let t=n.infoData_.getNode(new Xe(".info/serverTimeOffset")).val()||0;return new Date().getTime()+t}function MF(n){return UY({timestamp:sQ(n)})}function x2(n,e,t,r,i){n.dataUpdateCount++;let o=new Xe(e);t=n.interceptServerDataCallback_?n.interceptServerDataCallback_(e,t):t;let s=[];if(i)if(r){let c=Bu(t,u=>cn(u));s=BY(n.serverSyncTree_,o,c,i)}else{let c=cn(t);s=jY(n.serverSyncTree_,o,c,i)}else if(r){let c=Bu(t,u=>cn(u));s=VY(n.serverSyncTree_,o,c)}else{let c=cn(t);s=lv(n.serverSyncTree_,o,c)}let a=o;s.length>0&&(a=ux(n,o)),aa(n.eventQueue_,a,s)}function S2(n,e){cx(n,"connected",e),e===!1&&lQ(n)}function aQ(n,e){or(e,(t,r)=>{cx(n,t,r)})}function cx(n,e,t){let r=new Xe("/.info/"+e),i=cn(t);n.infoData_.updateSnapshot(r,i);let o=lv(n.infoSyncTree_,r,i);aa(n.eventQueue_,r,o)}function cQ(n){return n.nextWriteId_++}function lQ(n){PF(n,"onDisconnectEvents");let e=MF(n),t=iv();OE(n.onDisconnect_,Ge(),(i,o)=>{let s=HY(i,o,n.serverSyncTree_,e);rF(t,i,s)});let r=[];OE(t,Ge(),(i,o)=>{r=r.concat(lv(n.serverSyncTree_,i,o));let s=fQ(n,i);ux(n,s)}),n.onDisconnect_=iv(),aa(n.eventQueue_,Ge(),r)}function uQ(n){n.persistentConnection_&&n.persistentConnection_.interrupt(rQ)}function PF(n,...e){let t="";n.persistentConnection_&&(t=n.persistentConnection_.id+":"),an(t,...e)}function AF(n,e,t){return _F(n.serverSyncTree_,e,t)||ut.EMPTY_NODE}function lx(n,e=n.transactionQueueTree_){if(e||hv(n,e),sl(e)){let t=NF(n,e);Y(t.length>0,"Sending zero length transaction queue"),t.every(i=>i.status===0)&&dQ(n,nh(e),t)}else xF(e)&&dv(e,t=>{lx(n,t)})}function dQ(n,e,t){let r=t.map(u=>u.currentWriteId),i=AF(n,e,r),o=i,s=i.hash();for(let u=0;u<t.length;u++){let d=t[u];Y(d.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),d.status=1,d.retryCount++;let f=rr(e,d.path);o=o.updateChild(f,d.currentOutputSnapshotRaw)}let a=o.val(!0),c=e;n.server_.put(c.toString(),a,u=>{PF(n,"transaction put response",{path:c.toString(),status:u});let d=[];if(u==="ok"){let f=[];for(let v=0;v<t.length;v++)t[v].status=2,d=d.concat(Yc(n.serverSyncTree_,t[v].currentWriteId)),t[v].onComplete&&f.push(()=>t[v].onComplete(null,!0,t[v].currentOutputSnapshotResolved)),t[v].unwatcher();hv(n,ax(n.transactionQueueTree_,e)),lx(n,n.transactionQueueTree_),aa(n.eventQueue_,e,d);for(let v=0;v<f.length;v++)eh(f[v])}else{if(u==="datastale")for(let f=0;f<t.length;f++)t[f].status===3?t[f].status=4:t[f].status=0;else{zn("transaction at "+c.toString()+" failed: "+u);for(let f=0;f<t.length;f++)t[f].status=4,t[f].abortReason=u}ux(n,e)}},s)}function ux(n,e){let t=OF(n,e),r=nh(t),i=NF(n,t);return hQ(n,i,r),r}function hQ(n,e,t){if(e.length===0)return;let r=[],i=[],s=e.filter(a=>a.status===0).map(a=>a.currentWriteId);for(let a=0;a<e.length;a++){let c=e[a],u=rr(t,c.path),d=!1,f;if(Y(u!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),c.status===4)d=!0,f=c.abortReason,i=i.concat(Yc(n.serverSyncTree_,c.currentWriteId,!0));else if(c.status===0)if(c.retryCount>=iQ)d=!0,f="maxretry",i=i.concat(Yc(n.serverSyncTree_,c.currentWriteId,!0));else{let v=AF(n,c.path,s);c.currentInputSnapshot=v;let _=e[a].update(v.val());if(_!==void 0){DF("transaction failed: Data returned ",_,c.path);let b=cn(_);typeof _=="object"&&_!=null&&Zr(_,".priority")||(b=b.updatePriority(v.getPriority()));let R=c.currentWriteId,G=MF(n),oe=WY(b,v,G);c.currentOutputSnapshotRaw=b,c.currentOutputSnapshotResolved=oe,c.currentWriteId=cQ(n),s.splice(s.indexOf(R),1),i=i.concat(LY(n.serverSyncTree_,c.path,oe,c.currentWriteId,c.applyLocally)),i=i.concat(Yc(n.serverSyncTree_,R,!0))}else d=!0,f="nodata",i=i.concat(Yc(n.serverSyncTree_,c.currentWriteId,!0))}aa(n.eventQueue_,t,i),i=[],d&&(e[a].status=2,function(v){setTimeout(v,Math.floor(0))}(e[a].unwatcher),e[a].onComplete&&(f==="nodata"?r.push(()=>e[a].onComplete(null,!1,e[a].currentInputSnapshot)):r.push(()=>e[a].onComplete(new Error(f),!1,null))))}hv(n,n.transactionQueueTree_);for(let a=0;a<r.length;a++)eh(r[a]);lx(n,n.transactionQueueTree_)}function OF(n,e){let t,r=n.transactionQueueTree_;for(t=Re(e);t!==null&&sl(r)===void 0;)r=ax(r,t),e=ot(e),t=Re(e);return r}function NF(n,e){let t=[];return RF(n,e,t),t.sort((r,i)=>r.order-i.order),t}function RF(n,e,t){let r=sl(e);if(r)for(let i=0;i<r.length;i++)t.push(r[i]);dv(e,i=>{RF(n,i,t)})}function hv(n,e){let t=sl(e);if(t){let r=0;for(let i=0;i<t.length;i++)t[i].status!==2&&(t[r]=t[i],r++);t.length=r,EF(e,t.length>0?t:void 0)}dv(e,r=>{hv(n,r)})}function fQ(n,e){let t=nh(OF(n,e)),r=ax(n.transactionQueueTree_,e);return GY(r,i=>{aE(n,i)}),aE(n,r),SF(r,i=>{aE(n,i)}),t}function aE(n,e){let t=sl(e);if(t){let r=[],i=[],o=-1;for(let s=0;s<t.length;s++)t[s].status===3||(t[s].status===1?(Y(o===s-1,"All SENT items should be at beginning of queue."),o=s,t[s].status=3,t[s].abortReason="set"):(Y(t[s].status===0,"Unexpected transaction status in abort"),t[s].unwatcher(),i=i.concat(Yc(n.serverSyncTree_,t[s].currentWriteId,!0)),t[s].onComplete&&r.push(t[s].onComplete.bind(null,new Error("set"),!1,null))));o===-1?EF(e,void 0):t.length=o+1,aa(n.eventQueue_,nh(e),i);for(let s=0;s<r.length;s++)eh(r[s])}}function pQ(n){let e="",t=n.split("/");for(let r=0;r<t.length;r++)if(t[r].length>0){let i=t[r];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch{}e+="/"+i}return e}function mQ(n){let e={};n.charAt(0)==="?"&&(n=n.substring(1));for(let t of n.split("&")){if(t.length===0)continue;let r=t.split("=");r.length===2?e[decodeURIComponent(r[0])]=decodeURIComponent(r[1]):zn(`Invalid query segment '${t}' in query '${n}'`)}return e}var T2=function(n,e){let t=gQ(n),r=t.namespace;t.domain==="firebase.com"&&qi(t.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!r||r==="undefined")&&t.domain!=="localhost"&&qi("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),t.secure||uK();let i=t.scheme==="ws"||t.scheme==="wss";return{repoInfo:new Zg(t.host,t.secure,r,i,e,"",r!==t.subdomain),path:new Xe(t.pathString)}},gQ=function(n){let e="",t="",r="",i="",o="",s=!0,a="https",c=443;if(typeof n=="string"){let u=n.indexOf("//");u>=0&&(a=n.substring(0,u-1),n=n.substring(u+2));let d=n.indexOf("/");d===-1&&(d=n.length);let f=n.indexOf("?");f===-1&&(f=n.length),e=n.substring(0,Math.min(d,f)),d<f&&(i=pQ(n.substring(d,f)));let v=mQ(n.substring(Math.min(n.length,f)));u=e.indexOf(":"),u>=0?(s=a==="https"||a==="wss",c=parseInt(e.substring(u+1),10)):u=e.length;let _=e.slice(0,u);if(_.toLowerCase()==="localhost")t="localhost";else if(_.split(".").length<=2)t=_;else{let b=e.indexOf(".");r=e.substring(0,b).toLowerCase(),t=e.substring(b+1),o=r}"ns"in v&&(o=v.ns)}return{host:e,port:c,domain:t,subdomain:r,secure:s,scheme:a,pathString:i,namespace:o}};var YE=class n{constructor(e,t,r,i){this._repo=e,this._path=t,this._queryParams=r,this._orderByCalled=i}get key(){return Ae(this._path)?null:K2(this._path)}get ref(){return new il(this._repo,this._path)}get _queryIdentifier(){let e=f2(this._queryParams),t=XE(e);return t==="{}"?"default":t}get _queryObject(){return f2(this._queryParams)}isEqual(e){if(e=lt(e),!(e instanceof n))return!1;let t=this._repo===e._repo,r=Z2(this._path,e._path),i=this._queryIdentifier===e._queryIdentifier;return t&&r&&i}toJSON(){return this.toString()}toString(){return this._repo.toString()+$K(this._path)}};var il=class n extends YE{constructor(e,t){super(e,t,new ME,!1)}get parent(){let e=Q2(this._path);return e===null?null:new n(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}};kY(il);FY(il);var vQ="FIREBASE_DATABASE_EMULATOR_HOST",QE={},_Q=!1;function yQ(n,e,t,r){let i=e.lastIndexOf(":"),o=e.substring(0,i),s=yr(o);n.repoInfo_=new Zg(e,s,n.repoInfo_.namespace,n.repoInfo_.webSocketOnly,n.repoInfo_.nodeAdmin,n.repoInfo_.persistenceKey,n.repoInfo_.includeNamespaceInQueryParams,!0,t),r&&(n.authTokenProvider_=r)}function wQ(n,e,t,r,i){let o=r||n.options.databaseURL;o===void 0&&(n.options.projectId||qi("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),an("Using default host for project ",n.options.projectId),o=`${n.options.projectId}-default-rtdb.firebaseio.com`);let s=T2(o,i),a=s.repoInfo,c,u;typeof process<"u"&&process.env&&(u=process.env[vQ]),u?(c=!0,o=`http://${u}?ns=${a.namespace}`,s=T2(o,i),a=s.repoInfo):c=!s.repoInfo.secure;let d=i&&c?new qd(qd.OWNER):new fE(n.name,n.options,e);XY("Invalid Firebase Database URL",s),Ae(s.path)||qi("Database URL must point to the root of a Firebase Database (not including a child path).");let f=bQ(a,n,d,new hE(n,t));return new ZE(f,n)}function CQ(n,e){let t=QE[e];(!t||t[n.key]!==n)&&qi(`Database ${e}(${n.repoInfo_}) has already been deleted.`),uQ(n),delete t[n.key]}function bQ(n,e,t,r){let i=QE[e.name];i||(i={},QE[e.name]=i);let o=i[n.toURLString()];return o&&qi("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),o=new KE(n,_Q,t,r),i[n.toURLString()]=o,o}var ZE=class{constructor(e,t){this._repoInternal=e,this.app=t,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(oQ(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new il(this._repo,Ge())),this._rootInternal}_delete(){return this._rootInternal!==null&&(CQ(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&qi("Cannot call "+e+" on a deleted database.")}};function kF(n=Ai(),e){let t=yo(n,"database").getImmediate({identifier:e});if(!t._instanceStarted){let r=Wp("database");r&&FF(t,...r)}return t}function FF(n,e,t,r={}){n=lt(n),n._checkNotDeleted("useEmulator");let i=`${e}:${t}`,o=n._repoInternal;if(n._instanceStarted){if(i===n._repoInternal.repoInfo_.host&&Qn(r,o.repoInfo_.emulatorOptions))return;qi("connectDatabaseEmulator() cannot initialize or alter the emulator configuration after the database instance has started.")}let s;if(o.repoInfo_.nodeAdmin)r.mockUserToken&&qi('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),s=new qd(qd.OWNER);else if(r.mockUserToken){let a=typeof r.mockUserToken=="string"?r.mockUserToken:qp(r.mockUserToken,n.app.options.projectId);s=new qd(a)}yr(e)&&(uc(e),dc("Database",!0)),yQ(o,i,r,s)}function IQ(n){aK(Xr),Bn(new Gt("database",(e,{instanceIdentifier:t})=>{let r=e.getProvider("app").getImmediate(),i=e.getProvider("auth-internal"),o=e.getProvider("app-check-internal");return wQ(r,i,o,t)},"PUBLIC").setMultipleInstances(!0)),Je(Yk,Qk,n),Je(Yk,Qk,"esm2017")}tx.prototype.simpleListen=function(n,e){this.sendRequest("q",{p:n},e)};tx.prototype.echo=function(n,e){this.sendRequest("echo",{d:n},e)};IQ();var rh=class{constructor(e){return e}},LF="database",dx=class{constructor(){return wo(LF)}};var hx=new J("angularfire2.database-instances");function EQ(n,e){let t=Os(LF,n,e);return t&&new rh(t)}function xQ(n){return(e,t)=>{let r=e.runOutsideAngular(()=>n(t));return new rh(r)}}var SQ={provide:dx,deps:[[new Mt,hx]]},TQ={provide:rh,useFactory:EQ,deps:[[new Mt,hx],wr]};function VF(n,...e){return Je("angularfire",ei.full,"rtdb"),En([TQ,SQ,{provide:hx,useFactory:xQ(n),multi:!0,deps:[Pe,rt,ti,Oi,[new Mt,Vs],[new Mt,bo],...e]}])}var jF=gt(kF,!0);var fx="Service workers are disabled or not supported by this browser",al=class{serviceWorker;worker;registration;events;constructor(e,t){if(this.serviceWorker=e,!e)this.worker=this.events=this.registration=new me(r=>r.error(new Z(5601,!1)));else{let r=null,i=new ct;this.worker=new me(u=>(r!==null&&u.next(r),i.subscribe(d=>u.next(d))));let o=()=>{let{controller:u}=e;u!==null&&(r=u,i.next(r))};e.addEventListener("controllerchange",o),o(),this.registration=this.worker.pipe($t(()=>e.getRegistration()));let s=new ct;this.events=s.asObservable();let a=u=>{let{data:d}=u;d?.type&&s.next(d)};e.addEventListener("message",a),t?.get(Vr,null,{optional:!0})?.onDestroy(()=>{e.removeEventListener("controllerchange",o),e.removeEventListener("message",a)})}}postMessage(e,t){return new Promise(r=>{this.worker.pipe(hn(1)).subscribe(i=>{i.postMessage(L({action:e},t)),r()})})}postMessageWithOperation(e,t,r){let i=this.waitForOperationCompleted(r),o=this.postMessage(e,t);return Promise.all([o,i]).then(([,s])=>s)}generateNonce(){return Math.round(Math.random()*1e7)}eventsOfType(e){let t;return typeof e=="string"?t=r=>r.type===e:t=r=>e.includes(r.type),this.events.pipe(Ut(t))}nextEventOfType(e){return this.eventsOfType(e).pipe(hn(1))}waitForOperationCompleted(e){return new Promise((t,r)=>{this.eventsOfType("OPERATION_COMPLETED").pipe(Ut(i=>i.nonce===e),hn(1),_e(i=>{if(i.result!==void 0)return i.result;throw new Error(i.error)})).subscribe({next:t,error:r})})}get isEnabled(){return!!this.serviceWorker}},DQ=(()=>{class n{sw;messages;notificationClicks;subscription;get isEnabled(){return this.sw.isEnabled}pushManager=null;subscriptionChanges=new ct;constructor(t){if(this.sw=t,!t.isEnabled){this.messages=es,this.notificationClicks=es,this.subscription=es;return}this.messages=this.sw.eventsOfType("PUSH").pipe(_e(i=>i.data)),this.notificationClicks=this.sw.eventsOfType("NOTIFICATION_CLICK").pipe(_e(i=>i.data)),this.pushManager=this.sw.registration.pipe(_e(i=>i.pushManager));let r=this.pushManager.pipe($t(i=>i.getSubscription()));this.subscription=new me(i=>{let o=r.subscribe(i),s=this.subscriptionChanges.subscribe(i);return()=>{o.unsubscribe(),s.unsubscribe()}})}requestSubscription(t){if(!this.sw.isEnabled||this.pushManager===null)return Promise.reject(new Error(fx));let r={userVisibleOnly:!0},i=this.decodeBase64(t.serverPublicKey.replace(/_/g,"/").replace(/-/g,"+")),o=new Uint8Array(new ArrayBuffer(i.length));for(let s=0;s<i.length;s++)o[s]=i.charCodeAt(s);return r.applicationServerKey=o,new Promise((s,a)=>{this.pushManager.pipe($t(c=>c.subscribe(r)),hn(1)).subscribe({next:c=>{this.subscriptionChanges.next(c),s(c)},error:a})})}unsubscribe(){if(!this.sw.isEnabled)return Promise.reject(new Error(fx));let t=r=>{if(r===null)throw new Z(5602,!1);return r.unsubscribe().then(i=>{if(!i)throw new Z(5603,!1);this.subscriptionChanges.next(null)})};return new Promise((r,i)=>{this.subscription.pipe(hn(1),$t(t)).subscribe({next:r,error:i})})}decodeBase64(t){return atob(t)}static \u0275fac=function(r){return new(r||n)(ee(al))};static \u0275prov=H({token:n,factory:n.\u0275fac})}return n})(),MQ=(()=>{class n{sw;versionUpdates;unrecoverable;get isEnabled(){return this.sw.isEnabled}constructor(t){if(this.sw=t,!t.isEnabled){this.versionUpdates=es,this.unrecoverable=es;return}this.versionUpdates=this.sw.eventsOfType(["VERSION_DETECTED","VERSION_INSTALLATION_FAILED","VERSION_READY","NO_NEW_VERSION_DETECTED"]),this.unrecoverable=this.sw.eventsOfType("UNRECOVERABLE_STATE")}checkForUpdate(){if(!this.sw.isEnabled)return Promise.reject(new Error(fx));let t=this.sw.generateNonce();return this.sw.postMessageWithOperation("CHECK_FOR_UPDATES",{nonce:t},t)}activateUpdate(){if(!this.sw.isEnabled)return Promise.reject(new Z(5601,!1));let t=this.sw.generateNonce();return this.sw.postMessageWithOperation("ACTIVATE_UPDATE",{nonce:t},t)}static \u0275fac=function(r){return new(r||n)(ee(al))};static \u0275prov=H({token:n,factory:n.\u0275fac})}return n})();var UF=new J("");function PQ(){let n=j(ih);if(!("serviceWorker"in navigator&&n.enabled!==!1))return;let e=j(UF),t=j(Pe),r=j(Vr);t.runOutsideAngular(()=>{let i=navigator.serviceWorker,o=()=>i.controller?.postMessage({action:"INITIALIZE"});i.addEventListener("controllerchange",o),r.onDestroy(()=>{i.removeEventListener("controllerchange",o)})}),t.runOutsideAngular(()=>{let i,{registrationStrategy:o}=n;if(typeof o=="function")i=new Promise(s=>o().subscribe(()=>s()));else{let[s,...a]=(o||"registerWhenStable:30000").split(":");switch(s){case"registerImmediately":i=Promise.resolve();break;case"registerWithDelay":i=BF(+a[0]||0);break;case"registerWhenStable":i=Promise.race([r.whenStable(),BF(+a[0])]);break;default:throw new Z(5600,!1)}}i.then(()=>{r.destroyed||navigator.serviceWorker.register(e,{scope:n.scope}).catch(s=>console.error(Lf(5604,!1)))})})}function BF(n){return new Promise(e=>setTimeout(e,n))}function AQ(n,e){return new al(n.enabled!==!1?navigator.serviceWorker:void 0,e)}var ih=class{enabled;scope;registrationStrategy};function $F(n,e={}){return En([DQ,MQ,{provide:UF,useValue:n},{provide:ih,useValue:e},{provide:al,useFactory:AQ,deps:[ih,rt]},Xl(PQ)])}var zF={production:!1,firebase:{apiKey:"AIzaSyD00RkPgtzB4eUSm0myL5aHAvW_zhb5pJA",authDomain:"global-financial-service-346f9.firebaseapp.com",projectId:"global-financial-service-346f9",storageBucket:"global-financial-service-346f9.firebasestorage.app",messagingSenderId:"408507363440",appId:"1:408507363440:web:d3a629d1da9646dcc404b5",measurementId:"G-S04YF9S6H5"}};var HF={providers:[cM({eventCoalescing:!0}),sw(Kk),My(Mn),xA(()=>SA(zF.firebase)),AO(()=>OO()),yk(()=>wk()),VF(()=>jF()),$F("ngsw-worker.js",{enabled:!nu(),registrationStrategy:"registerWhenStable:30000"})]};O0(Dg,HF);
